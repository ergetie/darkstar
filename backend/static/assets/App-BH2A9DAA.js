import{r as gb,a as y,R as xb,j as l,g as yb}from"./index-CoJUeHvy.js";var gp=gb();function nr(){return nr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},nr.apply(this,arguments)}var As;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(As||(As={}));const Bu="popstate";function bb(t){t===void 0&&(t={});function e(n,i){let{pathname:r,search:a,hash:o}=n.location;return Gl("",{pathname:r,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function s(n,i){return typeof i=="string"?i:Oa(i)}return _b(e,s,null,t)}function $e(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Xc(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function vb(){return Math.random().toString(36).substr(2,8)}function zu(t,e){return{usr:t.state,key:t.key,idx:e}}function Gl(t,e,s,n){return s===void 0&&(s=null),nr({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ni(e):e,{state:s,key:e&&e.key||n||vb()})}function Oa(t){let{pathname:e="/",search:s="",hash:n=""}=t;return s&&s!=="?"&&(e+=s.charAt(0)==="?"?s:"?"+s),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function ni(t){let e={};if(t){let s=t.indexOf("#");s>=0&&(e.hash=t.substr(s),t=t.substr(0,s));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function _b(t,e,s,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:r=!1}=n,a=i.history,o=As.Pop,c=null,d=u();d==null&&(d=0,a.replaceState(nr({},a.state,{idx:d}),""));function u(){return(a.state||{idx:null}).idx}function h(){o=As.Pop;let x=u(),v=x==null?null:x-d;d=x,c&&c({action:o,location:g.location,delta:v})}function f(x,v){o=As.Push;let _=Gl(g.location,x,v);d=u()+1;let S=zu(_,d),N=g.createHref(_);try{a.pushState(S,"",N)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;i.location.assign(N)}r&&c&&c({action:o,location:g.location,delta:1})}function m(x,v){o=As.Replace;let _=Gl(g.location,x,v);d=u();let S=zu(_,d),N=g.createHref(_);a.replaceState(S,"",N),r&&c&&c({action:o,location:g.location,delta:0})}function p(x){let v=i.location.origin!=="null"?i.location.origin:i.location.href,_=typeof x=="string"?x:Oa(x);return _=_.replace(/ $/,"%20"),$e(v,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,v)}let g={get action(){return o},get location(){return t(i,a)},listen(x){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(Bu,h),c=x,()=>{i.removeEventListener(Bu,h),c=null}},createHref(x){return e(i,x)},createURL:p,encodeLocation(x){let v=p(x);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:m,go(x){return a.go(x)}};return g}var Hu;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Hu||(Hu={}));function wb(t,e,s){return s===void 0&&(s="/"),kb(t,e,s)}function kb(t,e,s,n){let i=typeof e=="string"?ni(e):e,r=Xn(i.pathname||"/",s);if(r==null)return null;let a=xp(t);Sb(a);let o=null;for(let c=0;o==null&&c<a.length;++c){let d=Rb(r);o=Ab(a[c],d)}return o}function xp(t,e,s,n){e===void 0&&(e=[]),s===void 0&&(s=[]),n===void 0&&(n="");let i=(r,a,o)=>{let c={relativePath:o===void 0?r.path||"":o,caseSensitive:r.caseSensitive===!0,childrenIndex:a,route:r};c.relativePath.startsWith("/")&&($e(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=Ws([n,c.relativePath]),u=s.concat(c);r.children&&r.children.length>0&&($e(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),xp(r.children,e,u,d)),!(r.path==null&&!r.index)&&e.push({path:d,score:Db(d,r.index),routesMeta:u})};return t.forEach((r,a)=>{var o;if(r.path===""||!((o=r.path)!=null&&o.includes("?")))i(r,a);else for(let c of yp(r.path))i(r,a,c)}),e}function yp(t){let e=t.split("/");if(e.length===0)return[];let[s,...n]=e,i=s.endsWith("?"),r=s.replace(/\?$/,"");if(n.length===0)return i?[r,""]:[r];let a=yp(n.join("/")),o=[];return o.push(...a.map(c=>c===""?r:[r,c].join("/"))),i&&o.push(...a),o.map(c=>t.startsWith("/")&&c===""?"/":c)}function Sb(t){t.sort((e,s)=>e.score!==s.score?s.score-e.score:Eb(e.routesMeta.map(n=>n.childrenIndex),s.routesMeta.map(n=>n.childrenIndex)))}const jb=/^:[\w-]+$/,Nb=3,Tb=2,Mb=1,Cb=10,Pb=-2,$u=t=>t==="*";function Db(t,e){let s=t.split("/"),n=s.length;return s.some($u)&&(n+=Pb),e&&(n+=Tb),s.filter(i=>!$u(i)).reduce((i,r)=>i+(jb.test(r)?Nb:r===""?Mb:Cb),n)}function Eb(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function Ab(t,e,s){let{routesMeta:n}=t,i={},r="/",a=[];for(let o=0;o<n.length;++o){let c=n[o],d=o===n.length-1,u=r==="/"?e:e.slice(r.length)||"/",h=ql({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),f=c.route;if(!h)return null;Object.assign(i,h.params),a.push({params:i,pathname:Ws([r,h.pathname]),pathnameBase:Wb(Ws([r,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(r=Ws([r,h.pathnameBase]))}return a}function ql(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[s,n]=Ob(t.path,t.caseSensitive,t.end),i=e.match(s);if(!i)return null;let r=i[0],a=r.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((d,u,h)=>{let{paramName:f,isOptional:m}=u;if(f==="*"){let g=o[h]||"";a=r.slice(0,r.length-g.length).replace(/(.)\/+$/,"$1")}const p=o[h];return m&&!p?d[f]=void 0:d[f]=(p||"").replace(/%2F/g,"/"),d},{}),pathname:r,pathnameBase:a,pattern:t}}function Ob(t,e,s){e===void 0&&(e=!1),s===void 0&&(s=!0),Xc(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function Rb(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Xc(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Xn(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let s=e.endsWith("/")?e.length-1:e.length,n=t.charAt(s);return n&&n!=="/"?null:t.slice(s)||"/"}const Lb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Fb=t=>Lb.test(t);function Ib(t,e){e===void 0&&(e="/");let{pathname:s,search:n="",hash:i=""}=typeof t=="string"?ni(t):t,r;if(s)if(Fb(s))r=s;else{if(s.includes("//")){let a=s;s=s.replace(/\/\/+/g,"/"),Xc(!1,"Pathnames cannot have embedded double slashes - normalizing "+(a+" -> "+s))}s.startsWith("/")?r=Yu(s.substring(1),"/"):r=Yu(s,e)}else r=e;return{pathname:r,search:Bb(n),hash:zb(i)}}function Yu(t,e){let s=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?s.length>1&&s.pop():i!=="."&&s.push(i)}),s.length>1?s.join("/"):"/"}function il(t,e,s,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Vb(t){return t.filter((e,s)=>s===0||e.route.path&&e.route.path.length>0)}function bp(t,e){let s=Vb(t);return e?s.map((n,i)=>i===s.length-1?n.pathname:n.pathnameBase):s.map(n=>n.pathnameBase)}function vp(t,e,s,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=ni(t):(i=nr({},t),$e(!i.pathname||!i.pathname.includes("?"),il("?","pathname","search",i)),$e(!i.pathname||!i.pathname.includes("#"),il("#","pathname","hash",i)),$e(!i.search||!i.search.includes("#"),il("#","search","hash",i)));let r=t===""||i.pathname==="",a=r?"/":i.pathname,o;if(a==null)o=s;else{let h=e.length-1;if(!n&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),h-=1;i.pathname=f.join("/")}o=h>=0?e[h]:"/"}let c=Ib(i,o),d=a&&a!=="/"&&a.endsWith("/"),u=(r||a===".")&&s.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const Ws=t=>t.join("/").replace(/\/\/+/g,"/"),Wb=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Bb=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,zb=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Hb(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const _p=["post","put","patch","delete"];new Set(_p);const $b=["get",..._p];new Set($b);function ir(){return ir=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},ir.apply(this,arguments)}const co=y.createContext(null),wp=y.createContext(null),Ks=y.createContext(null),uo=y.createContext(null),jn=y.createContext({outlet:null,matches:[],isDataRoute:!1}),kp=y.createContext(null);function Yb(t,e){let{relative:s}=e===void 0?{}:e;kr()||$e(!1);let{basename:n,navigator:i}=y.useContext(Ks),{hash:r,pathname:a,search:o}=ho(t,{relative:s}),c=a;return n!=="/"&&(c=a==="/"?n:Ws([n,a])),i.createHref({pathname:c,search:o,hash:r})}function kr(){return y.useContext(uo)!=null}function Nn(){return kr()||$e(!1),y.useContext(uo).location}function Sp(t){y.useContext(Ks).static||y.useLayoutEffect(t)}function jp(){let{isDataRoute:t}=y.useContext(jn);return t?iv():Ub()}function Ub(){kr()||$e(!1);let t=y.useContext(co),{basename:e,future:s,navigator:n}=y.useContext(Ks),{matches:i}=y.useContext(jn),{pathname:r}=Nn(),a=JSON.stringify(bp(i,s.v7_relativeSplatPath)),o=y.useRef(!1);return Sp(()=>{o.current=!0}),y.useCallback(function(d,u){if(u===void 0&&(u={}),!o.current)return;if(typeof d=="number"){n.go(d);return}let h=vp(d,JSON.parse(a),r,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ws([e,h.pathname])),(u.replace?n.replace:n.push)(h,u.state,u)},[e,n,a,r,t])}function ho(t,e){let{relative:s}=e===void 0?{}:e,{future:n}=y.useContext(Ks),{matches:i}=y.useContext(jn),{pathname:r}=Nn(),a=JSON.stringify(bp(i,n.v7_relativeSplatPath));return y.useMemo(()=>vp(t,JSON.parse(a),r,s==="path"),[t,a,r,s])}function Gb(t,e){return qb(t,e)}function qb(t,e,s,n){kr()||$e(!1);let{navigator:i}=y.useContext(Ks),{matches:r}=y.useContext(jn),a=r[r.length-1],o=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let d=Nn(),u;if(e){var h;let x=typeof e=="string"?ni(e):e;c==="/"||(h=x.pathname)!=null&&h.startsWith(c)||$e(!1),u=x}else u=d;let f=u.pathname||"/",m=f;if(c!=="/"){let x=c.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(x.length).join("/")}let p=wb(t,{pathname:m}),g=Qb(p&&p.map(x=>Object.assign({},x,{params:Object.assign({},o,x.params),pathname:Ws([c,i.encodeLocation?i.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?c:Ws([c,i.encodeLocation?i.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),r,s,n);return e&&g?y.createElement(uo.Provider,{value:{location:ir({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:As.Pop}},g):g}function Kb(){let t=nv(),e=Hb(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),s=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},e),s?y.createElement("pre",{style:i},s):null,null)}const Xb=y.createElement(Kb,null);class Zb extends y.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,s){return s.location!==e.location||s.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:s.error,location:s.location,revalidation:e.revalidation||s.revalidation}}componentDidCatch(e,s){console.error("React Router caught the following error during render",e,s)}render(){return this.state.error!==void 0?y.createElement(jn.Provider,{value:this.props.routeContext},y.createElement(kp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Jb(t){let{routeContext:e,match:s,children:n}=t,i=y.useContext(co);return i&&i.static&&i.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=s.route.id),y.createElement(jn.Provider,{value:e},n)}function Qb(t,e,s,n){var i;if(e===void 0&&(e=[]),s===void 0&&(s=null),n===void 0&&(n=null),t==null){var r;if(!s)return null;if(s.errors)t=s.matches;else if((r=n)!=null&&r.v7_partialHydration&&e.length===0&&!s.initialized&&s.matches.length>0)t=s.matches;else return null}let a=t,o=(i=s)==null?void 0:i.errors;if(o!=null){let u=a.findIndex(h=>h.route.id&&o?.[h.route.id]!==void 0);u>=0||$e(!1),a=a.slice(0,Math.min(a.length,u+1))}let c=!1,d=-1;if(s&&n&&n.v7_partialHydration)for(let u=0;u<a.length;u++){let h=a[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=u),h.route.id){let{loaderData:f,errors:m}=s,p=h.route.loader&&f[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||p){c=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((u,h,f)=>{let m,p=!1,g=null,x=null;s&&(m=o&&h.route.id?o[h.route.id]:void 0,g=h.route.errorElement||Xb,c&&(d<0&&f===0?(rv("route-fallback"),p=!0,x=null):d===f&&(p=!0,x=h.route.hydrateFallbackElement||null)));let v=e.concat(a.slice(0,f+1)),_=()=>{let S;return m?S=g:p?S=x:h.route.Component?S=y.createElement(h.route.Component,null):h.route.element?S=h.route.element:S=u,y.createElement(Jb,{match:h,routeContext:{outlet:u,matches:v,isDataRoute:s!=null},children:S})};return s&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?y.createElement(Zb,{location:s.location,revalidation:s.revalidation,component:g,error:m,children:_(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):_()},null)}var Np=(function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t})(Np||{}),Tp=(function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t})(Tp||{});function ev(t){let e=y.useContext(co);return e||$e(!1),e}function tv(t){let e=y.useContext(wp);return e||$e(!1),e}function sv(t){let e=y.useContext(jn);return e||$e(!1),e}function Mp(t){let e=sv(),s=e.matches[e.matches.length-1];return s.route.id||$e(!1),s.route.id}function nv(){var t;let e=y.useContext(kp),s=tv(),n=Mp();return e!==void 0?e:(t=s.errors)==null?void 0:t[n]}function iv(){let{router:t}=ev(Np.UseNavigateStable),e=Mp(Tp.UseNavigateStable),s=y.useRef(!1);return Sp(()=>{s.current=!0}),y.useCallback(function(i,r){r===void 0&&(r={}),s.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,ir({fromRouteId:e},r)))},[t,e])}const Uu={};function rv(t,e,s){Uu[t]||(Uu[t]=!0)}function av(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath}function ds(t){$e(!1)}function ov(t){let{basename:e="/",children:s=null,location:n,navigationType:i=As.Pop,navigator:r,static:a=!1,future:o}=t;kr()&&$e(!1);let c=e.replace(/^\/*/,"/"),d=y.useMemo(()=>({basename:c,navigator:r,static:a,future:ir({v7_relativeSplatPath:!1},o)}),[c,o,r,a]);typeof n=="string"&&(n=ni(n));let{pathname:u="/",search:h="",hash:f="",state:m=null,key:p="default"}=n,g=y.useMemo(()=>{let x=Xn(u,c);return x==null?null:{location:{pathname:x,search:h,hash:f,state:m,key:p},navigationType:i}},[c,u,h,f,m,p,i]);return g==null?null:y.createElement(Ks.Provider,{value:d},y.createElement(uo.Provider,{children:s,value:g}))}function lv(t){let{children:e,location:s}=t;return Gb(Kl(e),s)}new Promise(()=>{});function Kl(t,e){e===void 0&&(e=[]);let s=[];return y.Children.forEach(t,(n,i)=>{if(!y.isValidElement(n))return;let r=[...e,i];if(n.type===y.Fragment){s.push.apply(s,Kl(n.props.children,r));return}n.type!==ds&&$e(!1),!n.props.index||!n.props.children||$e(!1);let a={id:n.props.id||r.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=Kl(n.props.children,r)),s.push(a)}),s}function Ra(){return Ra=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},Ra.apply(this,arguments)}function Cp(t,e){if(t==null)return{};var s={},n=Object.keys(t),i,r;for(r=0;r<n.length;r++)i=n[r],!(e.indexOf(i)>=0)&&(s[i]=t[i]);return s}function cv(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function dv(t,e){return t.button===0&&(!e||e==="_self")&&!cv(t)}function Xl(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,s)=>{let n=t[s];return e.concat(Array.isArray(n)?n.map(i=>[s,i]):[[s,n]])},[]))}function uv(t,e){let s=Xl(t);return e&&e.forEach((n,i)=>{s.has(i)||e.getAll(i).forEach(r=>{s.append(i,r)})}),s}const hv=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],fv=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],mv="6";try{window.__reactRouterVersion=mv}catch{}const pv=y.createContext({isTransitioning:!1}),gv="startTransition",Gu=xb[gv];function xv(t){let{basename:e,children:s,future:n,window:i}=t,r=y.useRef();r.current==null&&(r.current=bb({window:i,v5Compat:!0}));let a=r.current,[o,c]=y.useState({action:a.action,location:a.location}),{v7_startTransition:d}=n||{},u=y.useCallback(h=>{d&&Gu?Gu(()=>c(h)):c(h)},[c,d]);return y.useLayoutEffect(()=>a.listen(u),[a,u]),y.useEffect(()=>av(n),[n]),y.createElement(ov,{basename:e,children:s,location:o.location,navigationType:o.action,navigator:a,future:n})}const yv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",bv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,hn=y.forwardRef(function(e,s){let{onClick:n,relative:i,reloadDocument:r,replace:a,state:o,target:c,to:d,preventScrollReset:u,viewTransition:h}=e,f=Cp(e,hv),{basename:m}=y.useContext(Ks),p,g=!1;if(typeof d=="string"&&bv.test(d)&&(p=d,yv))try{let S=new URL(window.location.href),N=d.startsWith("//")?new URL(S.protocol+d):new URL(d),j=Xn(N.pathname,m);N.origin===S.origin&&j!=null?d=j+N.search+N.hash:g=!0}catch{}let x=Yb(d,{relative:i}),v=wv(d,{replace:a,state:o,target:c,preventScrollReset:u,relative:i,viewTransition:h});function _(S){n&&n(S),S.defaultPrevented||v(S)}return y.createElement("a",Ra({},f,{href:p||x,onClick:g||r?n:_,ref:s,target:c}))}),vv=y.forwardRef(function(e,s){let{"aria-current":n="page",caseSensitive:i=!1,className:r="",end:a=!1,style:o,to:c,viewTransition:d,children:u}=e,h=Cp(e,fv),f=ho(c,{relative:h.relative}),m=Nn(),p=y.useContext(wp),{navigator:g,basename:x}=y.useContext(Ks),v=p!=null&&Sv(f)&&d===!0,_=g.encodeLocation?g.encodeLocation(f).pathname:f.pathname,S=m.pathname,N=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;i||(S=S.toLowerCase(),N=N?N.toLowerCase():null,_=_.toLowerCase()),N&&x&&(N=Xn(N,x)||N);const j=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let k=S===_||!a&&S.startsWith(_)&&S.charAt(j)==="/",T=N!=null&&(N===_||!a&&N.startsWith(_)&&N.charAt(_.length)==="/"),M={isActive:k,isPending:T,isTransitioning:v},P=k?n:void 0,O;typeof r=="function"?O=r(M):O=[r,k?"active":null,T?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let A=typeof o=="function"?o(M):o;return y.createElement(hn,Ra({},h,{"aria-current":P,className:O,ref:s,style:A,to:c,viewTransition:d}),typeof u=="function"?u(M):u)});var Zl;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Zl||(Zl={}));var qu;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(qu||(qu={}));function _v(t){let e=y.useContext(co);return e||$e(!1),e}function wv(t,e){let{target:s,replace:n,state:i,preventScrollReset:r,relative:a,viewTransition:o}=e===void 0?{}:e,c=jp(),d=Nn(),u=ho(t,{relative:a});return y.useCallback(h=>{if(dv(h,s)){h.preventDefault();let f=n!==void 0?n:Oa(d)===Oa(u);c(t,{replace:f,state:i,preventScrollReset:r,relative:a,viewTransition:o})}},[d,c,u,n,i,s,t,r,a,o])}function kv(t){let e=y.useRef(Xl(t)),s=y.useRef(!1),n=Nn(),i=y.useMemo(()=>uv(n.search,s.current?null:e.current),[n.search]),r=jp(),a=y.useCallback((o,c)=>{const d=Xl(typeof o=="function"?o(i):o);s.current=!0,r("?"+d,c)},[r,i]);return[i,a]}function Sv(t,e){e===void 0&&(e={});let s=y.useContext(pv);s==null&&$e(!1);let{basename:n}=_v(Zl.useViewTransitionState),i=ho(t,{relative:e.relative});if(!s.isTransitioning)return!1;let r=Xn(s.currentLocation.pathname,n)||s.currentLocation.pathname,a=Xn(s.nextLocation.pathname,n)||s.nextLocation.pathname;return ql(i.pathname,a)!=null||ql(i.pathname,r)!=null}const jv=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Pp=(...t)=>t.filter((e,s,n)=>!!e&&n.indexOf(e)===s).join(" ");var Nv={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Tv=y.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:i="",children:r,iconNode:a,...o},c)=>y.createElement("svg",{ref:c,...Nv,width:e,height:e,stroke:t,strokeWidth:n?Number(s)*24/Number(e):s,className:Pp("lucide",i),...o},[...a.map(([d,u])=>y.createElement(d,u)),...Array.isArray(r)?r:[r]]));const te=(t,e)=>{const s=y.forwardRef(({className:n,...i},r)=>y.createElement(Tv,{ref:r,iconNode:e,className:Pp(`lucide-${jv(t)}`,n),...i}));return s.displayName=`${t}`,s};const rr=te("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);const Dp=te("ArrowDownToLine",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);const Ep=te("ArrowUpFromLine",[["path",{d:"m18 9-6-6-6 6",key:"kcunyi"}],["path",{d:"M12 3v14",key:"7cf3v8"}],["path",{d:"M5 21h14",key:"11awu3"}]]);const Sr=te("BatteryCharging",[["path",{d:"M15 7h1a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2h-2",key:"1sdynx"}],["path",{d:"M6 7H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h1",key:"1gkd3k"}],["path",{d:"m11 7-3 5h4l-3 5",key:"b4a64w"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]);const fo=te("Battery",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]);const rl=te("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);const Jl=te("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);const Ap=te("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);const Ku=te("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);const Xu=te("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const mo=te("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const al=te("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const ol=te("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const Mv=te("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const Op=te("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const Cv=te("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const Zu=te("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);const Ju=te("CloudRain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]);const Pv=te("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]);const Ql=te("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);const Rp=te("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);const po=te("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);const Dv=te("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const Lp=te("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);const La=te("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);const Qu=te("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);const Ev=te("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);const Fp=te("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);const ec=te("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);const tc=te("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const Av=te("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);const Ov=te("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);const Rv=te("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);const Lv=te("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);const Ip=te("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);const Fv=te("Plug",[["path",{d:"M12 22v-5",key:"1ega77"}],["path",{d:"M9 8V2",key:"14iosj"}],["path",{d:"M15 8V2",key:"18g5xt"}],["path",{d:"M18 8v5a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V8Z",key:"osxo6l"}]]);const Vp=te("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);const Iv=te("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);const Zc=te("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const Fa=te("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const Vv=te("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);const Wv=te("SlidersVertical",[["line",{x1:"4",x2:"4",y1:"21",y2:"14",key:"1p332r"}],["line",{x1:"4",x2:"4",y1:"10",y2:"3",key:"gb41h5"}],["line",{x1:"12",x2:"12",y1:"21",y2:"12",key:"hf2csr"}],["line",{x1:"12",x2:"12",y1:"8",y2:"3",key:"1kfi7u"}],["line",{x1:"20",x2:"20",y1:"21",y2:"16",key:"1lhrwl"}],["line",{x1:"20",x2:"20",y1:"12",y2:"3",key:"16vvfq"}],["line",{x1:"2",x2:"6",y1:"14",y2:"14",key:"1uebub"}],["line",{x1:"10",x2:"14",y1:"8",y2:"8",key:"1yglbp"}],["line",{x1:"18",x2:"22",y1:"16",y2:"16",key:"1jxqpz"}]]);const Wp=te("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);const Bp=te("SunMedium",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 3v1",key:"1asbbs"}],["path",{d:"M12 20v1",key:"1wcdkc"}],["path",{d:"M3 12h1",key:"lp3yf2"}],["path",{d:"M20 12h1",key:"1vloll"}],["path",{d:"m18.364 5.636-.707.707",key:"1hakh0"}],["path",{d:"m6.343 17.657-.707.707",key:"18m9nf"}],["path",{d:"m5.636 5.636.707.707",key:"1xv1c5"}],["path",{d:"m17.657 17.657.707.707",key:"vl76zb"}]]);const jr=te("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);const eh=te("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);const Bv=te("TreePalm",[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]]);const th=te("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);const sc=te("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);const va=te("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const zp=te("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);const ii=te("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);const It=te("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function ll(t){return l.jsx("svg",{viewBox:"0 0 741 741",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t,children:l.jsx("path",{d:"m0-71v71h741v-142h-741zm0 882.5v70.5h741v-141h-741zm355.5-782.94c-3.3 0.83-8.48 2.92-11.5 4.62-3.02 1.71-6.85 4.12-8.5 5.36-1.65 1.23-4.89 4.66-7.2 7.6-2.31 2.95-5.52 8.06-7.13 11.36-1.61 3.3-5.03 13.2-7.6 22-2.57 8.8-5.52 18.7-6.55 22-1.03 3.3-4.63 15.9-8.01 28-3.37 12.1-6.97 24.7-7.98 28-1.02 3.3-3.5 11.63-5.51 18.5-2.01 6.88-6.14 19.93-9.18 29-3.04 9.08-8.34 22.35-11.76 29.5-3.43 7.15-8.26 16.15-10.75 20-2.48 3.85-7.22 10.38-10.53 14.5-3.31 4.13-9.12 10.22-12.91 13.55-3.79 3.32-8.69 7.4-10.89 9.06-2.2 1.65-7.6 5.29-12 8.09-4.4 2.79-18.35 10.37-31 16.84-12.65 6.47-25.7 13.66-29 15.97-3.3 2.32-7.61 6.19-9.58 8.6-1.98 2.41-4.74 6.42-6.14 8.89-1.41 2.48-3.38 6.98-4.4 10-1.29 3.85-1.83 8.35-1.81 15 0.03 7.34 0.58 11.09 2.42 16.5 1.39 4.06 4.31 9.5 6.95 12.97 2.51 3.28 7.09 8 10.19 10.5 3.09 2.49 13.44 8.52 23 13.4 9.55 4.88 21.19 10.92 25.87 13.43 4.68 2.51 11.87 6.81 16 9.55 4.12 2.75 10.65 7.55 14.5 10.67 3.85 3.12 9.93 8.82 13.5 12.66 3.57 3.84 9.4 11.22 12.95 16.4 3.55 5.18 8.58 13.7 11.17 18.92 2.59 5.23 5.69 11.98 6.9 15 1.2 3.03 3.67 9.78 5.49 15 1.82 5.23 5.56 16.7 8.31 25.5 2.76 8.8 7.55 24.78 10.65 35.5 3.11 10.73 7.84 26.93 10.51 36 2.68 9.08 6.93 23.81 9.45 32.75 2.51 8.94 5.64 18.39 6.95 21 1.31 2.61 4.09 7 6.19 9.75 2.09 2.75 5.63 6.67 7.87 8.72 2.23 2.04 6.54 5.05 9.56 6.69 3.02 1.64 8.43 3.73 12 4.66 4.88 1.26 8.62 1.53 15 1.06 6.56-0.49 10.1-1.36 15.5-3.85 3.85-1.77 9.25-4.88 12-6.92 2.75-2.03 6.56-5.65 8.47-8.03 1.91-2.38 4.98-7.25 6.82-10.83 1.84-3.57 4.02-8.97 4.84-12 0.82-3.02 2.79-10 4.36-15.5 1.58-5.5 5.36-18.55 8.4-29 3.05-10.45 8.5-29.12 12.12-41.5 3.61-12.37 7.45-25.54 8.53-29.25 1.08-3.71 4.71-14.51 8.07-24 3.36-9.49 8.51-22.2 11.45-28.25 2.93-6.05 7.22-13.92 9.53-17.5 2.3-3.57 6.76-9.65 9.91-13.5 3.15-3.85 8.94-10.04 12.86-13.75 3.93-3.71 10.4-9.04 14.39-11.84 3.99-2.8 11.3-7.48 16.25-10.4 4.95-2.92 17.77-9.76 28.5-15.19 10.73-5.44 21.52-11.27 24-12.96 2.48-1.69 6.71-5.5 9.41-8.47 2.7-2.96 6.38-8.54 8.18-12.39 1.8-3.85 3.75-10.04 4.34-13.75 0.73-4.63 0.76-8.94 0.07-13.75-0.55-3.85-1.92-9.59-3.05-12.75-1.12-3.16-4.05-8.56-6.5-12-2.45-3.44-6.81-8.02-9.7-10.17-2.89-2.16-16.05-9.52-29.25-16.35-13.2-6.84-28.09-15.08-33.1-18.33-5-3.24-11.08-7.21-13.5-8.81-2.42-1.59-8.67-7.22-13.9-12.5-5.23-5.27-12.25-13.64-15.6-18.59-3.36-4.95-8.02-12.6-10.35-17-2.34-4.4-5.36-10.7-6.71-14-1.36-3.3-4.63-11.85-7.28-19-2.66-7.15-6.72-19.75-9.03-28-2.32-8.25-5.29-18.37-6.6-22.5-1.31-4.12-5.28-17.62-8.81-30-3.53-12.37-8.1-28.12-10.15-35-2.06-6.87-4.52-15.42-5.48-19-0.96-3.57-3.15-9.87-4.87-14-1.72-4.12-5.34-10.42-8.03-14-3.25-4.3-7.22-8.01-11.75-10.97-3.76-2.46-9.32-5.31-12.34-6.33-3.02-1.03-9.1-2.04-13.5-2.26-5.13-0.26-10.16 0.14-14 1.12z"})})}async function ne(t,e="GET",s){const n=t.startsWith("/")?t.slice(1):t,i={method:e,headers:{Accept:"application/json","Content-Type":"application/json"}};s&&(e==="POST"||e==="DELETE")&&(i.body=JSON.stringify(s));const r=await fetch(n,i);if(!r.ok)throw new Error(`${t} -> ${r.status}`);return r.json()}const K={dashboardBundle:()=>ne("/api/dashboard/bundle"),schedule:()=>ne("/api/schedule"),scheduleTodayWithHistory:()=>ne("/api/schedule/today_with_history"),status:()=>ne("/api/status"),health:()=>ne("/api/health"),version:()=>ne("/api/version"),horizon:()=>ne("/api/forecast/horizon"),config:()=>ne("/api/config"),configSave:async t=>{const e=await fetch("api/config/save",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}),s=await e.json();if(!e.ok){if(e.status===400&&s.detail){const n=s.detail,r=(n.errors||[])[0];throw r?new Error(r.message+": "+r.guidance):new Error(n.message||"Configuration error")}throw new Error(`/api/config/save -> ${e.status}`)}return s},configReset:()=>ne("/api/config/reset","POST"),setTheme:t=>ne("/api/theme","POST",t),haAverage:()=>ne("/api/ha/average"),haWaterToday:()=>ne("/api/ha/water_today"),haTest:t=>ne("/api/ha/test","POST",t),haEntities:()=>ne("/api/ha/entities"),haServices:()=>ne("/api/ha/services"),haEntityState:t=>ne(`/api/ha/entity/${t}`),learningStatus:()=>ne("/api/learning/status"),learningHistory:()=>ne("/api/learning/history"),learningDailyMetrics:()=>ne("/api/learning/daily_metrics"),learningRun:()=>ne("/api/learning/run","POST"),learningLoops:()=>ne("/api/learning/loops"),theme:()=>ne("/api/themes"),runPlanner:()=>ne("/api/run_planner","POST"),resetToOptimal:()=>ne("/api/schedule/save","POST"),simulate:async t=>{const e=await fetch("api/simulate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok)throw new Error("Simulation failed");return e.json()},getAdvice:async()=>{const t=await fetch("api/analyst/advice");if(!t.ok)throw new Error("Failed to fetch advice");return t.json()},analystRun:()=>ne("/api/analyst/run"),debug:()=>ne("/api/debug"),debugLogs:()=>ne("/api/debug/logs"),historySoc:(t="today")=>ne(`/api/history/soc?date=${t}`),forecastEval:()=>ne("/api/forecast/eval"),forecastDay:t=>ne(t?`/api/forecast/day?date=${t}`:"/api/forecast/day"),forecastRunEval:(t=7)=>ne("/api/forecast/run_eval","POST",{days_back:t}),forecastRunForward:(t=48)=>ne("/api/forecast/run_forward","POST",{horizon_hours:t}),schedulerStatus:()=>ne("/api/scheduler/status"),aurora:{dashboard:()=>ne("/api/aurora/dashboard"),briefing:t=>ne("/api/aurora/briefing","POST",t),toggleReflex:t=>ne("/api/aurora/config/toggle_reflex","POST",{enabled:t})},performanceData:(t=7)=>ne(`/api/performance/data?days=${t}`),executor:{status:()=>ne("/api/executor/status"),run:()=>ne("/api/executor/run","POST"),pause:(t=60)=>ne("/api/executor/pause","POST",{duration_minutes:t}),resume:()=>ne("/api/executor/resume","POST"),quickAction:{get:()=>ne("/api/executor/quick-action"),set:(t,e,s)=>ne("/api/executor/quick-action","POST",{action:t,duration_minutes:e,params:s}),clear:()=>ne("/api/executor/quick-action","DELETE")}},waterBoost:{status:()=>ne("/api/water/boost"),start:t=>ne("/api/water/boost","POST",{duration_minutes:t}),cancel:()=>ne("/api/water/boost","DELETE")},energyToday:()=>ne("/api/energy/today"),energyRange:t=>ne(`/api/energy/range?period=${t}`)};function Hp(){const[t,e]=y.useState("dark"),[s,n]=y.useState(!0),i=c=>c==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":c,r=c=>{const d=document.documentElement;c==="dark"?d.classList.add("dark"):d.classList.remove("dark")};y.useEffect(()=>{(async()=>{try{const u=(await K.config())?.ui?.theme_mode;if(u&&["light","dark","system"].includes(u))e(u),r(i(u));else{const h=localStorage.getItem("darkstar-theme");h&&["light","dark","system"].includes(h)?(e(h),r(i(h))):(e("dark"),r("dark"))}}catch{const u=localStorage.getItem("darkstar-theme")||"dark";e(u),r(i(u))}finally{n(!1)}})()},[]),y.useEffect(()=>{if(t!=="system")return;const c=window.matchMedia("(prefers-color-scheme: dark)"),d=u=>{r(u.matches?"dark":"light")};return c.addEventListener("change",d),()=>c.removeEventListener("change",d)},[t]);const a=async()=>{const c=t==="dark"?"light":"dark";e(c),r(c),localStorage.setItem("darkstar-theme",c);try{await K.configSave({ui:{theme_mode:c}})}catch(d){console.warn("[ThemeToggle] Failed to save theme to backend:",d)}};if(s)return l.jsx("div",{className:"h-12 w-12 rounded-2xl border border-line/70 bg-surface/80 flex items-center justify-center",children:l.jsx("div",{className:"h-5 w-5 rounded-full bg-muted/30 animate-pulse"})});const o=i(t);return l.jsxs("button",{type:"button",onClick:a,className:"group relative flex items-center justify-center w-12 h-12 rounded-2xl border border-line/70 bg-surface/80 hover:bg-surface2 transition",title:`Switch to ${o==="dark"?"light":"dark"} mode`,children:[o==="dark"?l.jsx(jr,{className:"h-5 w-5 text-muted group-hover:text-accent transition-colors"}):l.jsx(Ov,{className:"h-5 w-5 text-muted group-hover:text-accent transition-colors"}),l.jsx("span",{className:"absolute -right-2 top-1 rounded-full bg-surface2/90 border border-line/60 px-2 py-0.5 text-[10px] text-muted opacity-0 group-hover:opacity-100 transition z-50 whitespace-nowrap",children:o==="dark"?"Light mode":"Dark mode"})]})}const wi=({to:t,icon:e,label:s,onClick:n})=>{const i="group relative flex items-center justify-center w-12 h-12 rounded-2xl border border-line/70 bg-surface2 hover:brightness-110 transition",r="ring-2 ring-accent/50",a=l.jsxs(l.Fragment,{children:[l.jsx(e,{className:"h-5 w-5 text-muted group-hover:text-text"}),l.jsx("span",{className:"absolute -right-2 top-1 rounded-pill bg-surface2/90 border border-line/60 px-2 py-0.5 text-[10px] text-muted opacity-0 group-hover:opacity-100 transition z-50 whitespace-nowrap",children:s})]});return t?l.jsx(vv,{to:t,className:({isActive:o})=>`${i} ${o?r:""}`,title:s,children:a}):l.jsx("button",{onClick:n,className:i,title:s,children:a})};function zv(){const{pathname:t}=Nn(),[e,s]=y.useState(!1),[n,i]=y.useState(null),[r,a]=y.useState("...");y.useEffect(()=>{const c=async()=>{try{await K.status(),i(!0)}catch{i(!1)}};c();const d=setInterval(c,3e4);return()=>clearInterval(d)},[]),y.useEffect(()=>{K.version().then(c=>a(c.version||"dev")).catch(()=>a("dev"))},[]);const o=()=>s(!1);return l.jsxs(l.Fragment,{children:[l.jsx("aside",{className:"hidden lg:block fixed left-6 top-6 bottom-6 z-50",children:l.jsxs("div",{className:"h-full w-16 rounded-2xl bg-surface shadow-float border border-line/60 flex flex-col items-center gap-3 p-2",children:[l.jsxs(hn,{to:"/",className:"mt-1 mb-1 flex items-center justify-center group relative",children:[l.jsx("span",{className:"inline-flex h-12 w-12 items-center justify-center rounded-2xl bg-surface2 border border-line/60 overflow-hidden",children:l.jsx(ll,{className:"h-8 w-8 text-accent"})}),l.jsxs("span",{className:"absolute left-14 top-1/2 -translate-y-1/2 rounded-pill bg-surface2/90 border border-line/60 px-2 py-0.5 text-[10px] text-muted opacity-0 group-hover:opacity-100 transition whitespace-nowrap z-50 pointer-events-none",children:["darkstar v",r]})]}),l.jsx(wi,{to:"/",icon:La,label:"Dash"}),l.jsx(wi,{to:"/executor",icon:Ql,label:"Executor"}),l.jsx(wi,{to:"/aurora",icon:Jl,label:"Aurora"}),l.jsx(wi,{to:"/debug",icon:Ku,label:"Debug"}),l.jsx("div",{className:"mt-auto w-8 h-px bg-line/70"}),l.jsxs("div",{className:"py-2 flex flex-col items-center gap-2",children:[l.jsx("div",{className:`h-1.5 w-1.5 rounded-full transition-all duration-500 ${n===!0?"bg-good shadow-[0_0_8px_rgba(31,178,86,0.5)]":n===!1?"bg-bad":"bg-slate-700"}`,title:n===!0?"System Online":n===!1?"System Offline":"Connecting..."}),l.jsxs("span",{className:"text-[10px] text-muted/60 font-mono select-none tracking-widest whitespace-nowrap opacity-80 hover:opacity-100 transition",style:{writingMode:"vertical-rl",transform:"rotate(180deg)"},children:["darkstar v",r]})]}),l.jsx(Hp,{}),l.jsx(wi,{to:"/settings",icon:Fa,label:"Settings"})]})}),l.jsxs("div",{className:"lg:hidden fixed top-0 left-0 right-0 z-40 bg-surface/95 border-b border-line/60 flex items-center justify-between px-4 py-2",children:[l.jsx("button",{type:"button","aria-label":"Open navigation",className:"inline-flex h-10 w-10 items-center justify-center rounded-xl border border-line/70 bg-surface2 text-muted hover:border-accent hover:text-accent",onClick:()=>s(!0),children:l.jsx(Av,{className:"h-5 w-5"})}),l.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-muted",children:[l.jsx(ll,{className:"h-5 w-5 text-accent"}),l.jsxs("span",{className:"font-mono",children:["v",r]})]}),l.jsx("div",{className:"w-10"})]}),e&&l.jsxs("div",{className:"lg:hidden fixed inset-0 z-50 bg-[rgba(4,6,10,0.92)] backdrop-blur-sm",children:[l.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-line/60",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[l.jsx("span",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-surface2 border border-line/60",children:l.jsx(ll,{className:"h-5 w-5 text-accent"})}),l.jsxs("span",{className:"text-muted font-mono",children:["darkstar v",r]})]}),l.jsx("button",{type:"button","aria-label":"Close navigation",className:"inline-flex h-9 w-9 items-center justify-center rounded-xl border border-line/70 bg-surface text-muted hover:border-accent hover:text-accent",onClick:o,children:l.jsx(ii,{className:"h-5 w-5"})})]}),l.jsxs("div",{className:"p-4 grid grid-cols-2 gap-3",onClick:o,children:[l.jsxs(hn,{to:"/",className:`flex flex-col items-center justify-center gap-2 p-4 rounded-2xl border ${t==="/"?"bg-surface2 border-accent/50 ring-1 ring-accent/50":"bg-surface/50 border-line/70"}`,children:[l.jsx(La,{className:`h-6 w-6 ${t==="/"?"text-accent":"text-muted"}`}),l.jsx("span",{className:"text-sm",children:"Dash"})]}),l.jsxs(hn,{to:"/executor",className:`flex flex-col items-center justify-center gap-2 p-4 rounded-2xl border ${t==="/executor"?"bg-surface2 border-accent/50 ring-1 ring-accent/50":"bg-surface/50 border-line/70"}`,children:[l.jsx(Ql,{className:`h-6 w-6 ${t==="/executor"?"text-accent":"text-muted"}`}),l.jsx("span",{className:"text-sm",children:"Executor"})]}),l.jsxs(hn,{to:"/aurora",className:`flex flex-col items-center justify-center gap-2 p-4 rounded-2xl border ${t==="/aurora"?"bg-surface2 border-accent/50 ring-1 ring-accent/50":"bg-surface/50 border-line/70"}`,children:[l.jsx(Jl,{className:`h-6 w-6 ${t==="/aurora"?"text-accent":"text-muted"}`}),l.jsx("span",{className:"text-sm",children:"Aurora"})]}),l.jsxs(hn,{to:"/debug",className:`flex flex-col items-center justify-center gap-2 p-4 rounded-2xl border ${t==="/debug"?"bg-surface2 border-accent/50 ring-1 ring-accent/50":"bg-surface/50 border-line/70"}`,children:[l.jsx(Ku,{className:`h-6 w-6 ${t==="/debug"?"text-accent":"text-muted"}`}),l.jsx("span",{className:"text-sm",children:"Debug"})]}),l.jsxs(hn,{to:"/settings",className:`flex flex-col items-center justify-center gap-2 p-4 rounded-2xl border ${t==="/settings"?"bg-surface2 border-accent/50 ring-1 ring-accent/50":"bg-surface/50 border-line/70"}`,children:[l.jsx(Fa,{className:`h-6 w-6 ${t==="/settings"?"text-accent":"text-muted"}`}),l.jsx("span",{className:"text-sm",children:"Settings"})]})]})]})]})}class Hv extends y.Component{constructor(e){super(e),this.handleReload=()=>{window.location.reload()},this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,s){console.error("[ErrorBoundary] Caught error:",e),console.error("[ErrorBoundary] Component stack:",s.componentStack)}render(){return this.state.hasError?l.jsx("div",{className:"min-h-screen bg-canvas flex items-center justify-center p-6",children:l.jsxs("div",{className:"max-w-md w-full bg-surface border border-line rounded-2xl p-8 shadow-float text-center",children:[l.jsx("div",{className:"h-16 w-16 mx-auto mb-4 rounded-full bg-red-500/20 border border-red-500/40 flex items-center justify-center",children:l.jsx("svg",{className:"h-8 w-8 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),l.jsx("h1",{className:"text-lg font-semibold text-text mb-2",children:"Something went wrong"}),l.jsx("p",{className:"text-sm text-muted mb-4",children:"The application encountered an unexpected error."}),this.state.error&&l.jsx("div",{className:"mb-4 p-3 rounded-lg bg-red-500/10 border border-red-500/30",children:l.jsx("code",{className:"text-xs text-red-400 break-all",children:this.state.error.message})}),l.jsx("button",{onClick:this.handleReload,className:"px-6 py-2.5 rounded-full bg-accent text-canvas font-medium text-sm hover:bg-accent2 transition-colors",children:"Reload Page"}),l.jsx("p",{className:"mt-4 text-xs text-muted/60",children:"If this keeps happening, check the browser console for details."})]})}):this.props.children}}const $v={card:"rounded-xl2 bg-surface shadow-float border border-line/60"};function de({children:t,className:e=""}){return l.jsx("div",{className:`${$v.card} ${e}`,children:t})}function Nr(t){return t+.5|0}const Os=(t,e,s)=>Math.max(Math.min(t,s),e);function Vi(t){return Os(Nr(t*2.55),0,255)}function Bs(t){return Os(Nr(t*255),0,255)}function ms(t){return Os(Nr(t/2.55)/100,0,1)}function sh(t){return Os(Nr(t*100),0,100)}const kt={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},nc=[..."0123456789ABCDEF"],Yv=t=>nc[t&15],Uv=t=>nc[(t&240)>>4]+nc[t&15],qr=t=>(t&240)>>4===(t&15),Gv=t=>qr(t.r)&&qr(t.g)&&qr(t.b)&&qr(t.a);function qv(t){var e=t.length,s;return t[0]==="#"&&(e===4||e===5?s={r:255&kt[t[1]]*17,g:255&kt[t[2]]*17,b:255&kt[t[3]]*17,a:e===5?kt[t[4]]*17:255}:(e===7||e===9)&&(s={r:kt[t[1]]<<4|kt[t[2]],g:kt[t[3]]<<4|kt[t[4]],b:kt[t[5]]<<4|kt[t[6]],a:e===9?kt[t[7]]<<4|kt[t[8]]:255})),s}const Kv=(t,e)=>t<255?e(t):"";function Xv(t){var e=Gv(t)?Yv:Uv;return t?"#"+e(t.r)+e(t.g)+e(t.b)+Kv(t.a,e):void 0}const Zv=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function $p(t,e,s){const n=e*Math.min(s,1-s),i=(r,a=(r+t/30)%12)=>s-n*Math.max(Math.min(a-3,9-a,1),-1);return[i(0),i(8),i(4)]}function Jv(t,e,s){const n=(i,r=(i+t/60)%6)=>s-s*e*Math.max(Math.min(r,4-r,1),0);return[n(5),n(3),n(1)]}function Qv(t,e,s){const n=$p(t,1,.5);let i;for(e+s>1&&(i=1/(e+s),e*=i,s*=i),i=0;i<3;i++)n[i]*=1-e-s,n[i]+=e;return n}function e_(t,e,s,n,i){return t===i?(e-s)/n+(e<s?6:0):e===i?(s-t)/n+2:(t-e)/n+4}function Jc(t){const s=t.r/255,n=t.g/255,i=t.b/255,r=Math.max(s,n,i),a=Math.min(s,n,i),o=(r+a)/2;let c,d,u;return r!==a&&(u=r-a,d=o>.5?u/(2-r-a):u/(r+a),c=e_(s,n,i,u,r),c=c*60+.5),[c|0,d||0,o]}function Qc(t,e,s,n){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,s,n)).map(Bs)}function ed(t,e,s){return Qc($p,t,e,s)}function t_(t,e,s){return Qc(Qv,t,e,s)}function s_(t,e,s){return Qc(Jv,t,e,s)}function Yp(t){return(t%360+360)%360}function n_(t){const e=Zv.exec(t);let s=255,n;if(!e)return;e[5]!==n&&(s=e[6]?Vi(+e[5]):Bs(+e[5]));const i=Yp(+e[2]),r=+e[3]/100,a=+e[4]/100;return e[1]==="hwb"?n=t_(i,r,a):e[1]==="hsv"?n=s_(i,r,a):n=ed(i,r,a),{r:n[0],g:n[1],b:n[2],a:s}}function i_(t,e){var s=Jc(t);s[0]=Yp(s[0]+e),s=ed(s),t.r=s[0],t.g=s[1],t.b=s[2]}function r_(t){if(!t)return;const e=Jc(t),s=e[0],n=sh(e[1]),i=sh(e[2]);return t.a<255?`hsla(${s}, ${n}%, ${i}%, ${ms(t.a)})`:`hsl(${s}, ${n}%, ${i}%)`}const nh={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},ih={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function a_(){const t={},e=Object.keys(ih),s=Object.keys(nh);let n,i,r,a,o;for(n=0;n<e.length;n++){for(a=o=e[n],i=0;i<s.length;i++)r=s[i],o=o.replace(r,nh[r]);r=parseInt(ih[a],16),t[o]=[r>>16&255,r>>8&255,r&255]}return t}let Kr;function o_(t){Kr||(Kr=a_(),Kr.transparent=[0,0,0,0]);const e=Kr[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const l_=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function c_(t){const e=l_.exec(t);let s=255,n,i,r;if(e){if(e[7]!==n){const a=+e[7];s=e[8]?Vi(a):Os(a*255,0,255)}return n=+e[1],i=+e[3],r=+e[5],n=255&(e[2]?Vi(n):Os(n,0,255)),i=255&(e[4]?Vi(i):Os(i,0,255)),r=255&(e[6]?Vi(r):Os(r,0,255)),{r:n,g:i,b:r,a:s}}}function d_(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${ms(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const cl=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,An=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function u_(t,e,s){const n=An(ms(t.r)),i=An(ms(t.g)),r=An(ms(t.b));return{r:Bs(cl(n+s*(An(ms(e.r))-n))),g:Bs(cl(i+s*(An(ms(e.g))-i))),b:Bs(cl(r+s*(An(ms(e.b))-r))),a:t.a+s*(e.a-t.a)}}function Xr(t,e,s){if(t){let n=Jc(t);n[e]=Math.max(0,Math.min(n[e]+n[e]*s,e===0?360:1)),n=ed(n),t.r=n[0],t.g=n[1],t.b=n[2]}}function Up(t,e){return t&&Object.assign(e||{},t)}function rh(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=Bs(t[3]))):(e=Up(t,{r:0,g:0,b:0,a:1}),e.a=Bs(e.a)),e}function h_(t){return t.charAt(0)==="r"?c_(t):n_(t)}class ar{constructor(e){if(e instanceof ar)return e;const s=typeof e;let n;s==="object"?n=rh(e):s==="string"&&(n=qv(e)||o_(e)||h_(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=Up(this._rgb);return e&&(e.a=ms(e.a)),e}set rgb(e){this._rgb=rh(e)}rgbString(){return this._valid?d_(this._rgb):void 0}hexString(){return this._valid?Xv(this._rgb):void 0}hslString(){return this._valid?r_(this._rgb):void 0}mix(e,s){if(e){const n=this.rgb,i=e.rgb;let r;const a=s===r?.5:s,o=2*a-1,c=n.a-i.a,d=((o*c===-1?o:(o+c)/(1+o*c))+1)/2;r=1-d,n.r=255&d*n.r+r*i.r+.5,n.g=255&d*n.g+r*i.g+.5,n.b=255&d*n.b+r*i.b+.5,n.a=a*n.a+(1-a)*i.a,this.rgb=n}return this}interpolate(e,s){return e&&(this._rgb=u_(this._rgb,e._rgb,s)),this}clone(){return new ar(this.rgb)}alpha(e){return this._rgb.a=Bs(e),this}clearer(e){const s=this._rgb;return s.a*=1-e,this}greyscale(){const e=this._rgb,s=Nr(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=s,this}opaquer(e){const s=this._rgb;return s.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Xr(this._rgb,2,e),this}darken(e){return Xr(this._rgb,2,-e),this}saturate(e){return Xr(this._rgb,1,e),this}desaturate(e){return Xr(this._rgb,1,-e),this}rotate(e){return i_(this._rgb,e),this}}function ls(){}const f_=(()=>{let t=0;return()=>t++})();function ge(t){return t==null}function Oe(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function xe(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function He(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function yt(t,e){return He(t)?t:e}function re(t,e){return typeof t>"u"?e:t}const m_=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,Gp=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function ie(t,e,s){if(t&&typeof t.call=="function")return t.apply(s,e)}function pe(t,e,s,n){let i,r,a;if(Oe(t))for(r=t.length,i=0;i<r;i++)e.call(s,t[i],i);else if(xe(t))for(a=Object.keys(t),r=a.length,i=0;i<r;i++)e.call(s,t[a[i]],a[i])}function Ia(t,e){let s,n,i,r;if(!t||!e||t.length!==e.length)return!1;for(s=0,n=t.length;s<n;++s)if(i=t[s],r=e[s],i.datasetIndex!==r.datasetIndex||i.index!==r.index)return!1;return!0}function Va(t){if(Oe(t))return t.map(Va);if(xe(t)){const e=Object.create(null),s=Object.keys(t),n=s.length;let i=0;for(;i<n;++i)e[s[i]]=Va(t[s[i]]);return e}return t}function qp(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function p_(t,e,s,n){if(!qp(t))return;const i=e[t],r=s[t];xe(i)&&xe(r)?or(i,r,n):e[t]=Va(r)}function or(t,e,s){const n=Oe(e)?e:[e],i=n.length;if(!xe(t))return t;s=s||{};const r=s.merger||p_;let a;for(let o=0;o<i;++o){if(a=n[o],!xe(a))continue;const c=Object.keys(a);for(let d=0,u=c.length;d<u;++d)r(c[d],t,a,s)}return t}function Gi(t,e){return or(t,e,{merger:g_})}function g_(t,e,s){if(!qp(t))return;const n=e[t],i=s[t];xe(n)&&xe(i)?Gi(n,i):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=Va(i))}const ah={"":t=>t,x:t=>t.x,y:t=>t.y};function x_(t){const e=t.split("."),s=[];let n="";for(const i of e)n+=i,n.endsWith("\\")?n=n.slice(0,-1)+".":(s.push(n),n="");return s}function y_(t){const e=x_(t);return s=>{for(const n of e){if(n==="")break;s=s&&s[n]}return s}}function $s(t,e){return(ah[e]||(ah[e]=y_(e)))(t)}function td(t){return t.charAt(0).toUpperCase()+t.slice(1)}const lr=t=>typeof t<"u",Ys=t=>typeof t=="function",oh=(t,e)=>{if(t.size!==e.size)return!1;for(const s of t)if(!e.has(s))return!1;return!0};function b_(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const ve=Math.PI,Me=2*ve,v_=Me+ve,Wa=Number.POSITIVE_INFINITY,__=ve/180,qe=ve/2,an=ve/4,lh=ve*2/3,Rs=Math.log10,Mt=Math.sign;function yn(t,e,s){return Math.abs(t-e)<s}function ch(t){const e=Math.round(t);t=yn(t,e,t/1e3)?e:t;const s=Math.pow(10,Math.floor(Rs(t))),n=t/s;return(n<=1?1:n<=2?2:n<=5?5:10)*s}function w_(t){const e=[],s=Math.sqrt(t);let n;for(n=1;n<s;n++)t%n===0&&(e.push(n),e.push(t/n));return s===(s|0)&&e.push(s),e.sort((i,r)=>i-r).pop(),e}function k_(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function Zn(t){return!k_(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function S_(t,e){const s=Math.round(t);return s-e<=t&&s+e>=t}function Kp(t,e,s){let n,i,r;for(n=0,i=t.length;n<i;n++)r=t[n][s],isNaN(r)||(e.min=Math.min(e.min,r),e.max=Math.max(e.max,r))}function Lt(t){return t*(ve/180)}function sd(t){return t*(180/ve)}function dh(t){if(!He(t))return;let e=1,s=0;for(;Math.round(t*e)/e!==t;)e*=10,s++;return s}function Xp(t,e){const s=e.x-t.x,n=e.y-t.y,i=Math.sqrt(s*s+n*n);let r=Math.atan2(n,s);return r<-.5*ve&&(r+=Me),{angle:r,distance:i}}function ic(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function j_(t,e){return(t-e+v_)%Me-ve}function rt(t){return(t%Me+Me)%Me}function cr(t,e,s,n){const i=rt(t),r=rt(e),a=rt(s),o=rt(r-i),c=rt(a-i),d=rt(i-r),u=rt(i-a);return i===r||i===a||n&&r===a||o>c&&d<u}function et(t,e,s){return Math.max(e,Math.min(s,t))}function N_(t){return et(t,-32768,32767)}function ps(t,e,s,n=1e-6){return t>=Math.min(e,s)-n&&t<=Math.max(e,s)+n}function nd(t,e,s){s=s||(a=>t[a]<e);let n=t.length-1,i=0,r;for(;n-i>1;)r=i+n>>1,s(r)?i=r:n=r;return{lo:i,hi:n}}const gs=(t,e,s,n)=>nd(t,s,n?i=>{const r=t[i][e];return r<s||r===s&&t[i+1][e]===s}:i=>t[i][e]<s),T_=(t,e,s)=>nd(t,s,n=>t[n][e]>=s);function M_(t,e,s){let n=0,i=t.length;for(;n<i&&t[n]<e;)n++;for(;i>n&&t[i-1]>s;)i--;return n>0||i<t.length?t.slice(n,i):t}const Zp=["push","pop","shift","splice","unshift"];function C_(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),Zp.forEach(s=>{const n="_onData"+td(s),i=t[s];Object.defineProperty(t,s,{configurable:!0,enumerable:!1,value(...r){const a=i.apply(this,r);return t._chartjs.listeners.forEach(o=>{typeof o[n]=="function"&&o[n](...r)}),a}})})}function uh(t,e){const s=t._chartjs;if(!s)return;const n=s.listeners,i=n.indexOf(e);i!==-1&&n.splice(i,1),!(n.length>0)&&(Zp.forEach(r=>{delete t[r]}),delete t._chartjs)}function Jp(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const Qp=(function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame})();function eg(t,e){let s=[],n=!1;return function(...i){s=i,n||(n=!0,Qp.call(window,()=>{n=!1,t.apply(e,s)}))}}function P_(t,e){let s;return function(...n){return e?(clearTimeout(s),s=setTimeout(t,e,n)):t.apply(this,n),e}}const id=t=>t==="start"?"left":t==="end"?"right":"center",nt=(t,e,s)=>t==="start"?e:t==="end"?s:(e+s)/2,D_=(t,e,s,n)=>t===(n?"left":"right")?s:t==="center"?(e+s)/2:e;function tg(t,e,s){const n=e.length;let i=0,r=n;if(t._sorted){const{iScale:a,vScale:o,_parsed:c}=t,d=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null,u=a.axis,{min:h,max:f,minDefined:m,maxDefined:p}=a.getUserBounds();if(m){if(i=Math.min(gs(c,u,h).lo,s?n:gs(e,u,a.getPixelForValue(h)).lo),d){const g=c.slice(0,i+1).reverse().findIndex(x=>!ge(x[o.axis]));i-=Math.max(0,g)}i=et(i,0,n-1)}if(p){let g=Math.max(gs(c,a.axis,f,!0).hi+1,s?0:gs(e,u,a.getPixelForValue(f),!0).hi+1);if(d){const x=c.slice(g-1).findIndex(v=>!ge(v[o.axis]));g+=Math.max(0,x)}r=et(g,i,n)-i}else r=n-i}return{start:i,count:r}}function sg(t){const{xScale:e,yScale:s,_scaleRanges:n}=t,i={xmin:e.min,xmax:e.max,ymin:s.min,ymax:s.max};if(!n)return t._scaleRanges=i,!0;const r=n.xmin!==e.min||n.xmax!==e.max||n.ymin!==s.min||n.ymax!==s.max;return Object.assign(n,i),r}const Zr=t=>t===0||t===1,hh=(t,e,s)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Me/s)),fh=(t,e,s)=>Math.pow(2,-10*t)*Math.sin((t-e)*Me/s)+1,qi={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*qe)+1,easeOutSine:t=>Math.sin(t*qe),easeInOutSine:t=>-.5*(Math.cos(ve*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Zr(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Zr(t)?t:hh(t,.075,.3),easeOutElastic:t=>Zr(t)?t:fh(t,.075,.3),easeInOutElastic(t){return Zr(t)?t:t<.5?.5*hh(t*2,.1125,.45):.5+.5*fh(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-qi.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?qi.easeInBounce(t*2)*.5:qi.easeOutBounce(t*2-1)*.5+.5};function rd(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function mh(t){return rd(t)?t:new ar(t)}function dl(t){return rd(t)?t:new ar(t).saturate(.5).darken(.1).hexString()}const E_=["x","y","borderWidth","radius","tension"],A_=["color","borderColor","backgroundColor"];function O_(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:A_},numbers:{type:"number",properties:E_}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function R_(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const ph=new Map;function L_(t,e){e=e||{};const s=t+JSON.stringify(e);let n=ph.get(s);return n||(n=new Intl.NumberFormat(t,e),ph.set(s,n)),n}function Tr(t,e,s){return L_(e,s).format(t)}const ng={values(t){return Oe(t)?t:""+t},numeric(t,e,s){if(t===0)return"0";const n=this.chart.options.locale;let i,r=t;if(s.length>1){const d=Math.max(Math.abs(s[0].value),Math.abs(s[s.length-1].value));(d<1e-4||d>1e15)&&(i="scientific"),r=F_(t,s)}const a=Rs(Math.abs(r)),o=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),c={notation:i,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(c,this.options.ticks.format),Tr(t,n,c)},logarithmic(t,e,s){if(t===0)return"0";const n=s[e].significand||t/Math.pow(10,Math.floor(Rs(t)));return[1,2,3,5,10,15].includes(n)||e>.8*s.length?ng.numeric.call(this,t,e,s):""}};function F_(t,e){let s=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(s)>=1&&t!==Math.floor(t)&&(s=t-Math.floor(t)),s}var go={formatters:ng};function I_(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,s)=>s.lineWidth,tickColor:(e,s)=>s.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:go.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const kn=Object.create(null),rc=Object.create(null);function Ki(t,e){if(!e)return t;const s=e.split(".");for(let n=0,i=s.length;n<i;++n){const r=s[n];t=t[r]||(t[r]=Object.create(null))}return t}function ul(t,e,s){return typeof e=="string"?or(Ki(t,e),s):or(Ki(t,""),e)}class V_{constructor(e,s){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,i)=>dl(i.backgroundColor),this.hoverBorderColor=(n,i)=>dl(i.borderColor),this.hoverColor=(n,i)=>dl(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(s)}set(e,s){return ul(this,e,s)}get(e){return Ki(this,e)}describe(e,s){return ul(rc,e,s)}override(e,s){return ul(kn,e,s)}route(e,s,n,i){const r=Ki(this,e),a=Ki(this,n),o="_"+s;Object.defineProperties(r,{[o]:{value:r[s],writable:!0},[s]:{enumerable:!0,get(){const c=this[o],d=a[i];return xe(c)?Object.assign({},d,c):re(c,d)},set(c){this[o]=c}}})}apply(e){e.forEach(s=>s(this))}}var Re=new V_({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[O_,R_,I_]);function W_(t){return!t||ge(t.size)||ge(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function Ba(t,e,s,n,i){let r=e[i];return r||(r=e[i]=t.measureText(i).width,s.push(i)),r>n&&(n=r),n}function B_(t,e,s,n){n=n||{};let i=n.data=n.data||{},r=n.garbageCollect=n.garbageCollect||[];n.font!==e&&(i=n.data={},r=n.garbageCollect=[],n.font=e),t.save(),t.font=e;let a=0;const o=s.length;let c,d,u,h,f;for(c=0;c<o;c++)if(h=s[c],h!=null&&!Oe(h))a=Ba(t,i,r,a,h);else if(Oe(h))for(d=0,u=h.length;d<u;d++)f=h[d],f!=null&&!Oe(f)&&(a=Ba(t,i,r,a,f));t.restore();const m=r.length/2;if(m>s.length){for(c=0;c<m;c++)delete i[r[c]];r.splice(0,m)}return a}function on(t,e,s){const n=t.currentDevicePixelRatio,i=s!==0?Math.max(s/2,.5):0;return Math.round((e-i)*n)/n+i}function gh(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function ac(t,e,s,n){ig(t,e,s,n,null)}function ig(t,e,s,n,i){let r,a,o,c,d,u,h,f;const m=e.pointStyle,p=e.rotation,g=e.radius;let x=(p||0)*__;if(m&&typeof m=="object"&&(r=m.toString(),r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]")){t.save(),t.translate(s,n),t.rotate(x),t.drawImage(m,-m.width/2,-m.height/2,m.width,m.height),t.restore();return}if(!(isNaN(g)||g<=0)){switch(t.beginPath(),m){default:i?t.ellipse(s,n,i/2,g,0,0,Me):t.arc(s,n,g,0,Me),t.closePath();break;case"triangle":u=i?i/2:g,t.moveTo(s+Math.sin(x)*u,n-Math.cos(x)*g),x+=lh,t.lineTo(s+Math.sin(x)*u,n-Math.cos(x)*g),x+=lh,t.lineTo(s+Math.sin(x)*u,n-Math.cos(x)*g),t.closePath();break;case"rectRounded":d=g*.516,c=g-d,a=Math.cos(x+an)*c,h=Math.cos(x+an)*(i?i/2-d:c),o=Math.sin(x+an)*c,f=Math.sin(x+an)*(i?i/2-d:c),t.arc(s-h,n-o,d,x-ve,x-qe),t.arc(s+f,n-a,d,x-qe,x),t.arc(s+h,n+o,d,x,x+qe),t.arc(s-f,n+a,d,x+qe,x+ve),t.closePath();break;case"rect":if(!p){c=Math.SQRT1_2*g,u=i?i/2:c,t.rect(s-u,n-c,2*u,2*c);break}x+=an;case"rectRot":h=Math.cos(x)*(i?i/2:g),a=Math.cos(x)*g,o=Math.sin(x)*g,f=Math.sin(x)*(i?i/2:g),t.moveTo(s-h,n-o),t.lineTo(s+f,n-a),t.lineTo(s+h,n+o),t.lineTo(s-f,n+a),t.closePath();break;case"crossRot":x+=an;case"cross":h=Math.cos(x)*(i?i/2:g),a=Math.cos(x)*g,o=Math.sin(x)*g,f=Math.sin(x)*(i?i/2:g),t.moveTo(s-h,n-o),t.lineTo(s+h,n+o),t.moveTo(s+f,n-a),t.lineTo(s-f,n+a);break;case"star":h=Math.cos(x)*(i?i/2:g),a=Math.cos(x)*g,o=Math.sin(x)*g,f=Math.sin(x)*(i?i/2:g),t.moveTo(s-h,n-o),t.lineTo(s+h,n+o),t.moveTo(s+f,n-a),t.lineTo(s-f,n+a),x+=an,h=Math.cos(x)*(i?i/2:g),a=Math.cos(x)*g,o=Math.sin(x)*g,f=Math.sin(x)*(i?i/2:g),t.moveTo(s-h,n-o),t.lineTo(s+h,n+o),t.moveTo(s+f,n-a),t.lineTo(s-f,n+a);break;case"line":a=i?i/2:Math.cos(x)*g,o=Math.sin(x)*g,t.moveTo(s-a,n-o),t.lineTo(s+a,n+o);break;case"dash":t.moveTo(s,n),t.lineTo(s+Math.cos(x)*(i?i/2:g),n+Math.sin(x)*g);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function Xt(t,e,s){return s=s||.5,!e||t&&t.x>e.left-s&&t.x<e.right+s&&t.y>e.top-s&&t.y<e.bottom+s}function xo(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function yo(t){t.restore()}function z_(t,e,s,n,i){if(!e)return t.lineTo(s.x,s.y);if(i==="middle"){const r=(e.x+s.x)/2;t.lineTo(r,e.y),t.lineTo(r,s.y)}else i==="after"!=!!n?t.lineTo(e.x,s.y):t.lineTo(s.x,e.y);t.lineTo(s.x,s.y)}function H_(t,e,s,n){if(!e)return t.lineTo(s.x,s.y);t.bezierCurveTo(n?e.cp1x:e.cp2x,n?e.cp1y:e.cp2y,n?s.cp2x:s.cp1x,n?s.cp2y:s.cp1y,s.x,s.y)}function $_(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),ge(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function Y_(t,e,s,n,i){if(i.strikethrough||i.underline){const r=t.measureText(n),a=e-r.actualBoundingBoxLeft,o=e+r.actualBoundingBoxRight,c=s-r.actualBoundingBoxAscent,d=s+r.actualBoundingBoxDescent,u=i.strikethrough?(c+d)/2:d;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=i.decorationWidth||2,t.moveTo(a,u),t.lineTo(o,u),t.stroke()}}function U_(t,e){const s=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=s}function Sn(t,e,s,n,i,r={}){const a=Oe(e)?e:[e],o=r.strokeWidth>0&&r.strokeColor!=="";let c,d;for(t.save(),t.font=i.string,$_(t,r),c=0;c<a.length;++c)d=a[c],r.backdrop&&U_(t,r.backdrop),o&&(r.strokeColor&&(t.strokeStyle=r.strokeColor),ge(r.strokeWidth)||(t.lineWidth=r.strokeWidth),t.strokeText(d,s,n,r.maxWidth)),t.fillText(d,s,n,r.maxWidth),Y_(t,s,n,d,r),n+=Number(i.lineHeight);t.restore()}function dr(t,e){const{x:s,y:n,w:i,h:r,radius:a}=e;t.arc(s+a.topLeft,n+a.topLeft,a.topLeft,1.5*ve,ve,!0),t.lineTo(s,n+r-a.bottomLeft),t.arc(s+a.bottomLeft,n+r-a.bottomLeft,a.bottomLeft,ve,qe,!0),t.lineTo(s+i-a.bottomRight,n+r),t.arc(s+i-a.bottomRight,n+r-a.bottomRight,a.bottomRight,qe,0,!0),t.lineTo(s+i,n+a.topRight),t.arc(s+i-a.topRight,n+a.topRight,a.topRight,0,-qe,!0),t.lineTo(s+a.topLeft,n)}const G_=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,q_=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function K_(t,e){const s=(""+t).match(G_);if(!s||s[1]==="normal")return e*1.2;switch(t=+s[2],s[3]){case"px":return t;case"%":t/=100;break}return e*t}const X_=t=>+t||0;function ad(t,e){const s={},n=xe(e),i=n?Object.keys(e):e,r=xe(t)?n?a=>re(t[a],t[e[a]]):a=>t[a]:()=>t;for(const a of i)s[a]=X_(r(a));return s}function rg(t){return ad(t,{top:"y",right:"x",bottom:"y",left:"x"})}function bn(t){return ad(t,["topLeft","topRight","bottomLeft","bottomRight"])}function ct(t){const e=rg(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Xe(t,e){t=t||{},e=e||Re.font;let s=re(t.size,e.size);typeof s=="string"&&(s=parseInt(s,10));let n=re(t.style,e.style);n&&!(""+n).match(q_)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const i={family:re(t.family,e.family),lineHeight:K_(re(t.lineHeight,e.lineHeight),s),size:s,style:n,weight:re(t.weight,e.weight),string:""};return i.string=W_(i),i}function Wi(t,e,s,n){let i,r,a;for(i=0,r=t.length;i<r;++i)if(a=t[i],a!==void 0&&a!==void 0)return a}function Z_(t,e,s){const{min:n,max:i}=t,r=Gp(e,(i-n)/2),a=(o,c)=>s&&o===0?0:o+c;return{min:a(n,-Math.abs(r)),max:a(i,r)}}function Xs(t,e){return Object.assign(Object.create(t),e)}function od(t,e=[""],s,n,i=()=>t[0]){const r=s||t;typeof n>"u"&&(n=cg("_fallback",t));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:r,_fallback:n,_getTarget:i,override:o=>od([o,...t],e,r,n)};return new Proxy(a,{deleteProperty(o,c){return delete o[c],delete o._keys,delete t[0][c],!0},get(o,c){return og(o,c,()=>r1(c,e,t,o))},getOwnPropertyDescriptor(o,c){return Reflect.getOwnPropertyDescriptor(o._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(o,c){return yh(o).includes(c)},ownKeys(o){return yh(o)},set(o,c,d){const u=o._storage||(o._storage=i());return o[c]=u[c]=d,delete o._keys,!0}})}function Jn(t,e,s,n){const i={_cacheable:!1,_proxy:t,_context:e,_subProxy:s,_stack:new Set,_descriptors:ag(t,n),setContext:r=>Jn(t,r,s,n),override:r=>Jn(t.override(r),e,s,n)};return new Proxy(i,{deleteProperty(r,a){return delete r[a],delete t[a],!0},get(r,a,o){return og(r,a,()=>Q_(r,a,o))},getOwnPropertyDescriptor(r,a){return r._descriptors.allKeys?Reflect.has(t,a)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,a)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(r,a){return Reflect.has(t,a)},ownKeys(){return Reflect.ownKeys(t)},set(r,a,o){return t[a]=o,delete r[a],!0}})}function ag(t,e={scriptable:!0,indexable:!0}){const{_scriptable:s=e.scriptable,_indexable:n=e.indexable,_allKeys:i=e.allKeys}=t;return{allKeys:i,scriptable:s,indexable:n,isScriptable:Ys(s)?s:()=>s,isIndexable:Ys(n)?n:()=>n}}const J_=(t,e)=>t?t+td(e):e,ld=(t,e)=>xe(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function og(t,e,s){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const n=s();return t[e]=n,n}function Q_(t,e,s){const{_proxy:n,_context:i,_subProxy:r,_descriptors:a}=t;let o=n[e];return Ys(o)&&a.isScriptable(e)&&(o=e1(e,o,t,s)),Oe(o)&&o.length&&(o=t1(e,o,t,a.isIndexable)),ld(e,o)&&(o=Jn(o,i,r&&r[e],a)),o}function e1(t,e,s,n){const{_proxy:i,_context:r,_subProxy:a,_stack:o}=s;if(o.has(t))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+t);o.add(t);let c=e(r,a||n);return o.delete(t),ld(t,c)&&(c=cd(i._scopes,i,t,c)),c}function t1(t,e,s,n){const{_proxy:i,_context:r,_subProxy:a,_descriptors:o}=s;if(typeof r.index<"u"&&n(t))return e[r.index%e.length];if(xe(e[0])){const c=e,d=i._scopes.filter(u=>u!==c);e=[];for(const u of c){const h=cd(d,i,t,u);e.push(Jn(h,r,a&&a[t],o))}}return e}function lg(t,e,s){return Ys(t)?t(e,s):t}const s1=(t,e)=>t===!0?e:typeof t=="string"?$s(e,t):void 0;function n1(t,e,s,n,i){for(const r of e){const a=s1(s,r);if(a){t.add(a);const o=lg(a._fallback,s,i);if(typeof o<"u"&&o!==s&&o!==n)return o}else if(a===!1&&typeof n<"u"&&s!==n)return null}return!1}function cd(t,e,s,n){const i=e._rootScopes,r=lg(e._fallback,s,n),a=[...t,...i],o=new Set;o.add(n);let c=xh(o,a,s,r||s,n);return c===null||typeof r<"u"&&r!==s&&(c=xh(o,a,r,c,n),c===null)?!1:od(Array.from(o),[""],i,r,()=>i1(e,s,n))}function xh(t,e,s,n,i){for(;s;)s=n1(t,e,s,n,i);return s}function i1(t,e,s){const n=t._getTarget();e in n||(n[e]={});const i=n[e];return Oe(i)&&xe(s)?s:i||{}}function r1(t,e,s,n){let i;for(const r of e)if(i=cg(J_(r,t),s),typeof i<"u")return ld(t,i)?cd(s,n,t,i):i}function cg(t,e){for(const s of e){if(!s)continue;const n=s[t];if(typeof n<"u")return n}}function yh(t){let e=t._keys;return e||(e=t._keys=a1(t._scopes)),e}function a1(t){const e=new Set;for(const s of t)for(const n of Object.keys(s).filter(i=>!i.startsWith("_")))e.add(n);return Array.from(e)}function dg(t,e,s,n){const{iScale:i}=t,{key:r="r"}=this._parsing,a=new Array(n);let o,c,d,u;for(o=0,c=n;o<c;++o)d=o+s,u=e[d],a[o]={r:i.parse($s(u,r),d)};return a}const o1=Number.EPSILON||1e-14,Qn=(t,e)=>e<t.length&&!t[e].skip&&t[e],ug=t=>t==="x"?"y":"x";function l1(t,e,s,n){const i=t.skip?e:t,r=e,a=s.skip?e:s,o=ic(r,i),c=ic(a,r);let d=o/(o+c),u=c/(o+c);d=isNaN(d)?0:d,u=isNaN(u)?0:u;const h=n*d,f=n*u;return{previous:{x:r.x-h*(a.x-i.x),y:r.y-h*(a.y-i.y)},next:{x:r.x+f*(a.x-i.x),y:r.y+f*(a.y-i.y)}}}function c1(t,e,s){const n=t.length;let i,r,a,o,c,d=Qn(t,0);for(let u=0;u<n-1;++u)if(c=d,d=Qn(t,u+1),!(!c||!d)){if(yn(e[u],0,o1)){s[u]=s[u+1]=0;continue}i=s[u]/e[u],r=s[u+1]/e[u],o=Math.pow(i,2)+Math.pow(r,2),!(o<=9)&&(a=3/Math.sqrt(o),s[u]=i*a*e[u],s[u+1]=r*a*e[u])}}function d1(t,e,s="x"){const n=ug(s),i=t.length;let r,a,o,c=Qn(t,0);for(let d=0;d<i;++d){if(a=o,o=c,c=Qn(t,d+1),!o)continue;const u=o[s],h=o[n];a&&(r=(u-a[s])/3,o[`cp1${s}`]=u-r,o[`cp1${n}`]=h-r*e[d]),c&&(r=(c[s]-u)/3,o[`cp2${s}`]=u+r,o[`cp2${n}`]=h+r*e[d])}}function u1(t,e="x"){const s=ug(e),n=t.length,i=Array(n).fill(0),r=Array(n);let a,o,c,d=Qn(t,0);for(a=0;a<n;++a)if(o=c,c=d,d=Qn(t,a+1),!!c){if(d){const u=d[e]-c[e];i[a]=u!==0?(d[s]-c[s])/u:0}r[a]=o?d?Mt(i[a-1])!==Mt(i[a])?0:(i[a-1]+i[a])/2:i[a-1]:i[a]}c1(t,i,r),d1(t,r,e)}function Jr(t,e,s){return Math.max(Math.min(t,s),e)}function h1(t,e){let s,n,i,r,a,o=Xt(t[0],e);for(s=0,n=t.length;s<n;++s)a=r,r=o,o=s<n-1&&Xt(t[s+1],e),r&&(i=t[s],a&&(i.cp1x=Jr(i.cp1x,e.left,e.right),i.cp1y=Jr(i.cp1y,e.top,e.bottom)),o&&(i.cp2x=Jr(i.cp2x,e.left,e.right),i.cp2y=Jr(i.cp2y,e.top,e.bottom)))}function f1(t,e,s,n,i){let r,a,o,c;if(e.spanGaps&&(t=t.filter(d=>!d.skip)),e.cubicInterpolationMode==="monotone")u1(t,i);else{let d=n?t[t.length-1]:t[0];for(r=0,a=t.length;r<a;++r)o=t[r],c=l1(d,o,t[Math.min(r+1,a-(n?0:1))%a],e.tension),o.cp1x=c.previous.x,o.cp1y=c.previous.y,o.cp2x=c.next.x,o.cp2y=c.next.y,d=o}e.capBezierPoints&&h1(t,s)}function dd(){return typeof window<"u"&&typeof document<"u"}function ud(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function za(t,e,s){let n;return typeof t=="string"?(n=parseInt(t,10),t.indexOf("%")!==-1&&(n=n/100*e.parentNode[s])):n=t,n}const bo=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function m1(t,e){return bo(t).getPropertyValue(e)}const p1=["top","right","bottom","left"];function vn(t,e,s){const n={};s=s?"-"+s:"";for(let i=0;i<4;i++){const r=p1[i];n[r]=parseFloat(t[e+"-"+r+s])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const g1=(t,e,s)=>(t>0||e>0)&&(!s||!s.shadowRoot);function x1(t,e){const s=t.touches,n=s&&s.length?s[0]:t,{offsetX:i,offsetY:r}=n;let a=!1,o,c;if(g1(i,r,t.target))o=i,c=r;else{const d=e.getBoundingClientRect();o=n.clientX-d.left,c=n.clientY-d.top,a=!0}return{x:o,y:c,box:a}}function qt(t,e){if("native"in t)return t;const{canvas:s,currentDevicePixelRatio:n}=e,i=bo(s),r=i.boxSizing==="border-box",a=vn(i,"padding"),o=vn(i,"border","width"),{x:c,y:d,box:u}=x1(t,s),h=a.left+(u&&o.left),f=a.top+(u&&o.top);let{width:m,height:p}=e;return r&&(m-=a.width+o.width,p-=a.height+o.height),{x:Math.round((c-h)/m*s.width/n),y:Math.round((d-f)/p*s.height/n)}}function y1(t,e,s){let n,i;if(e===void 0||s===void 0){const r=t&&ud(t);if(!r)e=t.clientWidth,s=t.clientHeight;else{const a=r.getBoundingClientRect(),o=bo(r),c=vn(o,"border","width"),d=vn(o,"padding");e=a.width-d.width-c.width,s=a.height-d.height-c.height,n=za(o.maxWidth,r,"clientWidth"),i=za(o.maxHeight,r,"clientHeight")}}return{width:e,height:s,maxWidth:n||Wa,maxHeight:i||Wa}}const Ls=t=>Math.round(t*10)/10;function b1(t,e,s,n){const i=bo(t),r=vn(i,"margin"),a=za(i.maxWidth,t,"clientWidth")||Wa,o=za(i.maxHeight,t,"clientHeight")||Wa,c=y1(t,e,s);let{width:d,height:u}=c;if(i.boxSizing==="content-box"){const f=vn(i,"border","width"),m=vn(i,"padding");d-=m.width+f.width,u-=m.height+f.height}return d=Math.max(0,d-r.width),u=Math.max(0,n?d/n:u-r.height),d=Ls(Math.min(d,a,c.maxWidth)),u=Ls(Math.min(u,o,c.maxHeight)),d&&!u&&(u=Ls(d/2)),(e!==void 0||s!==void 0)&&n&&c.height&&u>c.height&&(u=c.height,d=Ls(Math.floor(u*n))),{width:d,height:u}}function bh(t,e,s){const n=e||1,i=Ls(t.height*n),r=Ls(t.width*n);t.height=Ls(t.height),t.width=Ls(t.width);const a=t.canvas;return a.style&&(s||!a.style.height&&!a.style.width)&&(a.style.height=`${t.height}px`,a.style.width=`${t.width}px`),t.currentDevicePixelRatio!==n||a.height!==i||a.width!==r?(t.currentDevicePixelRatio=n,a.height=i,a.width=r,t.ctx.setTransform(n,0,0,n,0,0),!0):!1}const v1=(function(){let t=!1;try{const e={get passive(){return t=!0,!1}};dd()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t})();function vh(t,e){const s=m1(t,e),n=s&&s.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function fn(t,e,s,n){return{x:t.x+s*(e.x-t.x),y:t.y+s*(e.y-t.y)}}function _1(t,e,s,n){return{x:t.x+s*(e.x-t.x),y:n==="middle"?s<.5?t.y:e.y:n==="after"?s<1?t.y:e.y:s>0?e.y:t.y}}function w1(t,e,s,n){const i={x:t.cp2x,y:t.cp2y},r={x:e.cp1x,y:e.cp1y},a=fn(t,i,s),o=fn(i,r,s),c=fn(r,e,s),d=fn(a,o,s),u=fn(o,c,s);return fn(d,u,s)}const k1=function(t,e){return{x(s){return t+t+e-s},setWidth(s){e=s},textAlign(s){return s==="center"?s:s==="right"?"left":"right"},xPlus(s,n){return s-n},leftForLtr(s,n){return s-n}}},S1=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function Un(t,e,s){return t?k1(e,s):S1()}function hg(t,e){let s,n;(e==="ltr"||e==="rtl")&&(s=t.canvas.style,n=[s.getPropertyValue("direction"),s.getPropertyPriority("direction")],s.setProperty("direction",e,"important"),t.prevTextDirection=n)}function fg(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function mg(t){return t==="angle"?{between:cr,compare:j_,normalize:rt}:{between:ps,compare:(e,s)=>e-s,normalize:e=>e}}function _h({start:t,end:e,count:s,loop:n,style:i}){return{start:t%s,end:e%s,loop:n&&(e-t+1)%s===0,style:i}}function j1(t,e,s){const{property:n,start:i,end:r}=s,{between:a,normalize:o}=mg(n),c=e.length;let{start:d,end:u,loop:h}=t,f,m;if(h){for(d+=c,u+=c,f=0,m=c;f<m&&a(o(e[d%c][n]),i,r);++f)d--,u--;d%=c,u%=c}return u<d&&(u+=c),{start:d,end:u,loop:h,style:t.style}}function pg(t,e,s){if(!s)return[t];const{property:n,start:i,end:r}=s,a=e.length,{compare:o,between:c,normalize:d}=mg(n),{start:u,end:h,loop:f,style:m}=j1(t,e,s),p=[];let g=!1,x=null,v,_,S;const N=()=>c(i,S,v)&&o(i,S)!==0,j=()=>o(r,v)===0||c(r,S,v),k=()=>g||N(),T=()=>!g||j();for(let M=u,P=u;M<=h;++M)_=e[M%a],!_.skip&&(v=d(_[n]),v!==S&&(g=c(v,i,r),x===null&&k()&&(x=o(v,i)===0?M:P),x!==null&&T()&&(p.push(_h({start:x,end:M,loop:f,count:a,style:m})),x=null),P=M,S=v));return x!==null&&p.push(_h({start:x,end:h,loop:f,count:a,style:m})),p}function gg(t,e){const s=[],n=t.segments;for(let i=0;i<n.length;i++){const r=pg(n[i],t.points,e);r.length&&s.push(...r)}return s}function N1(t,e,s,n){let i=0,r=e-1;if(s&&!n)for(;i<e&&!t[i].skip;)i++;for(;i<e&&t[i].skip;)i++;for(i%=e,s&&(r+=i);r>i&&t[r%e].skip;)r--;return r%=e,{start:i,end:r}}function T1(t,e,s,n){const i=t.length,r=[];let a=e,o=t[e],c;for(c=e+1;c<=s;++c){const d=t[c%i];d.skip||d.stop?o.skip||(n=!1,r.push({start:e%i,end:(c-1)%i,loop:n}),e=a=d.stop?c:null):(a=c,o.skip&&(e=c)),o=d}return a!==null&&r.push({start:e%i,end:a%i,loop:n}),r}function M1(t,e){const s=t.points,n=t.options.spanGaps,i=s.length;if(!i)return[];const r=!!t._loop,{start:a,end:o}=N1(s,i,r,n);if(n===!0)return wh(t,[{start:a,end:o,loop:r}],s,e);const c=o<a?o+i:o,d=!!t._fullLoop&&a===0&&o===i-1;return wh(t,T1(s,a,c,d),s,e)}function wh(t,e,s,n){return!n||!n.setContext||!s?e:C1(t,e,s,n)}function C1(t,e,s,n){const i=t._chart.getContext(),r=kh(t.options),{_datasetIndex:a,options:{spanGaps:o}}=t,c=s.length,d=[];let u=r,h=e[0].start,f=h;function m(p,g,x,v){const _=o?-1:1;if(p!==g){for(p+=c;s[p%c].skip;)p-=_;for(;s[g%c].skip;)g+=_;p%c!==g%c&&(d.push({start:p%c,end:g%c,loop:x,style:v}),u=v,h=g%c)}}for(const p of e){h=o?h:p.start;let g=s[h%c],x;for(f=h+1;f<=p.end;f++){const v=s[f%c];x=kh(n.setContext(Xs(i,{type:"segment",p0:g,p1:v,p0DataIndex:(f-1)%c,p1DataIndex:f%c,datasetIndex:a}))),P1(x,u)&&m(h,f-1,p.loop,u),g=v,u=x}h<f-1&&m(h,f-1,p.loop,u)}return d}function kh(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function P1(t,e){if(!e)return!1;const s=[],n=function(i,r){return rd(r)?(s.includes(r)||s.push(r),s.indexOf(r)):r};return JSON.stringify(t,n)!==JSON.stringify(e,n)}function Qr(t,e,s){return t.options.clip?t[s]:e[s]}function D1(t,e){const{xScale:s,yScale:n}=t;return s&&n?{left:Qr(s,e,"left"),right:Qr(s,e,"right"),top:Qr(n,e,"top"),bottom:Qr(n,e,"bottom")}:e}function xg(t,e){const s=e._clip;if(s.disabled)return!1;const n=D1(e,t.chartArea);return{left:s.left===!1?0:n.left-(s.left===!0?0:s.left),right:s.right===!1?t.width:n.right+(s.right===!0?0:s.right),top:s.top===!1?0:n.top-(s.top===!0?0:s.top),bottom:s.bottom===!1?t.height:n.bottom+(s.bottom===!0?0:s.bottom)}}class E1{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,s,n,i){const r=s.listeners[i],a=s.duration;r.forEach(o=>o({chart:e,initial:s.initial,numSteps:a,currentStep:Math.min(n-s.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=Qp.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let s=0;this._charts.forEach((n,i)=>{if(!n.running||!n.items.length)return;const r=n.items;let a=r.length-1,o=!1,c;for(;a>=0;--a)c=r[a],c._active?(c._total>n.duration&&(n.duration=c._total),c.tick(e),o=!0):(r[a]=r[r.length-1],r.pop());o&&(i.draw(),this._notify(i,n,e,"progress")),r.length||(n.running=!1,this._notify(i,n,e,"complete"),n.initial=!1),s+=r.length}),this._lastDate=e,s===0&&(this._running=!1)}_getAnims(e){const s=this._charts;let n=s.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},s.set(e,n)),n}listen(e,s,n){this._getAnims(e).listeners[s].push(n)}add(e,s){!s||!s.length||this._getAnims(e).items.push(...s)}has(e){return this._getAnims(e).items.length>0}start(e){const s=this._charts.get(e);s&&(s.running=!0,s.start=Date.now(),s.duration=s.items.reduce((n,i)=>Math.max(n,i._duration),0),this._refresh())}running(e){if(!this._running)return!1;const s=this._charts.get(e);return!(!s||!s.running||!s.items.length)}stop(e){const s=this._charts.get(e);if(!s||!s.items.length)return;const n=s.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();s.items=[],this._notify(e,s,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var us=new E1;const Sh="transparent",A1={boolean(t,e,s){return s>.5?e:t},color(t,e,s){const n=mh(t||Sh),i=n.valid&&mh(e||Sh);return i&&i.valid?i.mix(n,s).hexString():e},number(t,e,s){return t+(e-t)*s}};class O1{constructor(e,s,n,i){const r=s[n];i=Wi([e.to,i,r,e.from]);const a=Wi([e.from,r,i]);this._active=!0,this._fn=e.fn||A1[e.type||typeof a],this._easing=qi[e.easing]||qi.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=s,this._prop=n,this._from=a,this._to=i,this._promises=void 0}active(){return this._active}update(e,s,n){if(this._active){this._notify(!1);const i=this._target[this._prop],r=n-this._start,a=this._duration-r;this._start=n,this._duration=Math.floor(Math.max(a,e.duration)),this._total+=r,this._loop=!!e.loop,this._to=Wi([e.to,s,i,e.from]),this._from=Wi([e.from,i,s])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const s=e-this._start,n=this._duration,i=this._prop,r=this._from,a=this._loop,o=this._to;let c;if(this._active=r!==o&&(a||s<n),!this._active){this._target[i]=o,this._notify(!0);return}if(s<0){this._target[i]=r;return}c=s/n%2,c=a&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[i]=this._fn(r,o,c)}wait(){const e=this._promises||(this._promises=[]);return new Promise((s,n)=>{e.push({res:s,rej:n})})}_notify(e){const s=e?"res":"rej",n=this._promises||[];for(let i=0;i<n.length;i++)n[i][s]()}}class yg{constructor(e,s){this._chart=e,this._properties=new Map,this.configure(s)}configure(e){if(!xe(e))return;const s=Object.keys(Re.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const r=e[i];if(!xe(r))return;const a={};for(const o of s)a[o]=r[o];(Oe(r.properties)&&r.properties||[i]).forEach(o=>{(o===i||!n.has(o))&&n.set(o,a)})})}_animateOptions(e,s){const n=s.options,i=L1(e,n);if(!i)return[];const r=this._createAnimations(i,n);return n.$shared&&R1(e.options.$animations,n).then(()=>{e.options=n},()=>{}),r}_createAnimations(e,s){const n=this._properties,i=[],r=e.$animations||(e.$animations={}),a=Object.keys(s),o=Date.now();let c;for(c=a.length-1;c>=0;--c){const d=a[c];if(d.charAt(0)==="$")continue;if(d==="options"){i.push(...this._animateOptions(e,s));continue}const u=s[d];let h=r[d];const f=n.get(d);if(h)if(f&&h.active()){h.update(f,u,o);continue}else h.cancel();if(!f||!f.duration){e[d]=u;continue}r[d]=h=new O1(f,e,d,u),i.push(h)}return i}update(e,s){if(this._properties.size===0){Object.assign(e,s);return}const n=this._createAnimations(e,s);if(n.length)return us.add(this._chart,n),!0}}function R1(t,e){const s=[],n=Object.keys(e);for(let i=0;i<n.length;i++){const r=t[n[i]];r&&r.active()&&s.push(r.wait())}return Promise.all(s)}function L1(t,e){if(!e)return;let s=t.options;if(!s){t.options=e;return}return s.$shared&&(t.options=s=Object.assign({},s,{$shared:!1,$animations:{}})),s}function jh(t,e){const s=t&&t.options||{},n=s.reverse,i=s.min===void 0?e:0,r=s.max===void 0?e:0;return{start:n?r:i,end:n?i:r}}function F1(t,e,s){if(s===!1)return!1;const n=jh(t,s),i=jh(e,s);return{top:i.end,right:n.end,bottom:i.start,left:n.start}}function I1(t){let e,s,n,i;return xe(t)?(e=t.top,s=t.right,n=t.bottom,i=t.left):e=s=n=i=t,{top:e,right:s,bottom:n,left:i,disabled:t===!1}}function bg(t,e){const s=[],n=t._getSortedDatasetMetas(e);let i,r;for(i=0,r=n.length;i<r;++i)s.push(n[i].index);return s}function Nh(t,e,s,n={}){const i=t.keys,r=n.mode==="single";let a,o,c,d;if(e===null)return;let u=!1;for(a=0,o=i.length;a<o;++a){if(c=+i[a],c===s){if(u=!0,n.all)continue;break}d=t.values[c],He(d)&&(r||e===0||Mt(e)===Mt(d))&&(e+=d)}return!u&&!n.all?0:e}function V1(t,e){const{iScale:s,vScale:n}=e,i=s.axis==="x"?"x":"y",r=n.axis==="x"?"x":"y",a=Object.keys(t),o=new Array(a.length);let c,d,u;for(c=0,d=a.length;c<d;++c)u=a[c],o[c]={[i]:u,[r]:t[u]};return o}function hl(t,e){const s=t&&t.options.stacked;return s||s===void 0&&e.stack!==void 0}function W1(t,e,s){return`${t.id}.${e.id}.${s.stack||s.type}`}function B1(t){const{min:e,max:s,minDefined:n,maxDefined:i}=t.getUserBounds();return{min:n?e:Number.NEGATIVE_INFINITY,max:i?s:Number.POSITIVE_INFINITY}}function z1(t,e,s){const n=t[e]||(t[e]={});return n[s]||(n[s]={})}function Th(t,e,s,n){for(const i of e.getMatchingVisibleMetas(n).reverse()){const r=t[i.index];if(s&&r>0||!s&&r<0)return i.index}return null}function Mh(t,e){const{chart:s,_cachedMeta:n}=t,i=s._stacks||(s._stacks={}),{iScale:r,vScale:a,index:o}=n,c=r.axis,d=a.axis,u=W1(r,a,n),h=e.length;let f;for(let m=0;m<h;++m){const p=e[m],{[c]:g,[d]:x}=p,v=p._stacks||(p._stacks={});f=v[d]=z1(i,u,g),f[o]=x,f._top=Th(f,a,!0,n.type),f._bottom=Th(f,a,!1,n.type);const _=f._visualValues||(f._visualValues={});_[o]=x}}function fl(t,e){const s=t.scales;return Object.keys(s).filter(n=>s[n].axis===e).shift()}function H1(t,e){return Xs(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function $1(t,e,s){return Xs(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:s,index:e,mode:"default",type:"data"})}function ki(t,e){const s=t.controller.index,n=t.vScale&&t.vScale.axis;if(n){e=e||t._parsed;for(const i of e){const r=i._stacks;if(!r||r[n]===void 0||r[n][s]===void 0)return;delete r[n][s],r[n]._visualValues!==void 0&&r[n]._visualValues[s]!==void 0&&delete r[n]._visualValues[s]}}}const ml=t=>t==="reset"||t==="none",Ch=(t,e)=>e?t:Object.assign({},t),Y1=(t,e,s)=>t&&!e.hidden&&e._stacked&&{keys:bg(s,!0),values:null};class Zs{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,s){this.chart=e,this._ctx=e.ctx,this.index=s,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=hl(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&ki(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,s=this._cachedMeta,n=this.getDataset(),i=(h,f,m,p)=>h==="x"?f:h==="r"?p:m,r=s.xAxisID=re(n.xAxisID,fl(e,"x")),a=s.yAxisID=re(n.yAxisID,fl(e,"y")),o=s.rAxisID=re(n.rAxisID,fl(e,"r")),c=s.indexAxis,d=s.iAxisID=i(c,r,a,o),u=s.vAxisID=i(c,a,r,o);s.xScale=this.getScaleForId(r),s.yScale=this.getScaleForId(a),s.rScale=this.getScaleForId(o),s.iScale=this.getScaleForId(d),s.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const s=this._cachedMeta;return e===s.iScale?s.vScale:s.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&uh(this._data,this),e._stacked&&ki(e)}_dataCheck(){const e=this.getDataset(),s=e.data||(e.data=[]),n=this._data;if(xe(s)){const i=this._cachedMeta;this._data=V1(s,i)}else if(n!==s){if(n){uh(n,this);const i=this._cachedMeta;ki(i),i._parsed=[]}s&&Object.isExtensible(s)&&C_(s,this),this._syncList=[],this._data=s}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const s=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const r=s._stacked;s._stacked=hl(s.vScale,s),s.stack!==n.stack&&(i=!0,ki(s),s.stack=n.stack),this._resyncElements(e),(i||r!==s._stacked)&&(Mh(this,s._parsed),s._stacked=hl(s.vScale,s))}configure(){const e=this.chart.config,s=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),s,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,s){const{_cachedMeta:n,_data:i}=this,{iScale:r,_stacked:a}=n,o=r.axis;let c=e===0&&s===i.length?!0:n._sorted,d=e>0&&n._parsed[e-1],u,h,f;if(this._parsing===!1)n._parsed=i,n._sorted=!0,f=i;else{Oe(i[e])?f=this.parseArrayData(n,i,e,s):xe(i[e])?f=this.parseObjectData(n,i,e,s):f=this.parsePrimitiveData(n,i,e,s);const m=()=>h[o]===null||d&&h[o]<d[o];for(u=0;u<s;++u)n._parsed[u+e]=h=f[u],c&&(m()&&(c=!1),d=h);n._sorted=c}a&&Mh(this,f)}parsePrimitiveData(e,s,n,i){const{iScale:r,vScale:a}=e,o=r.axis,c=a.axis,d=r.getLabels(),u=r===a,h=new Array(i);let f,m,p;for(f=0,m=i;f<m;++f)p=f+n,h[f]={[o]:u||r.parse(d[p],p),[c]:a.parse(s[p],p)};return h}parseArrayData(e,s,n,i){const{xScale:r,yScale:a}=e,o=new Array(i);let c,d,u,h;for(c=0,d=i;c<d;++c)u=c+n,h=s[u],o[c]={x:r.parse(h[0],u),y:a.parse(h[1],u)};return o}parseObjectData(e,s,n,i){const{xScale:r,yScale:a}=e,{xAxisKey:o="x",yAxisKey:c="y"}=this._parsing,d=new Array(i);let u,h,f,m;for(u=0,h=i;u<h;++u)f=u+n,m=s[f],d[u]={x:r.parse($s(m,o),f),y:a.parse($s(m,c),f)};return d}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,s,n){const i=this.chart,r=this._cachedMeta,a=s[e.axis],o={keys:bg(i,!0),values:s._stacks[e.axis]._visualValues};return Nh(o,a,r.index,{mode:n})}updateRangeFromParsed(e,s,n,i){const r=n[s.axis];let a=r===null?NaN:r;const o=i&&n._stacks[s.axis];i&&o&&(i.values=o,a=Nh(i,r,this._cachedMeta.index)),e.min=Math.min(e.min,a),e.max=Math.max(e.max,a)}getMinMax(e,s){const n=this._cachedMeta,i=n._parsed,r=n._sorted&&e===n.iScale,a=i.length,o=this._getOtherScale(e),c=Y1(s,n,this.chart),d={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:h}=B1(o);let f,m;function p(){m=i[f];const g=m[o.axis];return!He(m[e.axis])||u>g||h<g}for(f=0;f<a&&!(!p()&&(this.updateRangeFromParsed(d,e,m,c),r));++f);if(r){for(f=a-1;f>=0;--f)if(!p()){this.updateRangeFromParsed(d,e,m,c);break}}return d}getAllParsedValues(e){const s=this._cachedMeta._parsed,n=[];let i,r,a;for(i=0,r=s.length;i<r;++i)a=s[i][e.axis],He(a)&&n.push(a);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const s=this._cachedMeta,n=s.iScale,i=s.vScale,r=this.getParsed(e);return{label:n?""+n.getLabelForValue(r[n.axis]):"",value:i?""+i.getLabelForValue(r[i.axis]):""}}_update(e){const s=this._cachedMeta;this.update(e||"default"),s._clip=I1(re(this.options.clip,F1(s.xScale,s.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,s=this.chart,n=this._cachedMeta,i=n.data||[],r=s.chartArea,a=[],o=this._drawStart||0,c=this._drawCount||i.length-o,d=this.options.drawActiveElementsOnTop;let u;for(n.dataset&&n.dataset.draw(e,r,o,c),u=o;u<o+c;++u){const h=i[u];h.hidden||(h.active&&d?a.push(h):h.draw(e,r))}for(u=0;u<a.length;++u)a[u].draw(e,r)}getStyle(e,s){const n=s?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,s,n){const i=this.getDataset();let r;if(e>=0&&e<this._cachedMeta.data.length){const a=this._cachedMeta.data[e];r=a.$context||(a.$context=$1(this.getContext(),e,a)),r.parsed=this.getParsed(e),r.raw=i.data[e],r.index=r.dataIndex=e}else r=this.$context||(this.$context=H1(this.chart.getContext(),this.index)),r.dataset=i,r.index=r.datasetIndex=this.index;return r.active=!!s,r.mode=n,r}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,s){return this._resolveElementOptions(this.dataElementType.id,s,e)}_resolveElementOptions(e,s="default",n){const i=s==="active",r=this._cachedDataOpts,a=e+"-"+s,o=r[a],c=this.enableOptionSharing&&lr(n);if(o)return Ch(o,c);const d=this.chart.config,u=d.datasetElementScopeKeys(this._type,e),h=i?[`${e}Hover`,"hover",e,""]:[e,""],f=d.getOptionScopes(this.getDataset(),u),m=Object.keys(Re.elements[e]),p=()=>this.getContext(n,i,s),g=d.resolveNamedOptions(f,m,p,h);return g.$shared&&(g.$shared=c,r[a]=Object.freeze(Ch(g,c))),g}_resolveAnimations(e,s,n){const i=this.chart,r=this._cachedDataOpts,a=`animation-${s}`,o=r[a];if(o)return o;let c;if(i.options.animation!==!1){const u=this.chart.config,h=u.datasetAnimationScopeKeys(this._type,s),f=u.getOptionScopes(this.getDataset(),h);c=u.createResolver(f,this.getContext(e,n,s))}const d=new yg(i,c&&c.animations);return c&&c._cacheable&&(r[a]=Object.freeze(d)),d}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,s){return!s||ml(e)||this.chart._animationsDisabled}_getSharedOptions(e,s){const n=this.resolveDataElementOptions(e,s),i=this._sharedOptions,r=this.getSharedOptions(n),a=this.includeOptions(s,r)||r!==i;return this.updateSharedOptions(r,s,n),{sharedOptions:r,includeOptions:a}}updateElement(e,s,n,i){ml(i)?Object.assign(e,n):this._resolveAnimations(s,i).update(e,n)}updateSharedOptions(e,s,n){e&&!ml(s)&&this._resolveAnimations(void 0,s).update(e,n)}_setStyle(e,s,n,i){e.active=i;const r=this.getStyle(s,i);this._resolveAnimations(s,n,i).update(e,{options:!i&&this.getSharedOptions(r)||r})}removeHoverStyle(e,s,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,s,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const s=this._data,n=this._cachedMeta.data;for(const[o,c,d]of this._syncList)this[o](c,d);this._syncList=[];const i=n.length,r=s.length,a=Math.min(r,i);a&&this.parse(0,a),r>i?this._insertElements(i,r-i,e):r<i&&this._removeElements(r,i-r)}_insertElements(e,s,n=!0){const i=this._cachedMeta,r=i.data,a=e+s;let o;const c=d=>{for(d.length+=s,o=d.length-1;o>=a;o--)d[o]=d[o-s]};for(c(r),o=e;o<a;++o)r[o]=new this.dataElementType;this._parsing&&c(i._parsed),this.parse(e,s),n&&this.updateElements(r,e,s,"reset")}updateElements(e,s,n,i){}_removeElements(e,s){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(e,s);n._stacked&&ki(n,i)}n.data.splice(e,s)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[s,n,i]=e;this[s](n,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,s){s&&this._sync(["_removeElements",e,s]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function U1(t,e){if(!t._cache.$bar){const s=t.getMatchingVisibleMetas(e);let n=[];for(let i=0,r=s.length;i<r;i++)n=n.concat(s[i].controller.getAllParsedValues(t));t._cache.$bar=Jp(n.sort((i,r)=>i-r))}return t._cache.$bar}function G1(t){const e=t.iScale,s=U1(e,t.type);let n=e._length,i,r,a,o;const c=()=>{a===32767||a===-32768||(lr(o)&&(n=Math.min(n,Math.abs(a-o)||n)),o=a)};for(i=0,r=s.length;i<r;++i)a=e.getPixelForValue(s[i]),c();for(o=void 0,i=0,r=e.ticks.length;i<r;++i)a=e.getPixelForTick(i),c();return n}function q1(t,e,s,n){const i=s.barThickness;let r,a;return ge(i)?(r=e.min*s.categoryPercentage,a=s.barPercentage):(r=i*n,a=1),{chunk:r/n,ratio:a,start:e.pixels[t]-r/2}}function K1(t,e,s,n){const i=e.pixels,r=i[t];let a=t>0?i[t-1]:null,o=t<i.length-1?i[t+1]:null;const c=s.categoryPercentage;a===null&&(a=r-(o===null?e.end-e.start:o-r)),o===null&&(o=r+r-a);const d=r-(r-Math.min(a,o))/2*c;return{chunk:Math.abs(o-a)/2*c/n,ratio:s.barPercentage,start:d}}function X1(t,e,s,n){const i=s.parse(t[0],n),r=s.parse(t[1],n),a=Math.min(i,r),o=Math.max(i,r);let c=a,d=o;Math.abs(a)>Math.abs(o)&&(c=o,d=a),e[s.axis]=d,e._custom={barStart:c,barEnd:d,start:i,end:r,min:a,max:o}}function vg(t,e,s,n){return Oe(t)?X1(t,e,s,n):e[s.axis]=s.parse(t,n),e}function Ph(t,e,s,n){const i=t.iScale,r=t.vScale,a=i.getLabels(),o=i===r,c=[];let d,u,h,f;for(d=s,u=s+n;d<u;++d)f=e[d],h={},h[i.axis]=o||i.parse(a[d],d),c.push(vg(f,h,r,d));return c}function pl(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function Z1(t,e,s){return t!==0?Mt(t):(e.isHorizontal()?1:-1)*(e.min>=s?1:-1)}function J1(t){let e,s,n,i,r;return t.horizontal?(e=t.base>t.x,s="left",n="right"):(e=t.base<t.y,s="bottom",n="top"),e?(i="end",r="start"):(i="start",r="end"),{start:s,end:n,reverse:e,top:i,bottom:r}}function Q1(t,e,s,n){let i=e.borderSkipped;const r={};if(!i){t.borderSkipped=r;return}if(i===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:a,end:o,reverse:c,top:d,bottom:u}=J1(t);i==="middle"&&s&&(t.enableBorderRadius=!0,(s._top||0)===n?i=d:(s._bottom||0)===n?i=u:(r[Dh(u,a,o,c)]=!0,i=d)),r[Dh(i,a,o,c)]=!0,t.borderSkipped=r}function Dh(t,e,s,n){return n?(t=ew(t,e,s),t=Eh(t,s,e)):t=Eh(t,e,s),t}function ew(t,e,s){return t===e?s:t===s?e:t}function Eh(t,e,s){return t==="start"?e:t==="end"?s:t}function tw(t,{inflateAmount:e},s){t.inflateAmount=e==="auto"?s===1?.33:0:e}class _g extends Zs{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,s,n,i){return Ph(e,s,n,i)}parseArrayData(e,s,n,i){return Ph(e,s,n,i)}parseObjectData(e,s,n,i){const{iScale:r,vScale:a}=e,{xAxisKey:o="x",yAxisKey:c="y"}=this._parsing,d=r.axis==="x"?o:c,u=a.axis==="x"?o:c,h=[];let f,m,p,g;for(f=n,m=n+i;f<m;++f)g=s[f],p={},p[r.axis]=r.parse($s(g,d),f),h.push(vg($s(g,u),p,a,f));return h}updateRangeFromParsed(e,s,n,i){super.updateRangeFromParsed(e,s,n,i);const r=n._custom;r&&s===this._cachedMeta.vScale&&(e.min=Math.min(e.min,r.min),e.max=Math.max(e.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const s=this._cachedMeta,{iScale:n,vScale:i}=s,r=this.getParsed(e),a=r._custom,o=pl(a)?"["+a.start+", "+a.end+"]":""+i.getLabelForValue(r[i.axis]);return{label:""+n.getLabelForValue(r[n.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const s=this._cachedMeta;this.updateElements(s.data,0,s.data.length,e)}updateElements(e,s,n,i){const r=i==="reset",{index:a,_cachedMeta:{vScale:o}}=this,c=o.getBasePixel(),d=o.isHorizontal(),u=this._getRuler(),{sharedOptions:h,includeOptions:f}=this._getSharedOptions(s,i);for(let m=s;m<s+n;m++){const p=this.getParsed(m),g=r||ge(p[o.axis])?{base:c,head:c}:this._calculateBarValuePixels(m),x=this._calculateBarIndexPixels(m,u),v=(p._stacks||{})[o.axis],_={horizontal:d,base:g.base,enableBorderRadius:!v||pl(p._custom)||a===v._top||a===v._bottom,x:d?g.head:x.center,y:d?x.center:g.head,height:d?x.size:Math.abs(g.size),width:d?Math.abs(g.size):x.size};f&&(_.options=h||this.resolveDataElementOptions(m,e[m].active?"active":i));const S=_.options||e[m].options;Q1(_,S,v,a),tw(_,S,u.ratio),this.updateElement(e[m],m,_,i)}}_getStacks(e,s){const{iScale:n}=this._cachedMeta,i=n.getMatchingVisibleMetas(this._type).filter(u=>u.controller.options.grouped),r=n.options.stacked,a=[],o=this._cachedMeta.controller.getParsed(s),c=o&&o[n.axis],d=u=>{const h=u._parsed.find(m=>m[n.axis]===c),f=h&&h[u.vScale.axis];if(ge(f)||isNaN(f))return!0};for(const u of i)if(!(s!==void 0&&d(u))&&((r===!1||a.indexOf(u.stack)===-1||r===void 0&&u.stack===void 0)&&a.push(u.stack),u.index===e))break;return a.length||a.push(void 0),a}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,s=this.chart.options.indexAxis;return Object.keys(e).filter(n=>e[n].axis===s).shift()}_getAxis(){const e={},s=this.getFirstScaleIdForIndexAxis();for(const n of this.chart.data.datasets)e[re(this.chart.options.indexAxis==="x"?n.xAxisID:n.yAxisID,s)]=!0;return Object.keys(e)}_getStackIndex(e,s,n){const i=this._getStacks(e,n),r=s!==void 0?i.indexOf(s):-1;return r===-1?i.length-1:r}_getRuler(){const e=this.options,s=this._cachedMeta,n=s.iScale,i=[];let r,a;for(r=0,a=s.data.length;r<a;++r)i.push(n.getPixelForValue(this.getParsed(r)[n.axis],r));const o=e.barThickness;return{min:o||G1(s),pixels:i,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:e.grouped,ratio:o?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:s,_stacked:n,index:i},options:{base:r,minBarLength:a}}=this,o=r||0,c=this.getParsed(e),d=c._custom,u=pl(d);let h=c[s.axis],f=0,m=n?this.applyStack(s,c,n):h,p,g;m!==h&&(f=m-h,m=h),u&&(h=d.barStart,m=d.barEnd-d.barStart,h!==0&&Mt(h)!==Mt(d.barEnd)&&(f=0),f+=h);const x=!ge(r)&&!u?r:f;let v=s.getPixelForValue(x);if(this.chart.getDataVisibility(e)?p=s.getPixelForValue(f+m):p=v,g=p-v,Math.abs(g)<a){g=Z1(g,s,o)*a,h===o&&(v-=g/2);const _=s.getPixelForDecimal(0),S=s.getPixelForDecimal(1),N=Math.min(_,S),j=Math.max(_,S);v=Math.max(Math.min(v,j),N),p=v+g,n&&!u&&(c._stacks[s.axis]._visualValues[i]=s.getValueForPixel(p)-s.getValueForPixel(v))}if(v===s.getPixelForValue(o)){const _=Mt(g)*s.getLineWidthForValue(o)/2;v+=_,g-=_}return{size:g,base:v,head:p,center:p+g/2}}_calculateBarIndexPixels(e,s){const n=s.scale,i=this.options,r=i.skipNull,a=re(i.maxBarThickness,1/0);let o,c;const d=this._getAxisCount();if(s.grouped){const u=r?this._getStackCount(e):s.stackCount,h=i.barThickness==="flex"?K1(e,s,i,u*d):q1(e,s,i,u*d),f=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,m=this._getAxis().indexOf(re(f,this.getFirstScaleIdForIndexAxis())),p=this._getStackIndex(this.index,this._cachedMeta.stack,r?e:void 0)+m;o=h.start+h.chunk*p+h.chunk/2,c=Math.min(a,h.chunk*h.ratio)}else o=n.getPixelForValue(this.getParsed(e)[n.axis],e),c=Math.min(a,s.min*s.ratio);return{base:o-c/2,head:o+c/2,center:o,size:c}}draw(){const e=this._cachedMeta,s=e.vScale,n=e.data,i=n.length;let r=0;for(;r<i;++r)this.getParsed(r)[s.axis]!==null&&!n[r].hidden&&n[r].draw(this._ctx)}}class sw extends Zs{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,s,n,i){const r=super.parsePrimitiveData(e,s,n,i);for(let a=0;a<r.length;a++)r[a]._custom=this.resolveDataElementOptions(a+n).radius;return r}parseArrayData(e,s,n,i){const r=super.parseArrayData(e,s,n,i);for(let a=0;a<r.length;a++){const o=s[n+a];r[a]._custom=re(o[2],this.resolveDataElementOptions(a+n).radius)}return r}parseObjectData(e,s,n,i){const r=super.parseObjectData(e,s,n,i);for(let a=0;a<r.length;a++){const o=s[n+a];r[a]._custom=re(o&&o.r&&+o.r,this.resolveDataElementOptions(a+n).radius)}return r}getMaxOverflow(){const e=this._cachedMeta.data;let s=0;for(let n=e.length-1;n>=0;--n)s=Math.max(s,e[n].size(this.resolveDataElementOptions(n))/2);return s>0&&s}getLabelAndValue(e){const s=this._cachedMeta,n=this.chart.data.labels||[],{xScale:i,yScale:r}=s,a=this.getParsed(e),o=i.getLabelForValue(a.x),c=r.getLabelForValue(a.y),d=a._custom;return{label:n[e]||"",value:"("+o+", "+c+(d?", "+d:"")+")"}}update(e){const s=this._cachedMeta.data;this.updateElements(s,0,s.length,e)}updateElements(e,s,n,i){const r=i==="reset",{iScale:a,vScale:o}=this._cachedMeta,{sharedOptions:c,includeOptions:d}=this._getSharedOptions(s,i),u=a.axis,h=o.axis;for(let f=s;f<s+n;f++){const m=e[f],p=!r&&this.getParsed(f),g={},x=g[u]=r?a.getPixelForDecimal(.5):a.getPixelForValue(p[u]),v=g[h]=r?o.getBasePixel():o.getPixelForValue(p[h]);g.skip=isNaN(x)||isNaN(v),d&&(g.options=c||this.resolveDataElementOptions(f,m.active?"active":i),r&&(g.options.radius=0)),this.updateElement(m,f,g,i)}}resolveDataElementOptions(e,s){const n=this.getParsed(e);let i=super.resolveDataElementOptions(e,s);i.$shared&&(i=Object.assign({},i,{$shared:!1}));const r=i.radius;return s!=="active"&&(i.radius=0),i.radius+=re(n&&n._custom,r),i}}function nw(t,e,s){let n=1,i=1,r=0,a=0;if(e<Me){const o=t,c=o+e,d=Math.cos(o),u=Math.sin(o),h=Math.cos(c),f=Math.sin(c),m=(S,N,j)=>cr(S,o,c,!0)?1:Math.max(N,N*s,j,j*s),p=(S,N,j)=>cr(S,o,c,!0)?-1:Math.min(N,N*s,j,j*s),g=m(0,d,h),x=m(qe,u,f),v=p(ve,d,h),_=p(ve+qe,u,f);n=(g-v)/2,i=(x-_)/2,r=-(g+v)/2,a=-(x+_)/2}return{ratioX:n,ratioY:i,offsetX:r,offsetY:a}}class hd extends Zs{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const s=e.data,{labels:{pointStyle:n,textAlign:i,color:r,useBorderRadius:a,borderRadius:o}}=e.legend.options;return s.labels.length&&s.datasets.length?s.labels.map((c,d)=>{const h=e.getDatasetMeta(0).controller.getStyle(d);return{text:c,fillStyle:h.backgroundColor,fontColor:r,hidden:!e.getDataVisibility(d),lineDash:h.borderDash,lineDashOffset:h.borderDashOffset,lineJoin:h.borderJoinStyle,lineWidth:h.borderWidth,strokeStyle:h.borderColor,textAlign:i,pointStyle:n,borderRadius:a&&(o||h.borderRadius),index:d}}):[]}},onClick(e,s,n){n.chart.toggleDataVisibility(s.index),n.chart.update()}}}};constructor(e,s){super(e,s),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,s){const n=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=n;else{let r=c=>+n[c];if(xe(n[e])){const{key:c="value"}=this._parsing;r=d=>+$s(n[d],c)}let a,o;for(a=e,o=e+s;a<o;++a)i._parsed[a]=r(a)}}_getRotation(){return Lt(this.options.rotation-90)}_getCircumference(){return Lt(this.options.circumference)}_getRotationExtents(){let e=Me,s=-Me;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const i=this.chart.getDatasetMeta(n).controller,r=i._getRotation(),a=i._getCircumference();e=Math.min(e,r),s=Math.max(s,r+a)}return{rotation:e,circumference:s-e}}update(e){const s=this.chart,{chartArea:n}=s,i=this._cachedMeta,r=i.data,a=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,o=Math.max((Math.min(n.width,n.height)-a)/2,0),c=Math.min(m_(this.options.cutout,o),1),d=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:f,ratioY:m,offsetX:p,offsetY:g}=nw(h,u,c),x=(n.width-a)/f,v=(n.height-a)/m,_=Math.max(Math.min(x,v)/2,0),S=Gp(this.options.radius,_),N=Math.max(S*c,0),j=(S-N)/this._getVisibleDatasetWeightTotal();this.offsetX=p*S,this.offsetY=g*S,i.total=this.calculateTotal(),this.outerRadius=S-j*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-j*d,0),this.updateElements(r,0,r.length,e)}_circumference(e,s){const n=this.options,i=this._cachedMeta,r=this._getCircumference();return s&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||i._parsed[e]===null||i.data[e].hidden?0:this.calculateCircumference(i._parsed[e]*r/Me)}updateElements(e,s,n,i){const r=i==="reset",a=this.chart,o=a.chartArea,d=a.options.animation,u=(o.left+o.right)/2,h=(o.top+o.bottom)/2,f=r&&d.animateScale,m=f?0:this.innerRadius,p=f?0:this.outerRadius,{sharedOptions:g,includeOptions:x}=this._getSharedOptions(s,i);let v=this._getRotation(),_;for(_=0;_<s;++_)v+=this._circumference(_,r);for(_=s;_<s+n;++_){const S=this._circumference(_,r),N=e[_],j={x:u+this.offsetX,y:h+this.offsetY,startAngle:v,endAngle:v+S,circumference:S,outerRadius:p,innerRadius:m};x&&(j.options=g||this.resolveDataElementOptions(_,N.active?"active":i)),v+=S,this.updateElement(N,_,j,i)}}calculateTotal(){const e=this._cachedMeta,s=e.data;let n=0,i;for(i=0;i<s.length;i++){const r=e._parsed[i];r!==null&&!isNaN(r)&&this.chart.getDataVisibility(i)&&!s[i].hidden&&(n+=Math.abs(r))}return n}calculateCircumference(e){const s=this._cachedMeta.total;return s>0&&!isNaN(e)?Me*(Math.abs(e)/s):0}getLabelAndValue(e){const s=this._cachedMeta,n=this.chart,i=n.data.labels||[],r=Tr(s._parsed[e],n.options.locale);return{label:i[e]||"",value:r}}getMaxBorderWidth(e){let s=0;const n=this.chart;let i,r,a,o,c;if(!e){for(i=0,r=n.data.datasets.length;i<r;++i)if(n.isDatasetVisible(i)){a=n.getDatasetMeta(i),e=a.data,o=a.controller;break}}if(!e)return 0;for(i=0,r=e.length;i<r;++i)c=o.resolveDataElementOptions(i),c.borderAlign!=="inner"&&(s=Math.max(s,c.borderWidth||0,c.hoverBorderWidth||0));return s}getMaxOffset(e){let s=0;for(let n=0,i=e.length;n<i;++n){const r=this.resolveDataElementOptions(n);s=Math.max(s,r.offset||0,r.hoverOffset||0)}return s}_getRingWeightOffset(e){let s=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(s+=this._getRingWeight(n));return s}_getRingWeight(e){return Math.max(re(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class wg extends Zs{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const s=this._cachedMeta,{dataset:n,data:i=[],_dataset:r}=s,a=this.chart._animationsDisabled;let{start:o,count:c}=tg(s,i,a);this._drawStart=o,this._drawCount=c,sg(s)&&(o=0,c=i.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!r._decimated,n.points=i;const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0),d.segment=this.options.segment,this.updateElement(n,void 0,{animated:!a,options:d},e),this.updateElements(i,o,c,e)}updateElements(e,s,n,i){const r=i==="reset",{iScale:a,vScale:o,_stacked:c,_dataset:d}=this._cachedMeta,{sharedOptions:u,includeOptions:h}=this._getSharedOptions(s,i),f=a.axis,m=o.axis,{spanGaps:p,segment:g}=this.options,x=Zn(p)?p:Number.POSITIVE_INFINITY,v=this.chart._animationsDisabled||r||i==="none",_=s+n,S=e.length;let N=s>0&&this.getParsed(s-1);for(let j=0;j<S;++j){const k=e[j],T=v?k:{};if(j<s||j>=_){T.skip=!0;continue}const M=this.getParsed(j),P=ge(M[m]),O=T[f]=a.getPixelForValue(M[f],j),A=T[m]=r||P?o.getBasePixel():o.getPixelForValue(c?this.applyStack(o,M,c):M[m],j);T.skip=isNaN(O)||isNaN(A)||P,T.stop=j>0&&Math.abs(M[f]-N[f])>x,g&&(T.parsed=M,T.raw=d.data[j]),h&&(T.options=u||this.resolveDataElementOptions(j,k.active?"active":i)),v||this.updateElement(k,j,T,i),N=M}}getMaxOverflow(){const e=this._cachedMeta,s=e.dataset,n=s.options&&s.options.borderWidth||0,i=e.data||[];if(!i.length)return n;const r=i[0].size(this.resolveDataElementOptions(0)),a=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(n,r,a)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}class kg extends Zs{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const s=e.data;if(s.labels.length&&s.datasets.length){const{labels:{pointStyle:n,color:i}}=e.legend.options;return s.labels.map((r,a)=>{const c=e.getDatasetMeta(0).controller.getStyle(a);return{text:r,fillStyle:c.backgroundColor,strokeStyle:c.borderColor,fontColor:i,lineWidth:c.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(a),index:a}})}return[]}},onClick(e,s,n){n.chart.toggleDataVisibility(s.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(e,s){super(e,s),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const s=this._cachedMeta,n=this.chart,i=n.data.labels||[],r=Tr(s._parsed[e].r,n.options.locale);return{label:i[e]||"",value:r}}parseObjectData(e,s,n,i){return dg.bind(this)(e,s,n,i)}update(e){const s=this._cachedMeta.data;this._updateRadius(),this.updateElements(s,0,s.length,e)}getMinMax(){const e=this._cachedMeta,s={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((n,i)=>{const r=this.getParsed(i).r;!isNaN(r)&&this.chart.getDataVisibility(i)&&(r<s.min&&(s.min=r),r>s.max&&(s.max=r))}),s}_updateRadius(){const e=this.chart,s=e.chartArea,n=e.options,i=Math.min(s.right-s.left,s.bottom-s.top),r=Math.max(i/2,0),a=Math.max(n.cutoutPercentage?r/100*n.cutoutPercentage:1,0),o=(r-a)/e.getVisibleDatasetCount();this.outerRadius=r-o*this.index,this.innerRadius=this.outerRadius-o}updateElements(e,s,n,i){const r=i==="reset",a=this.chart,c=a.options.animation,d=this._cachedMeta.rScale,u=d.xCenter,h=d.yCenter,f=d.getIndexAngle(0)-.5*ve;let m=f,p;const g=360/this.countVisibleElements();for(p=0;p<s;++p)m+=this._computeAngle(p,i,g);for(p=s;p<s+n;p++){const x=e[p];let v=m,_=m+this._computeAngle(p,i,g),S=a.getDataVisibility(p)?d.getDistanceFromCenterForValue(this.getParsed(p).r):0;m=_,r&&(c.animateScale&&(S=0),c.animateRotate&&(v=_=f));const N={x:u,y:h,innerRadius:0,outerRadius:S,startAngle:v,endAngle:_,options:this.resolveDataElementOptions(p,x.active?"active":i)};this.updateElement(x,p,N,i)}}countVisibleElements(){const e=this._cachedMeta;let s=0;return e.data.forEach((n,i)=>{!isNaN(this.getParsed(i).r)&&this.chart.getDataVisibility(i)&&s++}),s}_computeAngle(e,s,n){return this.chart.getDataVisibility(e)?Lt(this.resolveDataElementOptions(e,s).angle||n):0}}class iw extends hd{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}class Sg extends Zs{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(e){const s=this._cachedMeta.vScale,n=this.getParsed(e);return{label:s.getLabels()[e],value:""+s.getLabelForValue(n[s.axis])}}parseObjectData(e,s,n,i){return dg.bind(this)(e,s,n,i)}update(e){const s=this._cachedMeta,n=s.dataset,i=s.data||[],r=s.iScale.getLabels();if(n.points=i,e!=="resize"){const a=this.resolveDatasetElementOptions(e);this.options.showLine||(a.borderWidth=0);const o={_loop:!0,_fullLoop:r.length===i.length,options:a};this.updateElement(n,void 0,o,e)}this.updateElements(i,0,i.length,e)}updateElements(e,s,n,i){const r=this._cachedMeta.rScale,a=i==="reset";for(let o=s;o<s+n;o++){const c=e[o],d=this.resolveDataElementOptions(o,c.active?"active":i),u=r.getPointPositionForValue(o,this.getParsed(o).r),h=a?r.xCenter:u.x,f=a?r.yCenter:u.y,m={x:h,y:f,angle:u.angle,skip:isNaN(h)||isNaN(f),options:d};this.updateElement(c,o,m,i)}}}class rw extends Zs{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(e){const s=this._cachedMeta,n=this.chart.data.labels||[],{xScale:i,yScale:r}=s,a=this.getParsed(e),o=i.getLabelForValue(a.x),c=r.getLabelForValue(a.y);return{label:n[e]||"",value:"("+o+", "+c+")"}}update(e){const s=this._cachedMeta,{data:n=[]}=s,i=this.chart._animationsDisabled;let{start:r,count:a}=tg(s,n,i);if(this._drawStart=r,this._drawCount=a,sg(s)&&(r=0,a=n.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:o,_dataset:c}=s;o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!c._decimated,o.points=n;const d=this.resolveDatasetElementOptions(e);d.segment=this.options.segment,this.updateElement(o,void 0,{animated:!i,options:d},e)}else this.datasetElementType&&(delete s.dataset,this.datasetElementType=!1);this.updateElements(n,r,a,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,s,n,i){const r=i==="reset",{iScale:a,vScale:o,_stacked:c,_dataset:d}=this._cachedMeta,u=this.resolveDataElementOptions(s,i),h=this.getSharedOptions(u),f=this.includeOptions(i,h),m=a.axis,p=o.axis,{spanGaps:g,segment:x}=this.options,v=Zn(g)?g:Number.POSITIVE_INFINITY,_=this.chart._animationsDisabled||r||i==="none";let S=s>0&&this.getParsed(s-1);for(let N=s;N<s+n;++N){const j=e[N],k=this.getParsed(N),T=_?j:{},M=ge(k[p]),P=T[m]=a.getPixelForValue(k[m],N),O=T[p]=r||M?o.getBasePixel():o.getPixelForValue(c?this.applyStack(o,k,c):k[p],N);T.skip=isNaN(P)||isNaN(O)||M,T.stop=N>0&&Math.abs(k[m]-S[m])>v,x&&(T.parsed=k,T.raw=d.data[N]),f&&(T.options=h||this.resolveDataElementOptions(N,j.active?"active":i)),_||this.updateElement(j,N,T,i),S=k}this.updateSharedOptions(h,i,u)}getMaxOverflow(){const e=this._cachedMeta,s=e.data||[];if(!this.options.showLine){let o=0;for(let c=s.length-1;c>=0;--c)o=Math.max(o,s[c].size(this.resolveDataElementOptions(c))/2);return o>0&&o}const n=e.dataset,i=n.options&&n.options.borderWidth||0;if(!s.length)return i;const r=s[0].size(this.resolveDataElementOptions(0)),a=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(i,r,a)/2}}var aw=Object.freeze({__proto__:null,BarController:_g,BubbleController:sw,DoughnutController:hd,LineController:wg,PieController:iw,PolarAreaController:kg,RadarController:Sg,ScatterController:rw});function ln(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class fd{static override(e){Object.assign(fd.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return ln()}parse(){return ln()}format(){return ln()}add(){return ln()}diff(){return ln()}startOf(){return ln()}endOf(){return ln()}}var jg={_date:fd};function ow(t,e,s,n){const{controller:i,data:r,_sorted:a}=t,o=i._cachedMeta.iScale,c=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(o&&e===o.axis&&e!=="r"&&a&&r.length){const d=o._reversePixels?T_:gs;if(n){if(i._sharedOptions){const u=r[0],h=typeof u.getRange=="function"&&u.getRange(e);if(h){const f=d(r,e,s-h),m=d(r,e,s+h);return{lo:f.lo,hi:m.hi}}}}else{const u=d(r,e,s);if(c){const{vScale:h}=i._cachedMeta,{_parsed:f}=t,m=f.slice(0,u.lo+1).reverse().findIndex(g=>!ge(g[h.axis]));u.lo-=Math.max(0,m);const p=f.slice(u.hi).findIndex(g=>!ge(g[h.axis]));u.hi+=Math.max(0,p)}return u}}return{lo:0,hi:r.length-1}}function vo(t,e,s,n,i){const r=t.getSortedVisibleDatasetMetas(),a=s[e];for(let o=0,c=r.length;o<c;++o){const{index:d,data:u}=r[o],{lo:h,hi:f}=ow(r[o],e,a,i);for(let m=h;m<=f;++m){const p=u[m];p.skip||n(p,d,m)}}}function lw(t){const e=t.indexOf("x")!==-1,s=t.indexOf("y")!==-1;return function(n,i){const r=e?Math.abs(n.x-i.x):0,a=s?Math.abs(n.y-i.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(a,2))}}function gl(t,e,s,n,i){const r=[];return!i&&!t.isPointInArea(e)||vo(t,s,e,function(o,c,d){!i&&!Xt(o,t.chartArea,0)||o.inRange(e.x,e.y,n)&&r.push({element:o,datasetIndex:c,index:d})},!0),r}function cw(t,e,s,n){let i=[];function r(a,o,c){const{startAngle:d,endAngle:u}=a.getProps(["startAngle","endAngle"],n),{angle:h}=Xp(a,{x:e.x,y:e.y});cr(h,d,u)&&i.push({element:a,datasetIndex:o,index:c})}return vo(t,s,e,r),i}function dw(t,e,s,n,i,r){let a=[];const o=lw(s);let c=Number.POSITIVE_INFINITY;function d(u,h,f){const m=u.inRange(e.x,e.y,i);if(n&&!m)return;const p=u.getCenterPoint(i);if(!(!!r||t.isPointInArea(p))&&!m)return;const x=o(e,p);x<c?(a=[{element:u,datasetIndex:h,index:f}],c=x):x===c&&a.push({element:u,datasetIndex:h,index:f})}return vo(t,s,e,d),a}function xl(t,e,s,n,i,r){return!r&&!t.isPointInArea(e)?[]:s==="r"&&!n?cw(t,e,s,i):dw(t,e,s,n,i,r)}function Ah(t,e,s,n,i){const r=[],a=s==="x"?"inXRange":"inYRange";let o=!1;return vo(t,s,e,(c,d,u)=>{c[a]&&c[a](e[s],i)&&(r.push({element:c,datasetIndex:d,index:u}),o=o||c.inRange(e.x,e.y,i))}),n&&!o?[]:r}var uw={modes:{index(t,e,s,n){const i=qt(e,t),r=s.axis||"x",a=s.includeInvisible||!1,o=s.intersect?gl(t,i,r,n,a):xl(t,i,r,!1,n,a),c=[];return o.length?(t.getSortedVisibleDatasetMetas().forEach(d=>{const u=o[0].index,h=d.data[u];h&&!h.skip&&c.push({element:h,datasetIndex:d.index,index:u})}),c):[]},dataset(t,e,s,n){const i=qt(e,t),r=s.axis||"xy",a=s.includeInvisible||!1;let o=s.intersect?gl(t,i,r,n,a):xl(t,i,r,!1,n,a);if(o.length>0){const c=o[0].datasetIndex,d=t.getDatasetMeta(c).data;o=[];for(let u=0;u<d.length;++u)o.push({element:d[u],datasetIndex:c,index:u})}return o},point(t,e,s,n){const i=qt(e,t),r=s.axis||"xy",a=s.includeInvisible||!1;return gl(t,i,r,n,a)},nearest(t,e,s,n){const i=qt(e,t),r=s.axis||"xy",a=s.includeInvisible||!1;return xl(t,i,r,s.intersect,n,a)},x(t,e,s,n){const i=qt(e,t);return Ah(t,i,"x",s.intersect,n)},y(t,e,s,n){const i=qt(e,t);return Ah(t,i,"y",s.intersect,n)}}};const Ng=["left","top","right","bottom"];function Si(t,e){return t.filter(s=>s.pos===e)}function Oh(t,e){return t.filter(s=>Ng.indexOf(s.pos)===-1&&s.box.axis===e)}function ji(t,e){return t.sort((s,n)=>{const i=e?n:s,r=e?s:n;return i.weight===r.weight?i.index-r.index:i.weight-r.weight})}function hw(t){const e=[];let s,n,i,r,a,o;for(s=0,n=(t||[]).length;s<n;++s)i=t[s],{position:r,options:{stack:a,stackWeight:o=1}}=i,e.push({index:s,box:i,pos:r,horizontal:i.isHorizontal(),weight:i.weight,stack:a&&r+a,stackWeight:o});return e}function fw(t){const e={};for(const s of t){const{stack:n,pos:i,stackWeight:r}=s;if(!n||!Ng.includes(i))continue;const a=e[n]||(e[n]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=r}return e}function mw(t,e){const s=fw(t),{vBoxMaxWidth:n,hBoxMaxHeight:i}=e;let r,a,o;for(r=0,a=t.length;r<a;++r){o=t[r];const{fullSize:c}=o.box,d=s[o.stack],u=d&&o.stackWeight/d.weight;o.horizontal?(o.width=u?u*n:c&&e.availableWidth,o.height=i):(o.width=n,o.height=u?u*i:c&&e.availableHeight)}return s}function pw(t){const e=hw(t),s=ji(e.filter(d=>d.box.fullSize),!0),n=ji(Si(e,"left"),!0),i=ji(Si(e,"right")),r=ji(Si(e,"top"),!0),a=ji(Si(e,"bottom")),o=Oh(e,"x"),c=Oh(e,"y");return{fullSize:s,leftAndTop:n.concat(r),rightAndBottom:i.concat(c).concat(a).concat(o),chartArea:Si(e,"chartArea"),vertical:n.concat(i).concat(c),horizontal:r.concat(a).concat(o)}}function Rh(t,e,s,n){return Math.max(t[s],e[s])+Math.max(t[n],e[n])}function Tg(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function gw(t,e,s,n){const{pos:i,box:r}=s,a=t.maxPadding;if(!xe(i)){s.size&&(t[i]-=s.size);const h=n[s.stack]||{size:0,count:1};h.size=Math.max(h.size,s.horizontal?r.height:r.width),s.size=h.size/h.count,t[i]+=s.size}r.getPadding&&Tg(a,r.getPadding());const o=Math.max(0,e.outerWidth-Rh(a,t,"left","right")),c=Math.max(0,e.outerHeight-Rh(a,t,"top","bottom")),d=o!==t.w,u=c!==t.h;return t.w=o,t.h=c,s.horizontal?{same:d,other:u}:{same:u,other:d}}function xw(t){const e=t.maxPadding;function s(n){const i=Math.max(e[n]-t[n],0);return t[n]+=i,i}t.y+=s("top"),t.x+=s("left"),s("right"),s("bottom")}function yw(t,e){const s=e.maxPadding;function n(i){const r={left:0,top:0,right:0,bottom:0};return i.forEach(a=>{r[a]=Math.max(e[a],s[a])}),r}return n(t?["left","right"]:["top","bottom"])}function Bi(t,e,s,n){const i=[];let r,a,o,c,d,u;for(r=0,a=t.length,d=0;r<a;++r){o=t[r],c=o.box,c.update(o.width||e.w,o.height||e.h,yw(o.horizontal,e));const{same:h,other:f}=gw(e,s,o,n);d|=h&&i.length,u=u||f,c.fullSize||i.push(o)}return d&&Bi(i,e,s,n)||u}function ea(t,e,s,n,i){t.top=s,t.left=e,t.right=e+n,t.bottom=s+i,t.width=n,t.height=i}function Lh(t,e,s,n){const i=s.padding;let{x:r,y:a}=e;for(const o of t){const c=o.box,d=n[o.stack]||{placed:0,weight:1},u=o.stackWeight/d.weight||1;if(o.horizontal){const h=e.w*u,f=d.size||c.height;lr(d.start)&&(a=d.start),c.fullSize?ea(c,i.left,a,s.outerWidth-i.right-i.left,f):ea(c,e.left+d.placed,a,h,f),d.start=a,d.placed+=h,a=c.bottom}else{const h=e.h*u,f=d.size||c.width;lr(d.start)&&(r=d.start),c.fullSize?ea(c,r,i.top,f,s.outerHeight-i.bottom-i.top):ea(c,r,e.top+d.placed,f,h),d.start=r,d.placed+=h,r=c.right}}e.x=r,e.y=a}var at={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(s){e.draw(s)}}]},t.boxes.push(e)},removeBox(t,e){const s=t.boxes?t.boxes.indexOf(e):-1;s!==-1&&t.boxes.splice(s,1)},configure(t,e,s){e.fullSize=s.fullSize,e.position=s.position,e.weight=s.weight},update(t,e,s,n){if(!t)return;const i=ct(t.options.layout.padding),r=Math.max(e-i.width,0),a=Math.max(s-i.height,0),o=pw(t.boxes),c=o.vertical,d=o.horizontal;pe(t.boxes,g=>{typeof g.beforeLayout=="function"&&g.beforeLayout()});const u=c.reduce((g,x)=>x.box.options&&x.box.options.display===!1?g:g+1,0)||1,h=Object.freeze({outerWidth:e,outerHeight:s,padding:i,availableWidth:r,availableHeight:a,vBoxMaxWidth:r/2/u,hBoxMaxHeight:a/2}),f=Object.assign({},i);Tg(f,ct(n));const m=Object.assign({maxPadding:f,w:r,h:a,x:i.left,y:i.top},i),p=mw(c.concat(d),h);Bi(o.fullSize,m,h,p),Bi(c,m,h,p),Bi(d,m,h,p)&&Bi(c,m,h,p),xw(m),Lh(o.leftAndTop,m,h,p),m.x+=m.w,m.y+=m.h,Lh(o.rightAndBottom,m,h,p),t.chartArea={left:m.left,top:m.top,right:m.left+m.w,bottom:m.top+m.h,height:m.h,width:m.w},pe(o.chartArea,g=>{const x=g.box;Object.assign(x,t.chartArea),x.update(m.w,m.h,{left:0,top:0,right:0,bottom:0})})}};class Mg{acquireContext(e,s){}releaseContext(e){return!1}addEventListener(e,s,n){}removeEventListener(e,s,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,s,n,i){return s=Math.max(0,s||e.width),n=n||e.height,{width:s,height:Math.max(0,i?Math.floor(s/i):n)}}isAttached(e){return!0}updateConfig(e){}}class bw extends Mg{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const _a="$chartjs",vw={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Fh=t=>t===null||t==="";function _w(t,e){const s=t.style,n=t.getAttribute("height"),i=t.getAttribute("width");if(t[_a]={initial:{height:n,width:i,style:{display:s.display,height:s.height,width:s.width}}},s.display=s.display||"block",s.boxSizing=s.boxSizing||"border-box",Fh(i)){const r=vh(t,"width");r!==void 0&&(t.width=r)}if(Fh(n))if(t.style.height==="")t.height=t.width/(e||2);else{const r=vh(t,"height");r!==void 0&&(t.height=r)}return t}const Cg=v1?{passive:!0}:!1;function ww(t,e,s){t&&t.addEventListener(e,s,Cg)}function kw(t,e,s){t&&t.canvas&&t.canvas.removeEventListener(e,s,Cg)}function Sw(t,e){const s=vw[t.type]||t.type,{x:n,y:i}=qt(t,e);return{type:s,chart:e,native:t,x:n!==void 0?n:null,y:i!==void 0?i:null}}function Ha(t,e){for(const s of t)if(s===e||s.contains(e))return!0}function jw(t,e,s){const n=t.canvas,i=new MutationObserver(r=>{let a=!1;for(const o of r)a=a||Ha(o.addedNodes,n),a=a&&!Ha(o.removedNodes,n);a&&s()});return i.observe(document,{childList:!0,subtree:!0}),i}function Nw(t,e,s){const n=t.canvas,i=new MutationObserver(r=>{let a=!1;for(const o of r)a=a||Ha(o.removedNodes,n),a=a&&!Ha(o.addedNodes,n);a&&s()});return i.observe(document,{childList:!0,subtree:!0}),i}const ur=new Map;let Ih=0;function Pg(){const t=window.devicePixelRatio;t!==Ih&&(Ih=t,ur.forEach((e,s)=>{s.currentDevicePixelRatio!==t&&e()}))}function Tw(t,e){ur.size||window.addEventListener("resize",Pg),ur.set(t,e)}function Mw(t){ur.delete(t),ur.size||window.removeEventListener("resize",Pg)}function Cw(t,e,s){const n=t.canvas,i=n&&ud(n);if(!i)return;const r=eg((o,c)=>{const d=i.clientWidth;s(o,c),d<i.clientWidth&&s()},window),a=new ResizeObserver(o=>{const c=o[0],d=c.contentRect.width,u=c.contentRect.height;d===0&&u===0||r(d,u)});return a.observe(i),Tw(t,r),a}function yl(t,e,s){s&&s.disconnect(),e==="resize"&&Mw(t)}function Pw(t,e,s){const n=t.canvas,i=eg(r=>{t.ctx!==null&&s(Sw(r,t))},t);return ww(n,e,i),i}class Dw extends Mg{acquireContext(e,s){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(_w(e,s),n):null}releaseContext(e){const s=e.canvas;if(!s[_a])return!1;const n=s[_a].initial;["height","width"].forEach(r=>{const a=n[r];ge(a)?s.removeAttribute(r):s.setAttribute(r,a)});const i=n.style||{};return Object.keys(i).forEach(r=>{s.style[r]=i[r]}),s.width=s.width,delete s[_a],!0}addEventListener(e,s,n){this.removeEventListener(e,s);const i=e.$proxies||(e.$proxies={}),a={attach:jw,detach:Nw,resize:Cw}[s]||Pw;i[s]=a(e,s,n)}removeEventListener(e,s){const n=e.$proxies||(e.$proxies={}),i=n[s];if(!i)return;({attach:yl,detach:yl,resize:yl}[s]||kw)(e,s,i),n[s]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,s,n,i){return b1(e,s,n,i)}isAttached(e){const s=e&&ud(e);return!!(s&&s.isConnected)}}function Ew(t){return!dd()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?bw:Dw}let js=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:s,y:n}=this.getProps(["x","y"],e);return{x:s,y:n}}hasValue(){return Zn(this.x)&&Zn(this.y)}getProps(e,s){const n=this.$animations;if(!s||!n)return this;const i={};return e.forEach(r=>{i[r]=n[r]&&n[r].active()?n[r]._to:this[r]}),i}};function Aw(t,e){const s=t.options.ticks,n=Ow(t),i=Math.min(s.maxTicksLimit||n,n),r=s.major.enabled?Lw(e):[],a=r.length,o=r[0],c=r[a-1],d=[];if(a>i)return Fw(e,d,r,a/i),d;const u=Rw(r,e,i);if(a>0){let h,f;const m=a>1?Math.round((c-o)/(a-1)):null;for(ta(e,d,u,ge(m)?0:o-m,o),h=0,f=a-1;h<f;h++)ta(e,d,u,r[h],r[h+1]);return ta(e,d,u,c,ge(m)?e.length:c+m),d}return ta(e,d,u),d}function Ow(t){const e=t.options.offset,s=t._tickSize(),n=t._length/s+(e?0:1),i=t._maxLength/s;return Math.floor(Math.min(n,i))}function Rw(t,e,s){const n=Iw(t),i=e.length/s;if(!n)return Math.max(i,1);const r=w_(n);for(let a=0,o=r.length-1;a<o;a++){const c=r[a];if(c>i)return c}return Math.max(i,1)}function Lw(t){const e=[];let s,n;for(s=0,n=t.length;s<n;s++)t[s].major&&e.push(s);return e}function Fw(t,e,s,n){let i=0,r=s[0],a;for(n=Math.ceil(n),a=0;a<t.length;a++)a===r&&(e.push(t[a]),i++,r=s[i*n])}function ta(t,e,s,n,i){const r=re(n,0),a=Math.min(re(i,t.length),t.length);let o=0,c,d,u;for(s=Math.ceil(s),i&&(c=i-n,s=c/Math.floor(c/s)),u=r;u<0;)o++,u=Math.round(r+o*s);for(d=Math.max(r,0);d<a;d++)d===u&&(e.push(t[d]),o++,u=Math.round(r+o*s))}function Iw(t){const e=t.length;let s,n;if(e<2)return!1;for(n=t[0],s=1;s<e;++s)if(t[s]-t[s-1]!==n)return!1;return n}const Vw=t=>t==="left"?"right":t==="right"?"left":t,Vh=(t,e,s)=>e==="top"||e==="left"?t[e]+s:t[e]-s,Wh=(t,e)=>Math.min(e||t,t);function Bh(t,e){const s=[],n=t.length/e,i=t.length;let r=0;for(;r<i;r+=n)s.push(t[Math.floor(r)]);return s}function Ww(t,e,s){const n=t.ticks.length,i=Math.min(e,n-1),r=t._startPixel,a=t._endPixel,o=1e-6;let c=t.getPixelForTick(i),d;if(!(s&&(n===1?d=Math.max(c-r,a-c):e===0?d=(t.getPixelForTick(1)-c)/2:d=(c-t.getPixelForTick(i-1))/2,c+=i<e?d:-d,c<r-o||c>a+o)))return c}function Bw(t,e){pe(t,s=>{const n=s.gc,i=n.length/2;let r;if(i>e){for(r=0;r<i;++r)delete s.data[n[r]];n.splice(0,i)}})}function Ni(t){return t.drawTicks?t.tickLength:0}function zh(t,e){if(!t.display)return 0;const s=Xe(t.font,e),n=ct(t.padding);return(Oe(t.text)?t.text.length:1)*s.lineHeight+n.height}function zw(t,e){return Xs(t,{scale:e,type:"scale"})}function Hw(t,e,s){return Xs(t,{tick:s,index:e,type:"tick"})}function $w(t,e,s){let n=id(t);return(s&&e!=="right"||!s&&e==="right")&&(n=Vw(n)),n}function Yw(t,e,s,n){const{top:i,left:r,bottom:a,right:o,chart:c}=t,{chartArea:d,scales:u}=c;let h=0,f,m,p;const g=a-i,x=o-r;if(t.isHorizontal()){if(m=nt(n,r,o),xe(s)){const v=Object.keys(s)[0],_=s[v];p=u[v].getPixelForValue(_)+g-e}else s==="center"?p=(d.bottom+d.top)/2+g-e:p=Vh(t,s,e);f=o-r}else{if(xe(s)){const v=Object.keys(s)[0],_=s[v];m=u[v].getPixelForValue(_)-x+e}else s==="center"?m=(d.left+d.right)/2-x+e:m=Vh(t,s,e);p=nt(n,a,i),h=s==="left"?-qe:qe}return{titleX:m,titleY:p,maxWidth:f,rotation:h}}class Tn extends js{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,s){return e}getUserBounds(){let{_userMin:e,_userMax:s,_suggestedMin:n,_suggestedMax:i}=this;return e=yt(e,Number.POSITIVE_INFINITY),s=yt(s,Number.NEGATIVE_INFINITY),n=yt(n,Number.POSITIVE_INFINITY),i=yt(i,Number.NEGATIVE_INFINITY),{min:yt(e,n),max:yt(s,i),minDefined:He(e),maxDefined:He(s)}}getMinMax(e){let{min:s,max:n,minDefined:i,maxDefined:r}=this.getUserBounds(),a;if(i&&r)return{min:s,max:n};const o=this.getMatchingVisibleMetas();for(let c=0,d=o.length;c<d;++c)a=o[c].controller.getMinMax(this,e),i||(s=Math.min(s,a.min)),r||(n=Math.max(n,a.max));return s=r&&s>n?n:s,n=i&&s>n?s:n,{min:yt(s,yt(n,s)),max:yt(n,yt(s,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){ie(this.options.beforeUpdate,[this])}update(e,s,n){const{beginAtZero:i,grace:r,ticks:a}=this.options,o=a.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=s,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Z_(this,r,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=o<this.ticks.length;this._convertTicksToLabels(c?Bh(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||a.source==="auto")&&(this.ticks=Aw(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,s,n;this.isHorizontal()?(s=this.left,n=this.right):(s=this.top,n=this.bottom,e=!e),this._startPixel=s,this._endPixel=n,this._reversePixels=e,this._length=n-s,this._alignToPixels=this.options.alignToPixels}afterUpdate(){ie(this.options.afterUpdate,[this])}beforeSetDimensions(){ie(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){ie(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),ie(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){ie(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const s=this.options.ticks;let n,i,r;for(n=0,i=e.length;n<i;n++)r=e[n],r.label=ie(s.callback,[r.value,n,e],this)}afterTickToLabelConversion(){ie(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){ie(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,s=e.ticks,n=Wh(this.ticks.length,e.ticks.maxTicksLimit),i=s.minRotation||0,r=s.maxRotation;let a=i,o,c,d;if(!this._isVisible()||!s.display||i>=r||n<=1||!this.isHorizontal()){this.labelRotation=i;return}const u=this._getLabelSizes(),h=u.widest.width,f=u.highest.height,m=et(this.chart.width-h,0,this.maxWidth);o=e.offset?this.maxWidth/n:m/(n-1),h+6>o&&(o=m/(n-(e.offset?.5:1)),c=this.maxHeight-Ni(e.grid)-s.padding-zh(e.title,this.chart.options.font),d=Math.sqrt(h*h+f*f),a=sd(Math.min(Math.asin(et((u.highest.height+6)/o,-1,1)),Math.asin(et(c/d,-1,1))-Math.asin(et(f/d,-1,1)))),a=Math.max(i,Math.min(r,a))),this.labelRotation=a}afterCalculateLabelRotation(){ie(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){ie(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:s,options:{ticks:n,title:i,grid:r}}=this,a=this._isVisible(),o=this.isHorizontal();if(a){const c=zh(i,s.options.font);if(o?(e.width=this.maxWidth,e.height=Ni(r)+c):(e.height=this.maxHeight,e.width=Ni(r)+c),n.display&&this.ticks.length){const{first:d,last:u,widest:h,highest:f}=this._getLabelSizes(),m=n.padding*2,p=Lt(this.labelRotation),g=Math.cos(p),x=Math.sin(p);if(o){const v=n.mirror?0:x*h.width+g*f.height;e.height=Math.min(this.maxHeight,e.height+v+m)}else{const v=n.mirror?0:g*h.width+x*f.height;e.width=Math.min(this.maxWidth,e.width+v+m)}this._calculatePadding(d,u,x,g)}}this._handleMargins(),o?(this.width=this._length=s.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=s.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,s,n,i){const{ticks:{align:r,padding:a},position:o}=this.options,c=this.labelRotation!==0,d=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,m=0;c?d?(f=i*e.width,m=n*s.height):(f=n*e.height,m=i*s.width):r==="start"?m=s.width:r==="end"?f=e.width:r!=="inner"&&(f=e.width/2,m=s.width/2),this.paddingLeft=Math.max((f-u+a)*this.width/(this.width-u),0),this.paddingRight=Math.max((m-h+a)*this.width/(this.width-h),0)}else{let u=s.height/2,h=e.height/2;r==="start"?(u=0,h=e.height):r==="end"&&(u=s.height,h=0),this.paddingTop=u+a,this.paddingBottom=h+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){ie(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:s}=this.options;return s==="top"||s==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let s,n;for(s=0,n=e.length;s<n;s++)ge(e[s].label)&&(e.splice(s,1),n--,s--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const s=this.options.ticks.sampleSize;let n=this.ticks;s<n.length&&(n=Bh(n,s)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,s,n){const{ctx:i,_longestTextCache:r}=this,a=[],o=[],c=Math.floor(s/Wh(s,n));let d=0,u=0,h,f,m,p,g,x,v,_,S,N,j;for(h=0;h<s;h+=c){if(p=e[h].label,g=this._resolveTickFontOptions(h),i.font=x=g.string,v=r[x]=r[x]||{data:{},gc:[]},_=g.lineHeight,S=N=0,!ge(p)&&!Oe(p))S=Ba(i,v.data,v.gc,S,p),N=_;else if(Oe(p))for(f=0,m=p.length;f<m;++f)j=p[f],!ge(j)&&!Oe(j)&&(S=Ba(i,v.data,v.gc,S,j),N+=_);a.push(S),o.push(N),d=Math.max(S,d),u=Math.max(N,u)}Bw(r,s);const k=a.indexOf(d),T=o.indexOf(u),M=P=>({width:a[P]||0,height:o[P]||0});return{first:M(0),last:M(s-1),widest:M(k),highest:M(T),widths:a,heights:o}}getLabelForValue(e){return e}getPixelForValue(e,s){return NaN}getValueForPixel(e){}getPixelForTick(e){const s=this.ticks;return e<0||e>s.length-1?null:this.getPixelForValue(s[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const s=this._startPixel+e*this._length;return N_(this._alignToPixels?on(this.chart,s,0):s)}getDecimalForPixel(e){const s=(e-this._startPixel)/this._length;return this._reversePixels?1-s:s}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:s}=this;return e<0&&s<0?s:e>0&&s>0?e:0}getContext(e){const s=this.ticks||[];if(e>=0&&e<s.length){const n=s[e];return n.$context||(n.$context=Hw(this.getContext(),e,n))}return this.$context||(this.$context=zw(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,s=Lt(this.labelRotation),n=Math.abs(Math.cos(s)),i=Math.abs(Math.sin(s)),r=this._getLabelSizes(),a=e.autoSkipPadding||0,o=r?r.widest.width+a:0,c=r?r.highest.height+a:0;return this.isHorizontal()?c*n>o*i?o/n:c/i:c*i<o*n?c/n:o/i}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const s=this.axis,n=this.chart,i=this.options,{grid:r,position:a,border:o}=i,c=r.offset,d=this.isHorizontal(),h=this.ticks.length+(c?1:0),f=Ni(r),m=[],p=o.setContext(this.getContext()),g=p.display?p.width:0,x=g/2,v=function(Q){return on(n,Q,g)};let _,S,N,j,k,T,M,P,O,A,F,X;if(a==="top")_=v(this.bottom),T=this.bottom-f,P=_-x,A=v(e.top)+x,X=e.bottom;else if(a==="bottom")_=v(this.top),A=e.top,X=v(e.bottom)-x,T=_+x,P=this.top+f;else if(a==="left")_=v(this.right),k=this.right-f,M=_-x,O=v(e.left)+x,F=e.right;else if(a==="right")_=v(this.left),O=e.left,F=v(e.right)-x,k=_+x,M=this.left+f;else if(s==="x"){if(a==="center")_=v((e.top+e.bottom)/2+.5);else if(xe(a)){const Q=Object.keys(a)[0],Y=a[Q];_=v(this.chart.scales[Q].getPixelForValue(Y))}A=e.top,X=e.bottom,T=_+x,P=T+f}else if(s==="y"){if(a==="center")_=v((e.left+e.right)/2);else if(xe(a)){const Q=Object.keys(a)[0],Y=a[Q];_=v(this.chart.scales[Q].getPixelForValue(Y))}k=_-x,M=k-f,O=e.left,F=e.right}const H=re(i.ticks.maxTicksLimit,h),Z=Math.max(1,Math.ceil(h/H));for(S=0;S<h;S+=Z){const Q=this.getContext(S),Y=r.setContext(Q),oe=o.setContext(Q),ue=Y.lineWidth,Se=Y.color,We=oe.dash||[],$=oe.dashOffset,ee=Y.tickWidth,D=Y.tickColor,R=Y.tickBorderDash||[],B=Y.tickBorderDashOffset;N=Ww(this,S,c),N!==void 0&&(j=on(n,N,ue),d?k=M=O=F=j:T=P=A=X=j,m.push({tx1:k,ty1:T,tx2:M,ty2:P,x1:O,y1:A,x2:F,y2:X,width:ue,color:Se,borderDash:We,borderDashOffset:$,tickWidth:ee,tickColor:D,tickBorderDash:R,tickBorderDashOffset:B}))}return this._ticksLength=h,this._borderValue=_,m}_computeLabelItems(e){const s=this.axis,n=this.options,{position:i,ticks:r}=n,a=this.isHorizontal(),o=this.ticks,{align:c,crossAlign:d,padding:u,mirror:h}=r,f=Ni(n.grid),m=f+u,p=h?-u:m,g=-Lt(this.labelRotation),x=[];let v,_,S,N,j,k,T,M,P,O,A,F,X="middle";if(i==="top")k=this.bottom-p,T=this._getXAxisLabelAlignment();else if(i==="bottom")k=this.top+p,T=this._getXAxisLabelAlignment();else if(i==="left"){const Z=this._getYAxisLabelAlignment(f);T=Z.textAlign,j=Z.x}else if(i==="right"){const Z=this._getYAxisLabelAlignment(f);T=Z.textAlign,j=Z.x}else if(s==="x"){if(i==="center")k=(e.top+e.bottom)/2+m;else if(xe(i)){const Z=Object.keys(i)[0],Q=i[Z];k=this.chart.scales[Z].getPixelForValue(Q)+m}T=this._getXAxisLabelAlignment()}else if(s==="y"){if(i==="center")j=(e.left+e.right)/2-m;else if(xe(i)){const Z=Object.keys(i)[0],Q=i[Z];j=this.chart.scales[Z].getPixelForValue(Q)}T=this._getYAxisLabelAlignment(f).textAlign}s==="y"&&(c==="start"?X="top":c==="end"&&(X="bottom"));const H=this._getLabelSizes();for(v=0,_=o.length;v<_;++v){S=o[v],N=S.label;const Z=r.setContext(this.getContext(v));M=this.getPixelForTick(v)+r.labelOffset,P=this._resolveTickFontOptions(v),O=P.lineHeight,A=Oe(N)?N.length:1;const Q=A/2,Y=Z.color,oe=Z.textStrokeColor,ue=Z.textStrokeWidth;let Se=T;a?(j=M,T==="inner"&&(v===_-1?Se=this.options.reverse?"left":"right":v===0?Se=this.options.reverse?"right":"left":Se="center"),i==="top"?d==="near"||g!==0?F=-A*O+O/2:d==="center"?F=-H.highest.height/2-Q*O+O:F=-H.highest.height+O/2:d==="near"||g!==0?F=O/2:d==="center"?F=H.highest.height/2-Q*O:F=H.highest.height-A*O,h&&(F*=-1),g!==0&&!Z.showLabelBackdrop&&(j+=O/2*Math.sin(g))):(k=M,F=(1-A)*O/2);let We;if(Z.showLabelBackdrop){const $=ct(Z.backdropPadding),ee=H.heights[v],D=H.widths[v];let R=F-$.top,B=0-$.left;switch(X){case"middle":R-=ee/2;break;case"bottom":R-=ee;break}switch(T){case"center":B-=D/2;break;case"right":B-=D;break;case"inner":v===_-1?B-=D:v>0&&(B-=D/2);break}We={left:B,top:R,width:D+$.width,height:ee+$.height,color:Z.backdropColor}}x.push({label:N,font:P,textOffset:F,options:{rotation:g,color:Y,strokeColor:oe,strokeWidth:ue,textAlign:Se,textBaseline:X,translation:[j,k],backdrop:We}})}return x}_getXAxisLabelAlignment(){const{position:e,ticks:s}=this.options;if(-Lt(this.labelRotation))return e==="top"?"left":"right";let i="center";return s.align==="start"?i="left":s.align==="end"?i="right":s.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(e){const{position:s,ticks:{crossAlign:n,mirror:i,padding:r}}=this.options,a=this._getLabelSizes(),o=e+r,c=a.widest.width;let d,u;return s==="left"?i?(u=this.right+r,n==="near"?d="left":n==="center"?(d="center",u+=c/2):(d="right",u+=c)):(u=this.right-o,n==="near"?d="right":n==="center"?(d="center",u-=c/2):(d="left",u=this.left)):s==="right"?i?(u=this.left+r,n==="near"?d="right":n==="center"?(d="center",u-=c/2):(d="left",u-=c)):(u=this.left+o,n==="near"?d="left":n==="center"?(d="center",u+=c/2):(d="right",u=this.right)):d="right",{textAlign:d,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,s=this.options.position;if(s==="left"||s==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(s==="top"||s==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:s},left:n,top:i,width:r,height:a}=this;s&&(e.save(),e.fillStyle=s,e.fillRect(n,i,r,a),e.restore())}getLineWidthForValue(e){const s=this.options.grid;if(!this._isVisible()||!s.display)return 0;const i=this.ticks.findIndex(r=>r.value===e);return i>=0?s.setContext(this.getContext(i)).lineWidth:0}drawGrid(e){const s=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let r,a;const o=(c,d,u)=>{!u.width||!u.color||(n.save(),n.lineWidth=u.width,n.strokeStyle=u.color,n.setLineDash(u.borderDash||[]),n.lineDashOffset=u.borderDashOffset,n.beginPath(),n.moveTo(c.x,c.y),n.lineTo(d.x,d.y),n.stroke(),n.restore())};if(s.display)for(r=0,a=i.length;r<a;++r){const c=i[r];s.drawOnChartArea&&o({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),s.drawTicks&&o({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:s,options:{border:n,grid:i}}=this,r=n.setContext(this.getContext()),a=n.display?r.width:0;if(!a)return;const o=i.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let d,u,h,f;this.isHorizontal()?(d=on(e,this.left,a)-a/2,u=on(e,this.right,o)+o/2,h=f=c):(h=on(e,this.top,a)-a/2,f=on(e,this.bottom,o)+o/2,d=u=c),s.save(),s.lineWidth=r.width,s.strokeStyle=r.color,s.beginPath(),s.moveTo(d,h),s.lineTo(u,f),s.stroke(),s.restore()}drawLabels(e){if(!this.options.ticks.display)return;const n=this.ctx,i=this._computeLabelArea();i&&xo(n,i);const r=this.getLabelItems(e);for(const a of r){const o=a.options,c=a.font,d=a.label,u=a.textOffset;Sn(n,d,0,u,c,o)}i&&yo(n)}drawTitle(){const{ctx:e,options:{position:s,title:n,reverse:i}}=this;if(!n.display)return;const r=Xe(n.font),a=ct(n.padding),o=n.align;let c=r.lineHeight/2;s==="bottom"||s==="center"||xe(s)?(c+=a.bottom,Oe(n.text)&&(c+=r.lineHeight*(n.text.length-1))):c+=a.top;const{titleX:d,titleY:u,maxWidth:h,rotation:f}=Yw(this,c,s,o);Sn(e,n.text,0,0,r,{color:n.color,maxWidth:h,rotation:f,textAlign:$w(o,s,i),textBaseline:"middle",translation:[d,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,s=e.ticks&&e.ticks.z||0,n=re(e.grid&&e.grid.z,-1),i=re(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Tn.prototype.draw?[{z:s,draw:r=>{this.draw(r)}}]:[{z:n,draw:r=>{this.drawBackground(),this.drawGrid(r),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:s,draw:r=>{this.drawLabels(r)}}]}getMatchingVisibleMetas(e){const s=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let r,a;for(r=0,a=s.length;r<a;++r){const o=s[r];o[n]===this.id&&(!e||o.type===e)&&i.push(o)}return i}_resolveTickFontOptions(e){const s=this.options.ticks.setContext(this.getContext(e));return Xe(s.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class sa{constructor(e,s,n){this.type=e,this.scope=s,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const s=Object.getPrototypeOf(e);let n;qw(s)&&(n=this.register(s));const i=this.items,r=e.id,a=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+e);return r in i||(i[r]=e,Uw(e,a,n),this.override&&Re.override(e.id,e.overrides)),a}get(e){return this.items[e]}unregister(e){const s=this.items,n=e.id,i=this.scope;n in s&&delete s[n],i&&n in Re[i]&&(delete Re[i][n],this.override&&delete kn[n])}}function Uw(t,e,s){const n=or(Object.create(null),[s?Re.get(s):{},Re.get(e),t.defaults]);Re.set(e,n),t.defaultRoutes&&Gw(e,t.defaultRoutes),t.descriptors&&Re.describe(e,t.descriptors)}function Gw(t,e){Object.keys(e).forEach(s=>{const n=s.split("."),i=n.pop(),r=[t].concat(n).join("."),a=e[s].split("."),o=a.pop(),c=a.join(".");Re.route(r,i,c,o)})}function qw(t){return"id"in t&&"defaults"in t}class Kw{constructor(){this.controllers=new sa(Zs,"datasets",!0),this.elements=new sa(js,"elements"),this.plugins=new sa(Object,"plugins"),this.scales=new sa(Tn,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,s,n){[...s].forEach(i=>{const r=n||this._getRegistryForType(i);n||r.isForType(i)||r===this.plugins&&i.id?this._exec(e,r,i):pe(i,a=>{const o=n||this._getRegistryForType(a);this._exec(e,o,a)})})}_exec(e,s,n){const i=td(e);ie(n["before"+i],[],n),s[e](n),ie(n["after"+i],[],n)}_getRegistryForType(e){for(let s=0;s<this._typedRegistries.length;s++){const n=this._typedRegistries[s];if(n.isForType(e))return n}return this.plugins}_get(e,s,n){const i=s.get(e);if(i===void 0)throw new Error('"'+e+'" is not a registered '+n+".");return i}}var Gt=new Kw;class Xw{constructor(){this._init=void 0}notify(e,s,n,i){if(s==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const r=i?this._descriptors(e).filter(i):this._descriptors(e),a=this._notify(r,e,s,n);return s==="afterDestroy"&&(this._notify(r,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),a}_notify(e,s,n,i){i=i||{};for(const r of e){const a=r.plugin,o=a[n],c=[s,i,r.options];if(ie(o,c,a)===!1&&i.cancelable)return!1}return!0}invalidate(){ge(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const s=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),s}_createDescriptors(e,s){const n=e&&e.config,i=re(n.options&&n.options.plugins,{}),r=Zw(n);return i===!1&&!s?[]:Qw(e,r,i,s)}_notifyStateChanges(e){const s=this._oldCache||[],n=this._cache,i=(r,a)=>r.filter(o=>!a.some(c=>o.plugin.id===c.plugin.id));this._notify(i(s,n),e,"stop"),this._notify(i(n,s),e,"start")}}function Zw(t){const e={},s=[],n=Object.keys(Gt.plugins.items);for(let r=0;r<n.length;r++)s.push(Gt.getPlugin(n[r]));const i=t.plugins||[];for(let r=0;r<i.length;r++){const a=i[r];s.indexOf(a)===-1&&(s.push(a),e[a.id]=!0)}return{plugins:s,localIds:e}}function Jw(t,e){return!e&&t===!1?null:t===!0?{}:t}function Qw(t,{plugins:e,localIds:s},n,i){const r=[],a=t.getContext();for(const o of e){const c=o.id,d=Jw(n[c],i);d!==null&&r.push({plugin:o,options:ek(t.config,{plugin:o,local:s[c]},d,a)})}return r}function ek(t,{plugin:e,local:s},n,i){const r=t.pluginScopeKeys(e),a=t.getOptionScopes(n,r);return s&&e.defaults&&a.push(e.defaults),t.createResolver(a,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function oc(t,e){const s=Re.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||s.indexAxis||"x"}function tk(t,e){let s=t;return t==="_index_"?s=e:t==="_value_"&&(s=e==="x"?"y":"x"),s}function sk(t,e){return t===e?"_index_":"_value_"}function Hh(t){if(t==="x"||t==="y"||t==="r")return t}function nk(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function lc(t,...e){if(Hh(t))return t;for(const s of e){const n=s.axis||nk(s.position)||t.length>1&&Hh(t[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function $h(t,e,s){if(s[e+"AxisID"]===t)return{axis:e}}function ik(t,e){if(e.data&&e.data.datasets){const s=e.data.datasets.filter(n=>n.xAxisID===t||n.yAxisID===t);if(s.length)return $h(t,"x",s[0])||$h(t,"y",s[0])}return{}}function rk(t,e){const s=kn[t.type]||{scales:{}},n=e.scales||{},i=oc(t.type,e),r=Object.create(null);return Object.keys(n).forEach(a=>{const o=n[a];if(!xe(o))return console.error(`Invalid scale configuration for scale: ${a}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${a}`);const c=lc(a,o,ik(a,t),Re.scales[o.type]),d=sk(c,i),u=s.scales||{};r[a]=Gi(Object.create(null),[{axis:c},o,u[c],u[d]])}),t.data.datasets.forEach(a=>{const o=a.type||t.type,c=a.indexAxis||oc(o,e),u=(kn[o]||{}).scales||{};Object.keys(u).forEach(h=>{const f=tk(h,c),m=a[f+"AxisID"]||f;r[m]=r[m]||Object.create(null),Gi(r[m],[{axis:f},n[m],u[h]])})}),Object.keys(r).forEach(a=>{const o=r[a];Gi(o,[Re.scales[o.type],Re.scale])}),r}function Dg(t){const e=t.options||(t.options={});e.plugins=re(e.plugins,{}),e.scales=rk(t,e)}function Eg(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function ak(t){return t=t||{},t.data=Eg(t.data),Dg(t),t}const Yh=new Map,Ag=new Set;function na(t,e){let s=Yh.get(t);return s||(s=e(),Yh.set(t,s),Ag.add(s)),s}const Ti=(t,e,s)=>{const n=$s(e,s);n!==void 0&&t.add(n)};class ok{constructor(e){this._config=ak(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Eg(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Dg(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return na(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,s){return na(`${e}.transition.${s}`,()=>[[`datasets.${e}.transitions.${s}`,`transitions.${s}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,s){return na(`${e}-${s}`,()=>[[`datasets.${e}.elements.${s}`,`datasets.${e}`,`elements.${s}`,""]])}pluginScopeKeys(e){const s=e.id,n=this.type;return na(`${n}-plugin-${s}`,()=>[[`plugins.${s}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,s){const n=this._scopeCache;let i=n.get(e);return(!i||s)&&(i=new Map,n.set(e,i)),i}getOptionScopes(e,s,n){const{options:i,type:r}=this,a=this._cachedScopes(e,n),o=a.get(s);if(o)return o;const c=new Set;s.forEach(u=>{e&&(c.add(e),u.forEach(h=>Ti(c,e,h))),u.forEach(h=>Ti(c,i,h)),u.forEach(h=>Ti(c,kn[r]||{},h)),u.forEach(h=>Ti(c,Re,h)),u.forEach(h=>Ti(c,rc,h))});const d=Array.from(c);return d.length===0&&d.push(Object.create(null)),Ag.has(s)&&a.set(s,d),d}chartOptionScopes(){const{options:e,type:s}=this;return[e,kn[s]||{},Re.datasets[s]||{},{type:s},Re,rc]}resolveNamedOptions(e,s,n,i=[""]){const r={$shared:!0},{resolver:a,subPrefixes:o}=Uh(this._resolverCache,e,i);let c=a;if(ck(a,s)){r.$shared=!1,n=Ys(n)?n():n;const d=this.createResolver(e,n,o);c=Jn(a,n,d)}for(const d of s)r[d]=c[d];return r}createResolver(e,s,n=[""],i){const{resolver:r}=Uh(this._resolverCache,e,n);return xe(s)?Jn(r,s,void 0,i):r}}function Uh(t,e,s){let n=t.get(e);n||(n=new Map,t.set(e,n));const i=s.join();let r=n.get(i);return r||(r={resolver:od(e,s),subPrefixes:s.filter(o=>!o.toLowerCase().includes("hover"))},n.set(i,r)),r}const lk=t=>xe(t)&&Object.getOwnPropertyNames(t).some(e=>Ys(t[e]));function ck(t,e){const{isScriptable:s,isIndexable:n}=ag(t);for(const i of e){const r=s(i),a=n(i),o=(a||r)&&t[i];if(r&&(Ys(o)||lk(o))||a&&Oe(o))return!0}return!1}var dk="4.5.1";const uk=["top","bottom","left","right","chartArea"];function Gh(t,e){return t==="top"||t==="bottom"||uk.indexOf(t)===-1&&e==="x"}function qh(t,e){return function(s,n){return s[t]===n[t]?s[e]-n[e]:s[t]-n[t]}}function Kh(t){const e=t.chart,s=e.options.animation;e.notifyPlugins("afterRender"),ie(s&&s.onComplete,[t],e)}function hk(t){const e=t.chart,s=e.options.animation;ie(s&&s.onProgress,[t],e)}function Og(t){return dd()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const wa={},Xh=t=>{const e=Og(t);return Object.values(wa).filter(s=>s.canvas===e).pop()};function fk(t,e,s){const n=Object.keys(t);for(const i of n){const r=+i;if(r>=e){const a=t[i];delete t[i],(s>0||r>e)&&(t[r+s]=a)}}}function mk(t,e,s,n){return!s||t.type==="mouseout"?null:n?e:t}let Ct=class{static defaults=Re;static instances=wa;static overrides=kn;static registry=Gt;static version=dk;static getChart=Xh;static register(...e){Gt.add(...e),Zh()}static unregister(...e){Gt.remove(...e),Zh()}constructor(e,s){const n=this.config=new ok(s),i=Og(e),r=Xh(i);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const a=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||Ew(i)),this.platform.updateConfig(n);const o=this.platform.acquireContext(i,a.aspectRatio),c=o&&o.canvas,d=c&&c.height,u=c&&c.width;if(this.id=f_(),this.ctx=o,this.canvas=c,this.width=u,this.height=d,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Xw,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=P_(h=>this.update(h),a.resizeDelay||0),this._dataChanges=[],wa[this.id]=this,!o||!c){console.error("Failed to create chart: can't acquire context from the given item");return}us.listen(this,"complete",Kh),us.listen(this,"progress",hk),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:s},width:n,height:i,_aspectRatio:r}=this;return ge(e)?s&&r?r:i?n/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Gt}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():bh(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return gh(this.canvas,this.ctx),this}stop(){return us.stop(this),this}resize(e,s){us.running(this)?this._resizeBeforeDraw={width:e,height:s}:this._resize(e,s)}_resize(e,s){const n=this.options,i=this.canvas,r=n.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(i,e,s,r),o=n.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,bh(this,o,!0)&&(this.notifyPlugins("resize",{size:a}),ie(n.onResize,[this,a],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const s=this.options.scales||{};pe(s,(n,i)=>{n.id=i})}buildOrUpdateScales(){const e=this.options,s=e.scales,n=this.scales,i=Object.keys(n).reduce((a,o)=>(a[o]=!1,a),{});let r=[];s&&(r=r.concat(Object.keys(s).map(a=>{const o=s[a],c=lc(a,o),d=c==="r",u=c==="x";return{options:o,dposition:d?"chartArea":u?"bottom":"left",dtype:d?"radialLinear":u?"category":"linear"}}))),pe(r,a=>{const o=a.options,c=o.id,d=lc(c,o),u=re(o.type,a.dtype);(o.position===void 0||Gh(o.position,d)!==Gh(a.dposition))&&(o.position=a.dposition),i[c]=!0;let h=null;if(c in n&&n[c].type===u)h=n[c];else{const f=Gt.getScale(u);h=new f({id:c,type:u,ctx:this.ctx,chart:this}),n[h.id]=h}h.init(o,e)}),pe(i,(a,o)=>{a||delete n[o]}),pe(n,a=>{at.configure(this,a,a.options),at.addBox(this,a)})}_updateMetasets(){const e=this._metasets,s=this.data.datasets.length,n=e.length;if(e.sort((i,r)=>i.index-r.index),n>s){for(let i=s;i<n;++i)this._destroyDatasetMeta(i);e.splice(s,n-s)}this._sortedMetasets=e.slice(0).sort(qh("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:s}}=this;e.length>s.length&&delete this._stacks,e.forEach((n,i)=>{s.filter(r=>r===n._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const e=[],s=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=s.length;n<i;n++){const r=s[n];let a=this.getDatasetMeta(n);const o=r.type||this.config.type;if(a.type&&a.type!==o&&(this._destroyDatasetMeta(n),a=this.getDatasetMeta(n)),a.type=o,a.indexAxis=r.indexAxis||oc(o,this.options),a.order=r.order||0,a.index=n,a.label=""+r.label,a.visible=this.isDatasetVisible(n),a.controller)a.controller.updateIndex(n),a.controller.linkScales();else{const c=Gt.getController(o),{datasetElementType:d,dataElementType:u}=Re.datasets[o];Object.assign(c,{dataElementType:Gt.getElement(u),datasetElementType:d&&Gt.getElement(d)}),a.controller=new c(this,n),e.push(a.controller)}}return this._updateMetasets(),e}_resetElements(){pe(this.data.datasets,(e,s)=>{this.getDatasetMeta(s).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const s=this.config;s.update();const n=this._options=s.createResolver(s.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let d=0,u=this.data.datasets.length;d<u;d++){const{controller:h}=this.getDatasetMeta(d),f=!i&&r.indexOf(h)===-1;h.buildOrUpdateElements(f),a=Math.max(+h.getMaxOverflow(),a)}a=this._minPadding=n.layout.autoPadding?a:0,this._updateLayout(a),i||pe(r,d=>{d.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(qh("z","_idx"));const{_active:o,_lastEvent:c}=this;c?this._eventHandler(c,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){pe(this.scales,e=>{at.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,s=new Set(Object.keys(this._listeners)),n=new Set(e.events);(!oh(s,n)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,s=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:r}of s){const a=n==="_removeElements"?-r:r;fk(e,i,a)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const s=this.data.datasets.length,n=r=>new Set(e.filter(a=>a[0]===r).map((a,o)=>o+","+a.splice(1).join(","))),i=n(0);for(let r=1;r<s;r++)if(!oh(i,n(r)))return;return Array.from(i).map(r=>r.split(",")).map(r=>({method:r[1],start:+r[2],count:+r[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;at.update(this,this.width,this.height,e);const s=this.chartArea,n=s.width<=0||s.height<=0;this._layers=[],pe(this.boxes,i=>{n&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,r)=>{i._idx=r}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let s=0,n=this.data.datasets.length;s<n;++s)this.getDatasetMeta(s).controller.configure();for(let s=0,n=this.data.datasets.length;s<n;++s)this._updateDataset(s,Ys(e)?e({datasetIndex:s}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,s){const n=this.getDatasetMeta(e),i={meta:n,index:e,mode:s,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(n.controller._update(s),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(us.has(this)?this.attached&&!us.running(this)&&us.start(this):(this.draw(),Kh({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:n,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const s=this._layers;for(e=0;e<s.length&&s[e].z<=0;++e)s[e].draw(this.chartArea);for(this._drawDatasets();e<s.length;++e)s[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const s=this._sortedMetasets,n=[];let i,r;for(i=0,r=s.length;i<r;++i){const a=s[i];(!e||a.visible)&&n.push(a)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let s=e.length-1;s>=0;--s)this._drawDataset(e[s]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const s=this.ctx,n={meta:e,index:e.index,cancelable:!0},i=xg(this,e);this.notifyPlugins("beforeDatasetDraw",n)!==!1&&(i&&xo(s,i),e.controller.draw(),i&&yo(s),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(e){return Xt(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,s,n,i){const r=uw.modes[s];return typeof r=="function"?r(this,e,n,i):[]}getDatasetMeta(e){const s=this.data.datasets[e],n=this._metasets;let i=n.filter(r=>r&&r._dataset===s).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:s&&s.order||0,index:e,_dataset:s,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=Xs(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const s=this.data.datasets[e];if(!s)return!1;const n=this.getDatasetMeta(e);return typeof n.hidden=="boolean"?!n.hidden:!s.hidden}setDatasetVisibility(e,s){const n=this.getDatasetMeta(e);n.hidden=!s}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,s,n){const i=n?"show":"hide",r=this.getDatasetMeta(e),a=r.controller._resolveAnimations(void 0,i);lr(s)?(r.data[s].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),a.update(r,{visible:n}),this.update(o=>o.datasetIndex===e?i:void 0))}hide(e,s){this._updateVisibility(e,s,!1)}show(e,s){this._updateVisibility(e,s,!0)}_destroyDatasetMeta(e){const s=this._metasets[e];s&&s.controller&&s.controller._destroy(),delete this._metasets[e]}_stop(){let e,s;for(this.stop(),us.remove(this),e=0,s=this.data.datasets.length;e<s;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:s}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),gh(e,s),this.platform.releaseContext(s),this.canvas=null,this.ctx=null),delete wa[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,s=this.platform,n=(r,a)=>{s.addEventListener(this,r,a),e[r]=a},i=(r,a,o)=>{r.offsetX=a,r.offsetY=o,this._eventHandler(r)};pe(this.options.events,r=>n(r,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,s=this.platform,n=(c,d)=>{s.addEventListener(this,c,d),e[c]=d},i=(c,d)=>{e[c]&&(s.removeEventListener(this,c,d),delete e[c])},r=(c,d)=>{this.canvas&&this.resize(c,d)};let a;const o=()=>{i("attach",o),this.attached=!0,this.resize(),n("resize",r),n("detach",a)};a=()=>{this.attached=!1,i("resize",r),this._stop(),this._resize(0,0),n("attach",o)},s.isAttached(this.canvas)?o():a()}unbindEvents(){pe(this._listeners,(e,s)=>{this.platform.removeEventListener(this,s,e)}),this._listeners={},pe(this._responsiveListeners,(e,s)=>{this.platform.removeEventListener(this,s,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,s,n){const i=n?"set":"remove";let r,a,o,c;for(s==="dataset"&&(r=this.getDatasetMeta(e[0].datasetIndex),r.controller["_"+i+"DatasetHoverStyle"]()),o=0,c=e.length;o<c;++o){a=e[o];const d=a&&this.getDatasetMeta(a.datasetIndex).controller;d&&d[i+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const s=this._active||[],n=e.map(({datasetIndex:r,index:a})=>{const o=this.getDatasetMeta(r);if(!o)throw new Error("No dataset found at index "+r);return{datasetIndex:r,element:o.data[a],index:a}});!Ia(n,s)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,s))}notifyPlugins(e,s,n){return this._plugins.notify(this,e,s,n)}isPluginEnabled(e){return this._plugins._cache.filter(s=>s.plugin.id===e).length===1}_updateHoverStyles(e,s,n){const i=this.options.hover,r=(c,d)=>c.filter(u=>!d.some(h=>u.datasetIndex===h.datasetIndex&&u.index===h.index)),a=r(s,e),o=n?e:r(e,s);a.length&&this.updateHoverStyle(a,i.mode,!1),o.length&&i.mode&&this.updateHoverStyle(o,i.mode,!0)}_eventHandler(e,s){const n={event:e,replay:s,cancelable:!0,inChartArea:this.isPointInArea(e)},i=a=>(a.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",n,i)===!1)return;const r=this._handleEvent(e,s,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(r||n.changed)&&this.render(),this}_handleEvent(e,s,n){const{_active:i=[],options:r}=this,a=s,o=this._getActiveElements(e,i,n,a),c=b_(e),d=mk(e,this._lastEvent,n,c);n&&(this._lastEvent=null,ie(r.onHover,[e,o,this],this),c&&ie(r.onClick,[e,o,this],this));const u=!Ia(o,i);return(u||s)&&(this._active=o,this._updateHoverStyles(o,i,s)),this._lastEvent=d,u}_getActiveElements(e,s,n,i){if(e.type==="mouseout")return[];if(!n)return s;const r=this.options.hover;return this.getElementsAtEventForMode(e,r.mode,r,i)}};function Zh(){return pe(Ct.instances,t=>t._plugins.invalidate())}function pk(t,e,s){const{startAngle:n,x:i,y:r,outerRadius:a,innerRadius:o,options:c}=e,{borderWidth:d,borderJoinStyle:u}=c,h=Math.min(d/a,rt(n-s));if(t.beginPath(),t.arc(i,r,a-d/2,n+h/2,s-h/2),o>0){const f=Math.min(d/o,rt(n-s));t.arc(i,r,o+d/2,s-f/2,n+f/2,!0)}else{const f=Math.min(d/2,a*rt(n-s));if(u==="round")t.arc(i,r,f,s-ve/2,n+ve/2,!0);else if(u==="bevel"){const m=2*f*f,p=-m*Math.cos(s+ve/2)+i,g=-m*Math.sin(s+ve/2)+r,x=m*Math.cos(n+ve/2)+i,v=m*Math.sin(n+ve/2)+r;t.lineTo(p,g),t.lineTo(x,v)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function gk(t,e,s){const{startAngle:n,pixelMargin:i,x:r,y:a,outerRadius:o,innerRadius:c}=e;let d=i/o;t.beginPath(),t.arc(r,a,o,n-d,s+d),c>i?(d=i/c,t.arc(r,a,c,s+d,n-d,!0)):t.arc(r,a,i,s+qe,n-qe),t.closePath(),t.clip()}function xk(t){return ad(t,["outerStart","outerEnd","innerStart","innerEnd"])}function yk(t,e,s,n){const i=xk(t.options.borderRadius),r=(s-e)/2,a=Math.min(r,n*e/2),o=c=>{const d=(s-Math.min(r,c))*n/2;return et(c,0,Math.min(r,d))};return{outerStart:o(i.outerStart),outerEnd:o(i.outerEnd),innerStart:et(i.innerStart,0,a),innerEnd:et(i.innerEnd,0,a)}}function On(t,e,s,n){return{x:s+t*Math.cos(e),y:n+t*Math.sin(e)}}function $a(t,e,s,n,i,r){const{x:a,y:o,startAngle:c,pixelMargin:d,innerRadius:u}=e,h=Math.max(e.outerRadius+n+s-d,0),f=u>0?u+n+s+d:0;let m=0;const p=i-c;if(n){const Z=u>0?u-n:0,Q=h>0?h-n:0,Y=(Z+Q)/2,oe=Y!==0?p*Y/(Y+n):p;m=(p-oe)/2}const g=Math.max(.001,p*h-s/ve)/h,x=(p-g)/2,v=c+x+m,_=i-x-m,{outerStart:S,outerEnd:N,innerStart:j,innerEnd:k}=yk(e,f,h,_-v),T=h-S,M=h-N,P=v+S/T,O=_-N/M,A=f+j,F=f+k,X=v+j/A,H=_-k/F;if(t.beginPath(),r){const Z=(P+O)/2;if(t.arc(a,o,h,P,Z),t.arc(a,o,h,Z,O),N>0){const ue=On(M,O,a,o);t.arc(ue.x,ue.y,N,O,_+qe)}const Q=On(F,_,a,o);if(t.lineTo(Q.x,Q.y),k>0){const ue=On(F,H,a,o);t.arc(ue.x,ue.y,k,_+qe,H+Math.PI)}const Y=(_-k/f+(v+j/f))/2;if(t.arc(a,o,f,_-k/f,Y,!0),t.arc(a,o,f,Y,v+j/f,!0),j>0){const ue=On(A,X,a,o);t.arc(ue.x,ue.y,j,X+Math.PI,v-qe)}const oe=On(T,v,a,o);if(t.lineTo(oe.x,oe.y),S>0){const ue=On(T,P,a,o);t.arc(ue.x,ue.y,S,v-qe,P)}}else{t.moveTo(a,o);const Z=Math.cos(P)*h+a,Q=Math.sin(P)*h+o;t.lineTo(Z,Q);const Y=Math.cos(O)*h+a,oe=Math.sin(O)*h+o;t.lineTo(Y,oe)}t.closePath()}function bk(t,e,s,n,i){const{fullCircles:r,startAngle:a,circumference:o}=e;let c=e.endAngle;if(r){$a(t,e,s,n,c,i);for(let d=0;d<r;++d)t.fill();isNaN(o)||(c=a+(o%Me||Me))}return $a(t,e,s,n,c,i),t.fill(),c}function vk(t,e,s,n,i){const{fullCircles:r,startAngle:a,circumference:o,options:c}=e,{borderWidth:d,borderJoinStyle:u,borderDash:h,borderDashOffset:f,borderRadius:m}=c,p=c.borderAlign==="inner";if(!d)return;t.setLineDash(h||[]),t.lineDashOffset=f,p?(t.lineWidth=d*2,t.lineJoin=u||"round"):(t.lineWidth=d,t.lineJoin=u||"bevel");let g=e.endAngle;if(r){$a(t,e,s,n,g,i);for(let x=0;x<r;++x)t.stroke();isNaN(o)||(g=a+(o%Me||Me))}p&&gk(t,e,g),c.selfJoin&&g-a>=ve&&m===0&&u!=="miter"&&pk(t,e,g),r||($a(t,e,s,n,g,i),t.stroke())}class _k extends js{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,s,n){const i=this.getProps(["x","y"],n),{angle:r,distance:a}=Xp(i,{x:e,y:s}),{startAngle:o,endAngle:c,innerRadius:d,outerRadius:u,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),f=(this.options.spacing+this.options.borderWidth)/2,m=re(h,c-o),p=cr(r,o,c)&&o!==c,g=m>=Me||p,x=ps(a,d+f,u+f);return g&&x}getCenterPoint(e){const{x:s,y:n,startAngle:i,endAngle:r,innerRadius:a,outerRadius:o}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:c,spacing:d}=this.options,u=(i+r)/2,h=(a+o+d+c)/2;return{x:s+Math.cos(u)*h,y:n+Math.sin(u)*h}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:s,circumference:n}=this,i=(s.offset||0)/4,r=(s.spacing||0)/2,a=s.circular;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=n>Me?Math.floor(n/Me):0,n===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const o=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(o)*i,Math.sin(o)*i);const c=1-Math.sin(Math.min(ve,n||0)),d=i*c;e.fillStyle=s.backgroundColor,e.strokeStyle=s.borderColor,bk(e,this,d,r,a),vk(e,this,d,r,a),e.restore()}}function Rg(t,e,s=e){t.lineCap=re(s.borderCapStyle,e.borderCapStyle),t.setLineDash(re(s.borderDash,e.borderDash)),t.lineDashOffset=re(s.borderDashOffset,e.borderDashOffset),t.lineJoin=re(s.borderJoinStyle,e.borderJoinStyle),t.lineWidth=re(s.borderWidth,e.borderWidth),t.strokeStyle=re(s.borderColor,e.borderColor)}function wk(t,e,s){t.lineTo(s.x,s.y)}function kk(t){return t.stepped?z_:t.tension||t.cubicInterpolationMode==="monotone"?H_:wk}function Lg(t,e,s={}){const n=t.length,{start:i=0,end:r=n-1}=s,{start:a,end:o}=e,c=Math.max(i,a),d=Math.min(r,o),u=i<a&&r<a||i>o&&r>o;return{count:n,start:c,loop:e.loop,ilen:d<c&&!u?n+d-c:d-c}}function Sk(t,e,s,n){const{points:i,options:r}=e,{count:a,start:o,loop:c,ilen:d}=Lg(i,s,n),u=kk(r);let{move:h=!0,reverse:f}=n||{},m,p,g;for(m=0;m<=d;++m)p=i[(o+(f?d-m:m))%a],!p.skip&&(h?(t.moveTo(p.x,p.y),h=!1):u(t,g,p,f,r.stepped),g=p);return c&&(p=i[(o+(f?d:0))%a],u(t,g,p,f,r.stepped)),!!c}function jk(t,e,s,n){const i=e.points,{count:r,start:a,ilen:o}=Lg(i,s,n),{move:c=!0,reverse:d}=n||{};let u=0,h=0,f,m,p,g,x,v;const _=N=>(a+(d?o-N:N))%r,S=()=>{g!==x&&(t.lineTo(u,x),t.lineTo(u,g),t.lineTo(u,v))};for(c&&(m=i[_(0)],t.moveTo(m.x,m.y)),f=0;f<=o;++f){if(m=i[_(f)],m.skip)continue;const N=m.x,j=m.y,k=N|0;k===p?(j<g?g=j:j>x&&(x=j),u=(h*u+N)/++h):(S(),t.lineTo(N,j),p=k,h=0,g=x=j),v=j}S()}function cc(t){const e=t.options,s=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!s?jk:Sk}function Nk(t){return t.stepped?_1:t.tension||t.cubicInterpolationMode==="monotone"?w1:fn}function Tk(t,e,s,n){let i=e._path;i||(i=e._path=new Path2D,e.path(i,s,n)&&i.closePath()),Rg(t,e.options),t.stroke(i)}function Mk(t,e,s,n){const{segments:i,options:r}=e,a=cc(e);for(const o of i)Rg(t,r,o.style),t.beginPath(),a(t,e,o,{start:s,end:s+n-1})&&t.closePath(),t.stroke()}const Ck=typeof Path2D=="function";function Pk(t,e,s,n){Ck&&!e.options.segment?Tk(t,e,s,n):Mk(t,e,s,n)}class Ns extends js{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,s){const n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){const i=n.spanGaps?this._loop:this._fullLoop;f1(this._points,n,e,i,s),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=M1(this,this.options.segment))}first(){const e=this.segments,s=this.points;return e.length&&s[e[0].start]}last(){const e=this.segments,s=this.points,n=e.length;return n&&s[e[n-1].end]}interpolate(e,s){const n=this.options,i=e[s],r=this.points,a=gg(this,{property:s,start:i,end:i});if(!a.length)return;const o=[],c=Nk(n);let d,u;for(d=0,u=a.length;d<u;++d){const{start:h,end:f}=a[d],m=r[h],p=r[f];if(m===p){o.push(m);continue}const g=Math.abs((i-m[s])/(p[s]-m[s])),x=c(m,p,g,n.stepped);x[s]=e[s],o.push(x)}return o.length===1?o[0]:o}pathSegment(e,s,n){return cc(this)(e,this,s,n)}path(e,s,n){const i=this.segments,r=cc(this);let a=this._loop;s=s||0,n=n||this.points.length-s;for(const o of i)a&=r(e,this,o,{start:s,end:s+n-1});return!!a}draw(e,s,n,i){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(e.save(),Pk(e,this,n,i),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function Jh(t,e,s,n){const i=t.options,{[s]:r}=t.getProps([s],n);return Math.abs(e-r)<i.radius+i.hitRadius}class ri extends js{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,s,n){const i=this.options,{x:r,y:a}=this.getProps(["x","y"],n);return Math.pow(e-r,2)+Math.pow(s-a,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(e,s){return Jh(this,e,"x",s)}inYRange(e,s){return Jh(this,e,"y",s)}getCenterPoint(e){const{x:s,y:n}=this.getProps(["x","y"],e);return{x:s,y:n}}size(e){e=e||this.options||{};let s=e.radius||0;s=Math.max(s,s&&e.hoverRadius||0);const n=s&&e.borderWidth||0;return(s+n)*2}draw(e,s){const n=this.options;this.skip||n.radius<.1||!Xt(this,s,this.size(n)/2)||(e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.fillStyle=n.backgroundColor,ac(e,n,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function Fg(t,e){const{x:s,y:n,base:i,width:r,height:a}=t.getProps(["x","y","base","width","height"],e);let o,c,d,u,h;return t.horizontal?(h=a/2,o=Math.min(s,i),c=Math.max(s,i),d=n-h,u=n+h):(h=r/2,o=s-h,c=s+h,d=Math.min(n,i),u=Math.max(n,i)),{left:o,top:d,right:c,bottom:u}}function Fs(t,e,s,n){return t?0:et(e,s,n)}function Dk(t,e,s){const n=t.options.borderWidth,i=t.borderSkipped,r=rg(n);return{t:Fs(i.top,r.top,0,s),r:Fs(i.right,r.right,0,e),b:Fs(i.bottom,r.bottom,0,s),l:Fs(i.left,r.left,0,e)}}function Ek(t,e,s){const{enableBorderRadius:n}=t.getProps(["enableBorderRadius"]),i=t.options.borderRadius,r=bn(i),a=Math.min(e,s),o=t.borderSkipped,c=n||xe(i);return{topLeft:Fs(!c||o.top||o.left,r.topLeft,0,a),topRight:Fs(!c||o.top||o.right,r.topRight,0,a),bottomLeft:Fs(!c||o.bottom||o.left,r.bottomLeft,0,a),bottomRight:Fs(!c||o.bottom||o.right,r.bottomRight,0,a)}}function Ak(t){const e=Fg(t),s=e.right-e.left,n=e.bottom-e.top,i=Dk(t,s/2,n/2),r=Ek(t,s/2,n/2);return{outer:{x:e.left,y:e.top,w:s,h:n,radius:r},inner:{x:e.left+i.l,y:e.top+i.t,w:s-i.l-i.r,h:n-i.t-i.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,r.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(i.b,i.r))}}}}function bl(t,e,s,n){const i=e===null,r=s===null,o=t&&!(i&&r)&&Fg(t,n);return o&&(i||ps(e,o.left,o.right))&&(r||ps(s,o.top,o.bottom))}function Ok(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function Rk(t,e){t.rect(e.x,e.y,e.w,e.h)}function vl(t,e,s={}){const n=t.x!==s.x?-e:0,i=t.y!==s.y?-e:0,r=(t.x+t.w!==s.x+s.w?e:0)-n,a=(t.y+t.h!==s.y+s.h?e:0)-i;return{x:t.x+n,y:t.y+i,w:t.w+r,h:t.h+a,radius:t.radius}}class md extends js{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:s,options:{borderColor:n,backgroundColor:i}}=this,{inner:r,outer:a}=Ak(this),o=Ok(a.radius)?dr:Rk;e.save(),(a.w!==r.w||a.h!==r.h)&&(e.beginPath(),o(e,vl(a,s,r)),e.clip(),o(e,vl(r,-s,a)),e.fillStyle=n,e.fill("evenodd")),e.beginPath(),o(e,vl(r,s)),e.fillStyle=i,e.fill(),e.restore()}inRange(e,s,n){return bl(this,e,s,n)}inXRange(e,s){return bl(this,e,null,s)}inYRange(e,s){return bl(this,null,e,s)}getCenterPoint(e){const{x:s,y:n,base:i,horizontal:r}=this.getProps(["x","y","base","horizontal"],e);return{x:r?(s+i)/2:s,y:r?n:(n+i)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}var Lk=Object.freeze({__proto__:null,ArcElement:_k,BarElement:md,LineElement:Ns,PointElement:ri});const dc=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],Qh=dc.map(t=>t.replace("rgb(","rgba(").replace(")",", 0.5)"));function Ig(t){return dc[t%dc.length]}function Vg(t){return Qh[t%Qh.length]}function Fk(t,e){return t.borderColor=Ig(e),t.backgroundColor=Vg(e),++e}function Ik(t,e){return t.backgroundColor=t.data.map(()=>Ig(e++)),e}function Vk(t,e){return t.backgroundColor=t.data.map(()=>Vg(e++)),e}function Wk(t){let e=0;return(s,n)=>{const i=t.getDatasetMeta(n).controller;i instanceof hd?e=Ik(s,e):i instanceof kg?e=Vk(s,e):i&&(e=Fk(s,e))}}function ef(t){let e;for(e in t)if(t[e].borderColor||t[e].backgroundColor)return!0;return!1}function Bk(t){return t&&(t.borderColor||t.backgroundColor)}function zk(){return Re.borderColor!=="rgba(0,0,0,0.1)"||Re.backgroundColor!=="rgba(0,0,0,0.1)"}var Hk={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(t,e,s){if(!s.enabled)return;const{data:{datasets:n},options:i}=t.config,{elements:r}=i,a=ef(n)||Bk(i)||r&&ef(r)||zk();if(!s.forceOverride&&a)return;const o=Wk(t);n.forEach(o)}};function $k(t,e,s,n,i){const r=i.samples||n;if(r>=s)return t.slice(e,e+s);const a=[],o=(s-2)/(r-2);let c=0;const d=e+s-1;let u=e,h,f,m,p,g;for(a[c++]=t[u],h=0;h<r-2;h++){let x=0,v=0,_;const S=Math.floor((h+1)*o)+1+e,N=Math.min(Math.floor((h+2)*o)+1,s)+e,j=N-S;for(_=S;_<N;_++)x+=t[_].x,v+=t[_].y;x/=j,v/=j;const k=Math.floor(h*o)+1+e,T=Math.min(Math.floor((h+1)*o)+1,s)+e,{x:M,y:P}=t[u];for(m=p=-1,_=k;_<T;_++)p=.5*Math.abs((M-x)*(t[_].y-P)-(M-t[_].x)*(v-P)),p>m&&(m=p,f=t[_],g=_);a[c++]=f,u=g}return a[c++]=t[d],a}function Yk(t,e,s,n){let i=0,r=0,a,o,c,d,u,h,f,m,p,g;const x=[],v=e+s-1,_=t[e].x,N=t[v].x-_;for(a=e;a<e+s;++a){o=t[a],c=(o.x-_)/N*n,d=o.y;const j=c|0;if(j===u)d<p?(p=d,h=a):d>g&&(g=d,f=a),i=(r*i+o.x)/++r;else{const k=a-1;if(!ge(h)&&!ge(f)){const T=Math.min(h,f),M=Math.max(h,f);T!==m&&T!==k&&x.push({...t[T],x:i}),M!==m&&M!==k&&x.push({...t[M],x:i})}a>0&&k!==m&&x.push(t[k]),x.push(o),u=j,r=0,p=g=d,h=f=m=a}}return x}function Wg(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function tf(t){t.data.datasets.forEach(e=>{Wg(e)})}function Uk(t,e){const s=e.length;let n=0,i;const{iScale:r}=t,{min:a,max:o,minDefined:c,maxDefined:d}=r.getUserBounds();return c&&(n=et(gs(e,r.axis,a).lo,0,s-1)),d?i=et(gs(e,r.axis,o).hi+1,n,s)-n:i=s-n,{start:n,count:i}}var Gk={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,s)=>{if(!s.enabled){tf(t);return}const n=t.width;t.data.datasets.forEach((i,r)=>{const{_data:a,indexAxis:o}=i,c=t.getDatasetMeta(r),d=a||i.data;if(Wi([o,t.options.indexAxis])==="y"||!c.controller.supportsDecimation)return;const u=t.scales[c.xAxisID];if(u.type!=="linear"&&u.type!=="time"||t.options.parsing)return;let{start:h,count:f}=Uk(c,d);const m=s.threshold||4*n;if(f<=m){Wg(i);return}ge(a)&&(i._data=d,delete i.data,Object.defineProperty(i,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(g){this._data=g}}));let p;switch(s.algorithm){case"lttb":p=$k(d,h,f,n,s);break;case"min-max":p=Yk(d,h,f,n);break;default:throw new Error(`Unsupported decimation algorithm '${s.algorithm}'`)}i._decimated=p})},destroy(t){tf(t)}};function qk(t,e,s){const n=t.segments,i=t.points,r=e.points,a=[];for(const o of n){let{start:c,end:d}=o;d=_o(c,d,i);const u=uc(s,i[c],i[d],o.loop);if(!e.segments){a.push({source:o,target:u,start:i[c],end:i[d]});continue}const h=gg(e,u);for(const f of h){const m=uc(s,r[f.start],r[f.end],f.loop),p=pg(o,i,m);for(const g of p)a.push({source:g,target:f,start:{[s]:sf(u,m,"start",Math.max)},end:{[s]:sf(u,m,"end",Math.min)}})}}return a}function uc(t,e,s,n){if(n)return;let i=e[t],r=s[t];return t==="angle"&&(i=rt(i),r=rt(r)),{property:t,start:i,end:r}}function Kk(t,e){const{x:s=null,y:n=null}=t||{},i=e.points,r=[];return e.segments.forEach(({start:a,end:o})=>{o=_o(a,o,i);const c=i[a],d=i[o];n!==null?(r.push({x:c.x,y:n}),r.push({x:d.x,y:n})):s!==null&&(r.push({x:s,y:c.y}),r.push({x:s,y:d.y}))}),r}function _o(t,e,s){for(;e>t;e--){const n=s[e];if(!isNaN(n.x)&&!isNaN(n.y))break}return e}function sf(t,e,s,n){return t&&e?n(t[s],e[s]):t?t[s]:e?e[s]:0}function Bg(t,e){let s=[],n=!1;return Oe(t)?(n=!0,s=t):s=Kk(t,e),s.length?new Ns({points:s,options:{tension:0},_loop:n,_fullLoop:n}):null}function nf(t){return t&&t.fill!==!1}function Xk(t,e,s){let i=t[e].fill;const r=[e];let a;if(!s)return i;for(;i!==!1&&r.indexOf(i)===-1;){if(!He(i))return i;if(a=t[i],!a)return!1;if(a.visible)return i;r.push(i),i=a.fill}return!1}function Zk(t,e,s){const n=t2(t);if(xe(n))return isNaN(n.value)?!1:n;let i=parseFloat(n);return He(i)&&Math.floor(i)===i?Jk(n[0],e,i,s):["origin","start","end","stack","shape"].indexOf(n)>=0&&n}function Jk(t,e,s,n){return(t==="-"||t==="+")&&(s=e+s),s===e||s<0||s>=n?!1:s}function Qk(t,e){let s=null;return t==="start"?s=e.bottom:t==="end"?s=e.top:xe(t)?s=e.getPixelForValue(t.value):e.getBasePixel&&(s=e.getBasePixel()),s}function e2(t,e,s){let n;return t==="start"?n=s:t==="end"?n=e.options.reverse?e.min:e.max:xe(t)?n=t.value:n=e.getBaseValue(),n}function t2(t){const e=t.options,s=e.fill;let n=re(s&&s.target,s);return n===void 0&&(n=!!e.backgroundColor),n===!1||n===null?!1:n===!0?"origin":n}function s2(t){const{scale:e,index:s,line:n}=t,i=[],r=n.segments,a=n.points,o=n2(e,s);o.push(Bg({x:null,y:e.bottom},n));for(let c=0;c<r.length;c++){const d=r[c];for(let u=d.start;u<=d.end;u++)i2(i,a[u],o)}return new Ns({points:i,options:{}})}function n2(t,e){const s=[],n=t.getMatchingVisibleMetas("line");for(let i=0;i<n.length;i++){const r=n[i];if(r.index===e)break;r.hidden||s.unshift(r.dataset)}return s}function i2(t,e,s){const n=[];for(let i=0;i<s.length;i++){const r=s[i],{first:a,last:o,point:c}=r2(r,e,"x");if(!(!c||a&&o)){if(a)n.unshift(c);else if(t.push(c),!o)break}}t.push(...n)}function r2(t,e,s){const n=t.interpolate(e,s);if(!n)return{};const i=n[s],r=t.segments,a=t.points;let o=!1,c=!1;for(let d=0;d<r.length;d++){const u=r[d],h=a[u.start][s],f=a[u.end][s];if(ps(i,h,f)){o=i===h,c=i===f;break}}return{first:o,last:c,point:n}}class zg{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,s,n){const{x:i,y:r,radius:a}=this;return s=s||{start:0,end:Me},e.arc(i,r,a,s.end,s.start,!0),!n.bounds}interpolate(e){const{x:s,y:n,radius:i}=this,r=e.angle;return{x:s+Math.cos(r)*i,y:n+Math.sin(r)*i,angle:r}}}function a2(t){const{chart:e,fill:s,line:n}=t;if(He(s))return o2(e,s);if(s==="stack")return s2(t);if(s==="shape")return!0;const i=l2(t);return i instanceof zg?i:Bg(i,n)}function o2(t,e){const s=t.getDatasetMeta(e);return s&&t.isDatasetVisible(e)?s.dataset:null}function l2(t){return(t.scale||{}).getPointPositionForValue?d2(t):c2(t)}function c2(t){const{scale:e={},fill:s}=t,n=Qk(s,e);if(He(n)){const i=e.isHorizontal();return{x:i?n:null,y:i?null:n}}return null}function d2(t){const{scale:e,fill:s}=t,n=e.options,i=e.getLabels().length,r=n.reverse?e.max:e.min,a=e2(s,e,r),o=[];if(n.grid.circular){const c=e.getPointPositionForValue(0,r);return new zg({x:c.x,y:c.y,radius:e.getDistanceFromCenterForValue(a)})}for(let c=0;c<i;++c)o.push(e.getPointPositionForValue(c,a));return o}function _l(t,e,s){const n=a2(e),{chart:i,index:r,line:a,scale:o,axis:c}=e,d=a.options,u=d.fill,h=d.backgroundColor,{above:f=h,below:m=h}=u||{},p=i.getDatasetMeta(r),g=xg(i,p);n&&a.points.length&&(xo(t,s),u2(t,{line:a,target:n,above:f,below:m,area:s,scale:o,axis:c,clip:g}),yo(t))}function u2(t,e){const{line:s,target:n,above:i,below:r,area:a,scale:o,clip:c}=e,d=s._loop?"angle":e.axis;t.save();let u=r;r!==i&&(d==="x"?(rf(t,n,a.top),wl(t,{line:s,target:n,color:i,scale:o,property:d,clip:c}),t.restore(),t.save(),rf(t,n,a.bottom)):d==="y"&&(af(t,n,a.left),wl(t,{line:s,target:n,color:r,scale:o,property:d,clip:c}),t.restore(),t.save(),af(t,n,a.right),u=i)),wl(t,{line:s,target:n,color:u,scale:o,property:d,clip:c}),t.restore()}function rf(t,e,s){const{segments:n,points:i}=e;let r=!0,a=!1;t.beginPath();for(const o of n){const{start:c,end:d}=o,u=i[c],h=i[_o(c,d,i)];r?(t.moveTo(u.x,u.y),r=!1):(t.lineTo(u.x,s),t.lineTo(u.x,u.y)),a=!!e.pathSegment(t,o,{move:a}),a?t.closePath():t.lineTo(h.x,s)}t.lineTo(e.first().x,s),t.closePath(),t.clip()}function af(t,e,s){const{segments:n,points:i}=e;let r=!0,a=!1;t.beginPath();for(const o of n){const{start:c,end:d}=o,u=i[c],h=i[_o(c,d,i)];r?(t.moveTo(u.x,u.y),r=!1):(t.lineTo(s,u.y),t.lineTo(u.x,u.y)),a=!!e.pathSegment(t,o,{move:a}),a?t.closePath():t.lineTo(s,h.y)}t.lineTo(s,e.first().y),t.closePath(),t.clip()}function wl(t,e){const{line:s,target:n,property:i,color:r,scale:a,clip:o}=e,c=qk(s,n,i);for(const{source:d,target:u,start:h,end:f}of c){const{style:{backgroundColor:m=r}={}}=d,p=n!==!0;t.save(),t.fillStyle=m,h2(t,a,o,p&&uc(i,h,f)),t.beginPath();const g=!!s.pathSegment(t,d);let x;if(p){g?t.closePath():of(t,n,f,i);const v=!!n.pathSegment(t,u,{move:g,reverse:!0});x=g&&v,x||of(t,n,h,i)}t.closePath(),t.fill(x?"evenodd":"nonzero"),t.restore()}}function h2(t,e,s,n){const i=e.chart.chartArea,{property:r,start:a,end:o}=n||{};if(r==="x"||r==="y"){let c,d,u,h;r==="x"?(c=a,d=i.top,u=o,h=i.bottom):(c=i.left,d=a,u=i.right,h=o),t.beginPath(),s&&(c=Math.max(c,s.left),u=Math.min(u,s.right),d=Math.max(d,s.top),h=Math.min(h,s.bottom)),t.rect(c,d,u-c,h-d),t.clip()}}function of(t,e,s,n){const i=e.interpolate(s,n);i&&t.lineTo(i.x,i.y)}var wo={id:"filler",afterDatasetsUpdate(t,e,s){const n=(t.data.datasets||[]).length,i=[];let r,a,o,c;for(a=0;a<n;++a)r=t.getDatasetMeta(a),o=r.dataset,c=null,o&&o.options&&o instanceof Ns&&(c={visible:t.isDatasetVisible(a),index:a,fill:Zk(o,a,n),chart:t,axis:r.controller.options.indexAxis,scale:r.vScale,line:o}),r.$filler=c,i.push(c);for(a=0;a<n;++a)c=i[a],!(!c||c.fill===!1)&&(c.fill=Xk(i,a,s.propagate))},beforeDraw(t,e,s){const n=s.drawTime==="beforeDraw",i=t.getSortedVisibleDatasetMetas(),r=t.chartArea;for(let a=i.length-1;a>=0;--a){const o=i[a].$filler;o&&(o.line.updateControlPoints(r,o.axis),n&&o.fill&&_l(t.ctx,o,r))}},beforeDatasetsDraw(t,e,s){if(s.drawTime!=="beforeDatasetsDraw")return;const n=t.getSortedVisibleDatasetMetas();for(let i=n.length-1;i>=0;--i){const r=n[i].$filler;nf(r)&&_l(t.ctx,r,t.chartArea)}},beforeDatasetDraw(t,e,s){const n=e.meta.$filler;!nf(n)||s.drawTime!=="beforeDatasetDraw"||_l(t.ctx,n,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const lf=(t,e)=>{let{boxHeight:s=e,boxWidth:n=e}=t;return t.usePointStyle&&(s=Math.min(s,e),n=t.pointStyleWidth||Math.min(n,e)),{boxWidth:n,boxHeight:s,itemHeight:Math.max(e,s)}},f2=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class cf extends js{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,s,n){this.maxWidth=e,this.maxHeight=s,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let s=ie(e.generateLabels,[this.chart],this)||[];e.filter&&(s=s.filter(n=>e.filter(n,this.chart.data))),e.sort&&(s=s.sort((n,i)=>e.sort(n,i,this.chart.data))),this.options.reverse&&s.reverse(),this.legendItems=s}fit(){const{options:e,ctx:s}=this;if(!e.display){this.width=this.height=0;return}const n=e.labels,i=Xe(n.font),r=i.size,a=this._computeTitleHeight(),{boxWidth:o,itemHeight:c}=lf(n,r);let d,u;s.font=i.string,this.isHorizontal()?(d=this.maxWidth,u=this._fitRows(a,r,o,c)+10):(u=this.maxHeight,d=this._fitCols(a,i,o,c)+10),this.width=Math.min(d,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,s,n,i){const{ctx:r,maxWidth:a,options:{labels:{padding:o}}}=this,c=this.legendHitBoxes=[],d=this.lineWidths=[0],u=i+o;let h=e;r.textAlign="left",r.textBaseline="middle";let f=-1,m=-u;return this.legendItems.forEach((p,g)=>{const x=n+s/2+r.measureText(p.text).width;(g===0||d[d.length-1]+x+2*o>a)&&(h+=u,d[d.length-(g>0?0:1)]=0,m+=u,f++),c[g]={left:0,top:m,row:f,width:x,height:i},d[d.length-1]+=x+o}),h}_fitCols(e,s,n,i){const{ctx:r,maxHeight:a,options:{labels:{padding:o}}}=this,c=this.legendHitBoxes=[],d=this.columnSizes=[],u=a-e;let h=o,f=0,m=0,p=0,g=0;return this.legendItems.forEach((x,v)=>{const{itemWidth:_,itemHeight:S}=m2(n,s,r,x,i);v>0&&m+S+2*o>u&&(h+=f+o,d.push({width:f,height:m}),p+=f+o,g++,f=m=0),c[v]={left:p,top:m,col:g,width:_,height:S},f=Math.max(f,_),m+=S+o}),h+=f,d.push({width:f,height:m}),h}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:s,options:{align:n,labels:{padding:i},rtl:r}}=this,a=Un(r,this.left,this.width);if(this.isHorizontal()){let o=0,c=nt(n,this.left+i,this.right-this.lineWidths[o]);for(const d of s)o!==d.row&&(o=d.row,c=nt(n,this.left+i,this.right-this.lineWidths[o])),d.top+=this.top+e+i,d.left=a.leftForLtr(a.x(c),d.width),c+=d.width+i}else{let o=0,c=nt(n,this.top+e+i,this.bottom-this.columnSizes[o].height);for(const d of s)d.col!==o&&(o=d.col,c=nt(n,this.top+e+i,this.bottom-this.columnSizes[o].height)),d.top=c,d.left+=this.left+i,d.left=a.leftForLtr(a.x(d.left),d.width),c+=d.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;xo(e,this),this._draw(),yo(e)}}_draw(){const{options:e,columnSizes:s,lineWidths:n,ctx:i}=this,{align:r,labels:a}=e,o=Re.color,c=Un(e.rtl,this.left,this.width),d=Xe(a.font),{padding:u}=a,h=d.size,f=h/2;let m;this.drawTitle(),i.textAlign=c.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=d.string;const{boxWidth:p,boxHeight:g,itemHeight:x}=lf(a,h),v=function(k,T,M){if(isNaN(p)||p<=0||isNaN(g)||g<0)return;i.save();const P=re(M.lineWidth,1);if(i.fillStyle=re(M.fillStyle,o),i.lineCap=re(M.lineCap,"butt"),i.lineDashOffset=re(M.lineDashOffset,0),i.lineJoin=re(M.lineJoin,"miter"),i.lineWidth=P,i.strokeStyle=re(M.strokeStyle,o),i.setLineDash(re(M.lineDash,[])),a.usePointStyle){const O={radius:g*Math.SQRT2/2,pointStyle:M.pointStyle,rotation:M.rotation,borderWidth:P},A=c.xPlus(k,p/2),F=T+f;ig(i,O,A,F,a.pointStyleWidth&&p)}else{const O=T+Math.max((h-g)/2,0),A=c.leftForLtr(k,p),F=bn(M.borderRadius);i.beginPath(),Object.values(F).some(X=>X!==0)?dr(i,{x:A,y:O,w:p,h:g,radius:F}):i.rect(A,O,p,g),i.fill(),P!==0&&i.stroke()}i.restore()},_=function(k,T,M){Sn(i,M.text,k,T+x/2,d,{strikethrough:M.hidden,textAlign:c.textAlign(M.textAlign)})},S=this.isHorizontal(),N=this._computeTitleHeight();S?m={x:nt(r,this.left+u,this.right-n[0]),y:this.top+u+N,line:0}:m={x:this.left+u,y:nt(r,this.top+N+u,this.bottom-s[0].height),line:0},hg(this.ctx,e.textDirection);const j=x+u;this.legendItems.forEach((k,T)=>{i.strokeStyle=k.fontColor,i.fillStyle=k.fontColor;const M=i.measureText(k.text).width,P=c.textAlign(k.textAlign||(k.textAlign=a.textAlign)),O=p+f+M;let A=m.x,F=m.y;c.setWidth(this.width),S?T>0&&A+O+u>this.right&&(F=m.y+=j,m.line++,A=m.x=nt(r,this.left+u,this.right-n[m.line])):T>0&&F+j>this.bottom&&(A=m.x=A+s[m.line].width+u,m.line++,F=m.y=nt(r,this.top+N+u,this.bottom-s[m.line].height));const X=c.x(A);if(v(X,F,k),A=D_(P,A+p+f,S?A+O:this.right,e.rtl),_(c.x(A),F,k),S)m.x+=O+u;else if(typeof k.text!="string"){const H=d.lineHeight;m.y+=Hg(k,H)+u}else m.y+=j}),fg(this.ctx,e.textDirection)}drawTitle(){const e=this.options,s=e.title,n=Xe(s.font),i=ct(s.padding);if(!s.display)return;const r=Un(e.rtl,this.left,this.width),a=this.ctx,o=s.position,c=n.size/2,d=i.top+c;let u,h=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),u=this.top+d,h=nt(e.align,h,this.right-f);else{const p=this.columnSizes.reduce((g,x)=>Math.max(g,x.height),0);u=d+nt(e.align,this.top,this.bottom-p-e.labels.padding-this._computeTitleHeight())}const m=nt(o,h,h+f);a.textAlign=r.textAlign(id(o)),a.textBaseline="middle",a.strokeStyle=s.color,a.fillStyle=s.color,a.font=n.string,Sn(a,s.text,m,u,n)}_computeTitleHeight(){const e=this.options.title,s=Xe(e.font),n=ct(e.padding);return e.display?s.lineHeight+n.height:0}_getLegendItemAt(e,s){let n,i,r;if(ps(e,this.left,this.right)&&ps(s,this.top,this.bottom)){for(r=this.legendHitBoxes,n=0;n<r.length;++n)if(i=r[n],ps(e,i.left,i.left+i.width)&&ps(s,i.top,i.top+i.height))return this.legendItems[n]}return null}handleEvent(e){const s=this.options;if(!x2(e.type,s))return;const n=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const i=this._hoveredItem,r=f2(i,n);i&&!r&&ie(s.onLeave,[e,i,this],this),this._hoveredItem=n,n&&!r&&ie(s.onHover,[e,n,this],this)}else n&&ie(s.onClick,[e,n,this],this)}}function m2(t,e,s,n,i){const r=p2(n,t,e,s),a=g2(i,n,e.lineHeight);return{itemWidth:r,itemHeight:a}}function p2(t,e,s,n){let i=t.text;return i&&typeof i!="string"&&(i=i.reduce((r,a)=>r.length>a.length?r:a)),e+s.size/2+n.measureText(i).width}function g2(t,e,s){let n=t;return typeof e.text!="string"&&(n=Hg(e,s)),n}function Hg(t,e){const s=t.text?t.text.length:0;return e*s}function x2(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var ai={id:"legend",_element:cf,start(t,e,s){const n=t.legend=new cf({ctx:t.ctx,options:s,chart:t});at.configure(t,n,s),at.addBox(t,n)},stop(t){at.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,s){const n=t.legend;at.configure(t,n,s),n.options=s},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,s){const n=e.datasetIndex,i=s.chart;i.isDatasetVisible(n)?(i.hide(n),e.hidden=!0):(i.show(n),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:s,pointStyle:n,textAlign:i,color:r,useBorderRadius:a,borderRadius:o}}=t.legend.options;return t._getSortedDatasetMetas().map(c=>{const d=c.controller.getStyle(s?0:void 0),u=ct(d.borderWidth);return{text:e[c.index].label,fillStyle:d.backgroundColor,fontColor:r,hidden:!c.visible,lineCap:d.borderCapStyle,lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:d.borderColor,pointStyle:n||d.pointStyle,rotation:d.rotation,textAlign:i||d.textAlign,borderRadius:a&&(o||d.borderRadius),datasetIndex:c.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class pd extends js{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,s){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=s;const i=Oe(n.text)?n.text.length:1;this._padding=ct(n.padding);const r=i*Xe(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:s,left:n,bottom:i,right:r,options:a}=this,o=a.align;let c=0,d,u,h;return this.isHorizontal()?(u=nt(o,n,r),h=s+e,d=r-n):(a.position==="left"?(u=n+e,h=nt(o,i,s),c=ve*-.5):(u=r-e,h=nt(o,s,i),c=ve*.5),d=i-s),{titleX:u,titleY:h,maxWidth:d,rotation:c}}draw(){const e=this.ctx,s=this.options;if(!s.display)return;const n=Xe(s.font),r=n.lineHeight/2+this._padding.top,{titleX:a,titleY:o,maxWidth:c,rotation:d}=this._drawArgs(r);Sn(e,s.text,0,0,n,{color:s.color,maxWidth:c,rotation:d,textAlign:id(s.align),textBaseline:"middle",translation:[a,o]})}}function y2(t,e){const s=new pd({ctx:t.ctx,options:e,chart:t});at.configure(t,s,e),at.addBox(t,s),t.titleBlock=s}var ko={id:"title",_element:pd,start(t,e,s){y2(t,s)},stop(t){const e=t.titleBlock;at.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,s){const n=t.titleBlock;at.configure(t,n,s),n.options=s},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const ia=new WeakMap;var b2={id:"subtitle",start(t,e,s){const n=new pd({ctx:t.ctx,options:s,chart:t});at.configure(t,n,s),at.addBox(t,n),ia.set(t,n)},stop(t){at.removeBox(t,ia.get(t)),ia.delete(t)},beforeUpdate(t,e,s){const n=ia.get(t);at.configure(t,n,s),n.options=s},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const zi={average(t){if(!t.length)return!1;let e,s,n=new Set,i=0,r=0;for(e=0,s=t.length;e<s;++e){const o=t[e].element;if(o&&o.hasValue()){const c=o.tooltipPosition();n.add(c.x),i+=c.y,++r}}return r===0||n.size===0?!1:{x:[...n].reduce((o,c)=>o+c)/n.size,y:i/r}},nearest(t,e){if(!t.length)return!1;let s=e.x,n=e.y,i=Number.POSITIVE_INFINITY,r,a,o;for(r=0,a=t.length;r<a;++r){const c=t[r].element;if(c&&c.hasValue()){const d=c.getCenterPoint(),u=ic(e,d);u<i&&(i=u,o=c)}}if(o){const c=o.tooltipPosition();s=c.x,n=c.y}return{x:s,y:n}}};function Ut(t,e){return e&&(Oe(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function hs(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function v2(t,e){const{element:s,datasetIndex:n,index:i}=e,r=t.getDatasetMeta(n).controller,{label:a,value:o}=r.getLabelAndValue(i);return{chart:t,label:a,parsed:r.getParsed(i),raw:t.data.datasets[n].data[i],formattedValue:o,dataset:r.getDataset(),dataIndex:i,datasetIndex:n,element:s}}function df(t,e){const s=t.chart.ctx,{body:n,footer:i,title:r}=t,{boxWidth:a,boxHeight:o}=e,c=Xe(e.bodyFont),d=Xe(e.titleFont),u=Xe(e.footerFont),h=r.length,f=i.length,m=n.length,p=ct(e.padding);let g=p.height,x=0,v=n.reduce((N,j)=>N+j.before.length+j.lines.length+j.after.length,0);if(v+=t.beforeBody.length+t.afterBody.length,h&&(g+=h*d.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),v){const N=e.displayColors?Math.max(o,c.lineHeight):c.lineHeight;g+=m*N+(v-m)*c.lineHeight+(v-1)*e.bodySpacing}f&&(g+=e.footerMarginTop+f*u.lineHeight+(f-1)*e.footerSpacing);let _=0;const S=function(N){x=Math.max(x,s.measureText(N).width+_)};return s.save(),s.font=d.string,pe(t.title,S),s.font=c.string,pe(t.beforeBody.concat(t.afterBody),S),_=e.displayColors?a+2+e.boxPadding:0,pe(n,N=>{pe(N.before,S),pe(N.lines,S),pe(N.after,S)}),_=0,s.font=u.string,pe(t.footer,S),s.restore(),x+=p.width,{width:x,height:g}}function _2(t,e){const{y:s,height:n}=e;return s<n/2?"top":s>t.height-n/2?"bottom":"center"}function w2(t,e,s,n){const{x:i,width:r}=n,a=s.caretSize+s.caretPadding;if(t==="left"&&i+r+a>e.width||t==="right"&&i-r-a<0)return!0}function k2(t,e,s,n){const{x:i,width:r}=s,{width:a,chartArea:{left:o,right:c}}=t;let d="center";return n==="center"?d=i<=(o+c)/2?"left":"right":i<=r/2?d="left":i>=a-r/2&&(d="right"),w2(d,t,e,s)&&(d="center"),d}function uf(t,e,s){const n=s.yAlign||e.yAlign||_2(t,s);return{xAlign:s.xAlign||e.xAlign||k2(t,e,s,n),yAlign:n}}function S2(t,e){let{x:s,width:n}=t;return e==="right"?s-=n:e==="center"&&(s-=n/2),s}function j2(t,e,s){let{y:n,height:i}=t;return e==="top"?n+=s:e==="bottom"?n-=i+s:n-=i/2,n}function hf(t,e,s,n){const{caretSize:i,caretPadding:r,cornerRadius:a}=t,{xAlign:o,yAlign:c}=s,d=i+r,{topLeft:u,topRight:h,bottomLeft:f,bottomRight:m}=bn(a);let p=S2(e,o);const g=j2(e,c,d);return c==="center"?o==="left"?p+=d:o==="right"&&(p-=d):o==="left"?p-=Math.max(u,f)+i:o==="right"&&(p+=Math.max(h,m)+i),{x:et(p,0,n.width-e.width),y:et(g,0,n.height-e.height)}}function ra(t,e,s){const n=ct(s.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-n.right:t.x+n.left}function ff(t){return Ut([],hs(t))}function N2(t,e,s){return Xs(t,{tooltip:e,tooltipItems:s,type:"tooltip"})}function mf(t,e){const s=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return s?t.override(s):t}const $g={beforeTitle:ls,title(t){if(t.length>0){const e=t[0],s=e.chart.data.labels,n=s?s.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(n>0&&e.dataIndex<n)return s[e.dataIndex]}return""},afterTitle:ls,beforeBody:ls,beforeLabel:ls,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const s=t.formattedValue;return ge(s)||(e+=s),e},labelColor(t){const s=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:s.borderColor,backgroundColor:s.backgroundColor,borderWidth:s.borderWidth,borderDash:s.borderDash,borderDashOffset:s.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const s=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:s.pointStyle,rotation:s.rotation}},afterLabel:ls,afterBody:ls,beforeFooter:ls,footer:ls,afterFooter:ls};function ht(t,e,s,n){const i=t[e].call(s,n);return typeof i>"u"?$g[e].call(s,n):i}let pf=class extends js{static positioners=zi;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const s=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&s.options.animation&&n.animations,r=new yg(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=N2(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,s){const{callbacks:n}=s,i=ht(n,"beforeTitle",this,e),r=ht(n,"title",this,e),a=ht(n,"afterTitle",this,e);let o=[];return o=Ut(o,hs(i)),o=Ut(o,hs(r)),o=Ut(o,hs(a)),o}getBeforeBody(e,s){return ff(ht(s.callbacks,"beforeBody",this,e))}getBody(e,s){const{callbacks:n}=s,i=[];return pe(e,r=>{const a={before:[],lines:[],after:[]},o=mf(n,r);Ut(a.before,hs(ht(o,"beforeLabel",this,r))),Ut(a.lines,ht(o,"label",this,r)),Ut(a.after,hs(ht(o,"afterLabel",this,r))),i.push(a)}),i}getAfterBody(e,s){return ff(ht(s.callbacks,"afterBody",this,e))}getFooter(e,s){const{callbacks:n}=s,i=ht(n,"beforeFooter",this,e),r=ht(n,"footer",this,e),a=ht(n,"afterFooter",this,e);let o=[];return o=Ut(o,hs(i)),o=Ut(o,hs(r)),o=Ut(o,hs(a)),o}_createItems(e){const s=this._active,n=this.chart.data,i=[],r=[],a=[];let o=[],c,d;for(c=0,d=s.length;c<d;++c)o.push(v2(this.chart,s[c]));return e.filter&&(o=o.filter((u,h,f)=>e.filter(u,h,f,n))),e.itemSort&&(o=o.sort((u,h)=>e.itemSort(u,h,n))),pe(o,u=>{const h=mf(e.callbacks,u);i.push(ht(h,"labelColor",this,u)),r.push(ht(h,"labelPointStyle",this,u)),a.push(ht(h,"labelTextColor",this,u))}),this.labelColors=i,this.labelPointStyles=r,this.labelTextColors=a,this.dataPoints=o,o}update(e,s){const n=this.options.setContext(this.getContext()),i=this._active;let r,a=[];if(!i.length)this.opacity!==0&&(r={opacity:0});else{const o=zi[n.position].call(this,i,this._eventPosition);a=this._createItems(n),this.title=this.getTitle(a,n),this.beforeBody=this.getBeforeBody(a,n),this.body=this.getBody(a,n),this.afterBody=this.getAfterBody(a,n),this.footer=this.getFooter(a,n);const c=this._size=df(this,n),d=Object.assign({},o,c),u=uf(this.chart,n,d),h=hf(n,d,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,r={opacity:1,x:h.x,y:h.y,width:c.width,height:c.height,caretX:o.x,caretY:o.y}}this._tooltipItems=a,this.$context=void 0,r&&this._resolveAnimations().update(this,r),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:s})}drawCaret(e,s,n,i){const r=this.getCaretPosition(e,n,i);s.lineTo(r.x1,r.y1),s.lineTo(r.x2,r.y2),s.lineTo(r.x3,r.y3)}getCaretPosition(e,s,n){const{xAlign:i,yAlign:r}=this,{caretSize:a,cornerRadius:o}=n,{topLeft:c,topRight:d,bottomLeft:u,bottomRight:h}=bn(o),{x:f,y:m}=e,{width:p,height:g}=s;let x,v,_,S,N,j;return r==="center"?(N=m+g/2,i==="left"?(x=f,v=x-a,S=N+a,j=N-a):(x=f+p,v=x+a,S=N-a,j=N+a),_=x):(i==="left"?v=f+Math.max(c,u)+a:i==="right"?v=f+p-Math.max(d,h)-a:v=this.caretX,r==="top"?(S=m,N=S-a,x=v-a,_=v+a):(S=m+g,N=S+a,x=v+a,_=v-a),j=S),{x1:x,x2:v,x3:_,y1:S,y2:N,y3:j}}drawTitle(e,s,n){const i=this.title,r=i.length;let a,o,c;if(r){const d=Un(n.rtl,this.x,this.width);for(e.x=ra(this,n.titleAlign,n),s.textAlign=d.textAlign(n.titleAlign),s.textBaseline="middle",a=Xe(n.titleFont),o=n.titleSpacing,s.fillStyle=n.titleColor,s.font=a.string,c=0;c<r;++c)s.fillText(i[c],d.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+o,c+1===r&&(e.y+=n.titleMarginBottom-o)}}_drawColorBox(e,s,n,i,r){const a=this.labelColors[n],o=this.labelPointStyles[n],{boxHeight:c,boxWidth:d}=r,u=Xe(r.bodyFont),h=ra(this,"left",r),f=i.x(h),m=c<u.lineHeight?(u.lineHeight-c)/2:0,p=s.y+m;if(r.usePointStyle){const g={radius:Math.min(d,c)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},x=i.leftForLtr(f,d)+d/2,v=p+c/2;e.strokeStyle=r.multiKeyBackground,e.fillStyle=r.multiKeyBackground,ac(e,g,x,v),e.strokeStyle=a.borderColor,e.fillStyle=a.backgroundColor,ac(e,g,x,v)}else{e.lineWidth=xe(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,e.strokeStyle=a.borderColor,e.setLineDash(a.borderDash||[]),e.lineDashOffset=a.borderDashOffset||0;const g=i.leftForLtr(f,d),x=i.leftForLtr(i.xPlus(f,1),d-2),v=bn(a.borderRadius);Object.values(v).some(_=>_!==0)?(e.beginPath(),e.fillStyle=r.multiKeyBackground,dr(e,{x:g,y:p,w:d,h:c,radius:v}),e.fill(),e.stroke(),e.fillStyle=a.backgroundColor,e.beginPath(),dr(e,{x,y:p+1,w:d-2,h:c-2,radius:v}),e.fill()):(e.fillStyle=r.multiKeyBackground,e.fillRect(g,p,d,c),e.strokeRect(g,p,d,c),e.fillStyle=a.backgroundColor,e.fillRect(x,p+1,d-2,c-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,s,n){const{body:i}=this,{bodySpacing:r,bodyAlign:a,displayColors:o,boxHeight:c,boxWidth:d,boxPadding:u}=n,h=Xe(n.bodyFont);let f=h.lineHeight,m=0;const p=Un(n.rtl,this.x,this.width),g=function(M){s.fillText(M,p.x(e.x+m),e.y+f/2),e.y+=f+r},x=p.textAlign(a);let v,_,S,N,j,k,T;for(s.textAlign=a,s.textBaseline="middle",s.font=h.string,e.x=ra(this,x,n),s.fillStyle=n.bodyColor,pe(this.beforeBody,g),m=o&&x!=="right"?a==="center"?d/2+u:d+2+u:0,N=0,k=i.length;N<k;++N){for(v=i[N],_=this.labelTextColors[N],s.fillStyle=_,pe(v.before,g),S=v.lines,o&&S.length&&(this._drawColorBox(s,e,N,p,n),f=Math.max(h.lineHeight,c)),j=0,T=S.length;j<T;++j)g(S[j]),f=h.lineHeight;pe(v.after,g)}m=0,f=h.lineHeight,pe(this.afterBody,g),e.y-=r}drawFooter(e,s,n){const i=this.footer,r=i.length;let a,o;if(r){const c=Un(n.rtl,this.x,this.width);for(e.x=ra(this,n.footerAlign,n),e.y+=n.footerMarginTop,s.textAlign=c.textAlign(n.footerAlign),s.textBaseline="middle",a=Xe(n.footerFont),s.fillStyle=n.footerColor,s.font=a.string,o=0;o<r;++o)s.fillText(i[o],c.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+n.footerSpacing}}drawBackground(e,s,n,i){const{xAlign:r,yAlign:a}=this,{x:o,y:c}=e,{width:d,height:u}=n,{topLeft:h,topRight:f,bottomLeft:m,bottomRight:p}=bn(i.cornerRadius);s.fillStyle=i.backgroundColor,s.strokeStyle=i.borderColor,s.lineWidth=i.borderWidth,s.beginPath(),s.moveTo(o+h,c),a==="top"&&this.drawCaret(e,s,n,i),s.lineTo(o+d-f,c),s.quadraticCurveTo(o+d,c,o+d,c+f),a==="center"&&r==="right"&&this.drawCaret(e,s,n,i),s.lineTo(o+d,c+u-p),s.quadraticCurveTo(o+d,c+u,o+d-p,c+u),a==="bottom"&&this.drawCaret(e,s,n,i),s.lineTo(o+m,c+u),s.quadraticCurveTo(o,c+u,o,c+u-m),a==="center"&&r==="left"&&this.drawCaret(e,s,n,i),s.lineTo(o,c+h),s.quadraticCurveTo(o,c,o+h,c),s.closePath(),s.fill(),i.borderWidth>0&&s.stroke()}_updateAnimationTarget(e){const s=this.chart,n=this.$animations,i=n&&n.x,r=n&&n.y;if(i||r){const a=zi[e.position].call(this,this._active,this._eventPosition);if(!a)return;const o=this._size=df(this,e),c=Object.assign({},a,this._size),d=uf(s,e,c),u=hf(e,c,d,s);(i._to!==u.x||r._to!==u.y)&&(this.xAlign=d.xAlign,this.yAlign=d.yAlign,this.width=o.width,this.height=o.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const s=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(s);const i={width:this.width,height:this.height},r={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const a=ct(s.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;s.enabled&&o&&(e.save(),e.globalAlpha=n,this.drawBackground(r,e,i,s),hg(e,s.textDirection),r.y+=a.top,this.drawTitle(r,e,s),this.drawBody(r,e,s),this.drawFooter(r,e,s),fg(e,s.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,s){const n=this._active,i=e.map(({datasetIndex:o,index:c})=>{const d=this.chart.getDatasetMeta(o);if(!d)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:d.data[c],index:c}}),r=!Ia(n,i),a=this._positionChanged(i,s);(r||a)&&(this._active=i,this._eventPosition=s,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,s,n=!0){if(s&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,r=this._active||[],a=this._getActiveElements(e,r,s,n),o=this._positionChanged(a,e),c=s||!Ia(a,r)||o;return c&&(this._active=a,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,s))),c}_getActiveElements(e,s,n,i){const r=this.options;if(e.type==="mouseout")return[];if(!i)return s.filter(o=>this.chart.data.datasets[o.datasetIndex]&&this.chart.getDatasetMeta(o.datasetIndex).controller.getParsed(o.index)!==void 0);const a=this.chart.getElementsAtEventForMode(e,r.mode,r,n);return r.reverse&&a.reverse(),a}_positionChanged(e,s){const{caretX:n,caretY:i,options:r}=this,a=zi[r.position].call(this,e,s);return a!==!1&&(n!==a.x||i!==a.y)}};var oi={id:"tooltip",_element:pf,positioners:zi,afterInit(t,e,s){s&&(t.tooltip=new pf({chart:t,options:s}))},beforeUpdate(t,e,s){t.tooltip&&t.tooltip.initialize(s)},reset(t,e,s){t.tooltip&&t.tooltip.initialize(s)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const s={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...s,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",s)}},afterEvent(t,e){if(t.tooltip){const s=e.replay;t.tooltip.handleEvent(e.event,s,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:$g},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},T2=Object.freeze({__proto__:null,Colors:Hk,Decimation:Gk,Filler:wo,Legend:ai,SubTitle:b2,Title:ko,Tooltip:oi});const M2=(t,e,s,n)=>(typeof e=="string"?(s=t.push(e)-1,n.unshift({index:s,label:e})):isNaN(e)&&(s=null),s);function C2(t,e,s,n){const i=t.indexOf(e);if(i===-1)return M2(t,e,s,n);const r=t.lastIndexOf(e);return i!==r?s:i}const P2=(t,e)=>t===null?null:et(Math.round(t),0,e);function gf(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class Mr extends Tn{static id="category";static defaults={ticks:{callback:gf}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const s=this._addedLabels;if(s.length){const n=this.getLabels();for(const{index:i,label:r}of s)n[i]===r&&n.splice(i,1);this._addedLabels=[]}super.init(e)}parse(e,s){if(ge(e))return null;const n=this.getLabels();return s=isFinite(s)&&n[s]===e?s:C2(n,e,re(s,e),this._addedLabels),P2(s,n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:s}=this.getUserBounds();let{min:n,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(n=0),s||(i=this.getLabels().length-1)),this.min=n,this.max=i}buildTicks(){const e=this.min,s=this.max,n=this.options.offset,i=[];let r=this.getLabels();r=e===0&&s===r.length-1?r:r.slice(e,s+1),this._valueRange=Math.max(r.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let a=e;a<=s;a++)i.push({value:a});return i}getLabelForValue(e){return gf.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const s=this.ticks;return e<0||e>s.length-1?null:this.getPixelForValue(s[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function D2(t,e){const s=[],{bounds:i,step:r,min:a,max:o,precision:c,count:d,maxTicks:u,maxDigits:h,includeBounds:f}=t,m=r||1,p=u-1,{min:g,max:x}=e,v=!ge(a),_=!ge(o),S=!ge(d),N=(x-g)/(h+1);let j=ch((x-g)/p/m)*m,k,T,M,P;if(j<1e-14&&!v&&!_)return[{value:g},{value:x}];P=Math.ceil(x/j)-Math.floor(g/j),P>p&&(j=ch(P*j/p/m)*m),ge(c)||(k=Math.pow(10,c),j=Math.ceil(j*k)/k),i==="ticks"?(T=Math.floor(g/j)*j,M=Math.ceil(x/j)*j):(T=g,M=x),v&&_&&r&&S_((o-a)/r,j/1e3)?(P=Math.round(Math.min((o-a)/j,u)),j=(o-a)/P,T=a,M=o):S?(T=v?a:T,M=_?o:M,P=d-1,j=(M-T)/P):(P=(M-T)/j,yn(P,Math.round(P),j/1e3)?P=Math.round(P):P=Math.ceil(P));const O=Math.max(dh(j),dh(T));k=Math.pow(10,ge(c)?O:c),T=Math.round(T*k)/k,M=Math.round(M*k)/k;let A=0;for(v&&(f&&T!==a?(s.push({value:a}),T<a&&A++,yn(Math.round((T+A*j)*k)/k,a,xf(a,N,t))&&A++):T<a&&A++);A<P;++A){const F=Math.round((T+A*j)*k)/k;if(_&&F>o)break;s.push({value:F})}return _&&f&&M!==o?s.length&&yn(s[s.length-1].value,o,xf(o,N,t))?s[s.length-1].value=o:s.push({value:o}):(!_||M===o)&&s.push({value:M}),s}function xf(t,e,{horizontal:s,minRotation:n}){const i=Lt(n),r=(s?Math.sin(i):Math.cos(i))||.001,a=.75*e*(""+t).length;return Math.min(e/r,a)}class Ya extends Tn{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,s){return ge(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:s,maxDefined:n}=this.getUserBounds();let{min:i,max:r}=this;const a=c=>i=s?i:c,o=c=>r=n?r:c;if(e){const c=Mt(i),d=Mt(r);c<0&&d<0?o(0):c>0&&d>0&&a(0)}if(i===r){let c=r===0?1:Math.abs(r*.05);o(r+c),e||a(i-c)}this.min=i,this.max=r}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:s,stepSize:n}=e,i;return n?(i=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),s=s||11),s&&(i=Math.min(s,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,s=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const i={maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:s.precision,step:s.stepSize,count:s.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:s.minRotation||0,includeBounds:s.includeBounds!==!1},r=this._range||this,a=D2(i,r);return e.bounds==="ticks"&&Kp(a,this,"value"),e.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const e=this.ticks;let s=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const i=(n-s)/Math.max(e.length-1,1)/2;s-=i,n+=i}this._startValue=s,this._endValue=n,this._valueRange=n-s}getLabelForValue(e){return Tr(e,this.chart.options.locale,this.options.ticks.format)}}class Cr extends Ya{static id="linear";static defaults={ticks:{callback:go.formatters.numeric}};determineDataLimits(){const{min:e,max:s}=this.getMinMax(!0);this.min=He(e)?e:0,this.max=He(s)?s:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),s=e?this.width:this.height,n=Lt(this.options.ticks.minRotation),i=(e?Math.sin(n):Math.cos(n))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(s/Math.min(40,r.lineHeight/i))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const hr=t=>Math.floor(Rs(t)),cn=(t,e)=>Math.pow(10,hr(t)+e);function yf(t){return t/Math.pow(10,hr(t))===1}function bf(t,e,s){const n=Math.pow(10,s),i=Math.floor(t/n);return Math.ceil(e/n)-i}function E2(t,e){const s=e-t;let n=hr(s);for(;bf(t,e,n)>10;)n++;for(;bf(t,e,n)<10;)n--;return Math.min(n,hr(t))}function A2(t,{min:e,max:s}){e=yt(t.min,e);const n=[],i=hr(e);let r=E2(e,s),a=r<0?Math.pow(10,Math.abs(r)):1;const o=Math.pow(10,r),c=i>r?Math.pow(10,i):0,d=Math.round((e-c)*a)/a,u=Math.floor((e-c)/o/10)*o*10;let h=Math.floor((d-u)/Math.pow(10,r)),f=yt(t.min,Math.round((c+u+h*Math.pow(10,r))*a)/a);for(;f<s;)n.push({value:f,major:yf(f),significand:h}),h>=10?h=h<15?15:20:h++,h>=20&&(r++,h=2,a=r>=0?1:a),f=Math.round((c+u+h*Math.pow(10,r))*a)/a;const m=yt(t.max,f);return n.push({value:m,major:yf(m),significand:h}),n}class O2 extends Tn{static id="logarithmic";static defaults={ticks:{callback:go.formatters.logarithmic,major:{enabled:!0}}};constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,s){const n=Ya.prototype.parse.apply(this,[e,s]);if(n===0){this._zero=!0;return}return He(n)&&n>0?n:null}determineDataLimits(){const{min:e,max:s}=this.getMinMax(!0);this.min=He(e)?Math.max(0,e):null,this.max=He(s)?Math.max(0,s):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!He(this._userMin)&&(this.min=e===cn(this.min,0)?cn(this.min,-1):cn(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:s}=this.getUserBounds();let n=this.min,i=this.max;const r=o=>n=e?n:o,a=o=>i=s?i:o;n===i&&(n<=0?(r(1),a(10)):(r(cn(n,-1)),a(cn(i,1)))),n<=0&&r(cn(i,-1)),i<=0&&a(cn(n,1)),this.min=n,this.max=i}buildTicks(){const e=this.options,s={min:this._userMin,max:this._userMax},n=A2(s,this);return e.bounds==="ticks"&&Kp(n,this,"value"),e.reverse?(n.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),n}getLabelForValue(e){return e===void 0?"0":Tr(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=Rs(e),this._valueRange=Rs(this.max)-Rs(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(Rs(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const s=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+s*this._valueRange)}}function hc(t){const e=t.ticks;if(e.display&&t.display){const s=ct(e.backdropPadding);return re(e.font&&e.font.size,Re.font.size)+s.height}return 0}function R2(t,e,s){return s=Oe(s)?s:[s],{w:B_(t,e.string,s),h:s.length*e.lineHeight}}function vf(t,e,s,n,i){return t===n||t===i?{start:e-s/2,end:e+s/2}:t<n||t>i?{start:e-s,end:e}:{start:e,end:e+s}}function L2(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},s=Object.assign({},e),n=[],i=[],r=t._pointLabels.length,a=t.options.pointLabels,o=a.centerPointLabels?ve/r:0;for(let c=0;c<r;c++){const d=a.setContext(t.getPointLabelContext(c));i[c]=d.padding;const u=t.getPointPosition(c,t.drawingArea+i[c],o),h=Xe(d.font),f=R2(t.ctx,h,t._pointLabels[c]);n[c]=f;const m=rt(t.getIndexAngle(c)+o),p=Math.round(sd(m)),g=vf(p,u.x,f.w,0,180),x=vf(p,u.y,f.h,90,270);F2(s,e,m,g,x)}t.setCenterPoint(e.l-s.l,s.r-e.r,e.t-s.t,s.b-e.b),t._pointLabelItems=W2(t,n,i)}function F2(t,e,s,n,i){const r=Math.abs(Math.sin(s)),a=Math.abs(Math.cos(s));let o=0,c=0;n.start<e.l?(o=(e.l-n.start)/r,t.l=Math.min(t.l,e.l-o)):n.end>e.r&&(o=(n.end-e.r)/r,t.r=Math.max(t.r,e.r+o)),i.start<e.t?(c=(e.t-i.start)/a,t.t=Math.min(t.t,e.t-c)):i.end>e.b&&(c=(i.end-e.b)/a,t.b=Math.max(t.b,e.b+c))}function I2(t,e,s){const n=t.drawingArea,{extra:i,additionalAngle:r,padding:a,size:o}=s,c=t.getPointPosition(e,n+i+a,r),d=Math.round(sd(rt(c.angle+qe))),u=H2(c.y,o.h,d),h=B2(d),f=z2(c.x,o.w,h);return{visible:!0,x:c.x,y:u,textAlign:h,left:f,top:u,right:f+o.w,bottom:u+o.h}}function V2(t,e){if(!e)return!0;const{left:s,top:n,right:i,bottom:r}=t;return!(Xt({x:s,y:n},e)||Xt({x:s,y:r},e)||Xt({x:i,y:n},e)||Xt({x:i,y:r},e))}function W2(t,e,s){const n=[],i=t._pointLabels.length,r=t.options,{centerPointLabels:a,display:o}=r.pointLabels,c={extra:hc(r)/2,additionalAngle:a?ve/i:0};let d;for(let u=0;u<i;u++){c.padding=s[u],c.size=e[u];const h=I2(t,u,c);n.push(h),o==="auto"&&(h.visible=V2(h,d),h.visible&&(d=h))}return n}function B2(t){return t===0||t===180?"center":t<180?"left":"right"}function z2(t,e,s){return s==="right"?t-=e:s==="center"&&(t-=e/2),t}function H2(t,e,s){return s===90||s===270?t-=e/2:(s>270||s<90)&&(t-=e),t}function $2(t,e,s){const{left:n,top:i,right:r,bottom:a}=s,{backdropColor:o}=e;if(!ge(o)){const c=bn(e.borderRadius),d=ct(e.backdropPadding);t.fillStyle=o;const u=n-d.left,h=i-d.top,f=r-n+d.width,m=a-i+d.height;Object.values(c).some(p=>p!==0)?(t.beginPath(),dr(t,{x:u,y:h,w:f,h:m,radius:c}),t.fill()):t.fillRect(u,h,f,m)}}function Y2(t,e){const{ctx:s,options:{pointLabels:n}}=t;for(let i=e-1;i>=0;i--){const r=t._pointLabelItems[i];if(!r.visible)continue;const a=n.setContext(t.getPointLabelContext(i));$2(s,a,r);const o=Xe(a.font),{x:c,y:d,textAlign:u}=r;Sn(s,t._pointLabels[i],c,d+o.lineHeight/2,o,{color:a.color,textAlign:u,textBaseline:"middle"})}}function Yg(t,e,s,n){const{ctx:i}=t;if(s)i.arc(t.xCenter,t.yCenter,e,0,Me);else{let r=t.getPointPosition(0,e);i.moveTo(r.x,r.y);for(let a=1;a<n;a++)r=t.getPointPosition(a,e),i.lineTo(r.x,r.y)}}function U2(t,e,s,n,i){const r=t.ctx,a=e.circular,{color:o,lineWidth:c}=e;!a&&!n||!o||!c||s<0||(r.save(),r.strokeStyle=o,r.lineWidth=c,r.setLineDash(i.dash||[]),r.lineDashOffset=i.dashOffset,r.beginPath(),Yg(t,s,a,n),r.closePath(),r.stroke(),r.restore())}function G2(t,e,s){return Xs(t,{label:s,index:e,type:"pointLabel"})}class Ug extends Ya{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:go.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=ct(hc(this.options)/2),s=this.width=this.maxWidth-e.width,n=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+s/2+e.left),this.yCenter=Math.floor(this.top+n/2+e.top),this.drawingArea=Math.floor(Math.min(s,n)/2)}determineDataLimits(){const{min:e,max:s}=this.getMinMax(!1);this.min=He(e)&&!isNaN(e)?e:0,this.max=He(s)&&!isNaN(s)?s:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/hc(this.options))}generateTickLabels(e){Ya.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((s,n)=>{const i=ie(this.options.pointLabels.callback,[s,n],this);return i||i===0?i:""}).filter((s,n)=>this.chart.getDataVisibility(n))}fit(){const e=this.options;e.display&&e.pointLabels.display?L2(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,s,n,i){this.xCenter+=Math.floor((e-s)/2),this.yCenter+=Math.floor((n-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,s,n,i))}getIndexAngle(e){const s=Me/(this._pointLabels.length||1),n=this.options.startAngle||0;return rt(e*s+Lt(n))}getDistanceFromCenterForValue(e){if(ge(e))return NaN;const s=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*s:(e-this.min)*s}getValueForDistanceFromCenter(e){if(ge(e))return NaN;const s=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-s:this.min+s}getPointLabelContext(e){const s=this._pointLabels||[];if(e>=0&&e<s.length){const n=s[e];return G2(this.getContext(),e,n)}}getPointPosition(e,s,n=0){const i=this.getIndexAngle(e)-qe+n;return{x:Math.cos(i)*s+this.xCenter,y:Math.sin(i)*s+this.yCenter,angle:i}}getPointPositionForValue(e,s){return this.getPointPosition(e,this.getDistanceFromCenterForValue(s))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:s,top:n,right:i,bottom:r}=this._pointLabelItems[e];return{left:s,top:n,right:i,bottom:r}}drawBackground(){const{backgroundColor:e,grid:{circular:s}}=this.options;if(e){const n=this.ctx;n.save(),n.beginPath(),Yg(this,this.getDistanceFromCenterForValue(this._endValue),s,this._pointLabels.length),n.closePath(),n.fillStyle=e,n.fill(),n.restore()}}drawGrid(){const e=this.ctx,s=this.options,{angleLines:n,grid:i,border:r}=s,a=this._pointLabels.length;let o,c,d;if(s.pointLabels.display&&Y2(this,a),i.display&&this.ticks.forEach((u,h)=>{if(h!==0||h===0&&this.min<0){c=this.getDistanceFromCenterForValue(u.value);const f=this.getContext(h),m=i.setContext(f),p=r.setContext(f);U2(this,m,c,a,p)}}),n.display){for(e.save(),o=a-1;o>=0;o--){const u=n.setContext(this.getPointLabelContext(o)),{color:h,lineWidth:f}=u;!f||!h||(e.lineWidth=f,e.strokeStyle=h,e.setLineDash(u.borderDash),e.lineDashOffset=u.borderDashOffset,c=this.getDistanceFromCenterForValue(s.reverse?this.min:this.max),d=this.getPointPosition(o,c),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(d.x,d.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,s=this.options,n=s.ticks;if(!n.display)return;const i=this.getIndexAngle(0);let r,a;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(i),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((o,c)=>{if(c===0&&this.min>=0&&!s.reverse)return;const d=n.setContext(this.getContext(c)),u=Xe(d.font);if(r=this.getDistanceFromCenterForValue(this.ticks[c].value),d.showLabelBackdrop){e.font=u.string,a=e.measureText(o.label).width,e.fillStyle=d.backdropColor;const h=ct(d.backdropPadding);e.fillRect(-a/2-h.left,-r-u.size/2-h.top,a+h.width,u.size+h.height)}Sn(e,o.label,0,-r,u,{color:d.color,strokeColor:d.textStrokeColor,strokeWidth:d.textStrokeWidth})}),e.restore()}drawTitle(){}}const So={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},pt=Object.keys(So);function _f(t,e){return t-e}function wf(t,e){if(ge(e))return null;const s=t._adapter,{parser:n,round:i,isoWeekday:r}=t._parseOpts;let a=e;return typeof n=="function"&&(a=n(a)),He(a)||(a=typeof n=="string"?s.parse(a,n):s.parse(a)),a===null?null:(i&&(a=i==="week"&&(Zn(r)||r===!0)?s.startOf(a,"isoWeek",r):s.startOf(a,i)),+a)}function kf(t,e,s,n){const i=pt.length;for(let r=pt.indexOf(t);r<i-1;++r){const a=So[pt[r]],o=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((s-e)/(o*a.size))<=n)return pt[r]}return pt[i-1]}function q2(t,e,s,n,i){for(let r=pt.length-1;r>=pt.indexOf(s);r--){const a=pt[r];if(So[a].common&&t._adapter.diff(i,n,a)>=e-1)return a}return pt[s?pt.indexOf(s):0]}function K2(t){for(let e=pt.indexOf(t)+1,s=pt.length;e<s;++e)if(So[pt[e]].common)return pt[e]}function Sf(t,e,s){if(!s)t[e]=!0;else if(s.length){const{lo:n,hi:i}=nd(s,e),r=s[n]>=e?s[n]:s[i];t[r]=!0}}function X2(t,e,s,n){const i=t._adapter,r=+i.startOf(e[0].value,n),a=e[e.length-1].value;let o,c;for(o=r;o<=a;o=+i.add(o,1,n))c=s[o],c>=0&&(e[c].major=!0);return e}function jf(t,e,s){const n=[],i={},r=e.length;let a,o;for(a=0;a<r;++a)o=e[a],i[o]=a,n.push({value:o,major:!1});return r===0||!s?n:X2(t,n,i,s)}class Ua extends Tn{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,s={}){const n=e.time||(e.time={}),i=this._adapter=new jg._date(e.adapters.date);i.init(s),Gi(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=s.normalized}parse(e,s){return e===void 0?null:wf(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,s=this._adapter,n=e.time.unit||"day";let{min:i,max:r,minDefined:a,maxDefined:o}=this.getUserBounds();function c(d){!a&&!isNaN(d.min)&&(i=Math.min(i,d.min)),!o&&!isNaN(d.max)&&(r=Math.max(r,d.max))}(!a||!o)&&(c(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&c(this.getMinMax(!1))),i=He(i)&&!isNaN(i)?i:+s.startOf(Date.now(),n),r=He(r)&&!isNaN(r)?r:+s.endOf(Date.now(),n)+1,this.min=Math.min(i,r-1),this.max=Math.max(i+1,r)}_getLabelBounds(){const e=this.getLabelTimestamps();let s=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(s=e[0],n=e[e.length-1]),{min:s,max:n}}buildTicks(){const e=this.options,s=e.time,n=e.ticks,i=n.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const r=this.min,a=this.max,o=M_(i,r,a);return this._unit=s.unit||(n.autoSkip?kf(s.minUnit,this.min,this.max,this._getLabelCapacity(r)):q2(this,o.length,s.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:K2(this._unit),this.initOffsets(i),e.reverse&&o.reverse(),jf(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let s=0,n=0,i,r;this.options.offset&&e.length&&(i=this.getDecimalForValue(e[0]),e.length===1?s=1-i:s=(this.getDecimalForValue(e[1])-i)/2,r=this.getDecimalForValue(e[e.length-1]),e.length===1?n=r:n=(r-this.getDecimalForValue(e[e.length-2]))/2);const a=e.length<3?.5:.25;s=et(s,0,a),n=et(n,0,a),this._offsets={start:s,end:n,factor:1/(s+1+n)}}_generate(){const e=this._adapter,s=this.min,n=this.max,i=this.options,r=i.time,a=r.unit||kf(r.minUnit,s,n,this._getLabelCapacity(s)),o=re(i.ticks.stepSize,1),c=a==="week"?r.isoWeekday:!1,d=Zn(c)||c===!0,u={};let h=s,f,m;if(d&&(h=+e.startOf(h,"isoWeek",c)),h=+e.startOf(h,d?"day":a),e.diff(n,s,a)>1e5*o)throw new Error(s+" and "+n+" are too far apart with stepSize of "+o+" "+a);const p=i.ticks.source==="data"&&this.getDataTimestamps();for(f=h,m=0;f<n;f=+e.add(f,o,a),m++)Sf(u,f,p);return(f===n||i.bounds==="ticks"||m===1)&&Sf(u,f,p),Object.keys(u).sort(_f).map(g=>+g)}getLabelForValue(e){const s=this._adapter,n=this.options.time;return n.tooltipFormat?s.format(e,n.tooltipFormat):s.format(e,n.displayFormats.datetime)}format(e,s){const i=this.options.time.displayFormats,r=this._unit,a=s||i[r];return this._adapter.format(e,a)}_tickFormatFunction(e,s,n,i){const r=this.options,a=r.ticks.callback;if(a)return ie(a,[e,s,n],this);const o=r.time.displayFormats,c=this._unit,d=this._majorUnit,u=c&&o[c],h=d&&o[d],f=n[s],m=d&&h&&f&&f.major;return this._adapter.format(e,i||(m?h:u))}generateTickLabels(e){let s,n,i;for(s=0,n=e.length;s<n;++s)i=e[s],i.label=this._tickFormatFunction(i.value,s,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const s=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((s.start+n)*s.factor)}getValueForPixel(e){const s=this._offsets,n=this.getDecimalForPixel(e)/s.factor-s.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const s=this.options.ticks,n=this.ctx.measureText(e).width,i=Lt(this.isHorizontal()?s.maxRotation:s.minRotation),r=Math.cos(i),a=Math.sin(i),o=this._resolveTickFontOptions(0).size;return{w:n*r+o*a,h:n*a+o*r}}_getLabelCapacity(e){const s=this.options.time,n=s.displayFormats,i=n[s.unit]||n.millisecond,r=this._tickFormatFunction(e,0,jf(this,[e],this._majorUnit),i),a=this._getLabelSize(r),o=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return o>0?o:1}getDataTimestamps(){let e=this._cache.data||[],s,n;if(e.length)return e;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(s=0,n=i.length;s<n;++s)e=e.concat(i[s].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let s,n;if(e.length)return e;const i=this.getLabels();for(s=0,n=i.length;s<n;++s)e.push(wf(this,i[s]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Jp(e.sort(_f))}}function aa(t,e,s){let n=0,i=t.length-1,r,a,o,c;s?(e>=t[n].pos&&e<=t[i].pos&&({lo:n,hi:i}=gs(t,"pos",e)),{pos:r,time:o}=t[n],{pos:a,time:c}=t[i]):(e>=t[n].time&&e<=t[i].time&&({lo:n,hi:i}=gs(t,"time",e)),{time:r,pos:o}=t[n],{time:a,pos:c}=t[i]);const d=a-r;return d?o+(c-o)*(e-r)/d:o}class Z2 extends Ua{static id="timeseries";static defaults=Ua.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),s=this._table=this.buildLookupTable(e);this._minPos=aa(s,this.min),this._tableRange=aa(s,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:s,max:n}=this,i=[],r=[];let a,o,c,d,u;for(a=0,o=e.length;a<o;++a)d=e[a],d>=s&&d<=n&&i.push(d);if(i.length<2)return[{time:s,pos:0},{time:n,pos:1}];for(a=0,o=i.length;a<o;++a)u=i[a+1],c=i[a-1],d=i[a],Math.round((u+c)/2)!==d&&r.push({time:d,pos:a/(o-1)});return r}_generate(){const e=this.min,s=this.max;let n=super.getDataTimestamps();return(!n.includes(e)||!n.length)&&n.splice(0,0,e),(!n.includes(s)||n.length===1)&&n.push(s),n.sort((i,r)=>i-r)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const s=this.getDataTimestamps(),n=this.getLabelTimestamps();return s.length&&n.length?e=this.normalize(s.concat(n)):e=s.length?s:n,e=this._cache.all=e,e}getDecimalForValue(e){return(aa(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const s=this._offsets,n=this.getDecimalForPixel(e)/s.factor-s.end;return aa(this._table,n*this._tableRange+this._minPos,!0)}}var J2=Object.freeze({__proto__:null,CategoryScale:Mr,LinearScale:Cr,LogarithmicScale:O2,RadialLinearScale:Ug,TimeScale:Ua,TimeSeriesScale:Z2});const Q2=[aw,Lk,T2,J2];Ct.register(...Q2);var kl={exports:{}};var Nf;function eS(){return Nf||(Nf=1,(function(t){(function(e,s,n,i){var r=["","webkit","Moz","MS","ms","o"],a=s.createElement("div"),o="function",c=Math.round,d=Math.abs,u=Date.now;function h(b,w,C){return setTimeout(S(b,C),w)}function f(b,w,C){return Array.isArray(b)?(m(b,C[w],C),!0):!1}function m(b,w,C){var E;if(b)if(b.forEach)b.forEach(w,C);else if(b.length!==i)for(E=0;E<b.length;)w.call(C,b[E],E,b),E++;else for(E in b)b.hasOwnProperty(E)&&w.call(C,b[E],E,b)}function p(b,w,C){var E="DEPRECATED METHOD: "+w+`
`+C+` AT 
`;return function(){var L=new Error("get-stack-trace"),U=L&&L.stack?L.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",me=e.console&&(e.console.warn||e.console.log);return me&&me.call(e.console,E,U),b.apply(this,arguments)}}var g;typeof Object.assign!="function"?g=function(w){if(w===i||w===null)throw new TypeError("Cannot convert undefined or null to object");for(var C=Object(w),E=1;E<arguments.length;E++){var L=arguments[E];if(L!==i&&L!==null)for(var U in L)L.hasOwnProperty(U)&&(C[U]=L[U])}return C}:g=Object.assign;var x=p(function(w,C,E){for(var L=Object.keys(C),U=0;U<L.length;)(!E||E&&w[L[U]]===i)&&(w[L[U]]=C[L[U]]),U++;return w},"extend","Use `assign`."),v=p(function(w,C){return x(w,C,!0)},"merge","Use `assign`.");function _(b,w,C){var E=w.prototype,L;L=b.prototype=Object.create(E),L.constructor=b,L._super=E,C&&g(L,C)}function S(b,w){return function(){return b.apply(w,arguments)}}function N(b,w){return typeof b==o?b.apply(w&&w[0]||i,w):b}function j(b,w){return b===i?w:b}function k(b,w,C){m(O(w),function(E){b.addEventListener(E,C,!1)})}function T(b,w,C){m(O(w),function(E){b.removeEventListener(E,C,!1)})}function M(b,w){for(;b;){if(b==w)return!0;b=b.parentNode}return!1}function P(b,w){return b.indexOf(w)>-1}function O(b){return b.trim().split(/\s+/g)}function A(b,w,C){if(b.indexOf&&!C)return b.indexOf(w);for(var E=0;E<b.length;){if(C&&b[E][C]==w||!C&&b[E]===w)return E;E++}return-1}function F(b){return Array.prototype.slice.call(b,0)}function X(b,w,C){for(var E=[],L=[],U=0;U<b.length;){var me=b[U][w];A(L,me)<0&&E.push(b[U]),L[U]=me,U++}return E=E.sort(function(tt,ut){return tt[w]>ut[w]}),E}function H(b,w){for(var C,E,L=w[0].toUpperCase()+w.slice(1),U=0;U<r.length;){if(C=r[U],E=C?C+L:w,E in b)return E;U++}return i}var Z=1;function Q(){return Z++}function Y(b){var w=b.ownerDocument||b;return w.defaultView||w.parentWindow||e}var oe=/mobile|tablet|ip(ad|hone|od)|android/i,ue="ontouchstart"in e,Se=H(e,"PointerEvent")!==i,We=ue&&oe.test(navigator.userAgent),$="touch",ee="pen",D="mouse",R="kinect",B=25,ae=1,he=2,je=4,Le=8,gt=1,q=2,ke=4,Ee=8,zt=16,dt=q|ke,fe=Ee|zt,Je=dt|fe,pi=["x","y"],Qs=["clientX","clientY"];function Be(b,w){var C=this;this.manager=b,this.callback=w,this.element=b.element,this.target=b.options.inputTarget,this.domHandler=function(E){N(b.options.enable,[b])&&C.handler(E)},this.init()}Be.prototype={handler:function(){},init:function(){this.evEl&&k(this.element,this.evEl,this.domHandler),this.evTarget&&k(this.target,this.evTarget,this.domHandler),this.evWin&&k(Y(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&T(this.element,this.evEl,this.domHandler),this.evTarget&&T(this.target,this.evTarget,this.domHandler),this.evWin&&T(Y(this.element),this.evWin,this.domHandler)}};function Uo(b){var w,C=b.options.inputClass;return C?w=C:Se?w=rs:We?w=zr:ue?w=Xo:w=Ye,new w(b,Go)}function Go(b,w,C){var E=C.pointers.length,L=C.changedPointers.length,U=w&ae&&E-L===0,me=w&(je|Le)&&E-L===0;C.isFirst=!!U,C.isFinal=!!me,U&&(b.session={}),C.eventType=w,qo(b,C),b.emit("hammer.input",C),b.recognize(C),b.session.prevInput=C}function qo(b,w){var C=b.session,E=w.pointers,L=E.length;C.firstInput||(C.firstInput=Dn(w)),L>1&&!C.firstMultiple?C.firstMultiple=Dn(w):L===1&&(C.firstMultiple=!1);var U=C.firstInput,me=C.firstMultiple,Qe=me?me.center:U.center,tt=w.center=gi(E);w.timeStamp=u(),w.deltaTime=w.timeStamp-U.timeStamp,w.angle=sn(Qe,tt),w.distance=tn(Qe,tt),Ko(C,w),w.offsetDirection=Vr(w.deltaX,w.deltaY);var ut=xi(w.deltaTime,w.deltaX,w.deltaY);w.overallVelocityX=ut.x,w.overallVelocityY=ut.y,w.overallVelocity=d(ut.x)>d(ut.y)?ut.x:ut.y,w.scale=me?yi(me.pointers,E):1,w.rotation=me?Wr(me.pointers,E):0,w.maxPointers=C.prevInput?w.pointers.length>C.prevInput.maxPointers?w.pointers.length:C.prevInput.maxPointers:w.pointers.length,en(C,w);var $t=b.element;M(w.srcEvent.target,$t)&&($t=w.srcEvent.target),w.target=$t}function Ko(b,w){var C=w.center,E=b.offsetDelta||{},L=b.prevDelta||{},U=b.prevInput||{};(w.eventType===ae||U.eventType===je)&&(L=b.prevDelta={x:U.deltaX||0,y:U.deltaY||0},E=b.offsetDelta={x:C.x,y:C.y}),w.deltaX=L.x+(C.x-E.x),w.deltaY=L.y+(C.y-E.y)}function en(b,w){var C=b.lastInterval||w,E=w.timeStamp-C.timeStamp,L,U,me,Qe;if(w.eventType!=Le&&(E>B||C.velocity===i)){var tt=w.deltaX-C.deltaX,ut=w.deltaY-C.deltaY,$t=xi(E,tt,ut);U=$t.x,me=$t.y,L=d($t.x)>d($t.y)?$t.x:$t.y,Qe=Vr(tt,ut),b.lastInterval=w}else L=C.velocity,U=C.velocityX,me=C.velocityY,Qe=C.direction;w.velocity=L,w.velocityX=U,w.velocityY=me,w.direction=Qe}function Dn(b){for(var w=[],C=0;C<b.pointers.length;)w[C]={clientX:c(b.pointers[C].clientX),clientY:c(b.pointers[C].clientY)},C++;return{timeStamp:u(),pointers:w,center:gi(w),deltaX:b.deltaX,deltaY:b.deltaY}}function gi(b){var w=b.length;if(w===1)return{x:c(b[0].clientX),y:c(b[0].clientY)};for(var C=0,E=0,L=0;L<w;)C+=b[L].clientX,E+=b[L].clientY,L++;return{x:c(C/w),y:c(E/w)}}function xi(b,w,C){return{x:w/b||0,y:C/b||0}}function Vr(b,w){return b===w?gt:d(b)>=d(w)?b<0?q:ke:w<0?Ee:zt}function tn(b,w,C){C||(C=pi);var E=w[C[0]]-b[C[0]],L=w[C[1]]-b[C[1]];return Math.sqrt(E*E+L*L)}function sn(b,w,C){C||(C=pi);var E=w[C[0]]-b[C[0]],L=w[C[1]]-b[C[1]];return Math.atan2(L,E)*180/Math.PI}function Wr(b,w){return sn(w[1],w[0],Qs)+sn(b[1],b[0],Qs)}function yi(b,w){return tn(w[0],w[1],Qs)/tn(b[0],b[1],Qs)}var z={mousedown:ae,mousemove:he,mouseup:je},V="mousedown",Te="mousemove mouseup";function Ye(){this.evEl=V,this.evWin=Te,this.pressed=!1,Be.apply(this,arguments)}_(Ye,Be,{handler:function(w){var C=z[w.type];C&ae&&w.button===0&&(this.pressed=!0),C&he&&w.which!==1&&(C=je),this.pressed&&(C&je&&(this.pressed=!1),this.callback(this.manager,C,{pointers:[w],changedPointers:[w],pointerType:D,srcEvent:w}))}});var Cs={pointerdown:ae,pointermove:he,pointerup:je,pointercancel:Le,pointerout:Le},nn={2:$,3:ee,4:D,5:R},is="pointerdown",xt="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(is="MSPointerDown",xt="MSPointerMove MSPointerUp MSPointerCancel");function rs(){this.evEl=is,this.evWin=xt,Be.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}_(rs,Be,{handler:function(w){var C=this.store,E=!1,L=w.type.toLowerCase().replace("ms",""),U=Cs[L],me=nn[w.pointerType]||w.pointerType,Qe=me==$,tt=A(C,w.pointerId,"pointerId");U&ae&&(w.button===0||Qe)?tt<0&&(C.push(w),tt=C.length-1):U&(je|Le)&&(E=!0),!(tt<0)&&(C[tt]=w,this.callback(this.manager,U,{pointers:C,changedPointers:[w],pointerType:me,srcEvent:w}),E&&C.splice(tt,1))}});var Et={touchstart:ae,touchmove:he,touchend:je,touchcancel:Le},Br="touchstart",nb="touchstart touchmove touchend touchcancel";function Pu(){this.evTarget=Br,this.evWin=nb,this.started=!1,Be.apply(this,arguments)}_(Pu,Be,{handler:function(w){var C=Et[w.type];if(C===ae&&(this.started=!0),!!this.started){var E=ib.call(this,w,C);C&(je|Le)&&E[0].length-E[1].length===0&&(this.started=!1),this.callback(this.manager,C,{pointers:E[0],changedPointers:E[1],pointerType:$,srcEvent:w})}}});function ib(b,w){var C=F(b.touches),E=F(b.changedTouches);return w&(je|Le)&&(C=X(C.concat(E),"identifier")),[C,E]}var rb={touchstart:ae,touchmove:he,touchend:je,touchcancel:Le},ab="touchstart touchmove touchend touchcancel";function zr(){this.evTarget=ab,this.targetIds={},Be.apply(this,arguments)}_(zr,Be,{handler:function(w){var C=rb[w.type],E=ob.call(this,w,C);E&&this.callback(this.manager,C,{pointers:E[0],changedPointers:E[1],pointerType:$,srcEvent:w})}});function ob(b,w){var C=F(b.touches),E=this.targetIds;if(w&(ae|he)&&C.length===1)return E[C[0].identifier]=!0,[C,C];var L,U,me=F(b.changedTouches),Qe=[],tt=this.target;if(U=C.filter(function(ut){return M(ut.target,tt)}),w===ae)for(L=0;L<U.length;)E[U[L].identifier]=!0,L++;for(L=0;L<me.length;)E[me[L].identifier]&&Qe.push(me[L]),w&(je|Le)&&delete E[me[L].identifier],L++;if(Qe.length)return[X(U.concat(Qe),"identifier"),Qe]}var lb=2500,Du=25;function Xo(){Be.apply(this,arguments);var b=S(this.handler,this);this.touch=new zr(this.manager,b),this.mouse=new Ye(this.manager,b),this.primaryTouch=null,this.lastTouches=[]}_(Xo,Be,{handler:function(w,C,E){var L=E.pointerType==$,U=E.pointerType==D;if(!(U&&E.sourceCapabilities&&E.sourceCapabilities.firesTouchEvents)){if(L)cb.call(this,C,E);else if(U&&db.call(this,E))return;this.callback(w,C,E)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function cb(b,w){b&ae?(this.primaryTouch=w.changedPointers[0].identifier,Eu.call(this,w)):b&(je|Le)&&Eu.call(this,w)}function Eu(b){var w=b.changedPointers[0];if(w.identifier===this.primaryTouch){var C={x:w.clientX,y:w.clientY};this.lastTouches.push(C);var E=this.lastTouches,L=function(){var U=E.indexOf(C);U>-1&&E.splice(U,1)};setTimeout(L,lb)}}function db(b){for(var w=b.srcEvent.clientX,C=b.srcEvent.clientY,E=0;E<this.lastTouches.length;E++){var L=this.lastTouches[E],U=Math.abs(w-L.x),me=Math.abs(C-L.y);if(U<=Du&&me<=Du)return!0}return!1}var Au=H(a.style,"touchAction"),Ou=Au!==i,Ru="compute",Lu="auto",Zo="manipulation",rn="none",bi="pan-x",vi="pan-y",Hr=hb();function Jo(b,w){this.manager=b,this.set(w)}Jo.prototype={set:function(b){b==Ru&&(b=this.compute()),Ou&&this.manager.element.style&&Hr[b]&&(this.manager.element.style[Au]=b),this.actions=b.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var b=[];return m(this.manager.recognizers,function(w){N(w.options.enable,[w])&&(b=b.concat(w.getTouchAction()))}),ub(b.join(" "))},preventDefaults:function(b){var w=b.srcEvent,C=b.offsetDirection;if(this.manager.session.prevented){w.preventDefault();return}var E=this.actions,L=P(E,rn)&&!Hr[rn],U=P(E,vi)&&!Hr[vi],me=P(E,bi)&&!Hr[bi];if(L){var Qe=b.pointers.length===1,tt=b.distance<2,ut=b.deltaTime<250;if(Qe&&tt&&ut)return}if(!(me&&U)&&(L||U&&C&dt||me&&C&fe))return this.preventSrc(w)},preventSrc:function(b){this.manager.session.prevented=!0,b.preventDefault()}};function ub(b){if(P(b,rn))return rn;var w=P(b,bi),C=P(b,vi);return w&&C?rn:w||C?w?bi:vi:P(b,Zo)?Zo:Lu}function hb(){if(!Ou)return!1;var b={},w=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(C){b[C]=w?e.CSS.supports("touch-action",C):!0}),b}var $r=1,wt=2,En=4,Ps=8,as=Ps,_i=16,Ht=32;function os(b){this.options=g({},this.defaults,b||{}),this.id=Q(),this.manager=null,this.options.enable=j(this.options.enable,!0),this.state=$r,this.simultaneous={},this.requireFail=[]}os.prototype={defaults:{},set:function(b){return g(this.options,b),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(b){if(f(b,"recognizeWith",this))return this;var w=this.simultaneous;return b=Yr(b,this),w[b.id]||(w[b.id]=b,b.recognizeWith(this)),this},dropRecognizeWith:function(b){return f(b,"dropRecognizeWith",this)?this:(b=Yr(b,this),delete this.simultaneous[b.id],this)},requireFailure:function(b){if(f(b,"requireFailure",this))return this;var w=this.requireFail;return b=Yr(b,this),A(w,b)===-1&&(w.push(b),b.requireFailure(this)),this},dropRequireFailure:function(b){if(f(b,"dropRequireFailure",this))return this;b=Yr(b,this);var w=A(this.requireFail,b);return w>-1&&this.requireFail.splice(w,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(b){return!!this.simultaneous[b.id]},emit:function(b){var w=this,C=this.state;function E(L){w.manager.emit(L,b)}C<Ps&&E(w.options.event+Fu(C)),E(w.options.event),b.additionalEvent&&E(b.additionalEvent),C>=Ps&&E(w.options.event+Fu(C))},tryEmit:function(b){if(this.canEmit())return this.emit(b);this.state=Ht},canEmit:function(){for(var b=0;b<this.requireFail.length;){if(!(this.requireFail[b].state&(Ht|$r)))return!1;b++}return!0},recognize:function(b){var w=g({},b);if(!N(this.options.enable,[this,w])){this.reset(),this.state=Ht;return}this.state&(as|_i|Ht)&&(this.state=$r),this.state=this.process(w),this.state&(wt|En|Ps|_i)&&this.tryEmit(w)},process:function(b){},getTouchAction:function(){},reset:function(){}};function Fu(b){return b&_i?"cancel":b&Ps?"end":b&En?"move":b&wt?"start":""}function Iu(b){return b==zt?"down":b==Ee?"up":b==q?"left":b==ke?"right":""}function Yr(b,w){var C=w.manager;return C?C.get(b):b}function At(){os.apply(this,arguments)}_(At,os,{defaults:{pointers:1},attrTest:function(b){var w=this.options.pointers;return w===0||b.pointers.length===w},process:function(b){var w=this.state,C=b.eventType,E=w&(wt|En),L=this.attrTest(b);return E&&(C&Le||!L)?w|_i:E||L?C&je?w|Ps:w&wt?w|En:wt:Ht}});function Ur(){At.apply(this,arguments),this.pX=null,this.pY=null}_(Ur,At,{defaults:{event:"pan",threshold:10,pointers:1,direction:Je},getTouchAction:function(){var b=this.options.direction,w=[];return b&dt&&w.push(vi),b&fe&&w.push(bi),w},directionTest:function(b){var w=this.options,C=!0,E=b.distance,L=b.direction,U=b.deltaX,me=b.deltaY;return L&w.direction||(w.direction&dt?(L=U===0?gt:U<0?q:ke,C=U!=this.pX,E=Math.abs(b.deltaX)):(L=me===0?gt:me<0?Ee:zt,C=me!=this.pY,E=Math.abs(b.deltaY))),b.direction=L,C&&E>w.threshold&&L&w.direction},attrTest:function(b){return At.prototype.attrTest.call(this,b)&&(this.state&wt||!(this.state&wt)&&this.directionTest(b))},emit:function(b){this.pX=b.deltaX,this.pY=b.deltaY;var w=Iu(b.direction);w&&(b.additionalEvent=this.options.event+w),this._super.emit.call(this,b)}});function Qo(){At.apply(this,arguments)}_(Qo,At,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[rn]},attrTest:function(b){return this._super.attrTest.call(this,b)&&(Math.abs(b.scale-1)>this.options.threshold||this.state&wt)},emit:function(b){if(b.scale!==1){var w=b.scale<1?"in":"out";b.additionalEvent=this.options.event+w}this._super.emit.call(this,b)}});function el(){os.apply(this,arguments),this._timer=null,this._input=null}_(el,os,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Lu]},process:function(b){var w=this.options,C=b.pointers.length===w.pointers,E=b.distance<w.threshold,L=b.deltaTime>w.time;if(this._input=b,!E||!C||b.eventType&(je|Le)&&!L)this.reset();else if(b.eventType&ae)this.reset(),this._timer=h(function(){this.state=as,this.tryEmit()},w.time,this);else if(b.eventType&je)return as;return Ht},reset:function(){clearTimeout(this._timer)},emit:function(b){this.state===as&&(b&&b.eventType&je?this.manager.emit(this.options.event+"up",b):(this._input.timeStamp=u(),this.manager.emit(this.options.event,this._input)))}});function tl(){At.apply(this,arguments)}_(tl,At,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[rn]},attrTest:function(b){return this._super.attrTest.call(this,b)&&(Math.abs(b.rotation)>this.options.threshold||this.state&wt)}});function sl(){At.apply(this,arguments)}_(sl,At,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:dt|fe,pointers:1},getTouchAction:function(){return Ur.prototype.getTouchAction.call(this)},attrTest:function(b){var w=this.options.direction,C;return w&(dt|fe)?C=b.overallVelocity:w&dt?C=b.overallVelocityX:w&fe&&(C=b.overallVelocityY),this._super.attrTest.call(this,b)&&w&b.offsetDirection&&b.distance>this.options.threshold&&b.maxPointers==this.options.pointers&&d(C)>this.options.velocity&&b.eventType&je},emit:function(b){var w=Iu(b.offsetDirection);w&&this.manager.emit(this.options.event+w,b),this.manager.emit(this.options.event,b)}});function Gr(){os.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}_(Gr,os,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Zo]},process:function(b){var w=this.options,C=b.pointers.length===w.pointers,E=b.distance<w.threshold,L=b.deltaTime<w.time;if(this.reset(),b.eventType&ae&&this.count===0)return this.failTimeout();if(E&&L&&C){if(b.eventType!=je)return this.failTimeout();var U=this.pTime?b.timeStamp-this.pTime<w.interval:!0,me=!this.pCenter||tn(this.pCenter,b.center)<w.posThreshold;this.pTime=b.timeStamp,this.pCenter=b.center,!me||!U?this.count=1:this.count+=1,this._input=b;var Qe=this.count%w.taps;if(Qe===0)return this.hasRequireFailures()?(this._timer=h(function(){this.state=as,this.tryEmit()},w.interval,this),wt):as}return Ht},failTimeout:function(){return this._timer=h(function(){this.state=Ht},this.options.interval,this),Ht},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==as&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Ds(b,w){return w=w||{},w.recognizers=j(w.recognizers,Ds.defaults.preset),new nl(b,w)}Ds.VERSION="2.0.7",Ds.defaults={domEvents:!1,touchAction:Ru,enable:!0,inputTarget:null,inputClass:null,preset:[[tl,{enable:!1}],[Qo,{enable:!1},["rotate"]],[sl,{direction:dt}],[Ur,{direction:dt},["swipe"]],[Gr],[Gr,{event:"doubletap",taps:2},["tap"]],[el]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var fb=1,Vu=2;function nl(b,w){this.options=g({},Ds.defaults,w||{}),this.options.inputTarget=this.options.inputTarget||b,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=b,this.input=Uo(this),this.touchAction=new Jo(this,this.options.touchAction),Wu(this,!0),m(this.options.recognizers,function(C){var E=this.add(new C[0](C[1]));C[2]&&E.recognizeWith(C[2]),C[3]&&E.requireFailure(C[3])},this)}nl.prototype={set:function(b){return g(this.options,b),b.touchAction&&this.touchAction.update(),b.inputTarget&&(this.input.destroy(),this.input.target=b.inputTarget,this.input.init()),this},stop:function(b){this.session.stopped=b?Vu:fb},recognize:function(b){var w=this.session;if(!w.stopped){this.touchAction.preventDefaults(b);var C,E=this.recognizers,L=w.curRecognizer;(!L||L&&L.state&as)&&(L=w.curRecognizer=null);for(var U=0;U<E.length;)C=E[U],w.stopped!==Vu&&(!L||C==L||C.canRecognizeWith(L))?C.recognize(b):C.reset(),!L&&C.state&(wt|En|Ps)&&(L=w.curRecognizer=C),U++}},get:function(b){if(b instanceof os)return b;for(var w=this.recognizers,C=0;C<w.length;C++)if(w[C].options.event==b)return w[C];return null},add:function(b){if(f(b,"add",this))return this;var w=this.get(b.options.event);return w&&this.remove(w),this.recognizers.push(b),b.manager=this,this.touchAction.update(),b},remove:function(b){if(f(b,"remove",this))return this;if(b=this.get(b),b){var w=this.recognizers,C=A(w,b);C!==-1&&(w.splice(C,1),this.touchAction.update())}return this},on:function(b,w){if(b!==i&&w!==i){var C=this.handlers;return m(O(b),function(E){C[E]=C[E]||[],C[E].push(w)}),this}},off:function(b,w){if(b!==i){var C=this.handlers;return m(O(b),function(E){w?C[E]&&C[E].splice(A(C[E],w),1):delete C[E]}),this}},emit:function(b,w){this.options.domEvents&&mb(b,w);var C=this.handlers[b]&&this.handlers[b].slice();if(!(!C||!C.length)){w.type=b,w.preventDefault=function(){w.srcEvent.preventDefault()};for(var E=0;E<C.length;)C[E](w),E++}},destroy:function(){this.element&&Wu(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Wu(b,w){var C=b.element;if(C.style){var E;m(b.options.cssProps,function(L,U){E=H(C.style,U),w?(b.oldCssProps[E]=C.style[E],C.style[E]=L):C.style[E]=b.oldCssProps[E]||""}),w||(b.oldCssProps={})}}function mb(b,w){var C=s.createEvent("Event");C.initEvent(b,!0,!0),C.gesture=w,w.target.dispatchEvent(C)}g(Ds,{INPUT_START:ae,INPUT_MOVE:he,INPUT_END:je,INPUT_CANCEL:Le,STATE_POSSIBLE:$r,STATE_BEGAN:wt,STATE_CHANGED:En,STATE_ENDED:Ps,STATE_RECOGNIZED:as,STATE_CANCELLED:_i,STATE_FAILED:Ht,DIRECTION_NONE:gt,DIRECTION_LEFT:q,DIRECTION_RIGHT:ke,DIRECTION_UP:Ee,DIRECTION_DOWN:zt,DIRECTION_HORIZONTAL:dt,DIRECTION_VERTICAL:fe,DIRECTION_ALL:Je,Manager:nl,Input:Be,TouchAction:Jo,TouchInput:zr,MouseInput:Ye,PointerEventInput:rs,TouchMouseInput:Xo,SingleTouchInput:Pu,Recognizer:os,AttrRecognizer:At,Tap:Gr,Pan:Ur,Swipe:sl,Pinch:Qo,Rotate:tl,Press:el,on:k,off:T,each:m,merge:v,extend:x,assign:g,inherit:_,bindFn:S,prefixed:H});var pb=typeof e<"u"?e:typeof self<"u"?self:{};pb.Hammer=Ds,t.exports?t.exports=Ds:e[n]=Ds})(window,document,"Hammer")})(kl)),kl.exports}var tS=eS();const Xi=yb(tS);const fr=t=>t&&t.enabled&&t.modifierKey,Gg=(t,e)=>t&&e[t+"Key"],gd=(t,e)=>t&&!e[t+"Key"];function Us(t,e,s){return t===void 0?!0:typeof t=="string"?t.indexOf(e)!==-1:typeof t=="function"?t({chart:s}).indexOf(e)!==-1:!1}function Sl(t,e){return typeof t=="function"&&(t=t({chart:e})),typeof t=="string"?{x:t.indexOf("x")!==-1,y:t.indexOf("y")!==-1}:{x:!1,y:!1}}function sS(t,e){let s;return function(){return clearTimeout(s),s=setTimeout(t,e),e}}function nS({x:t,y:e},s){const n=s.scales,i=Object.keys(n);for(let r=0;r<i.length;r++){const a=n[i[r]];if(e>=a.top&&e<=a.bottom&&t>=a.left&&t<=a.right)return a}return null}function qg(t,e,s){const{mode:n="xy",scaleMode:i,overScaleMode:r}=t||{},a=nS(e,s),o=Sl(n,s),c=Sl(i,s);if(r){const u=Sl(r,s);for(const h of["x","y"])u[h]&&(c[h]=o[h],o[h]=!1)}if(a&&c[a.axis])return[a];const d=[];return pe(s.scales,function(u){o[u.axis]&&d.push(u)}),d}const fc=new WeakMap;function Ve(t){let e=fc.get(t);return e||(e={originalScaleLimits:{},updatedScaleLimits:{},handlers:{},panDelta:{},dragging:!1,panning:!1},fc.set(t,e)),e}function iS(t){fc.delete(t)}function Kg(t,e,s,n){const i=Math.max(0,Math.min(1,(t-e)/s||0)),r=1-i;return{min:n*i,max:n*r}}function Xg(t,e){const s=t.isHorizontal()?e.x:e.y;return t.getValueForPixel(s)}function Zg(t,e,s){const n=t.max-t.min,i=n*(e-1),r=Xg(t,s);return Kg(r,t.min,n,i)}function rS(t,e,s){const n=Xg(t,s);if(n===void 0)return{min:t.min,max:t.max};const i=Math.log10(t.min),r=Math.log10(t.max),a=Math.log10(n),o=r-i,c=o*(e-1),d=Kg(a,i,o,c);return{min:Math.pow(10,i+d.min),max:Math.pow(10,r-d.max)}}function aS(t,e){return e&&(e[t.id]||e[t.axis])||{}}function Tf(t,e,s,n,i){let r=s[n];if(r==="original"){const a=t.originalScaleLimits[e.id][n];r=re(a.options,a.scale)}return re(r,i)}function oS(t,e,s){const n=t.getValueForPixel(e),i=t.getValueForPixel(s);return{min:Math.min(n,i),max:Math.max(n,i)}}function lS(t,{min:e,max:s,minLimit:n,maxLimit:i},r){const a=(t-s+e)/2;e-=a,s+=a;const o=r.min.options??r.min.scale,c=r.max.options??r.max.scale,d=t/1e6;return yn(e,o,d)&&(e=o),yn(s,c,d)&&(s=c),e<n?(e=n,s=Math.min(n+t,i)):s>i&&(s=i,e=Math.max(i-t,n)),{min:e,max:s}}function Mn(t,{min:e,max:s},n,i=!1){const r=Ve(t.chart),{options:a}=t,o=aS(t,n),{minRange:c=0}=o,d=Tf(r,t,o,"min",-1/0),u=Tf(r,t,o,"max",1/0);if(i==="pan"&&(e<d||s>u))return!0;const h=t.max-t.min,f=i?Math.max(s-e,c):h;if(i&&f===c&&h<=c)return!0;const m=lS(f,{min:e,max:s,minLimit:d,maxLimit:u},r.originalScaleLimits[t.id]);return a.min=m.min,a.max=m.max,r.updatedScaleLimits[t.id]=m,t.parse(m.min)!==t.min||t.parse(m.max)!==t.max}function cS(t,e,s,n){const i=Zg(t,e,s),r={min:t.min+i.min,max:t.max-i.max};return Mn(t,r,n,!0)}function dS(t,e,s,n){const i=rS(t,e,s);return Mn(t,i,n,!0)}function uS(t,e,s,n){Mn(t,oS(t,e,s),n,!0)}const Mf=t=>t===0||isNaN(t)?0:t<0?Math.min(Math.round(t),-1):Math.max(Math.round(t),1);function hS(t){const s=t.getLabels().length-1;t.min>0&&(t.min-=1),t.max<s&&(t.max+=1)}function fS(t,e,s,n){const i=Zg(t,e,s);t.min===t.max&&e<1&&hS(t);const r={min:t.min+Mf(i.min),max:t.max-Mf(i.max)};return Mn(t,r,n,!0)}function mS(t){return t.isHorizontal()?t.width:t.height}function pS(t,e,s){const i=t.getLabels().length-1;let{min:r,max:a}=t;const o=Math.max(a-r,1),c=Math.round(mS(t)/Math.max(o,10)),d=Math.round(Math.abs(e/c));let u;return e<-c?(a=Math.min(a+d,i),r=o===1?a:a-o,u=a===i):e>c&&(r=Math.max(0,r-d),a=o===1?r:r+o,u=r===0),Mn(t,{min:r,max:a},s)||u}const gS={second:500,minute:30*1e3,hour:1800*1e3,day:720*60*1e3,week:3.5*24*60*60*1e3,month:360*60*60*1e3,quarter:1440*60*60*1e3,year:4368*60*60*1e3};function Jg(t,e,s,n=!1){const{min:i,max:r,options:a}=t,o=a.time&&a.time.round,c=gS[o]||0,d=t.getValueForPixel(t.getPixelForValue(i+c)-e),u=t.getValueForPixel(t.getPixelForValue(r+c)-e);return isNaN(d)||isNaN(u)?!0:Mn(t,{min:d,max:u},s,n?"pan":!1)}function Cf(t,e,s){return Jg(t,e,s,!0)}const mc={category:fS,default:cS,logarithmic:dS},pc={default:uS},gc={category:pS,default:Jg,logarithmic:Cf,timeseries:Cf};function xS(t,e,s){const{id:n,options:{min:i,max:r}}=t;if(!e[n]||!s[n])return!0;const a=s[n];return a.min!==i||a.max!==r}function Pf(t,e){pe(t,(s,n)=>{e[n]||delete t[n]})}function li(t,e){const{scales:s}=t,{originalScaleLimits:n,updatedScaleLimits:i}=e;return pe(s,function(r){xS(r,n,i)&&(n[r.id]={min:{scale:r.min,options:r.options.min},max:{scale:r.max,options:r.options.max}})}),Pf(n,s),Pf(i,s),n}function Df(t,e,s,n){const i=mc[t.type]||mc.default;ie(i,[t,e,s,n])}function Ef(t,e,s,n){const i=pc[t.type]||pc.default;ie(i,[t,e,s,n])}function yS(t){const e=t.chartArea;return{x:(e.left+e.right)/2,y:(e.top+e.bottom)/2}}function xd(t,e,s="none",n="api"){const{x:i=1,y:r=1,focalPoint:a=yS(t)}=typeof e=="number"?{x:e,y:e}:e,o=Ve(t),{options:{limits:c,zoom:d}}=o;li(t,o);const u=i!==1,h=r!==1,f=qg(d,a,t);pe(f||t.scales,function(m){m.isHorizontal()&&u?Df(m,i,a,c):!m.isHorizontal()&&h&&Df(m,r,a,c)}),t.update(s),ie(d.onZoom,[{chart:t,trigger:n}])}function Qg(t,e,s,n="none",i="api"){const r=Ve(t),{options:{limits:a,zoom:o}}=r,{mode:c="xy"}=o;li(t,r);const d=Us(c,"x",t),u=Us(c,"y",t);pe(t.scales,function(h){h.isHorizontal()&&d?Ef(h,e.x,s.x,a):!h.isHorizontal()&&u&&Ef(h,e.y,s.y,a)}),t.update(n),ie(o.onZoom,[{chart:t,trigger:i}])}function bS(t,e,s,n="none",i="api"){const r=Ve(t);li(t,r);const a=t.scales[e];Mn(a,s,void 0,!0),t.update(n),ie(r.options.zoom?.onZoom,[{chart:t,trigger:i}])}function vS(t,e="default"){const s=Ve(t),n=li(t,s);pe(t.scales,function(i){const r=i.options;n[i.id]?(r.min=n[i.id].min.options,r.max=n[i.id].max.options):(delete r.min,delete r.max),delete s.updatedScaleLimits[i.id]}),t.update(e),ie(s.options.zoom.onZoomComplete,[{chart:t}])}function _S(t,e){const s=t.originalScaleLimits[e];if(!s)return;const{min:n,max:i}=s;return re(i.options,i.scale)-re(n.options,n.scale)}function wS(t){const e=Ve(t);let s=1,n=1;return pe(t.scales,function(i){const r=_S(e,i.id);if(r){const a=Math.round(r/(i.max-i.min)*100)/100;s=Math.min(s,a),n=Math.max(n,a)}}),s<1?s:n}function Af(t,e,s,n){const{panDelta:i}=n,r=i[t.id]||0;Mt(r)===Mt(e)&&(e+=r);const a=gc[t.type]||gc.default;ie(a,[t,e,s])?i[t.id]=0:i[t.id]=e}function ex(t,e,s,n="none"){const{x:i=0,y:r=0}=typeof e=="number"?{x:e,y:e}:e,a=Ve(t),{options:{pan:o,limits:c}}=a,{onPan:d}=o||{};li(t,a);const u=i!==0,h=r!==0;pe(s||t.scales,function(f){f.isHorizontal()&&u?Af(f,i,c,a):!f.isHorizontal()&&h&&Af(f,r,c,a)}),t.update(n),ie(d,[{chart:t}])}function tx(t){const e=Ve(t);li(t,e);const s={};for(const n of Object.keys(t.scales)){const{min:i,max:r}=e.originalScaleLimits[n]||{min:{},max:{}};s[n]={min:i.scale,max:r.scale}}return s}function kS(t){const e=Ve(t),s={};for(const n of Object.keys(t.scales))s[n]=e.updatedScaleLimits[n];return s}function SS(t){const e=tx(t);for(const s of Object.keys(t.scales)){const{min:n,max:i}=e[s];if(n!==void 0&&t.scales[s].min!==n||i!==void 0&&t.scales[s].max!==i)return!0}return!1}function Of(t){const e=Ve(t);return e.panning||e.dragging}const Rf=(t,e,s)=>Math.min(s,Math.max(e,t));function mt(t,e){const{handlers:s}=Ve(t),n=s[e];n&&n.target&&(n.target.removeEventListener(e,n),delete s[e])}function Zi(t,e,s,n){const{handlers:i,options:r}=Ve(t),a=i[s];if(a&&a.target===e)return;mt(t,s),i[s]=c=>n(t,c,r),i[s].target=e;const o=s==="wheel"?!1:void 0;e.addEventListener(s,i[s],{passive:o})}function jS(t,e){const s=Ve(t);s.dragStart&&(s.dragging=!0,s.dragEnd=e,t.update("none"))}function NS(t,e){const s=Ve(t);!s.dragStart||e.key!=="Escape"||(mt(t,"keydown"),s.dragging=!1,s.dragStart=s.dragEnd=null,t.update("none"))}function xc(t,e){if(t.target!==e.canvas){const s=e.canvas.getBoundingClientRect();return{x:t.clientX-s.left,y:t.clientY-s.top}}return qt(t,e)}function sx(t,e,s){const{onZoomStart:n,onZoomRejected:i}=s;if(n){const r=xc(e,t);if(ie(n,[{chart:t,event:e,point:r}])===!1)return ie(i,[{chart:t,event:e}]),!1}}function TS(t,e){if(t.legend){const r=qt(e,t);if(Xt(r,t.legend))return}const s=Ve(t),{pan:n,zoom:i={}}=s.options;if(e.button!==0||Gg(fr(n),e)||gd(fr(i.drag),e))return ie(i.onZoomRejected,[{chart:t,event:e}]);sx(t,e,i)!==!1&&(s.dragStart=e,Zi(t,t.canvas.ownerDocument,"mousemove",jS),Zi(t,window.document,"keydown",NS))}function MS({begin:t,end:e},s){let n=e.x-t.x,i=e.y-t.y;const r=Math.abs(n/i);r>s?n=Math.sign(n)*Math.abs(i*s):r<s&&(i=Math.sign(i)*Math.abs(n/s)),e.x=t.x+n,e.y=t.y+i}function Lf(t,e,s,{min:n,max:i,prop:r}){t[n]=Rf(Math.min(s.begin[r],s.end[r]),e[n],e[i]),t[i]=Rf(Math.max(s.begin[r],s.end[r]),e[n],e[i])}function CS(t,e,s){const n={begin:xc(e.dragStart,t),end:xc(e.dragEnd,t)};if(s){const i=t.chartArea.width/t.chartArea.height;MS(n,i)}return n}function nx(t,e,s,n){const i=Us(e,"x",t),r=Us(e,"y",t),{top:a,left:o,right:c,bottom:d,width:u,height:h}=t.chartArea,f={top:a,left:o,right:c,bottom:d},m=CS(t,s,n&&i&&r);i&&Lf(f,t.chartArea,m,{min:"left",max:"right",prop:"x"}),r&&Lf(f,t.chartArea,m,{min:"top",max:"bottom",prop:"y"});const p=f.right-f.left,g=f.bottom-f.top;return{...f,width:p,height:g,zoomX:i&&p?1+(u-p)/u:1,zoomY:r&&g?1+(h-g)/h:1}}function PS(t,e){const s=Ve(t);if(!s.dragStart)return;mt(t,"mousemove");const{mode:n,onZoomComplete:i,drag:{threshold:r=0,maintainAspectRatio:a}}=s.options.zoom,o=nx(t,n,{dragStart:s.dragStart,dragEnd:e},a),c=Us(n,"x",t)?o.width:0,d=Us(n,"y",t)?o.height:0,u=Math.sqrt(c*c+d*d);if(s.dragStart=s.dragEnd=null,u<=r){s.dragging=!1,t.update("none");return}Qg(t,{x:o.left,y:o.top},{x:o.right,y:o.bottom},"zoom","drag"),s.dragging=!1,s.filterNextClick=!0,ie(i,[{chart:t}])}function DS(t,e,s){if(gd(fr(s.wheel),e)){ie(s.onZoomRejected,[{chart:t,event:e}]);return}if(sx(t,e,s)!==!1&&(e.cancelable&&e.preventDefault(),e.deltaY!==void 0))return!0}function ES(t,e){const{handlers:{onZoomComplete:s},options:{zoom:n}}=Ve(t);if(!DS(t,e,n))return;const i=e.target.getBoundingClientRect(),r=n.wheel.speed,a=e.deltaY>=0?2-1/(1-r):1+r,o={x:a,y:a,focalPoint:{x:e.clientX-i.left,y:e.clientY-i.top}};xd(t,o,"zoom","wheel"),ie(s,[{chart:t}])}function AS(t,e,s,n){s&&(Ve(t).handlers[e]=sS(()=>ie(s,[{chart:t}]),n))}function OS(t,e){const s=t.canvas,{wheel:n,drag:i,onZoomComplete:r}=e.zoom;n.enabled?(Zi(t,s,"wheel",ES),AS(t,"onZoomComplete",r,250)):mt(t,"wheel"),i.enabled?(Zi(t,s,"mousedown",TS),Zi(t,s.ownerDocument,"mouseup",PS)):(mt(t,"mousedown"),mt(t,"mousemove"),mt(t,"mouseup"),mt(t,"keydown"))}function RS(t){mt(t,"mousedown"),mt(t,"mousemove"),mt(t,"mouseup"),mt(t,"wheel"),mt(t,"click"),mt(t,"keydown")}function LS(t,e){return function(s,n){const{pan:i,zoom:r={}}=e.options;if(!i||!i.enabled)return!1;const a=n&&n.srcEvent;return a&&!e.panning&&n.pointerType==="mouse"&&(gd(fr(i),a)||Gg(fr(r.drag),a))?(ie(i.onPanRejected,[{chart:t,event:n}]),!1):!0}}function FS(t,e){const s=Math.abs(t.clientX-e.clientX),n=Math.abs(t.clientY-e.clientY),i=s/n;let r,a;return i>.3&&i<1.7?r=a=!0:s>n?r=!0:a=!0,{x:r,y:a}}function ix(t,e,s){if(e.scale){const{center:n,pointers:i}=s,r=1/e.scale*s.scale,a=s.target.getBoundingClientRect(),o=FS(i[0],i[1]),c=e.options.zoom.mode,d={x:o.x&&Us(c,"x",t)?r:1,y:o.y&&Us(c,"y",t)?r:1,focalPoint:{x:n.x-a.left,y:n.y-a.top}};xd(t,d,"zoom","pinch"),e.scale=s.scale}}function IS(t,e,s){if(e.options.zoom.pinch.enabled){const n=qt(s,t);ie(e.options.zoom.onZoomStart,[{chart:t,event:s,point:n}])===!1?(e.scale=null,ie(e.options.zoom.onZoomRejected,[{chart:t,event:s}])):e.scale=1}}function VS(t,e,s){e.scale&&(ix(t,e,s),e.scale=null,ie(e.options.zoom.onZoomComplete,[{chart:t}]))}function rx(t,e,s){const n=e.delta;n&&(e.panning=!0,ex(t,{x:s.deltaX-n.x,y:s.deltaY-n.y},e.panScales),e.delta={x:s.deltaX,y:s.deltaY})}function WS(t,e,s){const{enabled:n,onPanStart:i,onPanRejected:r}=e.options.pan;if(!n)return;const a=s.target.getBoundingClientRect(),o={x:s.center.x-a.left,y:s.center.y-a.top};if(ie(i,[{chart:t,event:s,point:o}])===!1)return ie(r,[{chart:t,event:s}]);e.panScales=qg(e.options.pan,o,t),e.delta={x:0,y:0},rx(t,e,s)}function BS(t,e){e.delta=null,e.panning&&(e.panning=!1,e.filterNextClick=!0,ie(e.options.pan.onPanComplete,[{chart:t}]))}const yc=new WeakMap;function Ff(t,e){const s=Ve(t),n=t.canvas,{pan:i,zoom:r}=e,a=new Xi.Manager(n);r&&r.pinch.enabled&&(a.add(new Xi.Pinch),a.on("pinchstart",o=>IS(t,s,o)),a.on("pinch",o=>ix(t,s,o)),a.on("pinchend",o=>VS(t,s,o))),i&&i.enabled&&(a.add(new Xi.Pan({threshold:i.threshold,enable:LS(t,s)})),a.on("panstart",o=>WS(t,s,o)),a.on("panmove",o=>rx(t,s,o)),a.on("panend",()=>BS(t,s))),yc.set(t,a)}function If(t){const e=yc.get(t);e&&(e.remove("pinchstart"),e.remove("pinch"),e.remove("pinchend"),e.remove("panstart"),e.remove("pan"),e.remove("panend"),e.destroy(),yc.delete(t))}function zS(t,e){const{pan:s,zoom:n}=t,{pan:i,zoom:r}=e;return n?.zoom?.pinch?.enabled!==r?.zoom?.pinch?.enabled||s?.enabled!==i?.enabled||s?.threshold!==i?.threshold}var HS="2.2.0";function oa(t,e,s){const n=s.zoom.drag,{dragStart:i,dragEnd:r}=Ve(t);if(n.drawTime!==e||!r)return;const{left:a,top:o,width:c,height:d}=nx(t,s.zoom.mode,{dragStart:i,dragEnd:r},n.maintainAspectRatio),u=t.ctx;u.save(),u.beginPath(),u.fillStyle=n.backgroundColor||"rgba(225,225,225,0.3)",u.fillRect(a,o,c,d),n.borderWidth>0&&(u.lineWidth=n.borderWidth,u.strokeStyle=n.borderColor||"rgba(225,225,225)",u.strokeRect(a,o,c,d)),u.restore()}var $S={id:"zoom",version:HS,defaults:{pan:{enabled:!1,mode:"xy",threshold:10,modifierKey:null},zoom:{wheel:{enabled:!1,speed:.1,modifierKey:null},drag:{enabled:!1,drawTime:"beforeDatasetsDraw",modifierKey:null},pinch:{enabled:!1},mode:"xy"}},start:function(t,e,s){const n=Ve(t);n.options=s,Object.prototype.hasOwnProperty.call(s.zoom,"enabled")&&console.warn("The option `zoom.enabled` is no longer supported. Please use `zoom.wheel.enabled`, `zoom.drag.enabled`, or `zoom.pinch.enabled`."),(Object.prototype.hasOwnProperty.call(s.zoom,"overScaleMode")||Object.prototype.hasOwnProperty.call(s.pan,"overScaleMode"))&&console.warn("The option `overScaleMode` is deprecated. Please use `scaleMode` instead (and update `mode` as desired)."),Xi&&Ff(t,s),t.pan=(i,r,a)=>ex(t,i,r,a),t.zoom=(i,r)=>xd(t,i,r),t.zoomRect=(i,r,a)=>Qg(t,i,r,a),t.zoomScale=(i,r,a)=>bS(t,i,r,a),t.resetZoom=i=>vS(t,i),t.getZoomLevel=()=>wS(t),t.getInitialScaleBounds=()=>tx(t),t.getZoomedScaleBounds=()=>kS(t),t.isZoomedOrPanned=()=>SS(t),t.isZoomingOrPanning=()=>Of(t)},beforeEvent(t,{event:e}){if(Of(t))return!1;if(e.type==="click"||e.type==="mouseup"){const s=Ve(t);if(s.filterNextClick)return s.filterNextClick=!1,!1}},beforeUpdate:function(t,e,s){const n=Ve(t),i=n.options;n.options=s,zS(i,s)&&(If(t),Ff(t,s)),OS(t,s)},beforeDatasetsDraw(t,e,s){oa(t,"beforeDatasetsDraw",s)},afterDatasetsDraw(t,e,s){oa(t,"afterDatasetsDraw",s)},beforeDraw(t,e,s){oa(t,"beforeDraw",s)},afterDraw(t,e,s){oa(t,"afterDraw",s)},stop:function(t){RS(t),Xi&&If(t),iS(t)},panFunctions:gc,zoomFunctions:mc,zoomRectFunctions:pc};const la={labels:Array.from({length:24},(t,e)=>`${String(e).padStart(2,"0")}:00`),load:Array.from({length:24},()=>+(Math.random()*2.2+.6).toFixed(2)),pv:Array.from({length:24},(t,e)=>+(Math.max(0,Math.sin((e-6)/4))*2.4).toFixed(2)),price:Array.from({length:24},()=>+(Math.random()*3.2+.8).toFixed(2))},ax="Europe/Stockholm";function yd(t){return new Date(t)}function Ga(t,e=ax){return new Intl.DateTimeFormat("sv-SE",{year:"numeric",month:"2-digit",day:"2-digit",timeZone:e}).format(t)}function bd(t,e=new Date){return Ga(yd(t))===Ga(e)}function qa(t,e=new Date){const s=new Date(e);return s.setDate(s.getDate()+1),Ga(yd(t))===Ga(s)}function jl(t){const e=yd(t);return new Intl.DateTimeFormat("sv-SE",{hour:"2-digit",minute:"2-digit",timeZone:ax}).format(e)}function YS(t,e,s=new Date){return t.filter(i=>e==="today"?bd(i.start_time,s):qa(i.start_time,s))}Ct.register($S);const US={maintainAspectRatio:!1,animation:!1,plugins:{legend:{display:!1,labels:{color:"#e6e9ef",boxWidth:10,font:{size:12},filter:()=>!1}},tooltip:{enabled:!0,mode:"index",intersect:!1,backgroundColor:"rgba(30, 30, 46, 0.95)",titleColor:"#e6e9ef",bodyColor:"#a6b0bf",borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1,padding:12,displayColors:!0,caretPadding:8,yAlign:"bottom",callbacks:{title:function(t){return t[0].label},label:function(t){const e=t.dataset.label||"",s=t.parsed.y;if(s==null)return"";let n=s.toFixed(2),i="";if(e.includes("SEK/kWh")){n=s.toFixed(2),i=" SEK/kWh";const a=t.chart.data.pricingConfig;if(a){const o=1+a.vat/100,c=o>0?s/o:s,d=Math.max(0,c-a.fees),u=s-d;return[`${e}: ${n}${i}`,`(Spot: ${d.toFixed(2)} + Tax/Fees: ${u.toFixed(2)})`]}}else e.includes("kW")?(n=s.toFixed(1),i=" kW"):e.includes("kWh")?(n=s.toFixed(2),i=" kWh"):e.includes("%")&&(n=s.toFixed(1),i="%");return`${e}: ${n}${i}`}}},zoom:{pan:{enabled:!0,mode:"x"},zoom:{wheel:{enabled:!0},pinch:{enabled:!0},mode:"x"}}},scales:{x:{grid:{display:!1},ticks:{color:"#6c7086",font:{family:"monospace",size:10},maxRotation:0,autoSkip:!1,callback:function(t,e,s){const n=this.getLabelForValue(t);if(typeof n!="string")return"";const i=n.split(":");if(i.length<2)return"";const[r,a]=i;return a==="00"?r:""}},border:{display:!1}},y:{position:"right",min:0,max:8,title:{display:!1,text:"SEK/kWh"},grid:{display:!1},border:{display:!1},ticks:{display:!1,color:"#6c7086",font:{family:"monospace",size:10},callback:t=>`${t} SEK`}},y1:{position:"left",min:0,max:9,title:{display:!1,text:"kW"},grid:{display:!1},ticks:{display:!1},border:{display:!1}},y2:{position:"left",min:0,max:9,title:{display:!1,text:"kWh"},grid:{display:!1},ticks:{display:!1},border:{display:!1},display:!1},y3:{position:"right",min:0,max:100,title:{display:!0,text:"%",color:"#a6b0bf"},grid:{display:!1},ticks:{color:"#a6b0bf",font:{family:"monospace",size:10}},border:{display:!1},display:!1},y4:{position:"left",min:0,max:1.5,title:{display:!1,text:"kW (PV)"},grid:{display:!1},ticks:{display:!1},border:{display:!1}}}},GS=(t,e)=>{if(!t||!t.startsWith("#"))return t;const s=parseInt(t.slice(1,3),16),n=parseInt(t.slice(3,5),16),i=parseInt(t.slice(5,7),16);return`rgba(${s}, ${n}, ${i}, ${e})`},Fn=(t,e={},s)=>{const n={accent:"#FFCE59",grid:"#64748B",house:"#00B7B5",good:"#1FB256",bad:"#F15132",peak:"#EC4899",water:"#4EA8DE",night:"#06B6D4"},i={labels:t.labels,datasets:[{type:"line",label:"Import Price (SEK/kWh)",data:t.price,borderColor:n.grid,backgroundColor:r=>{const a=r.chart.ctx,c=document.documentElement.classList.contains("dark")?.35:.5,d=a.createLinearGradient(0,0,0,r.chart.height);return d.addColorStop(0,`rgba(100, 116, 139, ${c})`),d.addColorStop(1,"rgba(100, 116, 139, 0)"),d},fill:!0,yAxisID:"y",tension:.4,pointRadius:0,borderWidth:3,order:1},{type:"line",label:"PV Forecast (kW)",data:t.pv,borderColor:n.accent,backgroundColor:r=>{const a=r.chart.ctx,c=document.documentElement.classList.contains("dark")?.5:.65,d=a.createLinearGradient(0,0,0,r.chart.height);return d.addColorStop(0,`rgba(255, 206, 89, ${c})`),d.addColorStop(1,"rgba(255, 206, 89, 0)"),d},fill:!0,yAxisID:"y4",tension:.4,pointRadius:0,borderWidth:3,order:2},{type:"bar",label:"Load (kW)",data:t.load,backgroundColor:"rgba(0, 183, 181, 0.25)",borderColor:n.house,glow:!0,borderWidth:0,borderRadius:2,yAxisID:"y1",barPercentage:.85,categoryPercentage:.9,grouped:!1,order:0},{type:"bar",label:"Charge (kW)",data:t.charge??t.labels.map(()=>null),backgroundColor:"rgba(241, 81, 50, 0.25)",borderColor:n.bad,glow:!0,borderWidth:0,borderRadius:2,hidden:!0,yAxisID:"y1",barPercentage:.85,categoryPercentage:.9,grouped:!1,order:0},{type:"bar",label:"Discharge (kW)",data:t.discharge??t.labels.map(()=>null),backgroundColor:"rgba(236, 72, 153, 0.25)",borderColor:n.peak,glow:!0,borderWidth:0,borderRadius:2,hidden:!0,yAxisID:"y1",barPercentage:.85,categoryPercentage:.9,grouped:!1,order:0},{type:"bar",label:"Export (kWh)",data:t.export??t.labels.map(()=>null),backgroundColor:"rgba(31, 178, 86, 0.3)",borderColor:n.good,glow:!0,borderWidth:0,borderRadius:2,hidden:!0,yAxisID:"y2",barPercentage:.85,categoryPercentage:.9,grouped:!1,order:0},{type:"bar",label:"Water Heating (kW)",data:t.water??t.labels.map(()=>null),backgroundColor:"rgba(78, 168, 222, 0.25)",borderColor:n.water,glow:!0,borderWidth:0,borderRadius:2,hidden:!0,yAxisID:"y1",barPercentage:.85,categoryPercentage:.9,grouped:!1,order:0},{type:"line",label:"SoC Target (%)",data:t.socTarget??t.labels.map(()=>null),borderColor:n.night,borderDash:[0,6],borderCapStyle:"round",backgroundColor:r=>{const a=r.chart.ctx,c=document.documentElement.classList.contains("dark")?.05:.1,d=a.createLinearGradient(0,0,0,r.chart.height);return d.addColorStop(0,`rgba(6, 182, 212, ${c})`),d.addColorStop(1,"rgba(6, 182, 212, 0)"),d},fill:!0,segment:{borderColor:r=>{const a=t.nowIndex??-1;return a>=0&&r.p1DataIndex<a?"rgba(6, 182, 212, 0.5)":n.night}},yAxisID:"y3",pointRadius:0,borderWidth:3,tension:0,stepped:"after",hidden:!0,order:10},{type:"line",label:"SoC Projected (%)",data:t.socProjected??t.labels.map(()=>null),borderColor:n.night,segment:{borderColor:r=>{const a=t.nowIndex??-1;return a>=0&&r.p1DataIndex<a?"rgba(6, 182, 212, 0.5)":n.night}},yAxisID:"y3",pointRadius:0,borderWidth:3,tension:.3,hidden:!0},{type:"line",label:"SoC Actual (%)",data:t.socActual??t.labels.map(()=>null),borderColor:n.night,borderDash:[0,6],borderCapStyle:"round",yAxisID:"y3",pointRadius:0,borderWidth:3,tension:.3,hidden:!0}]};return t.hasNoData&&(i.plugins={tooltip:{enabled:!0,external:!0,callbacks:{title:()=>t.day==="tomorrow"?"No Price Data":"No Data",label:()=>t.day==="tomorrow"?"Schedule data not available yet. Check back later for prices.":"No schedule data available."}}}),{...i,nowIndex:t.nowIndex??null,nowPct:t.nowPct??null,hasNoData:!!t.hasNoData,pricingConfig:s}},qS={id:"nowLine",afterDatasetsDraw(t){const{ctx:e,chartArea:{top:s,bottom:n},scales:{x:i}}=t,r=t.data,a=r.nowPct;if(typeof a!="number"||a<0||a>1)return;const o=r.labels?.length||0;if(o<2)return;const c=a*o,d=Math.floor(c),u=Math.ceil(c),h=c-d,f=i.getPixelForValue(d),m=i.getPixelForValue(u),p=f+(m-f)*h;p<i.left||p>i.right||(e.save(),e.beginPath(),e.strokeStyle="#e879f9",e.lineWidth=1.5,e.shadowColor="#e879f9",e.shadowBlur=10,e.setLineDash([4,4]),e.moveTo(p,s),e.lineTo(p,n),e.stroke(),e.setLineDash([]),e.fillStyle="#e879f9",e.textAlign="center",e.font="bold 10px monospace",e.fillText("NOW",p,s-8),e.restore())}},KS={id:"dotGrid",beforeDraw(t){const{ctx:e,chartArea:s,scales:n}=t;if(!s||!n.x)return;const{left:i,right:r,top:a,bottom:o}=s,c=n.x,d=1,u=30;e.save(),e.fillStyle="rgba(100, 116, 139, 0.4)";const h=t.data.labels?.length||0;if(h<2){e.restore();return}const f=c.getPixelForValue(0),m=c.getPixelForValue(1),p=Math.abs(m-f);let g=1;p<8?g=4:p<15&&(g=2);for(let x=0;x<h;x+=g){const v=c.getPixelForValue(x);if(!(v<i-5||v>r+5))for(let _=a;_<=o;_+=u)e.beginPath(),e.arc(v,_,d,0,Math.PI*2),e.fill()}e.restore()}},XS={id:"glowEffects",beforeDatasetsDraw(t){const{ctx:e}=t;e.save(),e.shadowBlur=0,e.shadowColor="transparent"},afterDatasetDraw(t,e){const{ctx:s}=t;t.data.datasets[e.index].glow&&s.restore()},beforeDatasetDraw(t,e){const{ctx:s}=t,n=t.data.datasets[e.index];if(n.glow){s.save();const i=document.documentElement.classList.contains("dark");s.shadowColor=GS(n.borderColor,i?.4:.25),s.shadowBlur=n.glowBlur??(i?30:20),s.shadowOffsetX=0,s.shadowOffsetY=0}}};function ox({day:t="today",range:e="48h",refreshToken:s=0,slotsOverride:n,useHistoryForToday:i=!1,showDayToggle:r=!1}){const[a,o]=y.useState(!1),c=t||"today",[d,u]=y.useState(e),h=y.useRef(null),f=y.useRef(null),[m,p]=y.useState({}),[g,x]=y.useState({price:!0,pv:!0,load:!0,charge:!1,discharge:!1,export:!1,water:!1,socTarget:!1,socProjected:!1,socActual:!0}),[v,_]=y.useState(!1),[S,N]=y.useState();y.useEffect(()=>{K.config().then(k=>{if(k.pricing){const M=k.pricing,P=M.vat_percent??25,O=(M.grid_transfer_fee_sek??0)+(M.energy_tax_sek??0);N({vat:P,fees:O})}const T=k?.dashboard?.overlay_defaults;if(T&&typeof T=="string"){const M=T.split(",").map(A=>A.trim().toLowerCase()),P=M.includes("socactual")||M.includes("soc_actual"),O={price:!M.includes("price_off"),pv:!M.includes("pv_off"),load:!M.includes("load_off"),charge:M.includes("charge"),discharge:M.includes("discharge"),export:M.includes("export"),water:M.includes("water"),socTarget:M.includes("soctarget")||M.includes("soc_target"),socProjected:M.includes("socprojected")||M.includes("soc_projected"),socActual:P?!0:g.socActual};x(O)}}).catch(k=>console.error("Failed to load overlay defaults:",k))},[g.socActual]),y.useEffect(()=>{K.theme().then(k=>{const T=k.themes.find(M=>M.name===k.current);if(T){const M={};T.palette.forEach((P,O)=>{M[`palette = ${O}`]=P}),M.background=T.background,M.foreground=T.foreground,p(M)}}).catch(k=>console.error("Failed to load theme colors:",k))},[]),y.useEffect(()=>{if(!h.current||Object.keys(m).length===0)return;const k={type:"bar",data:Fn({labels:la.labels,price:la.price,pv:la.pv,load:la.load},m,S),options:US,plugins:[KS,qS,XS]};return f.current=new Ct(h.current,k),()=>{f.current&&(f.current.destroy(),f.current=null)}},[m,S]);const j=k=>{if(!k)return!1;const T=k;return!(T._destroyed||T._plugins===void 0&&T.$plugins===void 0)};return y.useEffect(()=>{u(e)},[e]),y.useEffect(()=>{const k=f.current;if(!j(k)||Object.keys(m).length===0)return;const T=P=>{if(!j(f.current))return;const O=ZS(P,c,d,m,S);if(!O)return;o(!!O.hasNoData);const A=O.datasets;A[0]&&(A[0].hidden=!g.price),A[1]&&(A[1].hidden=!g.pv),A[2]&&(A[2].hidden=!g.load),A[3]&&(A[3].hidden=!g.charge),A[4]&&(A[4].hidden=!g.discharge),A[5]&&(A[5].hidden=!g.export),A[6]&&(A[6].hidden=!g.water),A[7]&&(A[7].hidden=!g.socTarget),A[8]&&(A[8].hidden=!g.socProjected),A[9]&&(A[9].hidden=!g.socActual);try{if(!j(f.current))return;f.current&&(f.current.data=O,f.current.update())}catch(F){console.error("Chart update error:",F)}};if(n&&n.length){T(n);return}(i&&d==="day"&&c==="today"?K.scheduleTodayWithHistory().then(P=>({schedule:P.slots})):K.schedule()).then(P=>{T(P.schedule??[])}).catch(P=>{console.error("Failed to load schedule:",P),o(!0)})},[c,g,m,d,s,n,i,S]),l.jsxs(de,{className:"p-4 md:p-6 h-[380px]",children:[l.jsxs("div",{className:"flex items-baseline justify-between pb-2",children:[l.jsx("div",{className:"text-sm text-muted",children:"Schedule Overview"}),r&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{className:`rounded-pill px-3 py-1 text-[11px] font-semibold uppercase tracking-wide transition ${d==="day"?"bg-accent text-canvas":"bg-surface border border-line/60 text-muted"}`,onClick:()=>u("day"),children:"24h"}),l.jsx("button",{className:`rounded-pill px-3 py-1 text-[11px] font-semibold uppercase tracking-wide transition ${d==="48h"?"bg-accent text-canvas":"bg-surface border border-line/60 text-muted"}`,onClick:()=>u("48h"),children:"48h"})]}),l.jsx("button",{className:"rounded-pill px-3 py-1 text-[11px] font-semibold uppercase tracking-wide border border-line/60 text-muted hover:border-accent hover:text-accent transition",onClick:()=>_(k=>!k),children:"Overlays"})]})]}),v&&l.jsx("div",{className:"mt-2 flex flex-wrap gap-2 text-[11px]",children:[["Price","price"],["PV","pv"],["Load","load"],["Charge","charge"],["Discharge","discharge"],["Export","export"],["Water","water"],["SoC Target","socTarget"],["SoC Projected","socProjected"],["SoC Actual","socActual"]].map(([k,T])=>l.jsx("button",{onClick:M=>{M.preventDefault(),x(P=>({...P,[T]:!P[T]}))},className:`rounded-pill px-3 py-1 border ${g[T]?"bg-accent text-canvas border-accent":"border-line/60 text-muted hover:border-accent"}`,children:k},T))}),l.jsxs("div",{className:"h-[310px] relative mt-1",children:[a&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-surface/90 rounded-lg",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-lg font-semibold text-accent mb-2",children:"No Price Data"}),l.jsx("div",{className:"text-sm text-muted",children:"Schedule data not available yet. Check back later for prices."})]})}),l.jsx("canvas",{ref:h,style:{display:a?"none":"block"}})]})]})}function ZS(t,e,s,n={},i){const r=s==="day"?YS(t,e):t.filter(S=>bd(S.start_time)||qa(S.start_time));if(s==="day"){if(!r.length){const ee=Array.from({length:24},(R,B)=>`${String(B).padStart(2,"0")}:00`),D=Array(24).fill(null);return Fn({labels:ee,price:D.slice(),pv:D.slice(),load:D.slice(),charge:D.slice(),discharge:D.slice(),export:D.slice(),water:D.slice(),socTarget:D.slice(),socProjected:D.slice(),socActual:D.slice(),hasNoData:!0,day:e},n)}const S=[...r].sort((ee,D)=>{const R=new Date(ee.start_time).getTime(),B=new Date(D.start_time).getTime();return R-B});let N=15;if(S.length>=2){const ee=new Date(S[0].start_time).getTime(),D=new Date(S[1].start_time).getTime(),R=Math.max(1,Math.round((D-ee)/6e4));(R===15||R===30||R===60)&&(N=R)}const j=new Date;e==="today"||j.setDate(j.getDate()+1),j.setHours(0,0,0,0);const k=N*60*1e3,T=Math.round(1440/N),M=new Map;for(const ee of S){const D=new Date(ee.start_time).getTime();M.set(D,ee)}const P=[],O=[],A=[],F=[],X=[],H=[],Z=[],Q=[],Y=[],oe=[],ue=[];let Se=null;const We=new Date;for(let ee=0;ee<T;ee++){const D=new Date(j.getTime()+ee*k),R=new Date(D.getTime()+k),B=M.get(D.getTime());if(P.push(jl(D.toISOString())),B){const ae=B.is_executed===!0;O.push(B.import_price_sek_kwh??null),A.push(ae&&B.actual_pv_kwh!=null?B.actual_pv_kwh:B.pv_forecast_kwh??null),F.push(ae&&B.actual_load_kwh!=null?B.actual_load_kwh:B.load_forecast_kwh??null),X.push(ae&&B.actual_charge_kw!=null?B.actual_charge_kw:B.battery_charge_kw??B.charge_kw??null),H.push(B.battery_discharge_kw??B.discharge_kw??null),Z.push(ae&&B.actual_export_kw!=null?B.actual_export_kw:B.export_kwh??null),Q.push(B.water_heating_kw??null),Y.push(B.soc_target_percent??null),oe.push(B.projected_soc_percent??null),ue.push(B.actual_soc!=null?B.actual_soc:null)}else O.push(null),A.push(null),F.push(null),X.push(null),H.push(null),Z.push(null),Q.push(null),Y.push(null),oe.push(null),ue.push(null);e==="today"&&We>=D&&We<R&&(Se=ee)}let $=null;if(e==="today"){const ee=T*k,D=We.getTime()-j.getTime();D>=0&&D<=ee&&($=D/ee)}return Fn({labels:P,price:O,pv:A,load:F,charge:X,discharge:H,export:Z,water:Q,socTarget:Y,socProjected:oe,socActual:ue,nowIndex:Se,nowPct:$},n)}if(s==="48h"){if(!r.length){console.log("[buildLiveData] No slots found for 48h range, creating fallback");const R=Array.from({length:48},(B,ae)=>{const he=ae%24;return`${String(he).padStart(2,"0")}:00`});return Fn({labels:R,price:Array(R.length).fill(null),pv:Array(R.length).fill(null),load:Array(R.length).fill(null),charge:Array(R.length).fill(null),discharge:Array(R.length).fill(null),export:Array(R.length).fill(null),water:Array(R.length).fill(null),socTarget:Array(R.length).fill(null),socProjected:Array(R.length).fill(null),hasNoData:!0,day:e},n)}const S=[...r].sort((R,B)=>{const ae=new Date(R.start_time).getTime(),he=new Date(B.start_time).getTime();return ae-he});let N=15;if(S.length>=2){const R=new Date(S[0].start_time).getTime(),B=new Date(S[1].start_time).getTime(),ae=Math.max(1,Math.round((B-R)/6e4));(ae===15||ae===30||ae===60)&&(N=ae)}const j=new Date;j.setHours(0,0,0,0);const k=N*60*1e3,T=Math.round(2880/N),M=new Map;for(const R of S){const B=new Date(R.start_time).getTime();M.set(B,R)}const P=[],O=[],A=[],F=[],X=[],H=[],Z=[],Q=[],Y=[],oe=[],ue=[];let Se=null;const We=new Date;for(let R=0;R<T;R++){const B=new Date(j.getTime()+R*k),ae=new Date(B.getTime()+k),he=M.get(B.getTime());P.push(jl(B.toISOString())),he?(O.push(he.import_price_sek_kwh??null),A.push(he.actual_pv_kwh??he.pv_forecast_kwh??null),F.push(he.actual_load_kwh??he.load_forecast_kwh??null),X.push(he.actual_charge_kw??he.battery_charge_kw??he.charge_kw??null),H.push(he.battery_discharge_kw??he.discharge_kw??null),Z.push(he.actual_export_kw??he.export_kwh??null),Q.push(he.water_heating_kw??null),Y.push(he.soc_target_percent??null),oe.push(he.projected_soc_percent??null),ue.push(he.actual_soc!=null?he.actual_soc:null)):(O.push(null),A.push(null),F.push(null),X.push(null),H.push(null),Z.push(null),Q.push(null),Y.push(null),oe.push(null),ue.push(null)),We>=B&&We<ae&&(Se=R)}let $=null;const ee=T*k,D=We.getTime()-j.getTime();return D>=0&&D<=ee&&($=D/ee),Fn({labels:P,price:O,pv:A,load:F,charge:X,discharge:H,export:Z,water:Q,socTarget:Y,socProjected:oe,socActual:ue,nowIndex:Se,nowPct:$},n,i)}const a=[...r].sort((S,N)=>{const j=new Date(S.start_time).getTime(),k=new Date(N.start_time).getTime();return j-k}),o=a.map(S=>S.import_price_sek_kwh??null),c=a.map(S=>S.pv_forecast_kwh??null),d=a.map(S=>S.load_forecast_kwh??null),u=a.map(S=>S.battery_charge_kw??S.charge_kw??null),h=a.map(S=>S.battery_discharge_kw??S.discharge_kw??null),f=a.map(S=>S.export_kwh??null),m=a.map(S=>S.water_heating_kw??null),p=a.map(S=>S.soc_target_percent??null),g=a.map(S=>S.projected_soc_percent??null),x=a.map(S=>S.actual_soc??null),v=a.map(S=>jl(S.start_time));let _=null;if(e==="today"){const S=new Date;for(let N=0;N<a.length;N++){const j=new Date(a[N].start_time||""),k=new Date(j.getTime()+1800*1e3);if(S>=j&&S<k){_=N;break}}}return Fn({labels:v,price:o,pv:c,load:d,charge:u,discharge:h,export:f,water:m,socTarget:p,socProjected:g,socActual:x,nowIndex:_},n)}function JS({status:t,onRefresh:e}){const[s,n]=y.useState(null),[i,r]=y.useState("idle"),[a,o]=y.useState(null),[c,d]=y.useState(!1);y.useEffect(()=>{d(t==="paused"||t==="idle")},[t]);const u=async()=>{r("planning"),o(null);try{await K.runPlanner(),r("executing"),await K.executor.run(),r("done"),e&&setTimeout(e,500),setTimeout(()=>r("idle"),2e3)}catch(m){o({type:"error",message:m instanceof Error?m.message:"Failed"}),r("idle")}},h=async()=>{o(null),n("pause");try{c?(await K.executor.resume(),d(!1),o({type:"success",message:"Executor resumed"}),e?.()):(await K.executor.pause(),d(!0),o({type:"success",message:"Executor paused - idle mode"}),e?.()),setTimeout(()=>o(null),3e3)}catch(m){o({type:"error",message:m instanceof Error?m.message:"Failed"})}finally{n(null)}},f=()=>{switch(i){case"planning":return"Planning...";case"executing":return"Executing...";case"done":return"Done ";default:return"Run Planner"}};return l.jsxs("div",{className:"relative",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("button",{className:`relative overflow-hidden flex items-center justify-center gap-2 rounded-xl px-3 py-2.5 text-[11px] font-semibold transition btn-glow-primary
                        ${i!=="idle"?"bg-surface border border-accent/50 text-accent cursor-wait":"bg-accent hover:bg-accent2 text-[#100f0e]"}`,onClick:u,disabled:i!=="idle",title:"Run planner and execute",children:[l.jsx("div",{className:`absolute left-0 top-0 bottom-0 transition-all duration-[2000ms] ease-out pointer-events-none ${i==="idle"?"bg-transparent":"bg-accent/50"}`,style:{width:i==="idle"?"0%":i==="done"?"100%":"90%"}}),l.jsxs("div",{className:"relative z-10 flex items-center gap-2",children:[i==="planning"||i==="executing"?l.jsx(tc,{className:"h-4 w-4 animate-spin"}):l.jsx(Iv,{className:"h-4 w-4"}),l.jsx("span",{children:f()})]})]}),l.jsx("button",{className:`flex items-center justify-center gap-2 rounded-xl px-3 py-2.5 text-[11px] font-semibold transition
                        ${c?"bg-bad/80 text-white ring-2 ring-bad shadow-[0_0_20px_rgba(241,81,50,0.5)] animate-pulse":"bg-good hover:bg-good/80 text-white btn-glow-green"} ${s==="pause"?"opacity-60 cursor-wait":""}`,onClick:h,disabled:s==="pause",title:c?"Resume executor":"Pause executor (idle mode)",children:c?l.jsxs(l.Fragment,{children:[l.jsx(Ip,{className:"h-4 w-4"}),l.jsx("span",{children:"RESUME"})]}):l.jsxs(l.Fragment,{children:[l.jsx(Lv,{className:"h-4 w-4"}),l.jsx("span",{children:"Pause"})]})})]}),a&&l.jsx("div",{className:`absolute -bottom-8 left-0 right-0 text-center text-[10px] py-1 px-2 rounded-md transition-opacity animate-in fade-in slide-in-from-bottom-1 duration-300 ${a.type==="success"?"text-green-400":"text-red-400"}`,children:a.message})]})}const vd=y.createContext({});function _d(t){const e=y.useRef(null);return e.current===null&&(e.current=t()),e.current}const jo=y.createContext(null),wd=y.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class QS extends y.Component{getSnapshotBeforeUpdate(e){const s=this.props.childRef.current;if(s&&e.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=s.offsetHeight||0,n.width=s.offsetWidth||0,n.top=s.offsetTop,n.left=s.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function ej({children:t,isPresent:e}){const s=y.useId(),n=y.useRef(null),i=y.useRef({width:0,height:0,top:0,left:0}),{nonce:r}=y.useContext(wd);return y.useInsertionEffect(()=>{const{width:a,height:o,top:c,left:d}=i.current;if(e||!n.current||!a||!o)return;n.current.dataset.motionPopId=s;const u=document.createElement("style");return r&&(u.nonce=r),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${o}px !important;
            top: ${c}px !important;
            left: ${d}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),l.jsx(QS,{isPresent:e,childRef:n,sizeRef:i,children:y.cloneElement(t,{ref:n})})}const tj=({children:t,initial:e,isPresent:s,onExitComplete:n,custom:i,presenceAffectsLayout:r,mode:a})=>{const o=_d(sj),c=y.useId(),d=y.useCallback(h=>{o.set(h,!0);for(const f of o.values())if(!f)return;n&&n()},[o,n]),u=y.useMemo(()=>({id:c,initial:e,isPresent:s,custom:i,onExitComplete:d,register:h=>(o.set(h,!1),()=>o.delete(h))}),r?[Math.random(),d]:[s,d]);return y.useMemo(()=>{o.forEach((h,f)=>o.set(f,!1))},[s]),y.useEffect(()=>{!s&&!o.size&&n&&n()},[s]),a==="popLayout"&&(t=l.jsx(ej,{isPresent:s,children:t})),l.jsx(jo.Provider,{value:u,children:t})};function sj(){return new Map}function lx(t=!0){const e=y.useContext(jo);if(e===null)return[!0,null];const{isPresent:s,onExitComplete:n,register:i}=e,r=y.useId();y.useEffect(()=>{t&&i(r)},[t]);const a=y.useCallback(()=>t&&n&&n(r),[r,n,t]);return!s&&n?[!1,a]:[!0]}const ca=t=>t.key||"";function Vf(t){const e=[];return y.Children.forEach(t,s=>{y.isValidElement(s)&&e.push(s)}),e}const kd=typeof window<"u",cx=kd?y.useLayoutEffect:y.useEffect,nj=({children:t,custom:e,initial:s=!0,onExitComplete:n,presenceAffectsLayout:i=!0,mode:r="sync",propagate:a=!1})=>{const[o,c]=lx(a),d=y.useMemo(()=>Vf(t),[t]),u=a&&!o?[]:d.map(ca),h=y.useRef(!0),f=y.useRef(d),m=_d(()=>new Map),[p,g]=y.useState(d),[x,v]=y.useState(d);cx(()=>{h.current=!1,f.current=d;for(let N=0;N<x.length;N++){const j=ca(x[N]);u.includes(j)?m.delete(j):m.get(j)!==!0&&m.set(j,!1)}},[x,u.length,u.join("-")]);const _=[];if(d!==p){let N=[...d];for(let j=0;j<x.length;j++){const k=x[j],T=ca(k);u.includes(T)||(N.splice(j,0,k),_.push(k))}r==="wait"&&_.length&&(N=_),v(Vf(N)),g(d);return}const{forceRender:S}=y.useContext(vd);return l.jsx(l.Fragment,{children:x.map(N=>{const j=ca(N),k=a&&!o?!1:d===x||u.includes(j),T=()=>{if(m.has(j))m.set(j,!0);else return;let M=!0;m.forEach(P=>{P||(M=!1)}),M&&(S?.(),v(f.current),a&&c?.(),n&&n())};return l.jsx(tj,{isPresent:k,initial:!h.current||s?void 0:!1,custom:k?void 0:e,presenceAffectsLayout:i,mode:r,onExitComplete:k?void 0:T,children:N},j)})})},bt=t=>t;let dx=bt;function Sd(t){let e;return()=>(e===void 0&&(e=t()),e)}const ei=(t,e,s)=>{const n=e-t;return n===0?1:(s-t)/n},bs=t=>t*1e3,vs=t=>t/1e3,ij={useManualTiming:!1};function rj(t){let e=new Set,s=new Set,n=!1,i=!1;const r=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function o(d){r.has(d)&&(c.schedule(d),t()),d(a)}const c={schedule:(d,u=!1,h=!1)=>{const m=h&&n?e:s;return u&&r.add(d),m.has(d)||m.add(d),d},cancel:d=>{s.delete(d),r.delete(d)},process:d=>{if(a=d,n){i=!0;return}n=!0,[e,s]=[s,e],e.forEach(o),e.clear(),n=!1,i&&(i=!1,c.process(d))}};return c}const da=["read","resolveKeyframes","update","preRender","render","postRender"],aj=40;function ux(t,e){let s=!1,n=!0;const i={delta:0,timestamp:0,isProcessing:!1},r=()=>s=!0,a=da.reduce((v,_)=>(v[_]=rj(r),v),{}),{read:o,resolveKeyframes:c,update:d,preRender:u,render:h,postRender:f}=a,m=()=>{const v=performance.now();s=!1,i.delta=n?1e3/60:Math.max(Math.min(v-i.timestamp,aj),1),i.timestamp=v,i.isProcessing=!0,o.process(i),c.process(i),d.process(i),u.process(i),h.process(i),f.process(i),i.isProcessing=!1,s&&e&&(n=!1,t(m))},p=()=>{s=!0,n=!0,i.isProcessing||t(m)};return{schedule:da.reduce((v,_)=>{const S=a[_];return v[_]=(N,j=!1,k=!1)=>(s||p(),S.schedule(N,j,k)),v},{}),cancel:v=>{for(let _=0;_<da.length;_++)a[da[_]].cancel(v)},state:i,steps:a}}const{schedule:Ce,cancel:Gs,state:st,steps:Nl}=ux(typeof requestAnimationFrame<"u"?requestAnimationFrame:bt,!0),hx=y.createContext({strict:!1}),Wf={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ti={};for(const t in Wf)ti[t]={isEnabled:e=>Wf[t].some(s=>!!e[s])};function oj(t){for(const e in t)ti[e]={...ti[e],...t[e]}}const lj=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Ka(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||lj.has(t)}let fx=t=>!Ka(t);function cj(t){t&&(fx=e=>e.startsWith("on")?!Ka(e):t(e))}try{cj(require("@emotion/is-prop-valid").default)}catch{}function dj(t,e,s){const n={};for(const i in t)i==="values"&&typeof t.values=="object"||(fx(i)||s===!0&&Ka(i)||!e&&!Ka(i)||t.draggable&&i.startsWith("onDrag"))&&(n[i]=t[i]);return n}function uj(t){if(typeof Proxy>"u")return t;const e=new Map,s=(...n)=>t(...n);return new Proxy(s,{get:(n,i)=>i==="create"?t:(e.has(i)||e.set(i,t(i)),e.get(i))})}const No=y.createContext({});function mr(t){return typeof t=="string"||Array.isArray(t)}function To(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const jd=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Nd=["initial",...jd];function Mo(t){return To(t.animate)||Nd.some(e=>mr(t[e]))}function mx(t){return!!(Mo(t)||t.variants)}function hj(t,e){if(Mo(t)){const{initial:s,animate:n}=t;return{initial:s===!1||mr(s)?s:void 0,animate:mr(n)?n:void 0}}return t.inherit!==!1?e:{}}function fj(t){const{initial:e,animate:s}=hj(t,y.useContext(No));return y.useMemo(()=>({initial:e,animate:s}),[Bf(e),Bf(s)])}function Bf(t){return Array.isArray(t)?t.join(" "):t}const mj=Symbol.for("motionComponentSymbol");function Vn(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function pj(t,e,s){return y.useCallback(n=>{n&&t.onMount&&t.onMount(n),e&&(n?e.mount(n):e.unmount()),s&&(typeof s=="function"?s(n):Vn(s)&&(s.current=n))},[e])}const Td=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),gj="framerAppearId",px="data-"+Td(gj),{schedule:Md}=ux(queueMicrotask,!1),gx=y.createContext({});function xj(t,e,s,n,i){var r,a;const{visualElement:o}=y.useContext(No),c=y.useContext(hx),d=y.useContext(jo),u=y.useContext(wd).reducedMotion,h=y.useRef(null);n=n||c.renderer,!h.current&&n&&(h.current=n(t,{visualState:e,parent:o,props:s,presenceContext:d,blockInitialAnimation:d?d.initial===!1:!1,reducedMotionConfig:u}));const f=h.current,m=y.useContext(gx);f&&!f.projection&&i&&(f.type==="html"||f.type==="svg")&&yj(h.current,s,i,m);const p=y.useRef(!1);y.useInsertionEffect(()=>{f&&p.current&&f.update(s,d)});const g=s[px],x=y.useRef(!!g&&!(!((r=window.MotionHandoffIsComplete)===null||r===void 0)&&r.call(window,g))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,g)));return cx(()=>{f&&(p.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),Md.render(f.render),x.current&&f.animationState&&f.animationState.animateChanges())}),y.useEffect(()=>{f&&(!x.current&&f.animationState&&f.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{var v;(v=window.MotionHandoffMarkAsComplete)===null||v===void 0||v.call(window,g)}),x.current=!1))}),f}function yj(t,e,s,n){const{layoutId:i,layout:r,drag:a,dragConstraints:o,layoutScroll:c,layoutRoot:d}=e;t.projection=new s(t.latestValues,e["data-framer-portal-id"]?void 0:xx(t.parent)),t.projection.setOptions({layoutId:i,layout:r,alwaysMeasureLayout:!!a||o&&Vn(o),visualElement:t,animationType:typeof r=="string"?r:"both",initialPromotionConfig:n,layoutScroll:c,layoutRoot:d})}function xx(t){if(t)return t.options.allowProjection!==!1?t.projection:xx(t.parent)}function bj({preloadedFeatures:t,createVisualElement:e,useRender:s,useVisualState:n,Component:i}){var r,a;t&&oj(t);function o(d,u){let h;const f={...y.useContext(wd),...d,layoutId:vj(d)},{isStatic:m}=f,p=fj(d),g=n(d,m);if(!m&&kd){_j();const x=wj(f);h=x.MeasureLayout,p.visualElement=xj(i,g,f,e,x.ProjectionNode)}return l.jsxs(No.Provider,{value:p,children:[h&&p.visualElement?l.jsx(h,{visualElement:p.visualElement,...f}):null,s(i,d,pj(g,p.visualElement,u),g,m,p.visualElement)]})}o.displayName=`motion.${typeof i=="string"?i:`create(${(a=(r=i.displayName)!==null&&r!==void 0?r:i.name)!==null&&a!==void 0?a:""})`}`;const c=y.forwardRef(o);return c[mj]=i,c}function vj({layoutId:t}){const e=y.useContext(vd).id;return e&&t!==void 0?e+"-"+t:t}function _j(t,e){y.useContext(hx).strict}function wj(t){const{drag:e,layout:s}=ti;if(!e&&!s)return{};const n={...e,...s};return{MeasureLayout:e?.isEnabled(t)||s?.isEnabled(t)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const kj=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Cd(t){return typeof t!="string"||t.includes("-")?!1:!!(kj.indexOf(t)>-1||/[A-Z]/u.test(t))}function zf(t){const e=[{},{}];return t?.values.forEach((s,n)=>{e[0][n]=s.get(),e[1][n]=s.getVelocity()}),e}function Pd(t,e,s,n){if(typeof e=="function"){const[i,r]=zf(n);e=e(s!==void 0?s:t.custom,i,r)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,r]=zf(n);e=e(s!==void 0?s:t.custom,i,r)}return e}const bc=t=>Array.isArray(t),Sj=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),jj=t=>bc(t)?t[t.length-1]||0:t,ot=t=>!!(t&&t.getVelocity);function ka(t){const e=ot(t)?t.get():t;return Sj(e)?e.toValue():e}function Nj({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:s},n,i,r){const a={latestValues:Tj(n,i,r,t),renderState:e()};return s&&(a.onMount=o=>s({props:n,current:o,...a}),a.onUpdate=o=>s(o)),a}const yx=t=>(e,s)=>{const n=y.useContext(No),i=y.useContext(jo),r=()=>Nj(t,e,n,i);return s?r():_d(r)};function Tj(t,e,s,n){const i={},r=n(t,{});for(const f in r)i[f]=ka(r[f]);let{initial:a,animate:o}=t;const c=Mo(t),d=mx(t);e&&d&&!c&&t.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let u=s?s.initial===!1:!1;u=u||a===!1;const h=u?o:a;if(h&&typeof h!="boolean"&&!To(h)){const f=Array.isArray(h)?h:[h];for(let m=0;m<f.length;m++){const p=Pd(t,f[m]);if(p){const{transitionEnd:g,transition:x,...v}=p;for(const _ in v){let S=v[_];if(Array.isArray(S)){const N=u?S.length-1:0;S=S[N]}S!==null&&(i[_]=S)}for(const _ in g)i[_]=g[_]}}}return i}const ci=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Cn=new Set(ci),bx=t=>e=>typeof e=="string"&&e.startsWith(t),vx=bx("--"),Mj=bx("var(--"),Dd=t=>Mj(t)?Cj.test(t.split("/*")[0].trim()):!1,Cj=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,_x=(t,e)=>e&&typeof t=="number"?e.transform(t):t,ks=(t,e,s)=>s>e?e:s<t?t:s,di={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},pr={...di,transform:t=>ks(0,1,t)},ua={...di,default:1},Pr=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Es=Pr("deg"),Zt=Pr("%"),se=Pr("px"),Pj=Pr("vh"),Dj=Pr("vw"),Hf={...Zt,parse:t=>Zt.parse(t)/100,transform:t=>Zt.transform(t*100)},Ej={borderWidth:se,borderTopWidth:se,borderRightWidth:se,borderBottomWidth:se,borderLeftWidth:se,borderRadius:se,radius:se,borderTopLeftRadius:se,borderTopRightRadius:se,borderBottomRightRadius:se,borderBottomLeftRadius:se,width:se,maxWidth:se,height:se,maxHeight:se,top:se,right:se,bottom:se,left:se,padding:se,paddingTop:se,paddingRight:se,paddingBottom:se,paddingLeft:se,margin:se,marginTop:se,marginRight:se,marginBottom:se,marginLeft:se,backgroundPositionX:se,backgroundPositionY:se},Aj={rotate:Es,rotateX:Es,rotateY:Es,rotateZ:Es,scale:ua,scaleX:ua,scaleY:ua,scaleZ:ua,skew:Es,skewX:Es,skewY:Es,distance:se,translateX:se,translateY:se,translateZ:se,x:se,y:se,z:se,perspective:se,transformPerspective:se,opacity:pr,originX:Hf,originY:Hf,originZ:se},$f={...di,transform:Math.round},Ed={...Ej,...Aj,zIndex:$f,size:se,fillOpacity:pr,strokeOpacity:pr,numOctaves:$f},Oj={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Rj=ci.length;function Lj(t,e,s){let n="",i=!0;for(let r=0;r<Rj;r++){const a=ci[r],o=t[a];if(o===void 0)continue;let c=!0;if(typeof o=="number"?c=o===(a.startsWith("scale")?1:0):c=parseFloat(o)===0,!c||s){const d=_x(o,Ed[a]);if(!c){i=!1;const u=Oj[a]||a;n+=`${u}(${d}) `}s&&(e[a]=d)}}return n=n.trim(),s?n=s(e,i?"":n):i&&(n="none"),n}function Ad(t,e,s){const{style:n,vars:i,transformOrigin:r}=t;let a=!1,o=!1;for(const c in e){const d=e[c];if(Cn.has(c)){a=!0;continue}else if(vx(c)){i[c]=d;continue}else{const u=_x(d,Ed[c]);c.startsWith("origin")?(o=!0,r[c]=u):n[c]=u}}if(e.transform||(a||s?n.transform=Lj(e,t.transform,s):n.transform&&(n.transform="none")),o){const{originX:c="50%",originY:d="50%",originZ:u=0}=r;n.transformOrigin=`${c} ${d} ${u}`}}const Fj={offset:"stroke-dashoffset",array:"stroke-dasharray"},Ij={offset:"strokeDashoffset",array:"strokeDasharray"};function Vj(t,e,s=1,n=0,i=!0){t.pathLength=1;const r=i?Fj:Ij;t[r.offset]=se.transform(-n);const a=se.transform(e),o=se.transform(s);t[r.array]=`${a} ${o}`}function Yf(t,e,s){return typeof t=="string"?t:se.transform(e+s*t)}function Wj(t,e,s){const n=Yf(e,t.x,t.width),i=Yf(s,t.y,t.height);return`${n} ${i}`}function Od(t,{attrX:e,attrY:s,attrScale:n,originX:i,originY:r,pathLength:a,pathSpacing:o=1,pathOffset:c=0,...d},u,h){if(Ad(t,d,h),u){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:f,style:m,dimensions:p}=t;f.transform&&(p&&(m.transform=f.transform),delete f.transform),p&&(i!==void 0||r!==void 0||m.transform)&&(m.transformOrigin=Wj(p,i!==void 0?i:.5,r!==void 0?r:.5)),e!==void 0&&(f.x=e),s!==void 0&&(f.y=s),n!==void 0&&(f.scale=n),a!==void 0&&Vj(f,a,o,c,!1)}const Rd=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),wx=()=>({...Rd(),attrs:{}}),Ld=t=>typeof t=="string"&&t.toLowerCase()==="svg";function kx(t,{style:e,vars:s},n,i){Object.assign(t.style,e,i&&i.getProjectionStyles(n));for(const r in s)t.style.setProperty(r,s[r])}const Sx=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function jx(t,e,s,n){kx(t,e,void 0,n);for(const i in e.attrs)t.setAttribute(Sx.has(i)?i:Td(i),e.attrs[i])}const Xa={};function Bj(t){Object.assign(Xa,t)}function Nx(t,{layout:e,layoutId:s}){return Cn.has(t)||t.startsWith("origin")||(e||s!==void 0)&&(!!Xa[t]||t==="opacity")}function Fd(t,e,s){var n;const{style:i}=t,r={};for(const a in i)(ot(i[a])||e.style&&ot(e.style[a])||Nx(a,t)||((n=s?.getValue(a))===null||n===void 0?void 0:n.liveStyle)!==void 0)&&(r[a]=i[a]);return r}function Tx(t,e,s){const n=Fd(t,e,s);for(const i in t)if(ot(t[i])||ot(e[i])){const r=ci.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;n[r]=t[i]}return n}function zj(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const Uf=["x","y","width","height","cx","cy","r"],Hj={useVisualState:yx({scrapeMotionValuesFromProps:Tx,createRenderState:wx,onUpdate:({props:t,prevProps:e,current:s,renderState:n,latestValues:i})=>{if(!s)return;let r=!!t.drag;if(!r){for(const o in i)if(Cn.has(o)){r=!0;break}}if(!r)return;let a=!e;if(e)for(let o=0;o<Uf.length;o++){const c=Uf[o];t[c]!==e[c]&&(a=!0)}a&&Ce.read(()=>{zj(s,n),Ce.render(()=>{Od(n,i,Ld(s.tagName),t.transformTemplate),jx(s,n)})})}})},$j={useVisualState:yx({scrapeMotionValuesFromProps:Fd,createRenderState:Rd})};function Mx(t,e,s){for(const n in e)!ot(e[n])&&!Nx(n,s)&&(t[n]=e[n])}function Yj({transformTemplate:t},e){return y.useMemo(()=>{const s=Rd();return Ad(s,e,t),Object.assign({},s.vars,s.style)},[e])}function Uj(t,e){const s=t.style||{},n={};return Mx(n,s,t),Object.assign(n,Yj(t,e)),n}function Gj(t,e){const s={},n=Uj(t,e);return t.drag&&t.dragListener!==!1&&(s.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(s.tabIndex=0),s.style=n,s}function qj(t,e,s,n){const i=y.useMemo(()=>{const r=wx();return Od(r,e,Ld(n),t.transformTemplate),{...r.attrs,style:{...r.style}}},[e]);if(t.style){const r={};Mx(r,t.style,t),i.style={...r,...i.style}}return i}function Kj(t=!1){return(s,n,i,{latestValues:r},a)=>{const c=(Cd(s)?qj:Gj)(n,r,a,s),d=dj(n,typeof s=="string",t),u=s!==y.Fragment?{...d,...c,ref:i}:{},{children:h}=n,f=y.useMemo(()=>ot(h)?h.get():h,[h]);return y.createElement(s,{...u,children:f})}}function Xj(t,e){return function(n,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...Cd(n)?Hj:$j,preloadedFeatures:t,useRender:Kj(i),createVisualElement:e,Component:n};return bj(a)}}function Cx(t,e){if(!Array.isArray(e))return!1;const s=e.length;if(s!==t.length)return!1;for(let n=0;n<s;n++)if(e[n]!==t[n])return!1;return!0}function Co(t,e,s){const n=t.getProps();return Pd(n,e,s!==void 0?s:n.custom,t)}const Zj=Sd(()=>window.ScrollTimeline!==void 0);class Jj{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,s){for(let n=0;n<this.animations.length;n++)this.animations[n][e]=s}attachTimeline(e,s){const n=this.animations.map(i=>{if(Zj()&&i.attachTimeline)return i.attachTimeline(e);if(typeof s=="function")return s(i)});return()=>{n.forEach((i,r)=>{i&&i(),this.animations[r].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let s=0;s<this.animations.length;s++)e=Math.max(e,this.animations[s].duration);return e}runAll(e){this.animations.forEach(s=>s[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Qj extends Jj{then(e,s){return Promise.all(this.animations).then(e).catch(s)}}function Id(t,e){return t?t[e]||t.default||t:void 0}const vc=2e4;function Px(t){let e=0;const s=50;let n=t.next(e);for(;!n.done&&e<vc;)e+=s,n=t.next(e);return e>=vc?1/0:e}function Vd(t){return typeof t=="function"}function Gf(t,e){t.timeline=e,t.onfinish=null}const Wd=t=>Array.isArray(t)&&typeof t[0]=="number",eN={linearEasing:void 0};function tN(t,e){const s=Sd(t);return()=>{var n;return(n=eN[e])!==null&&n!==void 0?n:s()}}const Za=tN(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Dx=(t,e,s=10)=>{let n="";const i=Math.max(Math.round(e/s),2);for(let r=0;r<i;r++)n+=t(ei(0,i-1,r))+", ";return`linear(${n.substring(0,n.length-2)})`};function Ex(t){return!!(typeof t=="function"&&Za()||!t||typeof t=="string"&&(t in _c||Za())||Wd(t)||Array.isArray(t)&&t.every(Ex))}const Hi=([t,e,s,n])=>`cubic-bezier(${t}, ${e}, ${s}, ${n})`,_c={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Hi([0,.65,.55,1]),circOut:Hi([.55,0,1,.45]),backIn:Hi([.31,.01,.66,-.59]),backOut:Hi([.33,1.53,.69,.99])};function Ax(t,e){if(t)return typeof t=="function"&&Za()?Dx(t,e):Wd(t)?Hi(t):Array.isArray(t)?t.map(s=>Ax(s,e)||_c.easeOut):_c[t]}const Ot={x:!1,y:!1};function Ox(){return Ot.x||Ot.y}function sN(t,e,s){var n;if(t instanceof Element)return[t];if(typeof t=="string"){let i=document;const r=(n=void 0)!==null&&n!==void 0?n:i.querySelectorAll(t);return r?Array.from(r):[]}return Array.from(t)}function Rx(t,e){const s=sN(t),n=new AbortController,i={passive:!0,...e,signal:n.signal};return[s,i,()=>n.abort()]}function qf(t){return e=>{e.pointerType==="touch"||Ox()||t(e)}}function nN(t,e,s={}){const[n,i,r]=Rx(t,s),a=qf(o=>{const{target:c}=o,d=e(o);if(typeof d!="function"||!c)return;const u=qf(h=>{d(h),c.removeEventListener("pointerleave",u)});c.addEventListener("pointerleave",u,i)});return n.forEach(o=>{o.addEventListener("pointerenter",a,i)}),r}const Lx=(t,e)=>e?t===e?!0:Lx(t,e.parentElement):!1,Bd=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,iN=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function rN(t){return iN.has(t.tagName)||t.tabIndex!==-1}const $i=new WeakSet;function Kf(t){return e=>{e.key==="Enter"&&t(e)}}function Tl(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const aN=(t,e)=>{const s=t.currentTarget;if(!s)return;const n=Kf(()=>{if($i.has(s))return;Tl(s,"down");const i=Kf(()=>{Tl(s,"up")}),r=()=>Tl(s,"cancel");s.addEventListener("keyup",i,e),s.addEventListener("blur",r,e)});s.addEventListener("keydown",n,e),s.addEventListener("blur",()=>s.removeEventListener("keydown",n),e)};function Xf(t){return Bd(t)&&!Ox()}function oN(t,e,s={}){const[n,i,r]=Rx(t,s),a=o=>{const c=o.currentTarget;if(!Xf(o)||$i.has(c))return;$i.add(c);const d=e(o),u=(m,p)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",f),!(!Xf(m)||!$i.has(c))&&($i.delete(c),typeof d=="function"&&d(m,{success:p}))},h=m=>{u(m,s.useGlobalTarget||Lx(c,m.target))},f=m=>{u(m,!1)};window.addEventListener("pointerup",h,i),window.addEventListener("pointercancel",f,i)};return n.forEach(o=>{!rN(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(s.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),o.addEventListener("focus",d=>aN(d,i),i)}),r}function lN(t){return t==="x"||t==="y"?Ot[t]?null:(Ot[t]=!0,()=>{Ot[t]=!1}):Ot.x||Ot.y?null:(Ot.x=Ot.y=!0,()=>{Ot.x=Ot.y=!1})}const Fx=new Set(["width","height","top","left","right","bottom",...ci]);let Sa;function cN(){Sa=void 0}const Jt={now:()=>(Sa===void 0&&Jt.set(st.isProcessing||ij.useManualTiming?st.timestamp:performance.now()),Sa),set:t=>{Sa=t,queueMicrotask(cN)}};function zd(t,e){t.indexOf(e)===-1&&t.push(e)}function Hd(t,e){const s=t.indexOf(e);s>-1&&t.splice(s,1)}class $d{constructor(){this.subscriptions=[]}add(e){return zd(this.subscriptions,e),()=>Hd(this.subscriptions,e)}notify(e,s,n){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,s,n);else for(let r=0;r<i;r++){const a=this.subscriptions[r];a&&a(e,s,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function Ix(t,e){return e?t*(1e3/e):0}const Zf=30,dN=t=>!isNaN(parseFloat(t));class uN{constructor(e,s={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,i=!0)=>{const r=Jt.now();this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=s.owner}setCurrent(e){this.current=e,this.updatedAt=Jt.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=dN(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,s){this.events[e]||(this.events[e]=new $d);const n=this.events[e].add(s);return e==="change"?()=>{n(),Ce.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,s){this.passiveEffect=e,this.stopPassiveEffect=s}set(e,s=!0){!s||!this.passiveEffect?this.updateAndNotify(e,s):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,s,n){this.set(s),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,s=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,s&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Jt.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>Zf)return 0;const s=Math.min(this.updatedAt-this.prevUpdatedAt,Zf);return Ix(parseFloat(this.current)-parseFloat(this.prevFrameValue),s)}start(e){return this.stop(),new Promise(s=>{this.hasAnimated=!0,this.animation=e(s),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function gr(t,e){return new uN(t,e)}function hN(t,e,s){t.hasValue(e)?t.getValue(e).set(s):t.addValue(e,gr(s))}function fN(t,e){const s=Co(t,e);let{transitionEnd:n={},transition:i={},...r}=s||{};r={...r,...n};for(const a in r){const o=jj(r[a]);hN(t,a,o)}}function mN(t){return!!(ot(t)&&t.add)}function wc(t,e){const s=t.getValue("willChange");if(mN(s))return s.add(e)}function Vx(t){return t.props[px]}const Wx=(t,e,s)=>(((1-3*s+3*e)*t+(3*s-6*e))*t+3*e)*t,pN=1e-7,gN=12;function xN(t,e,s,n,i){let r,a,o=0;do a=e+(s-e)/2,r=Wx(a,n,i)-t,r>0?s=a:e=a;while(Math.abs(r)>pN&&++o<gN);return a}function Dr(t,e,s,n){if(t===e&&s===n)return bt;const i=r=>xN(r,0,1,t,s);return r=>r===0||r===1?r:Wx(i(r),e,n)}const Bx=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,zx=t=>e=>1-t(1-e),Hx=Dr(.33,1.53,.69,.99),Yd=zx(Hx),$x=Bx(Yd),Yx=t=>(t*=2)<1?.5*Yd(t):.5*(2-Math.pow(2,-10*(t-1))),Ud=t=>1-Math.sin(Math.acos(t)),Ux=zx(Ud),Gx=Bx(Ud),qx=t=>/^0[^.\s]+$/u.test(t);function yN(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||qx(t):!0}const Ji=t=>Math.round(t*1e5)/1e5,Gd=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function bN(t){return t==null}const vN=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,qd=(t,e)=>s=>!!(typeof s=="string"&&vN.test(s)&&s.startsWith(t)||e&&!bN(s)&&Object.prototype.hasOwnProperty.call(s,e)),Kx=(t,e,s)=>n=>{if(typeof n!="string")return n;const[i,r,a,o]=n.match(Gd);return{[t]:parseFloat(i),[e]:parseFloat(r),[s]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},_N=t=>ks(0,255,t),Ml={...di,transform:t=>Math.round(_N(t))},gn={test:qd("rgb","red"),parse:Kx("red","green","blue"),transform:({red:t,green:e,blue:s,alpha:n=1})=>"rgba("+Ml.transform(t)+", "+Ml.transform(e)+", "+Ml.transform(s)+", "+Ji(pr.transform(n))+")"};function wN(t){let e="",s="",n="",i="";return t.length>5?(e=t.substring(1,3),s=t.substring(3,5),n=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),s=t.substring(2,3),n=t.substring(3,4),i=t.substring(4,5),e+=e,s+=s,n+=n,i+=i),{red:parseInt(e,16),green:parseInt(s,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}}const kc={test:qd("#"),parse:wN,transform:gn.transform},Wn={test:qd("hsl","hue"),parse:Kx("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:s,alpha:n=1})=>"hsla("+Math.round(t)+", "+Zt.transform(Ji(e))+", "+Zt.transform(Ji(s))+", "+Ji(pr.transform(n))+")"},it={test:t=>gn.test(t)||kc.test(t)||Wn.test(t),parse:t=>gn.test(t)?gn.parse(t):Wn.test(t)?Wn.parse(t):kc.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?gn.transform(t):Wn.transform(t)},kN=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function SN(t){var e,s;return isNaN(t)&&typeof t=="string"&&(((e=t.match(Gd))===null||e===void 0?void 0:e.length)||0)+(((s=t.match(kN))===null||s===void 0?void 0:s.length)||0)>0}const Xx="number",Zx="color",jN="var",NN="var(",Jf="${}",TN=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function xr(t){const e=t.toString(),s=[],n={color:[],number:[],var:[]},i=[];let r=0;const o=e.replace(TN,c=>(it.test(c)?(n.color.push(r),i.push(Zx),s.push(it.parse(c))):c.startsWith(NN)?(n.var.push(r),i.push(jN),s.push(c)):(n.number.push(r),i.push(Xx),s.push(parseFloat(c))),++r,Jf)).split(Jf);return{values:s,split:o,indexes:n,types:i}}function Jx(t){return xr(t).values}function Qx(t){const{split:e,types:s}=xr(t),n=e.length;return i=>{let r="";for(let a=0;a<n;a++)if(r+=e[a],i[a]!==void 0){const o=s[a];o===Xx?r+=Ji(i[a]):o===Zx?r+=it.transform(i[a]):r+=i[a]}return r}}const MN=t=>typeof t=="number"?0:t;function CN(t){const e=Jx(t);return Qx(t)(e.map(MN))}const qs={test:SN,parse:Jx,createTransformer:Qx,getAnimatableNone:CN},PN=new Set(["brightness","contrast","saturate","opacity"]);function DN(t){const[e,s]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=s.match(Gd)||[];if(!n)return t;const i=s.replace(n,"");let r=PN.has(e)?1:0;return n!==s&&(r*=100),e+"("+r+i+")"}const EN=/\b([a-z-]*)\(.*?\)/gu,Sc={...qs,getAnimatableNone:t=>{const e=t.match(EN);return e?e.map(DN).join(" "):t}},AN={...Ed,color:it,backgroundColor:it,outlineColor:it,fill:it,stroke:it,borderColor:it,borderTopColor:it,borderRightColor:it,borderBottomColor:it,borderLeftColor:it,filter:Sc,WebkitFilter:Sc},Kd=t=>AN[t];function ey(t,e){let s=Kd(t);return s!==Sc&&(s=qs),s.getAnimatableNone?s.getAnimatableNone(e):void 0}const ON=new Set(["auto","none","0"]);function RN(t,e,s){let n=0,i;for(;n<t.length&&!i;){const r=t[n];typeof r=="string"&&!ON.has(r)&&xr(r).values.length&&(i=t[n]),n++}if(i&&s)for(const r of e)t[r]=ey(s,i)}const Qf=t=>t===di||t===se,em=(t,e)=>parseFloat(t.split(", ")[e]),tm=(t,e)=>(s,{transform:n})=>{if(n==="none"||!n)return 0;const i=n.match(/^matrix3d\((.+)\)$/u);if(i)return em(i[1],e);{const r=n.match(/^matrix\((.+)\)$/u);return r?em(r[1],t):0}},LN=new Set(["x","y","z"]),FN=ci.filter(t=>!LN.has(t));function IN(t){const e=[];return FN.forEach(s=>{const n=t.getValue(s);n!==void 0&&(e.push([s,n.get()]),n.set(s.startsWith("scale")?1:0))}),e}const si={width:({x:t},{paddingLeft:e="0",paddingRight:s="0"})=>t.max-t.min-parseFloat(e)-parseFloat(s),height:({y:t},{paddingTop:e="0",paddingBottom:s="0"})=>t.max-t.min-parseFloat(e)-parseFloat(s),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:tm(4,13),y:tm(5,14)};si.translateX=si.x;si.translateY=si.y;const _n=new Set;let jc=!1,Nc=!1;function ty(){if(Nc){const t=Array.from(_n).filter(n=>n.needsMeasurement),e=new Set(t.map(n=>n.element)),s=new Map;e.forEach(n=>{const i=IN(n);i.length&&(s.set(n,i),n.render())}),t.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const i=s.get(n);i&&i.forEach(([r,a])=>{var o;(o=n.getValue(r))===null||o===void 0||o.set(a)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}Nc=!1,jc=!1,_n.forEach(t=>t.complete()),_n.clear()}function sy(){_n.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Nc=!0)})}function VN(){sy(),ty()}class Xd{constructor(e,s,n,i,r,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=s,this.name=n,this.motionValue=i,this.element=r,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(_n.add(this),jc||(jc=!0,Ce.read(sy),Ce.resolveKeyframes(ty))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:s,element:n,motionValue:i}=this;for(let r=0;r<e.length;r++)if(e[r]===null)if(r===0){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(n&&s){const c=n.readValue(s,o);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}else e[r]=e[r-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),_n.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,_n.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const ny=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),WN=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function BN(t){const e=WN.exec(t);if(!e)return[,];const[,s,n,i]=e;return[`--${s??n}`,i]}function iy(t,e,s=1){const[n,i]=BN(t);if(!n)return;const r=window.getComputedStyle(e).getPropertyValue(n);if(r){const a=r.trim();return ny(a)?parseFloat(a):a}return Dd(i)?iy(i,e,s+1):i}const ry=t=>e=>e.test(t),zN={test:t=>t==="auto",parse:t=>t},ay=[di,se,Zt,Es,Dj,Pj,zN],sm=t=>ay.find(ry(t));class oy extends Xd{constructor(e,s,n,i,r){super(e,s,n,i,r,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:s,name:n}=this;if(!s||!s.current)return;super.readKeyframes();for(let c=0;c<e.length;c++){let d=e[c];if(typeof d=="string"&&(d=d.trim(),Dd(d))){const u=iy(d,s.current);u!==void 0&&(e[c]=u),c===e.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!Fx.has(n)||e.length!==2)return;const[i,r]=e,a=sm(i),o=sm(r);if(a!==o)if(Qf(a)&&Qf(o))for(let c=0;c<e.length;c++){const d=e[c];typeof d=="string"&&(e[c]=parseFloat(d))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:s}=this,n=[];for(let i=0;i<e.length;i++)yN(e[i])&&n.push(i);n.length&&RN(e,n,s)}measureInitialState(){const{element:e,unresolvedKeyframes:s,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=si[n](e.measureViewportBox(),window.getComputedStyle(e.current)),s[0]=this.measuredOrigin;const i=s[s.length-1];i!==void 0&&e.getValue(n,i).jump(i,!1)}measureEndState(){var e;const{element:s,name:n,unresolvedKeyframes:i}=this;if(!s||!s.current)return;const r=s.getValue(n);r&&r.jump(this.measuredOrigin,!1);const a=i.length-1,o=i[a];i[a]=si[n](s.measureViewportBox(),window.getComputedStyle(s.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([c,d])=>{s.getValue(c).set(d)}),this.resolveNoneKeyframes()}}const nm=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(qs.test(t)||t==="0")&&!t.startsWith("url("));function HN(t){const e=t[0];if(t.length===1)return!0;for(let s=0;s<t.length;s++)if(t[s]!==e)return!0}function $N(t,e,s,n){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const r=t[t.length-1],a=nm(i,e),o=nm(r,e);return!a||!o?!1:HN(t)||(s==="spring"||Vd(s))&&n}const YN=t=>t!==null;function Po(t,{repeat:e,repeatType:s="loop"},n){const i=t.filter(YN),r=e&&s!=="loop"&&e%2===1?0:i.length-1;return!r||n===void 0?i[r]:n}const UN=40;class ly{constructor({autoplay:e=!0,delay:s=0,type:n="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:a="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Jt.now(),this.options={autoplay:e,delay:s,type:n,repeat:i,repeatDelay:r,repeatType:a,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>UN?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&VN(),this._resolved}onKeyframesResolved(e,s){this.resolvedAt=Jt.now(),this.hasAttemptedResolve=!0;const{name:n,type:i,velocity:r,delay:a,onComplete:o,onUpdate:c,isGenerator:d}=this.options;if(!d&&!$N(e,n,i,r))if(a)this.options.duration=0;else{c&&c(Po(e,this.options,s)),o&&o(),this.resolveFinishedPromise();return}const u=this.initPlayback(e,s);u!==!1&&(this._resolved={keyframes:e,finalKeyframe:s,...u},this.onPostResolved())}onPostResolved(){}then(e,s){return this.currentFinishedPromise.then(e,s)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Ie=(t,e,s)=>t+(e-t)*s;function Cl(t,e,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?t+(e-t)*6*s:s<1/2?e:s<2/3?t+(e-t)*(2/3-s)*6:t}function GN({hue:t,saturation:e,lightness:s,alpha:n}){t/=360,e/=100,s/=100;let i=0,r=0,a=0;if(!e)i=r=a=s;else{const o=s<.5?s*(1+e):s+e-s*e,c=2*s-o;i=Cl(c,o,t+1/3),r=Cl(c,o,t),a=Cl(c,o,t-1/3)}return{red:Math.round(i*255),green:Math.round(r*255),blue:Math.round(a*255),alpha:n}}function Ja(t,e){return s=>s>0?e:t}const Pl=(t,e,s)=>{const n=t*t,i=s*(e*e-n)+n;return i<0?0:Math.sqrt(i)},qN=[kc,gn,Wn],KN=t=>qN.find(e=>e.test(t));function im(t){const e=KN(t);if(!e)return!1;let s=e.parse(t);return e===Wn&&(s=GN(s)),s}const rm=(t,e)=>{const s=im(t),n=im(e);if(!s||!n)return Ja(t,e);const i={...s};return r=>(i.red=Pl(s.red,n.red,r),i.green=Pl(s.green,n.green,r),i.blue=Pl(s.blue,n.blue,r),i.alpha=Ie(s.alpha,n.alpha,r),gn.transform(i))},XN=(t,e)=>s=>e(t(s)),Er=(...t)=>t.reduce(XN),Tc=new Set(["none","hidden"]);function ZN(t,e){return Tc.has(t)?s=>s<=0?t:e:s=>s>=1?e:t}function JN(t,e){return s=>Ie(t,e,s)}function Zd(t){return typeof t=="number"?JN:typeof t=="string"?Dd(t)?Ja:it.test(t)?rm:tT:Array.isArray(t)?cy:typeof t=="object"?it.test(t)?rm:QN:Ja}function cy(t,e){const s=[...t],n=s.length,i=t.map((r,a)=>Zd(r)(r,e[a]));return r=>{for(let a=0;a<n;a++)s[a]=i[a](r);return s}}function QN(t,e){const s={...t,...e},n={};for(const i in s)t[i]!==void 0&&e[i]!==void 0&&(n[i]=Zd(t[i])(t[i],e[i]));return i=>{for(const r in n)s[r]=n[r](i);return s}}function eT(t,e){var s;const n=[],i={color:0,var:0,number:0};for(let r=0;r<e.values.length;r++){const a=e.types[r],o=t.indexes[a][i[a]],c=(s=t.values[o])!==null&&s!==void 0?s:0;n[r]=c,i[a]++}return n}const tT=(t,e)=>{const s=qs.createTransformer(e),n=xr(t),i=xr(e);return n.indexes.var.length===i.indexes.var.length&&n.indexes.color.length===i.indexes.color.length&&n.indexes.number.length>=i.indexes.number.length?Tc.has(t)&&!i.values.length||Tc.has(e)&&!n.values.length?ZN(t,e):Er(cy(eT(n,i),i.values),s):Ja(t,e)};function dy(t,e,s){return typeof t=="number"&&typeof e=="number"&&typeof s=="number"?Ie(t,e,s):Zd(t)(t,e)}const sT=5;function uy(t,e,s){const n=Math.max(e-sT,0);return Ix(s-t(n),e-n)}const ze={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Dl=.001;function nT({duration:t=ze.duration,bounce:e=ze.bounce,velocity:s=ze.velocity,mass:n=ze.mass}){let i,r,a=1-e;a=ks(ze.minDamping,ze.maxDamping,a),t=ks(ze.minDuration,ze.maxDuration,vs(t)),a<1?(i=d=>{const u=d*a,h=u*t,f=u-s,m=Mc(d,a),p=Math.exp(-h);return Dl-f/m*p},r=d=>{const h=d*a*t,f=h*s+s,m=Math.pow(a,2)*Math.pow(d,2)*t,p=Math.exp(-h),g=Mc(Math.pow(d,2),a);return(-i(d)+Dl>0?-1:1)*((f-m)*p)/g}):(i=d=>{const u=Math.exp(-d*t),h=(d-s)*t+1;return-Dl+u*h},r=d=>{const u=Math.exp(-d*t),h=(s-d)*(t*t);return u*h});const o=5/t,c=rT(i,r,o);if(t=bs(t),isNaN(c))return{stiffness:ze.stiffness,damping:ze.damping,duration:t};{const d=Math.pow(c,2)*n;return{stiffness:d,damping:a*2*Math.sqrt(n*d),duration:t}}}const iT=12;function rT(t,e,s){let n=s;for(let i=1;i<iT;i++)n=n-t(n)/e(n);return n}function Mc(t,e){return t*Math.sqrt(1-e*e)}const aT=["duration","bounce"],oT=["stiffness","damping","mass"];function am(t,e){return e.some(s=>t[s]!==void 0)}function lT(t){let e={velocity:ze.velocity,stiffness:ze.stiffness,damping:ze.damping,mass:ze.mass,isResolvedFromDuration:!1,...t};if(!am(t,oT)&&am(t,aT))if(t.visualDuration){const s=t.visualDuration,n=2*Math.PI/(s*1.2),i=n*n,r=2*ks(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:ze.mass,stiffness:i,damping:r}}else{const s=nT(t);e={...e,...s,mass:ze.mass},e.isResolvedFromDuration=!0}return e}function hy(t=ze.visualDuration,e=ze.bounce){const s=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:i}=s;const r=s.keyframes[0],a=s.keyframes[s.keyframes.length-1],o={done:!1,value:r},{stiffness:c,damping:d,mass:u,duration:h,velocity:f,isResolvedFromDuration:m}=lT({...s,velocity:-vs(s.velocity||0)}),p=f||0,g=d/(2*Math.sqrt(c*u)),x=a-r,v=vs(Math.sqrt(c/u)),_=Math.abs(x)<5;n||(n=_?ze.restSpeed.granular:ze.restSpeed.default),i||(i=_?ze.restDelta.granular:ze.restDelta.default);let S;if(g<1){const j=Mc(v,g);S=k=>{const T=Math.exp(-g*v*k);return a-T*((p+g*v*x)/j*Math.sin(j*k)+x*Math.cos(j*k))}}else if(g===1)S=j=>a-Math.exp(-v*j)*(x+(p+v*x)*j);else{const j=v*Math.sqrt(g*g-1);S=k=>{const T=Math.exp(-g*v*k),M=Math.min(j*k,300);return a-T*((p+g*v*x)*Math.sinh(M)+j*x*Math.cosh(M))/j}}const N={calculatedDuration:m&&h||null,next:j=>{const k=S(j);if(m)o.done=j>=h;else{let T=0;g<1&&(T=j===0?bs(p):uy(S,j,k));const M=Math.abs(T)<=n,P=Math.abs(a-k)<=i;o.done=M&&P}return o.value=o.done?a:k,o},toString:()=>{const j=Math.min(Px(N),vc),k=Dx(T=>N.next(j*T).value,j,30);return j+"ms "+k}};return N}function om({keyframes:t,velocity:e=0,power:s=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:r=500,modifyTarget:a,min:o,max:c,restDelta:d=.5,restSpeed:u}){const h=t[0],f={done:!1,value:h},m=M=>o!==void 0&&M<o||c!==void 0&&M>c,p=M=>o===void 0?c:c===void 0||Math.abs(o-M)<Math.abs(c-M)?o:c;let g=s*e;const x=h+g,v=a===void 0?x:a(x);v!==x&&(g=v-h);const _=M=>-g*Math.exp(-M/n),S=M=>v+_(M),N=M=>{const P=_(M),O=S(M);f.done=Math.abs(P)<=d,f.value=f.done?v:O};let j,k;const T=M=>{m(f.value)&&(j=M,k=hy({keyframes:[f.value,p(f.value)],velocity:uy(S,M,f.value),damping:i,stiffness:r,restDelta:d,restSpeed:u}))};return T(0),{calculatedDuration:null,next:M=>{let P=!1;return!k&&j===void 0&&(P=!0,N(M),T(M)),j!==void 0&&M>=j?k.next(M-j):(!P&&N(M),f)}}}const cT=Dr(.42,0,1,1),dT=Dr(0,0,.58,1),fy=Dr(.42,0,.58,1),uT=t=>Array.isArray(t)&&typeof t[0]!="number",hT={linear:bt,easeIn:cT,easeInOut:fy,easeOut:dT,circIn:Ud,circInOut:Gx,circOut:Ux,backIn:Yd,backInOut:$x,backOut:Hx,anticipate:Yx},lm=t=>{if(Wd(t)){dx(t.length===4);const[e,s,n,i]=t;return Dr(e,s,n,i)}else if(typeof t=="string")return hT[t];return t};function fT(t,e,s){const n=[],i=s||dy,r=t.length-1;for(let a=0;a<r;a++){let o=i(t[a],t[a+1]);if(e){const c=Array.isArray(e)?e[a]||bt:e;o=Er(c,o)}n.push(o)}return n}function mT(t,e,{clamp:s=!0,ease:n,mixer:i}={}){const r=t.length;if(dx(r===e.length),r===1)return()=>e[0];if(r===2&&e[0]===e[1])return()=>e[1];const a=t[0]===t[1];t[0]>t[r-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=fT(e,n,i),c=o.length,d=u=>{if(a&&u<t[0])return e[0];let h=0;if(c>1)for(;h<t.length-2&&!(u<t[h+1]);h++);const f=ei(t[h],t[h+1],u);return o[h](f)};return s?u=>d(ks(t[0],t[r-1],u)):d}function pT(t,e){const s=t[t.length-1];for(let n=1;n<=e;n++){const i=ei(0,e,n);t.push(Ie(s,1,i))}}function gT(t){const e=[0];return pT(e,t.length-1),e}function xT(t,e){return t.map(s=>s*e)}function yT(t,e){return t.map(()=>e||fy).splice(0,t.length-1)}function Qa({duration:t=300,keyframes:e,times:s,ease:n="easeInOut"}){const i=uT(n)?n.map(lm):lm(n),r={done:!1,value:e[0]},a=xT(s&&s.length===e.length?s:gT(e),t),o=mT(a,e,{ease:Array.isArray(i)?i:yT(e,i)});return{calculatedDuration:t,next:c=>(r.value=o(c),r.done=c>=t,r)}}const bT=t=>{const e=({timestamp:s})=>t(s);return{start:()=>Ce.update(e,!0),stop:()=>Gs(e),now:()=>st.isProcessing?st.timestamp:Jt.now()}},vT={decay:om,inertia:om,tween:Qa,keyframes:Qa,spring:hy},_T=t=>t/100;class Jd extends ly{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:c}=this.options;c&&c()};const{name:s,motionValue:n,element:i,keyframes:r}=this.options,a=i?.KeyframeResolver||Xd,o=(c,d)=>this.onKeyframesResolved(c,d);this.resolver=new a(r,o,s,n,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:s="keyframes",repeat:n=0,repeatDelay:i=0,repeatType:r,velocity:a=0}=this.options,o=Vd(s)?s:vT[s]||Qa;let c,d;o!==Qa&&typeof e[0]!="number"&&(c=Er(_T,dy(e[0],e[1])),e=[0,100]);const u=o({...this.options,keyframes:e});r==="mirror"&&(d=o({...this.options,keyframes:[...e].reverse(),velocity:-a})),u.calculatedDuration===null&&(u.calculatedDuration=Px(u));const{calculatedDuration:h}=u,f=h+i,m=f*(n+1)-i;return{generator:u,mirroredGenerator:d,mapPercentToKeyframes:c,calculatedDuration:h,resolvedDuration:f,totalDuration:m}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,s=!1){const{resolved:n}=this;if(!n){const{keyframes:M}=this.options;return{done:!0,value:M[M.length-1]}}const{finalKeyframe:i,generator:r,mirroredGenerator:a,mapPercentToKeyframes:o,keyframes:c,calculatedDuration:d,totalDuration:u,resolvedDuration:h}=n;if(this.startTime===null)return r.next(0);const{delay:f,repeat:m,repeatType:p,repeatDelay:g,onUpdate:x}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-u/this.speed,this.startTime)),s?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const v=this.currentTime-f*(this.speed>=0?1:-1),_=this.speed>=0?v<0:v>u;this.currentTime=Math.max(v,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let S=this.currentTime,N=r;if(m){const M=Math.min(this.currentTime,u)/h;let P=Math.floor(M),O=M%1;!O&&M>=1&&(O=1),O===1&&P--,P=Math.min(P,m+1),P%2&&(p==="reverse"?(O=1-O,g&&(O-=g/h)):p==="mirror"&&(N=a)),S=ks(0,1,O)*h}const j=_?{done:!1,value:c[0]}:N.next(S);o&&(j.value=o(j.value));let{done:k}=j;!_&&d!==null&&(k=this.speed>=0?this.currentTime>=u:this.currentTime<=0);const T=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&k);return T&&i!==void 0&&(j.value=Po(c,this.options,i)),x&&x(j.value),T&&this.finish(),j}get duration(){const{resolved:e}=this;return e?vs(e.calculatedDuration):0}get time(){return vs(this.currentTime)}set time(e){e=bs(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const s=this.playbackSpeed!==e;this.playbackSpeed=e,s&&(this.time=vs(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=bT,onPlay:s,startTime:n}=this.options;this.driver||(this.driver=e(r=>this.tick(r))),s&&s();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=n??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const wT=new Set(["opacity","clipPath","filter","transform"]);function kT(t,e,s,{delay:n=0,duration:i=300,repeat:r=0,repeatType:a="loop",ease:o="easeInOut",times:c}={}){const d={[e]:s};c&&(d.offset=c);const u=Ax(o,i);return Array.isArray(u)&&(d.easing=u),t.animate(d,{delay:n,duration:i,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:r+1,direction:a==="reverse"?"alternate":"normal"})}const ST=Sd(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),eo=10,jT=2e4;function NT(t){return Vd(t.type)||t.type==="spring"||!Ex(t.ease)}function TT(t,e){const s=new Jd({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let n={done:!1,value:t[0]};const i=[];let r=0;for(;!n.done&&r<jT;)n=s.sample(r),i.push(n.value),r+=eo;return{times:void 0,keyframes:i,duration:r-eo,ease:"linear"}}const my={anticipate:Yx,backInOut:$x,circInOut:Gx};function MT(t){return t in my}class cm extends ly{constructor(e){super(e);const{name:s,motionValue:n,element:i,keyframes:r}=this.options;this.resolver=new oy(r,(a,o)=>this.onKeyframesResolved(a,o),s,n,i),this.resolver.scheduleResolve()}initPlayback(e,s){let{duration:n=300,times:i,ease:r,type:a,motionValue:o,name:c,startTime:d}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof r=="string"&&Za()&&MT(r)&&(r=my[r]),NT(this.options)){const{onComplete:h,onUpdate:f,motionValue:m,element:p,...g}=this.options,x=TT(e,g);e=x.keyframes,e.length===1&&(e[1]=e[0]),n=x.duration,i=x.times,r=x.ease,a="keyframes"}const u=kT(o.owner.current,c,e,{...this.options,duration:n,times:i,ease:r});return u.startTime=d??this.calcStartTime(),this.pendingTimeline?(Gf(u,this.pendingTimeline),this.pendingTimeline=void 0):u.onfinish=()=>{const{onComplete:h}=this.options;o.set(Po(e,this.options,s)),h&&h(),this.cancel(),this.resolveFinishedPromise()},{animation:u,duration:n,times:i,type:a,ease:r,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:s}=e;return vs(s)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:s}=e;return vs(s.currentTime||0)}set time(e){const{resolved:s}=this;if(!s)return;const{animation:n}=s;n.currentTime=bs(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:s}=e;return s.playbackRate}set speed(e){const{resolved:s}=this;if(!s)return;const{animation:n}=s;n.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:s}=e;return s.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:s}=e;return s.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:s}=this;if(!s)return bt;const{animation:n}=s;Gf(n,e)}return bt}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:s}=e;s.playState==="finished"&&this.updateFinishedPromise(),s.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:s}=e;s.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:s,keyframes:n,duration:i,type:r,ease:a,times:o}=e;if(s.playState==="idle"||s.playState==="finished")return;if(this.time){const{motionValue:d,onUpdate:u,onComplete:h,element:f,...m}=this.options,p=new Jd({...m,keyframes:n,duration:i,type:r,ease:a,times:o,isGenerator:!0}),g=bs(this.time);d.setWithVelocity(p.sample(g-eo).value,p.sample(g).value,eo)}const{onStop:c}=this.options;c&&c(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:s,name:n,repeatDelay:i,repeatType:r,damping:a,type:o}=e;if(!s||!s.owner||!(s.owner.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:d}=s.owner.getProps();return ST()&&n&&wT.has(n)&&!c&&!d&&!i&&r!=="mirror"&&a!==0&&o!=="inertia"}}const CT={type:"spring",stiffness:500,damping:25,restSpeed:10},PT=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),DT={type:"keyframes",duration:.8},ET={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},AT=(t,{keyframes:e})=>e.length>2?DT:Cn.has(t)?t.startsWith("scale")?PT(e[1]):CT:ET;function OT({when:t,delay:e,delayChildren:s,staggerChildren:n,staggerDirection:i,repeat:r,repeatType:a,repeatDelay:o,from:c,elapsed:d,...u}){return!!Object.keys(u).length}const Qd=(t,e,s,n={},i,r)=>a=>{const o=Id(n,t)||{},c=o.delay||n.delay||0;let{elapsed:d=0}=n;d=d-bs(c);let u={keyframes:Array.isArray(s)?s:[null,s],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-d,onUpdate:f=>{e.set(f),o.onUpdate&&o.onUpdate(f)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:t,motionValue:e,element:r?void 0:i};OT(o)||(u={...u,...AT(t,u)}),u.duration&&(u.duration=bs(u.duration)),u.repeatDelay&&(u.repeatDelay=bs(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let h=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(h=!0)),h&&!r&&e.get()!==void 0){const f=Po(u.keyframes,o);if(f!==void 0)return Ce.update(()=>{u.onUpdate(f),u.onComplete()}),new Qj([])}return!r&&cm.supports(u)?new cm(u):new Jd(u)};function RT({protectedKeys:t,needsAnimating:e},s){const n=t.hasOwnProperty(s)&&e[s]!==!0;return e[s]=!1,n}function py(t,e,{delay:s=0,transitionOverride:n,type:i}={}){var r;let{transition:a=t.getDefaultTransition(),transitionEnd:o,...c}=e;n&&(a=n);const d=[],u=i&&t.animationState&&t.animationState.getState()[i];for(const h in c){const f=t.getValue(h,(r=t.latestValues[h])!==null&&r!==void 0?r:null),m=c[h];if(m===void 0||u&&RT(u,h))continue;const p={delay:s,...Id(a||{},h)};let g=!1;if(window.MotionHandoffAnimation){const v=Vx(t);if(v){const _=window.MotionHandoffAnimation(v,h,Ce);_!==null&&(p.startTime=_,g=!0)}}wc(t,h),f.start(Qd(h,f,m,t.shouldReduceMotion&&Fx.has(h)?{type:!1}:p,t,g));const x=f.animation;x&&d.push(x)}return o&&Promise.all(d).then(()=>{Ce.update(()=>{o&&fN(t,o)})}),d}function Cc(t,e,s={}){var n;const i=Co(t,e,s.type==="exit"?(n=t.presenceContext)===null||n===void 0?void 0:n.custom:void 0);let{transition:r=t.getDefaultTransition()||{}}=i||{};s.transitionOverride&&(r=s.transitionOverride);const a=i?()=>Promise.all(py(t,i,s)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(d=0)=>{const{delayChildren:u=0,staggerChildren:h,staggerDirection:f}=r;return LT(t,e,u+d,h,f,s)}:()=>Promise.resolve(),{when:c}=r;if(c){const[d,u]=c==="beforeChildren"?[a,o]:[o,a];return d().then(()=>u())}else return Promise.all([a(),o(s.delay)])}function LT(t,e,s=0,n=0,i=1,r){const a=[],o=(t.variantChildren.size-1)*n,c=i===1?(d=0)=>d*n:(d=0)=>o-d*n;return Array.from(t.variantChildren).sort(FT).forEach((d,u)=>{d.notify("AnimationStart",e),a.push(Cc(d,e,{...r,delay:s+c(u)}).then(()=>d.notify("AnimationComplete",e)))}),Promise.all(a)}function FT(t,e){return t.sortNodePosition(e)}function IT(t,e,s={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const i=e.map(r=>Cc(t,r,s));n=Promise.all(i)}else if(typeof e=="string")n=Cc(t,e,s);else{const i=typeof e=="function"?Co(t,e,s.custom):e;n=Promise.all(py(t,i,s))}return n.then(()=>{t.notify("AnimationComplete",e)})}const VT=Nd.length;function gy(t){if(!t)return;if(!t.isControllingVariants){const s=t.parent?gy(t.parent)||{}:{};return t.props.initial!==void 0&&(s.initial=t.props.initial),s}const e={};for(let s=0;s<VT;s++){const n=Nd[s],i=t.props[n];(mr(i)||i===!1)&&(e[n]=i)}return e}const WT=[...jd].reverse(),BT=jd.length;function zT(t){return e=>Promise.all(e.map(({animation:s,options:n})=>IT(t,s,n)))}function HT(t){let e=zT(t),s=dm(),n=!0;const i=c=>(d,u)=>{var h;const f=Co(t,u,c==="exit"?(h=t.presenceContext)===null||h===void 0?void 0:h.custom:void 0);if(f){const{transition:m,transitionEnd:p,...g}=f;d={...d,...g,...p}}return d};function r(c){e=c(t)}function a(c){const{props:d}=t,u=gy(t.parent)||{},h=[],f=new Set;let m={},p=1/0;for(let x=0;x<BT;x++){const v=WT[x],_=s[v],S=d[v]!==void 0?d[v]:u[v],N=mr(S),j=v===c?_.isActive:null;j===!1&&(p=x);let k=S===u[v]&&S!==d[v]&&N;if(k&&n&&t.manuallyAnimateOnMount&&(k=!1),_.protectedKeys={...m},!_.isActive&&j===null||!S&&!_.prevProp||To(S)||typeof S=="boolean")continue;const T=$T(_.prevProp,S);let M=T||v===c&&_.isActive&&!k&&N||x>p&&N,P=!1;const O=Array.isArray(S)?S:[S];let A=O.reduce(i(v),{});j===!1&&(A={});const{prevResolvedValues:F={}}=_,X={...F,...A},H=Y=>{M=!0,f.has(Y)&&(P=!0,f.delete(Y)),_.needsAnimating[Y]=!0;const oe=t.getValue(Y);oe&&(oe.liveStyle=!1)};for(const Y in X){const oe=A[Y],ue=F[Y];if(m.hasOwnProperty(Y))continue;let Se=!1;bc(oe)&&bc(ue)?Se=!Cx(oe,ue):Se=oe!==ue,Se?oe!=null?H(Y):f.add(Y):oe!==void 0&&f.has(Y)?H(Y):_.protectedKeys[Y]=!0}_.prevProp=S,_.prevResolvedValues=A,_.isActive&&(m={...m,...A}),n&&t.blockInitialAnimation&&(M=!1),M&&(!(k&&T)||P)&&h.push(...O.map(Y=>({animation:Y,options:{type:v}})))}if(f.size){const x={};f.forEach(v=>{const _=t.getBaseTarget(v),S=t.getValue(v);S&&(S.liveStyle=!0),x[v]=_??null}),h.push({animation:x})}let g=!!h.length;return n&&(d.initial===!1||d.initial===d.animate)&&!t.manuallyAnimateOnMount&&(g=!1),n=!1,g?e(h):Promise.resolve()}function o(c,d){var u;if(s[c].isActive===d)return Promise.resolve();(u=t.variantChildren)===null||u===void 0||u.forEach(f=>{var m;return(m=f.animationState)===null||m===void 0?void 0:m.setActive(c,d)}),s[c].isActive=d;const h=a(c);for(const f in s)s[f].protectedKeys={};return h}return{animateChanges:a,setActive:o,setAnimateFunction:r,getState:()=>s,reset:()=>{s=dm(),n=!0}}}function $T(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!Cx(e,t):!1}function dn(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function dm(){return{animate:dn(!0),whileInView:dn(),whileHover:dn(),whileTap:dn(),whileDrag:dn(),whileFocus:dn(),exit:dn()}}class Js{constructor(e){this.isMounted=!1,this.node=e}update(){}}class YT extends Js{constructor(e){super(e),e.animationState||(e.animationState=HT(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();To(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:s}=this.node.prevProps||{};e!==s&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let UT=0;class GT extends Js{constructor(){super(...arguments),this.id=UT++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:s}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const i=this.node.animationState.setActive("exit",!e);s&&!e&&i.then(()=>s(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const qT={animation:{Feature:YT},exit:{Feature:GT}};function yr(t,e,s,n={passive:!0}){return t.addEventListener(e,s,n),()=>t.removeEventListener(e,s)}function Ar(t){return{point:{x:t.pageX,y:t.pageY}}}const KT=t=>e=>Bd(e)&&t(e,Ar(e));function Qi(t,e,s,n){return yr(t,e,KT(s),n)}const um=(t,e)=>Math.abs(t-e);function XT(t,e){const s=um(t.x,e.x),n=um(t.y,e.y);return Math.sqrt(s**2+n**2)}class xy{constructor(e,s,{transformPagePoint:n,contextWindow:i,dragSnapToOrigin:r=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=Al(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,m=XT(h.offset,{x:0,y:0})>=3;if(!f&&!m)return;const{point:p}=h,{timestamp:g}=st;this.history.push({...p,timestamp:g});const{onStart:x,onMove:v}=this.handlers;f||(x&&x(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,h)},this.handlePointerMove=(h,f)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=El(f,this.transformPagePoint),Ce.update(this.updatePoint,!0)},this.handlePointerUp=(h,f)=>{this.end();const{onEnd:m,onSessionEnd:p,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const x=Al(h.type==="pointercancel"?this.lastMoveEventInfo:El(f,this.transformPagePoint),this.history);this.startEvent&&m&&m(h,x),p&&p(h,x)},!Bd(e))return;this.dragSnapToOrigin=r,this.handlers=s,this.transformPagePoint=n,this.contextWindow=i||window;const a=Ar(e),o=El(a,this.transformPagePoint),{point:c}=o,{timestamp:d}=st;this.history=[{...c,timestamp:d}];const{onSessionStart:u}=s;u&&u(e,Al(o,this.history)),this.removeListeners=Er(Qi(this.contextWindow,"pointermove",this.handlePointerMove),Qi(this.contextWindow,"pointerup",this.handlePointerUp),Qi(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Gs(this.updatePoint)}}function El(t,e){return e?{point:e(t.point)}:t}function hm(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Al({point:t},e){return{point:t,delta:hm(t,yy(e)),offset:hm(t,ZT(e)),velocity:JT(e,.1)}}function ZT(t){return t[0]}function yy(t){return t[t.length-1]}function JT(t,e){if(t.length<2)return{x:0,y:0};let s=t.length-1,n=null;const i=yy(t);for(;s>=0&&(n=t[s],!(i.timestamp-n.timestamp>bs(e)));)s--;if(!n)return{x:0,y:0};const r=vs(i.timestamp-n.timestamp);if(r===0)return{x:0,y:0};const a={x:(i.x-n.x)/r,y:(i.y-n.y)/r};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const by=1e-4,QT=1-by,eM=1+by,vy=.01,tM=0-vy,sM=0+vy;function vt(t){return t.max-t.min}function nM(t,e,s){return Math.abs(t-e)<=s}function fm(t,e,s,n=.5){t.origin=n,t.originPoint=Ie(e.min,e.max,t.origin),t.scale=vt(s)/vt(e),t.translate=Ie(s.min,s.max,t.origin)-t.originPoint,(t.scale>=QT&&t.scale<=eM||isNaN(t.scale))&&(t.scale=1),(t.translate>=tM&&t.translate<=sM||isNaN(t.translate))&&(t.translate=0)}function er(t,e,s,n){fm(t.x,e.x,s.x,n?n.originX:void 0),fm(t.y,e.y,s.y,n?n.originY:void 0)}function mm(t,e,s){t.min=s.min+e.min,t.max=t.min+vt(e)}function iM(t,e,s){mm(t.x,e.x,s.x),mm(t.y,e.y,s.y)}function pm(t,e,s){t.min=e.min-s.min,t.max=t.min+vt(e)}function tr(t,e,s){pm(t.x,e.x,s.x),pm(t.y,e.y,s.y)}function rM(t,{min:e,max:s},n){return e!==void 0&&t<e?t=n?Ie(e,t,n.min):Math.max(t,e):s!==void 0&&t>s&&(t=n?Ie(s,t,n.max):Math.min(t,s)),t}function gm(t,e,s){return{min:e!==void 0?t.min+e:void 0,max:s!==void 0?t.max+s-(t.max-t.min):void 0}}function aM(t,{top:e,left:s,bottom:n,right:i}){return{x:gm(t.x,s,i),y:gm(t.y,e,n)}}function xm(t,e){let s=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([s,n]=[n,s]),{min:s,max:n}}function oM(t,e){return{x:xm(t.x,e.x),y:xm(t.y,e.y)}}function lM(t,e){let s=.5;const n=vt(t),i=vt(e);return i>n?s=ei(e.min,e.max-n,t.min):n>i&&(s=ei(t.min,t.max-i,e.min)),ks(0,1,s)}function cM(t,e){const s={};return e.min!==void 0&&(s.min=e.min-t.min),e.max!==void 0&&(s.max=e.max-t.min),s}const Pc=.35;function dM(t=Pc){return t===!1?t=0:t===!0&&(t=Pc),{x:ym(t,"left","right"),y:ym(t,"top","bottom")}}function ym(t,e,s){return{min:bm(t,e),max:bm(t,s)}}function bm(t,e){return typeof t=="number"?t:t[e]||0}const vm=()=>({translate:0,scale:1,origin:0,originPoint:0}),Bn=()=>({x:vm(),y:vm()}),_m=()=>({min:0,max:0}),Ue=()=>({x:_m(),y:_m()});function jt(t){return[t("x"),t("y")]}function _y({top:t,left:e,right:s,bottom:n}){return{x:{min:e,max:s},y:{min:t,max:n}}}function uM({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function hM(t,e){if(!e)return t;const s=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:s.y,left:s.x,bottom:n.y,right:n.x}}function Ol(t){return t===void 0||t===1}function Dc({scale:t,scaleX:e,scaleY:s}){return!Ol(t)||!Ol(e)||!Ol(s)}function mn(t){return Dc(t)||wy(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function wy(t){return wm(t.x)||wm(t.y)}function wm(t){return t&&t!=="0%"}function to(t,e,s){const n=t-s,i=e*n;return s+i}function km(t,e,s,n,i){return i!==void 0&&(t=to(t,i,n)),to(t,s,n)+e}function Ec(t,e=0,s=1,n,i){t.min=km(t.min,e,s,n,i),t.max=km(t.max,e,s,n,i)}function ky(t,{x:e,y:s}){Ec(t.x,e.translate,e.scale,e.originPoint),Ec(t.y,s.translate,s.scale,s.originPoint)}const Sm=.999999999999,jm=1.0000000000001;function fM(t,e,s,n=!1){const i=s.length;if(!i)return;e.x=e.y=1;let r,a;for(let o=0;o<i;o++){r=s[o],a=r.projectionDelta;const{visualElement:c}=r.options;c&&c.props.style&&c.props.style.display==="contents"||(n&&r.options.layoutScroll&&r.scroll&&r!==r.root&&Hn(t,{x:-r.scroll.offset.x,y:-r.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,ky(t,a)),n&&mn(r.latestValues)&&Hn(t,r.latestValues))}e.x<jm&&e.x>Sm&&(e.x=1),e.y<jm&&e.y>Sm&&(e.y=1)}function zn(t,e){t.min=t.min+e,t.max=t.max+e}function Nm(t,e,s,n,i=.5){const r=Ie(t.min,t.max,i);Ec(t,e,s,r,n)}function Hn(t,e){Nm(t.x,e.x,e.scaleX,e.scale,e.originX),Nm(t.y,e.y,e.scaleY,e.scale,e.originY)}function Sy(t,e){return _y(hM(t.getBoundingClientRect(),e))}function mM(t,e,s){const n=Sy(t,s),{scroll:i}=e;return i&&(zn(n.x,i.offset.x),zn(n.y,i.offset.y)),n}const jy=({current:t})=>t?t.ownerDocument.defaultView:null,pM=new WeakMap;class gM{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ue(),this.visualElement=e}start(e,{snapToCursor:s=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const i=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),s&&this.snapToCursor(Ar(u).point)},r=(u,h)=>{const{drag:f,dragPropagation:m,onDragStart:p}=this.getProps();if(f&&!m&&(this.openDragLock&&this.openDragLock(),this.openDragLock=lN(f),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),jt(x=>{let v=this.getAxisMotionValue(x).get()||0;if(Zt.test(v)){const{projection:_}=this.visualElement;if(_&&_.layout){const S=_.layout.layoutBox[x];S&&(v=vt(S)*(parseFloat(v)/100))}}this.originPoint[x]=v}),p&&Ce.postRender(()=>p(u,h)),wc(this.visualElement,"transform");const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},a=(u,h)=>{const{dragPropagation:f,dragDirectionLock:m,onDirectionLock:p,onDrag:g}=this.getProps();if(!f&&!this.openDragLock)return;const{offset:x}=h;if(m&&this.currentDirection===null){this.currentDirection=xM(x),this.currentDirection!==null&&p&&p(this.currentDirection);return}this.updateAxis("x",h.point,x),this.updateAxis("y",h.point,x),this.visualElement.render(),g&&g(u,h)},o=(u,h)=>this.stop(u,h),c=()=>jt(u=>{var h;return this.getAnimationState(u)==="paused"&&((h=this.getAxisMotionValue(u).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new xy(e,{onSessionStart:i,onStart:r,onMove:a,onSessionEnd:o,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:jy(this.visualElement)})}stop(e,s){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:i}=s;this.startAnimation(i);const{onDragEnd:r}=this.getProps();r&&Ce.postRender(()=>r(e,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:s}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),s&&s.setActive("whileDrag",!1)}updateAxis(e,s,n){const{drag:i}=this.getProps();if(!n||!ha(e,i,this.currentDirection))return;const r=this.getAxisMotionValue(e);let a=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(a=rM(a,this.constraints[e],this.elastic[e])),r.set(a)}resolveConstraints(){var e;const{dragConstraints:s,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,r=this.constraints;s&&Vn(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&i?this.constraints=aM(i.layoutBox,s):this.constraints=!1,this.elastic=dM(n),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&jt(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=cM(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:s}=this.getProps();if(!e||!Vn(e))return!1;const n=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const r=mM(n,i.root,this.visualElement.getTransformPagePoint());let a=oM(i.layout.layoutBox,r);if(s){const o=s(uM(a));this.hasMutatedConstraints=!!o,o&&(a=_y(o))}return a}startAnimation(e){const{drag:s,dragMomentum:n,dragElastic:i,dragTransition:r,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},d=jt(u=>{if(!ha(u,s,this.currentDirection))return;let h=c&&c[u]||{};a&&(h={min:0,max:0});const f=i?200:1e6,m=i?40:1e7,p={type:"inertia",velocity:n?e[u]:0,bounceStiffness:f,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...r,...h};return this.startAxisValueAnimation(u,p)});return Promise.all(d).then(o)}startAxisValueAnimation(e,s){const n=this.getAxisMotionValue(e);return wc(this.visualElement,e),n.start(Qd(e,n,0,s,this.visualElement,!1))}stopAnimation(){jt(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){jt(e=>{var s;return(s=this.getAxisMotionValue(e).animation)===null||s===void 0?void 0:s.pause()})}getAnimationState(e){var s;return(s=this.getAxisMotionValue(e).animation)===null||s===void 0?void 0:s.state}getAxisMotionValue(e){const s=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),i=n[s];return i||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){jt(s=>{const{drag:n}=this.getProps();if(!ha(s,n,this.currentDirection))return;const{projection:i}=this.visualElement,r=this.getAxisMotionValue(s);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[s];r.set(e[s]-Ie(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:s}=this.getProps(),{projection:n}=this.visualElement;if(!Vn(s)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};jt(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const c=o.get();i[a]=lM({min:c,max:c},this.constraints[a])}});const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),jt(a=>{if(!ha(a,e,null))return;const o=this.getAxisMotionValue(a),{min:c,max:d}=this.constraints[a];o.set(Ie(c,d,i[a]))})}addListeners(){if(!this.visualElement.current)return;pM.set(this.visualElement,this);const e=this.visualElement.current,s=Qi(e,"pointerdown",c=>{const{drag:d,dragListener:u=!0}=this.getProps();d&&u&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();Vn(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,r=i.addEventListener("measure",n);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),Ce.read(n);const a=yr(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(jt(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=c[u].translate,h.set(h.get()+c[u].translate))}),this.visualElement.render())}));return()=>{a(),s(),r(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:s=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:r=!1,dragElastic:a=Pc,dragMomentum:o=!0}=e;return{...e,drag:s,dragDirectionLock:n,dragPropagation:i,dragConstraints:r,dragElastic:a,dragMomentum:o}}}function ha(t,e,s){return(e===!0||e===t)&&(s===null||s===t)}function xM(t,e=10){let s=null;return Math.abs(t.y)>e?s="y":Math.abs(t.x)>e&&(s="x"),s}class yM extends Js{constructor(e){super(e),this.removeGroupControls=bt,this.removeListeners=bt,this.controls=new gM(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||bt}unmount(){this.removeGroupControls(),this.removeListeners()}}const Tm=t=>(e,s)=>{t&&Ce.postRender(()=>t(e,s))};class bM extends Js{constructor(){super(...arguments),this.removePointerDownListener=bt}onPointerDown(e){this.session=new xy(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:jy(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:s,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:Tm(e),onStart:Tm(s),onMove:n,onEnd:(r,a)=>{delete this.session,i&&Ce.postRender(()=>i(r,a))}}}mount(){this.removePointerDownListener=Qi(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const ja={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Mm(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Mi={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(se.test(t))t=parseFloat(t);else return t;const s=Mm(t,e.target.x),n=Mm(t,e.target.y);return`${s}% ${n}%`}},vM={correct:(t,{treeScale:e,projectionDelta:s})=>{const n=t,i=qs.parse(t);if(i.length>5)return n;const r=qs.createTransformer(t),a=typeof i[0]!="number"?1:0,o=s.x.scale*e.x,c=s.y.scale*e.y;i[0+a]/=o,i[1+a]/=c;const d=Ie(o,c,.5);return typeof i[2+a]=="number"&&(i[2+a]/=d),typeof i[3+a]=="number"&&(i[3+a]/=d),r(i)}};class _M extends y.Component{componentDidMount(){const{visualElement:e,layoutGroup:s,switchLayoutGroup:n,layoutId:i}=this.props,{projection:r}=e;Bj(wM),r&&(s.group&&s.group.add(r),n&&n.register&&i&&n.register(r),r.root.didUpdate(),r.addEventListener("animationComplete",()=>{this.safeToRemove()}),r.setOptions({...r.options,onExitComplete:()=>this.safeToRemove()})),ja.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:s,visualElement:n,drag:i,isPresent:r}=this.props,a=n.projection;return a&&(a.isPresent=r,i||e.layoutDependency!==s||s===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==r&&(r?a.promote():a.relegate()||Ce.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Md.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:s,switchLayoutGroup:n}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),s&&s.group&&s.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Ny(t){const[e,s]=lx(),n=y.useContext(vd);return l.jsx(_M,{...t,layoutGroup:n,switchLayoutGroup:y.useContext(gx),isPresent:e,safeToRemove:s})}const wM={borderRadius:{...Mi,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Mi,borderTopRightRadius:Mi,borderBottomLeftRadius:Mi,borderBottomRightRadius:Mi,boxShadow:vM};function kM(t,e,s){const n=ot(t)?t:gr(t);return n.start(Qd("",n,e,s)),n.animation}function SM(t){return t instanceof SVGElement&&t.tagName!=="svg"}const jM=(t,e)=>t.depth-e.depth;class NM{constructor(){this.children=[],this.isDirty=!1}add(e){zd(this.children,e),this.isDirty=!0}remove(e){Hd(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(jM),this.isDirty=!1,this.children.forEach(e)}}function TM(t,e){const s=Jt.now(),n=({timestamp:i})=>{const r=i-s;r>=e&&(Gs(n),t(r-e))};return Ce.read(n,!0),()=>Gs(n)}const Ty=["TopLeft","TopRight","BottomLeft","BottomRight"],MM=Ty.length,Cm=t=>typeof t=="string"?parseFloat(t):t,Pm=t=>typeof t=="number"||se.test(t);function CM(t,e,s,n,i,r){i?(t.opacity=Ie(0,s.opacity!==void 0?s.opacity:1,PM(n)),t.opacityExit=Ie(e.opacity!==void 0?e.opacity:1,0,DM(n))):r&&(t.opacity=Ie(e.opacity!==void 0?e.opacity:1,s.opacity!==void 0?s.opacity:1,n));for(let a=0;a<MM;a++){const o=`border${Ty[a]}Radius`;let c=Dm(e,o),d=Dm(s,o);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||Pm(c)===Pm(d)?(t[o]=Math.max(Ie(Cm(c),Cm(d),n),0),(Zt.test(d)||Zt.test(c))&&(t[o]+="%")):t[o]=d}(e.rotate||s.rotate)&&(t.rotate=Ie(e.rotate||0,s.rotate||0,n))}function Dm(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const PM=My(0,.5,Ux),DM=My(.5,.95,bt);function My(t,e,s){return n=>n<t?0:n>e?1:s(ei(t,e,n))}function Em(t,e){t.min=e.min,t.max=e.max}function St(t,e){Em(t.x,e.x),Em(t.y,e.y)}function Am(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function Om(t,e,s,n,i){return t-=e,t=to(t,1/s,n),i!==void 0&&(t=to(t,1/i,n)),t}function EM(t,e=0,s=1,n=.5,i,r=t,a=t){if(Zt.test(e)&&(e=parseFloat(e),e=Ie(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=Ie(r.min,r.max,n);t===r&&(o-=e),t.min=Om(t.min,e,s,o,i),t.max=Om(t.max,e,s,o,i)}function Rm(t,e,[s,n,i],r,a){EM(t,e[s],e[n],e[i],e.scale,r,a)}const AM=["x","scaleX","originX"],OM=["y","scaleY","originY"];function Lm(t,e,s,n){Rm(t.x,e,AM,s?s.x:void 0,n?n.x:void 0),Rm(t.y,e,OM,s?s.y:void 0,n?n.y:void 0)}function Fm(t){return t.translate===0&&t.scale===1}function Cy(t){return Fm(t.x)&&Fm(t.y)}function Im(t,e){return t.min===e.min&&t.max===e.max}function RM(t,e){return Im(t.x,e.x)&&Im(t.y,e.y)}function Vm(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function Py(t,e){return Vm(t.x,e.x)&&Vm(t.y,e.y)}function Wm(t){return vt(t.x)/vt(t.y)}function Bm(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class LM{constructor(){this.members=[]}add(e){zd(this.members,e),e.scheduleRender()}remove(e){if(Hd(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const s=this.members[this.members.length-1];s&&this.promote(s)}}relegate(e){const s=this.members.findIndex(i=>e===i);if(s===0)return!1;let n;for(let i=s;i>=0;i--){const r=this.members[i];if(r.isPresent!==!1){n=r;break}}return n?(this.promote(n),!0):!1}promote(e,s){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,s&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:s,resumingFrom:n}=e;s.onExitComplete&&s.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function FM(t,e,s){let n="";const i=t.x.translate/e.x,r=t.y.translate/e.y,a=s?.z||0;if((i||r||a)&&(n=`translate3d(${i}px, ${r}px, ${a}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),s){const{transformPerspective:d,rotate:u,rotateX:h,rotateY:f,skewX:m,skewY:p}=s;d&&(n=`perspective(${d}px) ${n}`),u&&(n+=`rotate(${u}deg) `),h&&(n+=`rotateX(${h}deg) `),f&&(n+=`rotateY(${f}deg) `),m&&(n+=`skewX(${m}deg) `),p&&(n+=`skewY(${p}deg) `)}const o=t.x.scale*e.x,c=t.y.scale*e.y;return(o!==1||c!==1)&&(n+=`scale(${o}, ${c})`),n||"none"}const pn={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Yi=typeof window<"u"&&window.MotionDebug!==void 0,Rl=["","X","Y","Z"],IM={visibility:"hidden"},zm=1e3;let VM=0;function Ll(t,e,s,n){const{latestValues:i}=e;i[t]&&(s[t]=i[t],e.setStaticValue(t,0),n&&(n[t]=0))}function Dy(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const s=Vx(e);if(window.MotionHasOptimisedAnimation(s,"transform")){const{layout:i,layoutId:r}=t.options;window.MotionCancelOptimisedAnimation(s,"transform",Ce,!(i||r))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&Dy(n)}function Ey({attachResizeListener:t,defaultParent:e,measureScroll:s,checkIsScrollRoot:n,resetTransform:i}){return class{constructor(a={},o=e?.()){this.id=VM++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Yi&&(pn.totalNodes=pn.resolvedTargetDeltas=pn.recalculatedProjection=0),this.nodes.forEach(zM),this.nodes.forEach(GM),this.nodes.forEach(qM),this.nodes.forEach(HM),Yi&&window.MotionDebug.record(pn)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new NM)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new $d),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const c=this.eventHandlers.get(a);c&&c.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=SM(a),this.instance=a;const{layoutId:c,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(d||c)&&(this.isLayoutDirty=!0),t){let h;const f=()=>this.root.updateBlockedByResize=!1;t(a,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=TM(f,250),ja.hasAnimatedSinceResize&&(ja.hasAnimatedSinceResize=!1,this.nodes.forEach($m))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&u&&(c||d)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:f,hasRelativeTargetChanged:m,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||u.getDefaultTransition()||QM,{onLayoutAnimationStart:x,onLayoutAnimationComplete:v}=u.getProps(),_=!this.targetLayout||!Py(this.targetLayout,p)||m,S=!f&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||S||f&&(_||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,S);const N={...Id(g,"layout"),onPlay:x,onComplete:v};(u.shouldReduceMotion||this.options.layoutRoot)&&(N.delay=0,N.type=!1),this.startAnimation(N)}else f||$m(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Gs(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(KM),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Dy(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Hm);return}this.isUpdating||this.nodes.forEach(YM),this.isUpdating=!1,this.nodes.forEach(UM),this.nodes.forEach(WM),this.nodes.forEach(BM),this.clearAllSnapshots();const o=Jt.now();st.delta=ks(0,1e3/60,o-st.timestamp),st.timestamp=o,st.isProcessing=!0,Nl.update.process(st),Nl.preRender.process(st),Nl.render.process(st),st.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Md.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach($M),this.sharedNodes.forEach(XM)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ce.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ce.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ue(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o){const c=n(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:c,offset:s(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!Cy(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;a&&(o||mn(this.latestValues)||u)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return a&&(c=this.removeTransform(c)),eC(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:o}=this.options;if(!o)return Ue();const c=o.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(tC))){const{scroll:u}=this.root;u&&(zn(c.x,u.offset.x),zn(c.y,u.offset.y))}return c}removeElementScroll(a){var o;const c=Ue();if(St(c,a),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return c;for(let d=0;d<this.path.length;d++){const u=this.path[d],{scroll:h,options:f}=u;u!==this.root&&h&&f.layoutScroll&&(h.wasRoot&&St(c,a),zn(c.x,h.offset.x),zn(c.y,h.offset.y))}return c}applyTransform(a,o=!1){const c=Ue();St(c,a);for(let d=0;d<this.path.length;d++){const u=this.path[d];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Hn(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),mn(u.latestValues)&&Hn(c,u.latestValues)}return mn(this.latestValues)&&Hn(c,this.latestValues),c}removeTransform(a){const o=Ue();St(o,a);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!mn(d.latestValues))continue;Dc(d.latestValues)&&d.updateSnapshot();const u=Ue(),h=d.measurePageBox();St(u,h),Lm(o,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return mn(this.latestValues)&&Lm(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==st.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(a||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:f}=this.options;if(!(!this.layout||!(h||f))){if(this.resolvedRelativeTargetAt=st.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ue(),this.relativeTargetOrigin=Ue(),tr(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),St(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ue(),this.targetWithTransforms=Ue()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),iM(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):St(this.target,this.layout.layoutBox),ky(this.target,this.targetDelta)):St(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ue(),this.relativeTargetOrigin=Ue(),tr(this.relativeTargetOrigin,this.target,m.target),St(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Yi&&pn.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Dc(this.parent.latestValues)||wy(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),c=!!this.resumingFrom||this!==o;let d=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===st.timestamp&&(d=!1),d)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;St(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,m=this.treeScale.y;fM(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Ue());const{target:p}=o;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Am(this.prevProjectionDelta.x,this.projectionDelta.x),Am(this.prevProjectionDelta.y,this.projectionDelta.y)),er(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==m||!Bm(this.projectionDelta.x,this.prevProjectionDelta.x)||!Bm(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p)),Yi&&pn.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),a){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Bn(),this.projectionDelta=Bn(),this.projectionDeltaWithTransform=Bn()}setAnimationOrigin(a,o=!1){const c=this.snapshot,d=c?c.latestValues:{},u={...this.latestValues},h=Bn();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const f=Ue(),m=c?c.source:void 0,p=this.layout?this.layout.source:void 0,g=m!==p,x=this.getStack(),v=!x||x.members.length<=1,_=!!(g&&!v&&this.options.crossfade===!0&&!this.path.some(JM));this.animationProgress=0;let S;this.mixTargetDelta=N=>{const j=N/1e3;Ym(h.x,a.x,j),Ym(h.y,a.y,j),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(tr(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),ZM(this.relativeTarget,this.relativeTargetOrigin,f,j),S&&RM(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=Ue()),St(S,this.relativeTarget)),g&&(this.animationValues=u,CM(u,d,this.latestValues,j,_,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=j},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Gs(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ce.update(()=>{ja.hasAnimatedSinceResize=!0,this.currentAnimation=kM(0,zm,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(zm),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:c,layout:d,latestValues:u}=a;if(!(!o||!c||!d)){if(this!==a&&this.layout&&d&&Ay(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||Ue();const h=vt(this.layout.layoutBox.x);c.x.min=a.target.x.min,c.x.max=c.x.min+h;const f=vt(this.layout.layoutBox.y);c.y.min=a.target.y.min,c.y.max=c.y.min+f}St(o,c),Hn(o,u),er(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new LM),this.sharedNodes.get(a).add(o);const d=o.options.initialPromotionConfig;o.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:c}=a;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(o=!0),!o)return;const d={};c.z&&Ll("z",a,d,this.animationValues);for(let u=0;u<Rl.length;u++)Ll(`rotate${Rl[u]}`,a,d,this.animationValues),Ll(`skew${Rl[u]}`,a,d,this.animationValues);a.render();for(const u in d)a.setStaticValue(u,d[u]),this.animationValues&&(this.animationValues[u]=d[u]);a.scheduleRender()}getProjectionStyles(a){var o,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return IM;const d={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=ka(a?.pointerEvents)||"",d.transform=u?u(this.latestValues,""):"none",d;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=ka(a?.pointerEvents)||""),this.hasProjected&&!mn(this.latestValues)&&(g.transform=u?u({},""):"none",this.hasProjected=!1),g}const f=h.animationValues||h.latestValues;this.applyTransformsToTarget(),d.transform=FM(this.projectionDeltaWithTransform,this.treeScale,f),u&&(d.transform=u(f,d.transform));const{x:m,y:p}=this.projectionDelta;d.transformOrigin=`${m.origin*100}% ${p.origin*100}% 0`,h.animationValues?d.opacity=h===this?(c=(o=f.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:d.opacity=h===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const g in Xa){if(f[g]===void 0)continue;const{correct:x,applyTo:v}=Xa[g],_=d.transform==="none"?f[g]:x(f[g],h);if(v){const S=v.length;for(let N=0;N<S;N++)d[v[N]]=_}else d[g]=_}return this.options.layoutId&&(d.pointerEvents=h===this?ka(a?.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(Hm),this.root.sharedNodes.clear()}}}function WM(t){t.updateLayout()}function BM(t){var e;const s=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&s&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=t.layout,{animationType:r}=t.options,a=s.source!==t.layout.source;r==="size"?jt(h=>{const f=a?s.measuredBox[h]:s.layoutBox[h],m=vt(f);f.min=n[h].min,f.max=f.min+m}):Ay(r,s.layoutBox,n)&&jt(h=>{const f=a?s.measuredBox[h]:s.layoutBox[h],m=vt(n[h]);f.max=f.min+m,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+m)});const o=Bn();er(o,n,s.layoutBox);const c=Bn();a?er(c,t.applyTransform(i,!0),s.measuredBox):er(c,n,s.layoutBox);const d=!Cy(o);let u=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:f,layout:m}=h;if(f&&m){const p=Ue();tr(p,s.layoutBox,f.layoutBox);const g=Ue();tr(g,n,m.layoutBox),Py(p,g)||(u=!0),h.options.layoutRoot&&(t.relativeTarget=g,t.relativeTargetOrigin=p,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:s,delta:c,layoutDelta:o,hasLayoutChanged:d,hasRelativeTargetChanged:u})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function zM(t){Yi&&pn.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function HM(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function $M(t){t.clearSnapshot()}function Hm(t){t.clearMeasurements()}function YM(t){t.isLayoutDirty=!1}function UM(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function $m(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function GM(t){t.resolveTargetDelta()}function qM(t){t.calcProjection()}function KM(t){t.resetSkewAndRotation()}function XM(t){t.removeLeadSnapshot()}function Ym(t,e,s){t.translate=Ie(e.translate,0,s),t.scale=Ie(e.scale,1,s),t.origin=e.origin,t.originPoint=e.originPoint}function Um(t,e,s,n){t.min=Ie(e.min,s.min,n),t.max=Ie(e.max,s.max,n)}function ZM(t,e,s,n){Um(t.x,e.x,s.x,n),Um(t.y,e.y,s.y,n)}function JM(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const QM={duration:.45,ease:[.4,0,.1,1]},Gm=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),qm=Gm("applewebkit/")&&!Gm("chrome/")?Math.round:bt;function Km(t){t.min=qm(t.min),t.max=qm(t.max)}function eC(t){Km(t.x),Km(t.y)}function Ay(t,e,s){return t==="position"||t==="preserve-aspect"&&!nM(Wm(e),Wm(s),.2)}function tC(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const sC=Ey({attachResizeListener:(t,e)=>yr(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Fl={current:void 0},Oy=Ey({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Fl.current){const t=new sC({});t.mount(window),t.setOptions({layoutScroll:!0}),Fl.current=t}return Fl.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),nC={pan:{Feature:bM},drag:{Feature:yM,ProjectionNode:Oy,MeasureLayout:Ny}};function Xm(t,e,s){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover",s==="Start");const i="onHover"+s,r=n[i];r&&Ce.postRender(()=>r(e,Ar(e)))}class iC extends Js{mount(){const{current:e}=this.node;e&&(this.unmount=nN(e,s=>(Xm(this.node,s,"Start"),n=>Xm(this.node,n,"End"))))}unmount(){}}class rC extends Js{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Er(yr(this.node.current,"focus",()=>this.onFocus()),yr(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Zm(t,e,s){const{props:n}=t;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap",s==="Start");const i="onTap"+(s==="End"?"":s),r=n[i];r&&Ce.postRender(()=>r(e,Ar(e)))}class aC extends Js{mount(){const{current:e}=this.node;e&&(this.unmount=oN(e,s=>(Zm(this.node,s,"Start"),(n,{success:i})=>Zm(this.node,n,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Ac=new WeakMap,Il=new WeakMap,oC=t=>{const e=Ac.get(t.target);e&&e(t)},lC=t=>{t.forEach(oC)};function cC({root:t,...e}){const s=t||document;Il.has(s)||Il.set(s,{});const n=Il.get(s),i=JSON.stringify(e);return n[i]||(n[i]=new IntersectionObserver(lC,{root:t,...e})),n[i]}function dC(t,e,s){const n=cC(e);return Ac.set(t,s),n.observe(t),()=>{Ac.delete(t),n.unobserve(t)}}const uC={some:0,all:1};class hC extends Js{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:s,margin:n,amount:i="some",once:r}=e,a={root:s?s.current:void 0,rootMargin:n,threshold:typeof i=="number"?i:uC[i]},o=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,r&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),f=d?u:h;f&&f(c)};return dC(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:s}=this.node;["amount","margin","root"].some(fC(e,s))&&this.startObserver()}unmount(){}}function fC({viewport:t={}},{viewport:e={}}={}){return s=>t[s]!==e[s]}const mC={inView:{Feature:hC},tap:{Feature:aC},focus:{Feature:rC},hover:{Feature:iC}},pC={layout:{ProjectionNode:Oy,MeasureLayout:Ny}},Oc={current:null},Ry={current:!1};function gC(){if(Ry.current=!0,!!kd)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Oc.current=t.matches;t.addListener(e),e()}else Oc.current=!1}const xC=[...ay,it,qs],yC=t=>xC.find(ry(t)),Jm=new WeakMap;function bC(t,e,s){for(const n in e){const i=e[n],r=s[n];if(ot(i))t.addValue(n,i);else if(ot(r))t.addValue(n,gr(i,{owner:t}));else if(r!==i)if(t.hasValue(n)){const a=t.getValue(n);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=t.getStaticValue(n);t.addValue(n,gr(a!==void 0?a:i,{owner:t}))}}for(const n in s)e[n]===void 0&&t.removeValue(n);return e}const Qm=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class vC{scrapeMotionValuesFromProps(e,s,n){return{}}constructor({parent:e,props:s,presenceContext:n,reducedMotionConfig:i,blockInitialAnimation:r,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Xd,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=Jt.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,Ce.render(this.render,!1,!0))};const{latestValues:c,renderState:d,onUpdate:u}=a;this.onUpdate=u,this.latestValues=c,this.baseTarget={...c},this.initialValues=s.initial?{...c}:{},this.renderState=d,this.parent=e,this.props=s,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!r,this.isControllingVariants=Mo(s),this.isVariantNode=mx(s),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...f}=this.scrapeMotionValuesFromProps(s,{},this);for(const m in f){const p=f[m];c[m]!==void 0&&ot(p)&&p.set(c[m],!1)}}mount(e){this.current=e,Jm.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,n)=>this.bindToMotionValue(n,s)),Ry.current||gC(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Oc.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Jm.delete(this.current),this.projection&&this.projection.unmount(),Gs(this.notifyUpdate),Gs(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const s=this.features[e];s&&(s.unmount(),s.isMounted=!1)}this.current=null}bindToMotionValue(e,s){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=Cn.has(e),i=s.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&Ce.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),r=s.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,s)),this.valueSubscriptions.set(e,()=>{i(),r(),a&&a(),s.owner&&s.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in ti){const s=ti[e];if(!s)continue;const{isEnabled:n,Feature:i}=s;if(!this.features[e]&&i&&n(this.props)&&(this.features[e]=new i(this)),this.features[e]){const r=this.features[e];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ue()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,s){this.latestValues[e]=s}update(e,s){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=s;for(let n=0;n<Qm.length;n++){const i=Qm[n];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const r="on"+i,a=e[r];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=bC(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const s=this.getClosestVariantNode();if(s)return s.variantChildren&&s.variantChildren.add(e),()=>s.variantChildren.delete(e)}addValue(e,s){const n=this.values.get(e);s!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,s),this.values.set(e,s),this.latestValues[e]=s.get())}removeValue(e){this.values.delete(e);const s=this.valueSubscriptions.get(e);s&&(s(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,s){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&s!==void 0&&(n=gr(s===null?void 0:s,{owner:this}),this.addValue(e,n)),n}readValue(e,s){var n;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(ny(i)||qx(i))?i=parseFloat(i):!yC(i)&&qs.test(s)&&(i=ey(e,s)),this.setBaseTarget(e,ot(i)?i.get():i)),ot(i)?i.get():i}setBaseTarget(e,s){this.baseTarget[e]=s}getBaseTarget(e){var s;const{initial:n}=this.props;let i;if(typeof n=="string"||typeof n=="object"){const a=Pd(this.props,n,(s=this.presenceContext)===null||s===void 0?void 0:s.custom);a&&(i=a[e])}if(n&&i!==void 0)return i;const r=this.getBaseTargetFromProps(this.props,e);return r!==void 0&&!ot(r)?r:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,s){return this.events[e]||(this.events[e]=new $d),this.events[e].add(s)}notify(e,...s){this.events[e]&&this.events[e].notify(...s)}}class Ly extends vC{constructor(){super(...arguments),this.KeyframeResolver=oy}sortInstanceNodePosition(e,s){return e.compareDocumentPosition(s)&2?1:-1}getBaseTargetFromProps(e,s){return e.style?e.style[s]:void 0}removeValueFromRenderState(e,{vars:s,style:n}){delete s[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ot(e)&&(this.childSubscription=e.on("change",s=>{this.current&&(this.current.textContent=`${s}`)}))}}function _C(t){return window.getComputedStyle(t)}class wC extends Ly{constructor(){super(...arguments),this.type="html",this.renderInstance=kx}readValueFromInstance(e,s){if(Cn.has(s)){const n=Kd(s);return n&&n.default||0}else{const n=_C(e),i=(vx(s)?n.getPropertyValue(s):n[s])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:s}){return Sy(e,s)}build(e,s,n){Ad(e,s,n.transformTemplate)}scrapeMotionValuesFromProps(e,s,n){return Fd(e,s,n)}}class kC extends Ly{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ue}getBaseTargetFromProps(e,s){return e[s]}readValueFromInstance(e,s){if(Cn.has(s)){const n=Kd(s);return n&&n.default||0}return s=Sx.has(s)?s:Td(s),e.getAttribute(s)}scrapeMotionValuesFromProps(e,s,n){return Tx(e,s,n)}build(e,s,n){Od(e,s,this.isSVGTag,n.transformTemplate)}renderInstance(e,s,n,i){jx(e,s,n,i)}mount(e){this.isSVGTag=Ld(e.tagName),super.mount(e)}}const SC=(t,e)=>Cd(t)?new kC(e):new wC(e,{allowProjection:t!==y.Fragment}),jC=Xj({...qT,...mC,...nC,...pC},SC),Fe=uj(jC);function NC(){const[t,e]=y.useState(null),[s,n]=y.useState(!1),[i,r]=y.useState(!1),[a,o]=y.useState(null),[c,d]=y.useState(!0),[u,h]=y.useState(null),f=y.useCallback(async()=>{if(a){n(!0),r(!1);try{const x=await K.getAdvice();x&&typeof x=="object"&&"status"in x&&x.status==="disabled"?(o(!1),e(null)):e(x.advice??null)}catch(x){console.error(x),r(!0)}finally{n(!1)}}},[a]),m=y.useCallback(async()=>{n(!0),r(!1);try{const x=await K.analystRun();h(x)}catch(x){console.error("Failed to fetch analyst summary:",x),r(!0)}finally{n(!1)}},[]);y.useEffect(()=>{K.config().then(x=>{const v=x.advisor||{},_=v.enable_llm!==!1,S=v.auto_fetch!==!1;o(_),d(S),_&&S&&f(),_||m()}).catch(x=>{console.error("Failed to load advisor config:",x),o(!1)})},[f,m]);const p=!!a&&!s,g=async()=>{const x=!c;d(x);try{await K.configSave({advisor:{auto_fetch:x}}),x&&a&&!t&&f()}catch(v){console.error("Failed to update advisor auto_fetch setting:",v)}};return l.jsxs(de,{className:"h-full p-4 md:p-5 flex flex-col",children:[l.jsxs("div",{className:"flex items-baseline justify-between mb-3",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted",children:[l.jsx(Wp,{className:"h-4 w-4 text-accent"}),l.jsx("span",{children:"Aurora Advisor"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[a&&l.jsx("button",{onClick:g,className:`rounded-pill px-2 py-1 text-[10px] font-medium transition ${c?"bg-accent text-canvas border border-accent":"bg-surface border border-line/60 text-muted hover:border-accent hover:text-accent"}`,title:c?"Disable auto-fetch (advisor runs only on manual request)":"Enable auto-fetch when the plan changes",children:""}),a!==null&&l.jsx("button",{onClick:f,disabled:!p,className:"text-[10px] text-muted hover:text-text transition-colors p-1 disabled:opacity-40",title:a?"Fetch latest advice":"Enable LLM advice in Settings",children:l.jsx(Vp,{className:`h-4 w-4 ${s?"animate-spin":""}`})})]})]}),l.jsxs("div",{className:"text-[11px] text-text leading-relaxed",children:[a===!1&&l.jsxs(l.Fragment,{children:[s&&l.jsx("span",{className:"animate-pulse",children:"Analyzing schedule (offline)"}),!s&&i&&l.jsx("span",{className:"text-red-400",children:"Unable to analyze schedule. Check backend logs for details."}),!s&&!i&&u&&u.recommendations&&l.jsx("div",{className:"space-y-2",children:Object.entries(u.recommendations).slice(0,3).map(([x,v])=>{const _=v??{},S=_.label||x,N=_.best_grid_window||{},j=_.best_solar_window||{},k=P=>P&&P.length>=16?P.slice(11,16):"",T=N.start&&N.end?`${k(N.start)}${k(N.end)} (${N.avg_price?.toFixed?.(2)??""} SEK/kWh)`:null,M=j.start&&j.end?`${k(j.start)}${k(j.end)} (${j.avg_pv_surplus?.toFixed?.(2)??""} kW surplus)`:null;return l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsx("div",{className:"font-medium",children:S}),l.jsxs("div",{className:"flex flex-wrap gap-3 text-[10px] text-muted",children:[T&&l.jsxs("span",{className:"inline-flex items-center gap-1",children:[l.jsx(It,{className:"h-3 w-3 text-accent"}),l.jsxs("span",{children:["Grid: ",T]})]}),M&&l.jsxs("span",{className:"inline-flex items-center gap-1",children:[l.jsx(Bp,{className:"h-3 w-3 text-accent"}),l.jsxs("span",{children:["Solar: ",M]})]})]})]},x)})}),!s&&!i&&(!u||!u.recommendations)&&l.jsx("span",{className:"text-muted",children:"No appliance recommendations available. Configure appliances in Settings to see suggested run windows."})]}),a===!0&&l.jsxs(l.Fragment,{children:[s&&l.jsx("span",{className:"animate-pulse",children:"Analyzing schedule..."}),!s&&i&&l.jsx("span",{className:"text-red-400",children:"Unable to fetch advice. Check AI settings or try again."}),!s&&!i&&!t&&!c&&l.jsx("span",{className:"text-muted",children:"Click the refresh icon to analyze your current schedule."}),!s&&!i&&t&&l.jsx("span",{children:t})]}),a===null&&!s&&!i&&l.jsx("span",{className:"text-muted",children:"Loading advisor settings"})]})]})}function fa({from:t,to:e,power:s,color:n,reverse:i}){const r=Math.abs(s),a=i?e:t,o=i?t:e,c=4,d=Math.max(3.5-r*.6,.8);return l.jsxs("g",{children:[l.jsx("line",{x1:a.x,y1:a.y,x2:o.x,y2:o.y,stroke:n,strokeWidth:2,strokeOpacity:.2}),r>.05&&Array.from({length:c}).map((u,h)=>l.jsx(Fe.circle,{r:3.5,fill:n,initial:{opacity:0},animate:{cx:[a.x,o.x],cy:[a.y,o.y],opacity:[0,.85,.85,0]},transition:{duration:d,repeat:1/0,delay:h/c*d,ease:"linear"}},h))]})}function Ci({x:t,y:e,iconType:s,label:n,value:i,subValue:r,color:a,glowIntensity:o,isCharging:c,compact:d}){const u=d?28:35,h=u+18*o,f=d?18:25,m={solar:jr,house:Fp,battery:c?Sr:fo,grid:It,water:po}[s];return l.jsxs("g",{transform:`translate(${t}, ${e})`,children:[o>.1&&l.jsx(Fe.circle,{r:h,fill:a,initial:{opacity:0},animate:{opacity:.1+o*.15},transition:{duration:.4}}),l.jsx("circle",{r:u,fill:"rgb(var(--color-surface))",stroke:a,strokeWidth:2.5}),l.jsx("foreignObject",{x:-f/2,y:-f/2,width:f,height:f,children:l.jsx(m,{size:f,style:{color:a},strokeWidth:1.5})}),l.jsx("text",{y:u+14,textAnchor:"middle",fill:"rgb(var(--color-text))",fontSize:d?"10":"11",fontWeight:"600",children:i}),r&&!d&&l.jsx("text",{y:u+26,textAnchor:"middle",fill:"rgb(var(--color-muted))",fontSize:"9",children:r}),l.jsx("text",{y:u+(r&&!d?38:26),textAnchor:"middle",fill:"rgb(var(--color-muted))",fontSize:d?"8":"9",children:n})]})}function TC({data:t,compact:e=!1}){const s=e?.75:1,n=y.useMemo(()=>{const g=e?150:200,x=e?117:161,v=S=>(S-200)*s+g,_=S=>(S-140)*s+x;return{solar:{x:v(100),y:_(50)},house:{x:v(200),y:_(142.5)},battery:{x:v(300),y:_(240)},grid:{x:v(100),y:_(240)},water:{x:v(300),y:_(50)}}},[s,e]),i={solar:"rgb(var(--color-accent))",battery:"rgb(var(--color-good))",grid:"rgb(var(--color-grid))",house:"rgb(var(--color-house))",water:"rgb(var(--color-water))"},r=6,a={solar:Math.min(t.solar.kw/r,1),battery:Math.min(Math.abs(t.battery.kw)/r,1),grid:Math.min(Math.abs(t.grid.kw)/r,1),house:Math.min(t.house.kw/r,1),water:Math.min(t.water.kw/r,1)},o=m=>{const p=Math.abs(m);return p>0&&p<.1?`${p.toFixed(2)} kW`:`${p.toFixed(1)} kW`},c=m=>m!=null?`${m.toFixed(1)} kWh`:void 0,d=t.grid.kw>=0?"Import":"Export",u=t.grid.kw>=0?c(t.grid.importKwh):c(t.grid.exportKwh),h=t.battery.kw<=0?"Charging":"Discharging",f=e?"0 0 300 260":"0 0 400 360";return l.jsxs("svg",{viewBox:f,className:"w-full h-full",children:[l.jsx(fa,{from:n.solar,to:n.house,power:t.solar.kw,color:i.solar}),l.jsx(fa,{from:n.battery,to:n.house,power:Math.abs(t.battery.kw),color:i.battery,reverse:t.battery.kw<0}),l.jsx(fa,{from:n.grid,to:n.house,power:Math.abs(t.grid.kw),color:i.grid,reverse:t.grid.kw<0}),l.jsx(fa,{from:n.house,to:n.water,power:t.water.kw,color:i.water}),l.jsx(Ci,{...n.solar,iconType:"solar",label:"Solar",value:o(t.solar.kw),subValue:c(t.solar.todayKwh),color:i.solar,glowIntensity:a.solar,compact:e}),l.jsx(Ci,{...n.house,iconType:"house",label:"House",value:o(t.house.kw),subValue:c(t.house.todayKwh),color:i.house,glowIntensity:a.house,compact:e}),l.jsx(Ci,{...n.battery,iconType:"battery",label:h,value:`${t.battery.soc.toFixed(0)}%`,subValue:o(t.battery.kw),color:i.battery,glowIntensity:a.battery,isCharging:t.battery.kw<0,compact:e}),l.jsx(Ci,{...n.grid,iconType:"grid",label:d,value:o(t.grid.kw),subValue:u,color:i.grid,glowIntensity:a.grid,compact:e}),l.jsx(Ci,{...n.water,iconType:"water",label:"Water",value:o(t.water.kw),color:i.water,glowIntensity:a.water,compact:e})]})}function MC(){return l.jsxs("div",{className:"animate-pulse space-y-4 p-2",children:[l.jsx("div",{className:"h-4 bg-surface2/50 rounded w-3/4"}),l.jsx("div",{className:"h-32 bg-surface2/30 rounded-lg"}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"h-3 bg-surface2/40 rounded w-full"}),l.jsx("div",{className:"h-3 bg-surface2/40 rounded w-5/6"})]})]})}function CC({powerFlowData:t,isLoading:e}){const[s]=y.useState("powerflow"),i=t??{solar:{kw:0,todayKwh:0},battery:{kw:0,soc:50},grid:{kw:0,importKwh:0,exportKwh:0},house:{kw:0,todayKwh:0},water:{kw:0}};return l.jsx(de,{className:"h-full p-4 md:p-5 flex flex-col",children:l.jsx("div",{className:"flex-1 min-h-0",children:e?l.jsx(MC,{}):s==="advisor"?l.jsx(PC,{}):l.jsx("div",{className:"h-full flex items-center justify-center",children:l.jsx(TC,{data:i})})})})}function PC(){return l.jsx("div",{className:"[&>div]:p-0 [&>div]:shadow-none [&>div]:bg-transparent [&>div]:border-none",children:l.jsx(NC,{})})}const Fy=y.createContext(void 0);function Or(){const t=y.useContext(Fy);if(t===void 0)throw new Error("useToast must be used within a ToastProvider");return t}const ma=[1,3,7,14,30],Pi=[30,60,120],pa=[30,50,80,100],ep=({value:t,total:e,colorClass:s})=>{const n=e>0?Math.min(100,t/e*100):0;return l.jsx("div",{className:"h-1.5 w-full bg-surface2 rounded-full overflow-hidden flex",children:l.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ${s}`,style:{width:`${n}%`}})})};function DC({netCost:t,importKwh:e,exportKwh:s}){const[n,i]=y.useState("today"),[r,a]=y.useState(null),[o,c]=y.useState(!0);y.useEffect(()=>{let p=!1;return K.energyRange(n).then(g=>{p||a({import_cost_sek:g.import_cost_sek,export_revenue_sek:g.export_revenue_sek,grid_charge_cost_sek:g.grid_charge_cost_sek,self_consumption_savings_sek:g.self_consumption_savings_sek,net_cost_sek:g.net_cost_sek,grid_import_kwh:g.grid_import_kwh,grid_export_kwh:g.grid_export_kwh,slot_count:g.slot_count})}).catch(()=>{p||a(null)}).finally(()=>{p||c(!1)}),()=>{p=!0}},[n]);const d=r?.net_cost_sek??t,u=r?.grid_import_kwh??e,h=r?.grid_export_kwh??s,f=(d??0)<=0,m=[{key:"today",label:"Today"},{key:"yesterday",label:"Yesterday"},{key:"week",label:"7 Days"},{key:"month",label:"30 Days"}];return l.jsxs(de,{className:"p-4 flex flex-col h-full relative overflow-hidden group",children:[l.jsx("div",{className:`absolute inset-0 opacity-[0.03] ${f?"bg-good":"bg-bad"}`}),l.jsxs("div",{className:"flex items-center gap-2 mb-2 relative z-10",children:[l.jsx("div",{className:`p-1.5 rounded-lg ${f?"bg-good/10 text-good":"bg-bad/10 text-bad"}`,children:l.jsx(Rp,{className:"h-4 w-4"})}),l.jsx("span",{className:"text-sm font-medium text-text",children:"Grid & Financial"})]}),l.jsx("div",{className:"flex gap-1 mb-2 relative z-10",children:m.map(p=>l.jsx("button",{onClick:()=>{i(p.key),c(!0)},className:`px-2 py-0.5 text-[9px] font-medium rounded-full transition ${n===p.key?"bg-accent/20 text-accent border border-accent/30":"bg-surface2/50 text-muted border border-line/30 hover:border-accent/50"}`,children:p.label},p.key))}),l.jsxs("div",{className:"mb-3 relative z-10",children:[l.jsxs("div",{className:"text-[10px] text-muted uppercase tracking-wider mb-0.5",children:["Net"," ",n==="today"?"Daily":n==="yesterday"?"Yesterday":n==="week"?"7 Day":"30 Day"," ","Cost"]}),l.jsxs("div",{className:"flex items-baseline gap-1",children:[l.jsx("span",{className:`text-2xl font-bold ${o?"opacity-50":""} ${f?"text-good":"text-bad"}`,children:d!=null?Math.abs(d).toFixed(2):""}),l.jsx("span",{className:"text-xs text-muted",children:"kr"}),d!==null&&!o&&l.jsx("span",{className:`text-[10px] ml-2 px-1.5 py-0.5 rounded ${f?"bg-good/10 text-good":"bg-bad/10 text-bad"}`,children:d>0?"COST":"EARNING"})]})]}),r&&l.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-2 relative z-10 text-[10px]",children:[l.jsxs("div",{className:"flex justify-between p-1.5 rounded bg-surface2/30",children:[l.jsx("span",{className:"text-muted",children:"Import Cost"}),l.jsxs("span",{className:"text-bad font-medium",children:[r.import_cost_sek.toFixed(1)," kr"]})]}),l.jsxs("div",{className:"flex justify-between p-1.5 rounded bg-surface2/30",children:[l.jsx("span",{className:"text-muted",children:"Export Rev"}),l.jsxs("span",{className:"text-good font-medium",children:[r.export_revenue_sek.toFixed(1)," kr"]})]}),l.jsxs("div",{className:"flex justify-between p-1.5 rounded bg-surface2/30",children:[l.jsx("span",{className:"text-muted",children:"Grid Charge"}),l.jsxs("span",{className:"text-bad font-medium",children:[r.grid_charge_cost_sek.toFixed(1)," kr"]})]}),l.jsxs("div",{className:"flex justify-between p-1.5 rounded bg-surface2/30",children:[l.jsx("span",{className:"text-muted",children:"Self-Use Saved"}),l.jsxs("span",{className:"text-accent font-medium",children:[r.self_consumption_savings_sek.toFixed(1)," kr"]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-auto relative z-10",children:[l.jsxs("div",{className:"p-2 rounded-lg bg-surface2/40 border border-line/30",children:[l.jsxs("div",{className:"flex items-center gap-1.5 text-bad mb-1",children:[l.jsx(Dp,{className:"h-3 w-3"}),l.jsx("span",{className:"text-[10px]",children:"Import"})]}),l.jsxs("div",{className:`text-lg font-semibold text-text ${o?"opacity-50":""}`,children:[u?.toFixed(1)??""," ",l.jsx("span",{className:"text-[10px] text-muted font-normal",children:"kWh"})]})]}),l.jsxs("div",{className:"p-2 rounded-lg bg-surface2/40 border border-line/30",children:[l.jsxs("div",{className:"flex items-center gap-1.5 text-good mb-1",children:[l.jsx(Ep,{className:"h-3 w-3"}),l.jsx("span",{className:"text-[10px]",children:"Export"})]}),l.jsxs("div",{className:`text-lg font-semibold text-text ${o?"opacity-50":""}`,children:[h?.toFixed(1)??""," ",l.jsx("span",{className:"text-[10px] text-muted font-normal",children:"kWh"})]})]})]})]})}function EC({pvActual:t,pvForecast:e,loadActual:s,loadAvg:n,waterKwh:i,batteryCapacity:r}){return l.jsxs(de,{className:"p-4 flex flex-col h-full relative overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0 bg-amber-500/[0.01]"}),l.jsxs("div",{className:"flex items-center gap-2 mb-4 relative z-10",children:[l.jsx("div",{className:"p-1.5 rounded-lg bg-accent/10 text-accent",children:l.jsx(It,{className:"h-4 w-4"})}),l.jsx("span",{className:"text-sm font-medium text-text",children:"Energy Resources"}),r!=null&&r>0&&l.jsxs("span",{className:"ml-auto text-[9px] text-muted opacity-60",children:[r," kWh Cap"]})]}),l.jsxs("div",{className:"space-y-4 relative z-10",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsxs("div",{className:"flex items-center gap-1.5 text-[11px] text-accent",children:[l.jsx(jr,{className:"h-3 w-3"}),l.jsx("span",{children:"Solar Production"})]}),l.jsxs("div",{className:"text-[10px] text-muted",children:[l.jsx("span",{className:"text-text font-medium",children:t?.toFixed(1)??""}),l.jsx("span",{className:"mx-1",children:"/"}),e?.toFixed(1)??""," kWh"]})]}),l.jsx(ep,{value:t??0,total:e??1,colorClass:"bg-accent"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsxs("div",{className:"flex items-center gap-1.5 text-[11px] text-house",children:[l.jsx(rr,{className:"h-3 w-3"}),l.jsx("span",{children:"House Load"})]}),l.jsxs("div",{className:"text-[10px] text-muted",children:[l.jsx("span",{className:"text-text font-medium",children:s?.toFixed(1)??""}),l.jsx("span",{className:"mx-1",children:"/"}),n?.toFixed(1)??""," kWh"]})]}),l.jsx(ep,{value:s??0,total:n??1,colorClass:"bg-house"})]}),l.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-line/30",children:[l.jsxs("div",{className:"flex items-center gap-1.5 text-[11px] text-water",children:[l.jsx(po,{className:"h-3 w-3"}),l.jsx("span",{children:"Water Heating"})]}),l.jsxs("div",{className:"text-sm font-medium text-text",children:[i?.toFixed(1)??""," ",l.jsx("span",{className:"text-[10px] text-muted font-normal",children:"kWh"})]})]})]})]})}function AC({soc:t,socTarget:e,sIndex:s,cycles:n,riskLabel:i}){return l.jsxs(de,{className:"p-4 flex flex-col h-full relative overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0 bg-ai/[0.01]"}),l.jsxs("div",{className:"flex items-center gap-2 mb-4 relative z-10",children:[l.jsx("div",{className:"p-1.5 rounded-lg bg-ai/10 text-ai",children:l.jsx(La,{className:"h-4 w-4"})}),l.jsx("span",{className:"text-sm font-medium text-text",children:"Battery & Strategy"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 relative z-10",children:[l.jsxs("div",{className:"col-span-2 flex items-center gap-3 p-3 rounded-xl bg-surface2/30 border border-line/30",children:[l.jsx(fo,{className:`h-8 w-8 ${(t??0)>50?"text-good":(t??0)>20?"text-warn":"text-bad"}`}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-2xl font-bold text-text",children:[t?.toFixed(0)??"","%"]}),l.jsx("div",{className:"text-[10px] text-muted",children:e!=null?`Targeting ${e.toFixed(0)}%`:"Current SoC"})]})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[10px] text-muted uppercase tracking-wider mb-1",children:"S-Index"}),l.jsx("div",{className:"text-lg font-semibold text-text",children:s?`x${s.toFixed(2)}`:""}),l.jsx("div",{className:"text-[10px] text-ai/80",children:"Strategy Factor"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[10px] text-muted uppercase tracking-wider mb-1",children:"Cycles"}),l.jsx("div",{className:"text-lg font-semibold text-text",children:n?.toFixed(1)??""}),l.jsx("div",{className:"text-[10px] text-muted",children:i||"Daily usage"})]})]})]})}function OC({comfortLevel:t,setComfortLevel:e,riskAppetite:s,setRiskAppetite:n,vacationMode:i,boostActive:r,activeQuickAction:a,currentSoc:o,onBatteryTopUp:c,onStatusRefresh:d}){const{toast:u}=Or(),[h,f]=y.useState(2),[m,p]=y.useState(i),[g,x]=y.useState(null),[v,_]=y.useState(!1),[S,N]=y.useState(1),[j,k]=y.useState(r||!1),[T,M]=y.useState(null),[P,O]=y.useState(0),[A,F]=y.useState(!1),X=a?.type==="force_charge",[H,Z]=y.useState(2),Q=y.useRef(null),Y=y.useCallback(async()=>{try{const[$,ee]=await Promise.all([K.waterBoost.status(),K.config()]);if($.water_boost){const R=new Date($.water_boost.expires_at);k(!0),M(R);const B=new Date,ae=Math.max(0,Math.floor((R.getTime()-B.getTime())/1e3));O(ae)}else k(!1),M(null),O(0);const D=ee.water_heating?.vacation_mode;D?.enabled?(p(!0),x(D.end_date||null)):(p(!1),x(null))}catch($){console.error("Failed to sync control parameters:",$)}},[]);y.useEffect(()=>{Y();const $=setInterval(Y,3e4);return()=>clearInterval($)},[Y]),y.useEffect(()=>{p(i)},[i]),y.useEffect(()=>{r!==void 0&&k(r)},[r]),y.useEffect(()=>{if(Q.current&&clearInterval(Q.current),!(!j||!T))return Q.current=setInterval(()=>{const $=new Date,ee=Math.floor((T.getTime()-$.getTime())/1e3);ee<=0?(k(!1),M(null),O(0)):O(ee)},1e3),()=>{Q.current&&clearInterval(Q.current)}},[j,T]);const oe=async()=>{_(!0);try{if(m)await K.configSave({water_heating:{vacation_mode:{enabled:!1,end_date:null}}}),p(!1),x(null),u({message:"Vacation Mode Off",variant:"success"});else{const $=ma[h],ee=new Date;ee.setDate(ee.getDate()+$);const D=ee.toISOString().split("T")[0];await K.configSave({water_heating:{vacation_mode:{enabled:!0,end_date:D}}}),p(!0),x(D),u({message:`Vacation Active until ${D}`,variant:"success"})}window.dispatchEvent(new Event("config-updated")),d?.()}catch{u({message:"Vacation toggle failed",variant:"error"})}finally{_(!1)}},ue=async()=>{if(!A){F(!0);try{if(j)await K.waterBoost.cancel(),k(!1),M(null),u({message:"Water Boost Cancelled",variant:"success"});else{const $=Pi[S];await K.waterBoost.start($);const ee=new Date;M(new Date(ee.getTime()+$*6e4)),k(!0),u({message:`Water Boost Started (${$}m)`,variant:"success"})}d&&d()}catch($){console.error("Failed to toggle boost",$),u({message:"Action Failed",variant:"error"})}finally{F(!1)}}},Se=()=>{if(c){const $=pa[H];c($)}},We=$=>{const ee=Math.floor($/60),D=$%60;return`${ee}:${D.toString().padStart(2,"0")}`};return l.jsx(de,{className:"p-4 flex flex-col h-full relative overflow-hidden",children:l.jsxs("div",{className:"space-y-3 relative z-10",children:[l.jsxs("div",{className:"metric-card-border metric-card-border-house bg-surface2/30 p-3 overflow-hidden group",children:[l.jsxs("div",{className:"flex justify-between items-baseline mb-2 pl-3",children:[l.jsxs("div",{className:"text-[10px] text-muted uppercase tracking-wider flex items-center gap-2",children:[l.jsx("span",{children:"Risk Appetite"}),l.jsx("div",{className:`h-1.5 w-1.5 rounded-full transition-colors ${s>3?"bg-purple-400 shadow-[0_0_5px_rgba(192,132,252,0.8)]":s<2?"bg-emerald-400":"bg-blue-400"}`})]}),l.jsx("div",{className:"text-xs font-medium text-text",children:{1:"Safety",2:"Conservative",3:"Neutral",4:"Aggressive",5:"Gambler"}[s]||"Unknown"})]}),l.jsx("div",{className:"flex gap-1 h-8 pl-3",children:[1,2,3,4,5].map($=>{const ee={1:"bg-good text-[#100f0e] border-good shadow-[0_0_10px_rgba(var(--color-good),0.4)]",2:"bg-night text-[#100f0e] border-night shadow-[0_0_10px_rgba(var(--color-night),0.4)]",3:"bg-water text-[#100f0e] border-water shadow-[0_0_10px_rgba(var(--color-water),0.4)]",4:"bg-warn text-[#100f0e] border-warn shadow-[0_0_10px_rgba(var(--color-warn),0.4)]",5:"bg-ai text-[#100f0e] border-ai shadow-[0_0_10px_rgba(var(--color-ai),0.4)]"},D=s===$;return l.jsx("button",{onClick:()=>n($),className:`flex-1 rounded transition-all duration-300 border text-xs font-medium ${D?`${ee[$]} ring-1 ring-inset ring-white/5`:"bg-surface2/50 text-muted hover:bg-surface2 hover:text-text border-transparent hover:border-line/50"}`,children:$},$)})})]}),l.jsxs("div",{className:"metric-card-border metric-card-border-water bg-surface2/30 p-3 overflow-hidden",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2 pl-3",children:[l.jsxs("div",{className:"text-[10px] text-muted uppercase tracking-wider flex items-center gap-2",children:[l.jsx("span",{children:"Water Comfort"}),m&&l.jsx("span",{className:"text-[9px] text-amber-300 bg-amber-500/20 px-1.5 rounded animate-pulse",children:"Vacation"})]}),l.jsx("div",{className:"text-xs font-medium text-text",children:{1:"Economy",2:"Balanced",3:"Neutral",4:"Priority",5:"Maximum"}[t]||"Unknown"})]}),l.jsx("div",{className:"flex gap-1 h-8 pl-3",children:[1,2,3,4,5].map($=>{const ee={1:"bg-good text-[#100f0e] border-good shadow-[0_0_10px_rgba(var(--color-good),0.4)]",2:"bg-night text-[#100f0e] border-night shadow-[0_0_10px_rgba(var(--color-night),0.4)]",3:"bg-water text-[#100f0e] border-water shadow-[0_0_10px_rgba(var(--color-water),0.4)]",4:"bg-warn text-[#100f0e] border-warn shadow-[0_0_10px_rgba(var(--color-warn),0.4)]",5:"bg-bad text-[#100f0e] border-bad shadow-[0_0_10px_rgba(var(--color-bad),0.4)]"},D=t===$;return l.jsx("button",{onClick:()=>e($),className:`flex-1 rounded transition-all duration-300 border text-xs font-medium ${D?`${ee[$]} ring-1 ring-inset ring-white/5`:"bg-surface2/50 text-muted hover:bg-surface2 hover:text-text border-transparent hover:border-line/50"}`,children:$},$)})})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:`flex items-center rounded-xl px-2 py-1.5 text-[11px] font-semibold transition-all duration-500
                            ${X?"bg-good/40 border border-good/60 ring-2 ring-good/70 shadow-[0_0_20px_rgba(34,197,94,0.6)] animate-in fade-in zoom-in-95":"bg-surface2/50 border border-line/50 hover:border-accent/40 shadow-none"}`,children:[!X&&l.jsxs("div",{className:"flex items-center",children:[l.jsx("button",{onClick:()=>Z($=>Math.max(0,$-1)),className:"px-0.5 hover:text-accent disabled:opacity-30",disabled:H===0,children:l.jsx(al,{className:"h-3 w-3"})}),l.jsxs("span",{className:"mx-0.5 min-w-[24px] text-center text-muted text-[10px]",children:[pa[H],"%"]}),l.jsx("button",{onClick:()=>Z($=>Math.min(pa.length-1,$+1)),className:"px-0.5 hover:text-accent disabled:opacity-30",disabled:H===pa.length-1,children:l.jsx(ol,{className:"h-3 w-3"})})]}),l.jsxs("button",{onClick:Se,className:`flex-1 flex items-center justify-center gap-1.5 py-1 px-2 rounded-lg transition
                                ${X?"bg-good/50 text-white":"bg-good/10 hover:bg-good/20 text-good hover:text-good/80"}`,children:[X?l.jsx(tc,{className:"h-3.5 w-3.5 animate-spin"}):l.jsx(Sr,{className:"h-3.5 w-3.5"}),X?l.jsxs("span",{className:"text-[10px] font-bold whitespace-nowrap",children:["STOP (",o??"?","-",a?.params?.target_soc??60,"%)"]}):l.jsx("span",{children:"Top Up"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("div",{className:`flex items-center rounded-xl px-2 py-1.5 text-[11px] font-semibold transition
                            ${m?"bg-amber-500/30 border border-amber-500/50 ring-2 ring-amber-400/50 shadow-[0_0_15px_rgba(245,158,11,0.4)]":"bg-surface2/50 border border-line/50 hover:border-accent/40"} ${v?"opacity-60":""}`,children:[!m&&l.jsxs("div",{className:"flex items-center",children:[l.jsx("button",{onClick:()=>f($=>Math.max(0,$-1)),className:"px-0.5 hover:text-accent disabled:opacity-30",disabled:h===0||v,children:l.jsx(al,{className:"h-3 w-3"})}),l.jsxs("span",{className:"mx-0.5 min-w-[20px] text-center text-muted text-[10px]",children:[ma[h],"d"]}),l.jsx("button",{onClick:()=>f($=>Math.min(ma.length-1,$+1)),className:"px-0.5 hover:text-accent disabled:opacity-30",disabled:h===ma.length-1||v,children:l.jsx(ol,{className:"h-3 w-3"})})]}),l.jsxs("button",{onClick:oe,disabled:v,className:`flex-1 flex items-center justify-center gap-1.5 py-1 px-2 rounded-lg transition
                                    ${m?"bg-amber-500/50 text-amber-100":"bg-amber-500/10 hover:bg-amber-500/20 text-amber-400/80 hover:text-amber-400"}`,children:[l.jsx(Bv,{className:"h-3.5 w-3.5"}),m?l.jsx("span",{className:"truncate",children:g?` ${g.slice(5)}`:"ON"}):l.jsx("span",{children:"Vacation"})]})]}),l.jsxs("div",{className:`flex items-center rounded-xl px-2 py-1.5 text-[11px] font-semibold transition-all duration-500
                            ${j?"bg-water/40 border border-water/60 ring-2 ring-water/70 shadow-[0_0_20px_rgba(var(--color-water),0.6)] animate-in fade-in zoom-in-95":"bg-surface2/50 border border-line/50 hover:border-accent/40 shadow-none"} ${A?"opacity-60":""}`,children:[!j&&l.jsxs("div",{className:"flex items-center",children:[l.jsx("button",{onClick:()=>N($=>Math.max(0,$-1)),className:"px-0.5 hover:text-accent disabled:opacity-30",disabled:S===0||A,children:l.jsx(al,{className:"h-3 w-3"})}),l.jsx("span",{className:"mx-0.5 min-w-[20px] text-center text-muted text-[10px]",children:Pi[S]===120?"2h":Pi[S]===60?"1h":"30m"}),l.jsx("button",{onClick:()=>N($=>Math.min(Pi.length-1,$+1)),className:"px-0.5 hover:text-accent disabled:opacity-30",disabled:S===Pi.length-1||A,children:l.jsx(ol,{className:"h-3 w-3"})})]}),l.jsxs("button",{onClick:ue,disabled:A,className:`flex-1 flex items-center justify-center gap-1.5 py-1 px-2 rounded-lg transition
                                    ${j?"bg-water/50 text-white":"bg-water/10 hover:bg-water/20 text-water hover:text-water/80"}`,children:[A?l.jsx(tc,{className:"h-3.5 w-3.5 animate-spin"}):l.jsx(Lp,{className:`h-3.5 w-3.5 ${j?"animate-pulse":""}`}),j?l.jsx("span",{className:"font-mono",children:We(P)}):l.jsx("span",{children:"Boost"})]})]})]})]})]})})}const es=Object.create(null);es.open="0";es.close="1";es.ping="2";es.pong="3";es.message="4";es.upgrade="5";es.noop="6";const Na=Object.create(null);Object.keys(es).forEach(t=>{Na[es[t]]=t});const Rc={type:"error",data:"parser error"},Iy=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Vy=typeof ArrayBuffer=="function",Wy=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,eu=({type:t,data:e},s,n)=>Iy&&e instanceof Blob?s?n(e):tp(e,n):Vy&&(e instanceof ArrayBuffer||Wy(e))?s?n(e):tp(new Blob([e]),n):n(es[t]+(e||"")),tp=(t,e)=>{const s=new FileReader;return s.onload=function(){const n=s.result.split(",")[1];e("b"+(n||""))},s.readAsDataURL(t)};function sp(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let Vl;function RC(t,e){if(Iy&&t.data instanceof Blob)return t.data.arrayBuffer().then(sp).then(e);if(Vy&&(t.data instanceof ArrayBuffer||Wy(t.data)))return e(sp(t.data));eu(t,!1,s=>{Vl||(Vl=new TextEncoder),e(Vl.encode(s))})}const np="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ui=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<np.length;t++)Ui[np.charCodeAt(t)]=t;const LC=t=>{let e=t.length*.75,s=t.length,n,i=0,r,a,o,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const d=new ArrayBuffer(e),u=new Uint8Array(d);for(n=0;n<s;n+=4)r=Ui[t.charCodeAt(n)],a=Ui[t.charCodeAt(n+1)],o=Ui[t.charCodeAt(n+2)],c=Ui[t.charCodeAt(n+3)],u[i++]=r<<2|a>>4,u[i++]=(a&15)<<4|o>>2,u[i++]=(o&3)<<6|c&63;return d},FC=typeof ArrayBuffer=="function",tu=(t,e)=>{if(typeof t!="string")return{type:"message",data:By(t,e)};const s=t.charAt(0);return s==="b"?{type:"message",data:IC(t.substring(1),e)}:Na[s]?t.length>1?{type:Na[s],data:t.substring(1)}:{type:Na[s]}:Rc},IC=(t,e)=>{if(FC){const s=LC(t);return By(s,e)}else return{base64:!0,data:t}},By=(t,e)=>e==="blob"?t instanceof Blob?t:new Blob([t]):t instanceof ArrayBuffer?t:t.buffer,zy="",VC=(t,e)=>{const s=t.length,n=new Array(s);let i=0;t.forEach((r,a)=>{eu(r,!1,o=>{n[a]=o,++i===s&&e(n.join(zy))})})},WC=(t,e)=>{const s=t.split(zy),n=[];for(let i=0;i<s.length;i++){const r=tu(s[i],e);if(n.push(r),r.type==="error")break}return n};function BC(){return new TransformStream({transform(t,e){RC(t,s=>{const n=s.length;let i;if(n<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,n);else if(n<65536){i=new Uint8Array(3);const r=new DataView(i.buffer);r.setUint8(0,126),r.setUint16(1,n)}else{i=new Uint8Array(9);const r=new DataView(i.buffer);r.setUint8(0,127),r.setBigUint64(1,BigInt(n))}t.data&&typeof t.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(s)})}})}let Wl;function ga(t){return t.reduce((e,s)=>e+s.length,0)}function xa(t,e){if(t[0].length===e)return t.shift();const s=new Uint8Array(e);let n=0;for(let i=0;i<e;i++)s[i]=t[0][n++],n===t[0].length&&(t.shift(),n=0);return t.length&&n<t[0].length&&(t[0]=t[0].slice(n)),s}function zC(t,e){Wl||(Wl=new TextDecoder);const s=[];let n=0,i=-1,r=!1;return new TransformStream({transform(a,o){for(s.push(a);;){if(n===0){if(ga(s)<1)break;const c=xa(s,1);r=(c[0]&128)===128,i=c[0]&127,i<126?n=3:i===126?n=1:n=2}else if(n===1){if(ga(s)<2)break;const c=xa(s,2);i=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),n=3}else if(n===2){if(ga(s)<8)break;const c=xa(s,8),d=new DataView(c.buffer,c.byteOffset,c.length),u=d.getUint32(0);if(u>Math.pow(2,21)-1){o.enqueue(Rc);break}i=u*Math.pow(2,32)+d.getUint32(4),n=3}else{if(ga(s)<i)break;const c=xa(s,i);o.enqueue(tu(r?c:Wl.decode(c),e)),n=0}if(i===0||i>t){o.enqueue(Rc);break}}}})}const Hy=4;function Ke(t){if(t)return HC(t)}function HC(t){for(var e in Ke.prototype)t[e]=Ke.prototype[e];return t}Ke.prototype.on=Ke.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};Ke.prototype.once=function(t,e){function s(){this.off(t,s),e.apply(this,arguments)}return s.fn=e,this.on(t,s),this};Ke.prototype.off=Ke.prototype.removeListener=Ke.prototype.removeAllListeners=Ke.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var s=this._callbacks["$"+t];if(!s)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,i=0;i<s.length;i++)if(n=s[i],n===e||n.fn===e){s.splice(i,1);break}return s.length===0&&delete this._callbacks["$"+t],this};Ke.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),s=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(s){s=s.slice(0);for(var n=0,i=s.length;n<i;++n)s[n].apply(this,e)}return this};Ke.prototype.emitReserved=Ke.prototype.emit;Ke.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};Ke.prototype.hasListeners=function(t){return!!this.listeners(t).length};const Do=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,s)=>s(e,0),Nt=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),$C="arraybuffer";function $y(t,...e){return e.reduce((s,n)=>(t.hasOwnProperty(n)&&(s[n]=t[n]),s),{})}const YC=Nt.setTimeout,UC=Nt.clearTimeout;function Eo(t,e){e.useNativeTimers?(t.setTimeoutFn=YC.bind(Nt),t.clearTimeoutFn=UC.bind(Nt)):(t.setTimeoutFn=Nt.setTimeout.bind(Nt),t.clearTimeoutFn=Nt.clearTimeout.bind(Nt))}const GC=1.33;function qC(t){return typeof t=="string"?KC(t):Math.ceil((t.byteLength||t.size)*GC)}function KC(t){let e=0,s=0;for(let n=0,i=t.length;n<i;n++)e=t.charCodeAt(n),e<128?s+=1:e<2048?s+=2:e<55296||e>=57344?s+=3:(n++,s+=4);return s}function Yy(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function XC(t){let e="";for(let s in t)t.hasOwnProperty(s)&&(e.length&&(e+="&"),e+=encodeURIComponent(s)+"="+encodeURIComponent(t[s]));return e}function ZC(t){let e={},s=t.split("&");for(let n=0,i=s.length;n<i;n++){let r=s[n].split("=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return e}class JC extends Error{constructor(e,s,n){super(e),this.description=s,this.context=n,this.type="TransportError"}}class su extends Ke{constructor(e){super(),this.writable=!1,Eo(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,s,n){return super.emitReserved("error",new JC(e,s,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const s=tu(e,this.socket.binaryType);this.onPacket(s)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,s={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(s)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const s=XC(e);return s.length?"?"+s:""}}class QC extends su{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const s=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||s()})),this.writable||(n++,this.once("drain",function(){--n||s()}))}else s()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const s=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};WC(e,this.socket.binaryType).forEach(s),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,VC(e,s=>{this.doWrite(s,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",s=this.query||{};return this.opts.timestampRequests!==!1&&(s[this.opts.timestampParam]=Yy()),!this.supportsBinary&&!s.sid&&(s.b64=1),this.createUri(e,s)}}let Uy=!1;try{Uy=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const eP=Uy;function tP(){}class sP extends QC{constructor(e){if(super(e),typeof location<"u"){const s=location.protocol==="https:";let n=location.port;n||(n=s?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,s){const n=this.request({method:"POST",data:e});n.on("success",s),n.on("error",(i,r)=>{this.onError("xhr post error",i,r)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(s,n)=>{this.onError("xhr poll error",s,n)}),this.pollXhr=e}}class Qt extends Ke{constructor(e,s,n){super(),this.createRequest=e,Eo(this,n),this._opts=n,this._method=n.method||"GET",this._uri=s,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const s=$y(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");s.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(s);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&n.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var i;n.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=Qt.requestsCount++,Qt.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=tP,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Qt.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Qt.requestsCount=0;Qt.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",ip);else if(typeof addEventListener=="function"){const t="onpagehide"in Nt?"pagehide":"unload";addEventListener(t,ip,!1)}}function ip(){for(let t in Qt.requests)Qt.requests.hasOwnProperty(t)&&Qt.requests[t].abort()}const nP=(function(){const t=Gy({xdomain:!1});return t&&t.responseType!==null})();class iP extends sP{constructor(e){super(e);const s=e&&e.forceBase64;this.supportsBinary=nP&&!s}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Qt(Gy,this.uri(),e)}}function Gy(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||eP))return new XMLHttpRequest}catch{}if(!e)try{return new Nt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const qy=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class rP extends su{get name(){return"websocket"}doOpen(){const e=this.uri(),s=this.opts.protocols,n=qy?{}:$y(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,s,n)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let s=0;s<e.length;s++){const n=e[s],i=s===e.length-1;eu(n,this.supportsBinary,r=>{try{this.doWrite(n,r)}catch{}i&&Do(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",s=this.query||{};return this.opts.timestampRequests&&(s[this.opts.timestampParam]=Yy()),this.supportsBinary||(s.b64=1),this.createUri(e,s)}}const Bl=Nt.WebSocket||Nt.MozWebSocket;class aP extends rP{createSocket(e,s,n){return qy?new Bl(e,s,n):s?new Bl(e,s):new Bl(e)}doWrite(e,s){this.ws.send(s)}}class oP extends su{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const s=zC(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(s).getReader(),i=BC();i.readable.pipeTo(e.writable),this._writer=i.writable.getWriter();const r=()=>{n.read().then(({done:o,value:c})=>{o||(this.onPacket(c),r())}).catch(o=>{})};r();const a={type:"open"};this.query.sid&&(a.data=`{"sid":"${this.query.sid}"}`),this._writer.write(a).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let s=0;s<e.length;s++){const n=e[s],i=s===e.length-1;this._writer.write(n).then(()=>{i&&Do(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const lP={websocket:aP,webtransport:oP,polling:iP},cP=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,dP=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Lc(t){if(t.length>8e3)throw"URI too long";const e=t,s=t.indexOf("["),n=t.indexOf("]");s!=-1&&n!=-1&&(t=t.substring(0,s)+t.substring(s,n).replace(/:/g,";")+t.substring(n,t.length));let i=cP.exec(t||""),r={},a=14;for(;a--;)r[dP[a]]=i[a]||"";return s!=-1&&n!=-1&&(r.source=e,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r.pathNames=uP(r,r.path),r.queryKey=hP(r,r.query),r}function uP(t,e){const s=/\/{2,9}/g,n=e.replace(s,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function hP(t,e){const s={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,i,r){i&&(s[i]=r)}),s}const Fc=typeof addEventListener=="function"&&typeof removeEventListener=="function",Ta=[];Fc&&addEventListener("offline",()=>{Ta.forEach(t=>t())},!1);class zs extends Ke{constructor(e,s){if(super(),this.binaryType=$C,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(s=e,e=null),e){const n=Lc(e);s.hostname=n.host,s.secure=n.protocol==="https"||n.protocol==="wss",s.port=n.port,n.query&&(s.query=n.query)}else s.host&&(s.hostname=Lc(s.host).host);Eo(this,s),this.secure=s.secure!=null?s.secure:typeof location<"u"&&location.protocol==="https:",s.hostname&&!s.port&&(s.port=this.secure?"443":"80"),this.hostname=s.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=s.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},s.transports.forEach(n=>{const i=n.prototype.name;this.transports.push(i),this._transportsByName[i]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},s),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=ZC(this.opts.query)),Fc&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Ta.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const s=Object.assign({},this.opts.query);s.EIO=Hy,s.transport=e,this.id&&(s.sid=this.id);const n=Object.assign({},this.opts,{query:s,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&zs.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const s=this.createTransport(e);s.open(),this.setTransport(s)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",s=>this._onClose("transport close",s))}onOpen(){this.readyState="open",zs.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const s=new Error("server error");s.code=e.data,this._onError(s);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let s=1;for(let n=0;n<this.writeBuffer.length;n++){const i=this.writeBuffer[n].data;if(i&&(s+=qC(i)),n>0&&s>this._maxPayload)return this.writeBuffer.slice(0,n);s+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Do(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,s,n){return this._sendPacket("message",e,s,n),this}send(e,s,n){return this._sendPacket("message",e,s,n),this}_sendPacket(e,s,n,i){if(typeof s=="function"&&(i=s,s=void 0),typeof n=="function"&&(i=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const r={type:e,data:s,options:n};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},s=()=>{this.off("upgrade",s),this.off("upgradeError",s),e()},n=()=>{this.once("upgrade",s),this.once("upgradeError",s)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(zs.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,s){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Fc&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=Ta.indexOf(this._offlineEventListener);n!==-1&&Ta.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,s),this.writeBuffer=[],this._prevBufferLen=0}}}zs.protocol=Hy;class fP extends zs{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let s=this.createTransport(e),n=!1;zs.priorWebsocketSuccess=!1;const i=()=>{n||(s.send([{type:"ping",data:"probe"}]),s.once("packet",h=>{if(!n)if(h.type==="pong"&&h.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",s),!s)return;zs.priorWebsocketSuccess=s.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(u(),this.setTransport(s),s.send([{type:"upgrade"}]),this.emitReserved("upgrade",s),s=null,this.upgrading=!1,this.flush())})}else{const f=new Error("probe error");f.transport=s.name,this.emitReserved("upgradeError",f)}}))};function r(){n||(n=!0,u(),s.close(),s=null)}const a=h=>{const f=new Error("probe error: "+h);f.transport=s.name,r(),this.emitReserved("upgradeError",f)};function o(){a("transport closed")}function c(){a("socket closed")}function d(h){s&&h.name!==s.name&&r()}const u=()=>{s.removeListener("open",i),s.removeListener("error",a),s.removeListener("close",o),this.off("close",c),this.off("upgrading",d)};s.once("open",i),s.once("error",a),s.once("close",o),this.once("close",c),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||s.open()},200):s.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const s=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&s.push(e[n]);return s}}let mP=class extends fP{constructor(e,s={}){const n=typeof e=="object"?e:s;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(i=>lP[i]).filter(i=>!!i)),super(e,n)}};function pP(t,e="",s){let n=t;s=s||typeof location<"u"&&location,t==null&&(t=s.protocol+"//"+s.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=s.protocol+t:t=s.host+t),/^(https?|wss?):\/\//.test(t)||(typeof s<"u"?t=s.protocol+"//"+t:t="https://"+t),n=Lc(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const r=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+r+":"+n.port+e,n.href=n.protocol+"://"+r+(s&&s.port===n.port?"":":"+n.port),n}const gP=typeof ArrayBuffer=="function",xP=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,Ky=Object.prototype.toString,yP=typeof Blob=="function"||typeof Blob<"u"&&Ky.call(Blob)==="[object BlobConstructor]",bP=typeof File=="function"||typeof File<"u"&&Ky.call(File)==="[object FileConstructor]";function nu(t){return gP&&(t instanceof ArrayBuffer||xP(t))||yP&&t instanceof Blob||bP&&t instanceof File}function Ma(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let s=0,n=t.length;s<n;s++)if(Ma(t[s]))return!0;return!1}if(nu(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Ma(t.toJSON(),!0);for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&Ma(t[s]))return!0;return!1}function vP(t){const e=[],s=t.data,n=t;return n.data=Ic(s,e),n.attachments=e.length,{packet:n,buffers:e}}function Ic(t,e){if(!t)return t;if(nu(t)){const s={_placeholder:!0,num:e.length};return e.push(t),s}else if(Array.isArray(t)){const s=new Array(t.length);for(let n=0;n<t.length;n++)s[n]=Ic(t[n],e);return s}else if(typeof t=="object"&&!(t instanceof Date)){const s={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=Ic(t[n],e));return s}return t}function _P(t,e){return t.data=Vc(t.data,e),delete t.attachments,t}function Vc(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let s=0;s<t.length;s++)t[s]=Vc(t[s],e);else if(typeof t=="object")for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(t[s]=Vc(t[s],e));return t}const Xy=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],wP=5;var ce;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(ce||(ce={}));class kP{constructor(e){this.replacer=e}encode(e){return(e.type===ce.EVENT||e.type===ce.ACK)&&Ma(e)?this.encodeAsBinary({type:e.type===ce.EVENT?ce.BINARY_EVENT:ce.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let s=""+e.type;return(e.type===ce.BINARY_EVENT||e.type===ce.BINARY_ACK)&&(s+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(s+=e.nsp+","),e.id!=null&&(s+=e.id),e.data!=null&&(s+=JSON.stringify(e.data,this.replacer)),s}encodeAsBinary(e){const s=vP(e),n=this.encodeAsString(s.packet),i=s.buffers;return i.unshift(n),i}}class iu extends Ke{constructor(e){super(),this.reviver=e}add(e){let s;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");s=this.decodeString(e);const n=s.type===ce.BINARY_EVENT;n||s.type===ce.BINARY_ACK?(s.type=n?ce.EVENT:ce.ACK,this.reconstructor=new SP(s),s.attachments===0&&super.emitReserved("decoded",s)):super.emitReserved("decoded",s)}else if(nu(e)||e.base64)if(this.reconstructor)s=this.reconstructor.takeBinaryData(e),s&&(this.reconstructor=null,super.emitReserved("decoded",s));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let s=0;const n={type:Number(e.charAt(0))};if(ce[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===ce.BINARY_EVENT||n.type===ce.BINARY_ACK){const r=s+1;for(;e.charAt(++s)!=="-"&&s!=e.length;);const a=e.substring(r,s);if(a!=Number(a)||e.charAt(s)!=="-")throw new Error("Illegal attachments");n.attachments=Number(a)}if(e.charAt(s+1)==="/"){const r=s+1;for(;++s&&!(e.charAt(s)===","||s===e.length););n.nsp=e.substring(r,s)}else n.nsp="/";const i=e.charAt(s+1);if(i!==""&&Number(i)==i){const r=s+1;for(;++s;){const a=e.charAt(s);if(a==null||Number(a)!=a){--s;break}if(s===e.length)break}n.id=Number(e.substring(r,s+1))}if(e.charAt(++s)){const r=this.tryParse(e.substr(s));if(iu.isPayloadValid(n.type,r))n.data=r;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,s){switch(e){case ce.CONNECT:return so(s);case ce.DISCONNECT:return s===void 0;case ce.CONNECT_ERROR:return typeof s=="string"||so(s);case ce.EVENT:case ce.BINARY_EVENT:return Array.isArray(s)&&(typeof s[0]=="number"||typeof s[0]=="string"&&Xy.indexOf(s[0])===-1);case ce.ACK:case ce.BINARY_ACK:return Array.isArray(s)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class SP{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const s=_P(this.reconPack,this.buffers);return this.finishedReconstruction(),s}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function jP(t){return typeof t=="string"}const NP=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};function TP(t){return t===void 0||NP(t)}function so(t){return Object.prototype.toString.call(t)==="[object Object]"}function MP(t,e){switch(t){case ce.CONNECT:return e===void 0||so(e);case ce.DISCONNECT:return e===void 0;case ce.EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&Xy.indexOf(e[0])===-1);case ce.ACK:return Array.isArray(e);case ce.CONNECT_ERROR:return typeof e=="string"||so(e);default:return!1}}function CP(t){return jP(t.nsp)&&TP(t.id)&&MP(t.type,t.data)}const PP=Object.freeze(Object.defineProperty({__proto__:null,Decoder:iu,Encoder:kP,get PacketType(){return ce},isPacketValid:CP,protocol:wP},Symbol.toStringTag,{value:"Module"}));function Rt(t,e,s){return t.on(e,s),function(){t.off(e,s)}}const DP=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Zy extends Ke{constructor(e,s,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=s,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Rt(e,"open",this.onopen.bind(this)),Rt(e,"packet",this.onpacket.bind(this)),Rt(e,"error",this.onerror.bind(this)),Rt(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...s){var n,i,r;if(DP.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(s.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(s),this;const a={type:ce.EVENT,data:s};if(a.options={},a.options.compress=this.flags.compress!==!1,typeof s[s.length-1]=="function"){const u=this.ids++,h=s.pop();this._registerAckCallback(u,h),a.id=u}const o=(i=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||i===void 0?void 0:i.writable,c=this.connected&&!(!((r=this.io.engine)===null||r===void 0)&&r._hasPingExpired());return this.flags.volatile&&!o||(c?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this}_registerAckCallback(e,s){var n;const i=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(i===void 0){this.acks[e]=s;return}const r=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===e&&this.sendBuffer.splice(o,1);s.call(this,new Error("operation has timed out"))},i),a=(...o)=>{this.io.clearTimeoutFn(r),s.apply(this,o)};a.withError=!0,this.acks[e]=a}emitWithAck(e,...s){return new Promise((n,i)=>{const r=(a,o)=>a?i(a):n(o);r.withError=!0,s.push(r),this.emit(e,...s)})}_addToQueue(e){let s;typeof e[e.length-1]=="function"&&(s=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...r)=>(this._queue[0],i!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),s&&s(i)):(this._queue.shift(),s&&s(null,...r)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const s=this._queue[0];s.pending&&!e||(s.pending=!0,s.tryCount++,this.flags=s.flags,this.emit.apply(this,s.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:ce.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,s){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,s),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case ce.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ce.EVENT:case ce.BINARY_EVENT:this.onevent(e);break;case ce.ACK:case ce.BINARY_ACK:this.onack(e);break;case ce.DISCONNECT:this.ondisconnect();break;case ce.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const s=e.data||[];e.id!=null&&s.push(this.ack(e.id)),this.connected?this.emitEvent(s):this.receiveBuffer.push(Object.freeze(s))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const s=this._anyListeners.slice();for(const n of s)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const s=this;let n=!1;return function(...i){n||(n=!0,s.packet({type:ce.ACK,id:e,data:i}))}}onack(e){const s=this.acks[e.id];typeof s=="function"&&(delete this.acks[e.id],s.withError&&e.data.unshift(null),s.apply(this,e.data))}onconnect(e,s){this.id=e,this.recovered=s&&this._pid===s,this._pid=s,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ce.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const s=this._anyListeners;for(let n=0;n<s.length;n++)if(e===s[n])return s.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const s=this._anyOutgoingListeners;for(let n=0;n<s.length;n++)if(e===s[n])return s.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const s=this._anyOutgoingListeners.slice();for(const n of s)n.apply(this,e.data)}}}function ui(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}ui.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),s=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-s:t+s}return Math.min(t,this.max)|0};ui.prototype.reset=function(){this.attempts=0};ui.prototype.setMin=function(t){this.ms=t};ui.prototype.setMax=function(t){this.max=t};ui.prototype.setJitter=function(t){this.jitter=t};class Wc extends Ke{constructor(e,s){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(s=e,e=void 0),s=s||{},s.path=s.path||"/socket.io",this.opts=s,Eo(this,s),this.reconnection(s.reconnection!==!1),this.reconnectionAttempts(s.reconnectionAttempts||1/0),this.reconnectionDelay(s.reconnectionDelay||1e3),this.reconnectionDelayMax(s.reconnectionDelayMax||5e3),this.randomizationFactor((n=s.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new ui({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(s.timeout==null?2e4:s.timeout),this._readyState="closed",this.uri=e;const i=s.parser||PP;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=s.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var s;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(s=this.backoff)===null||s===void 0||s.setMin(e),this)}randomizationFactor(e){var s;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(s=this.backoff)===null||s===void 0||s.setJitter(e),this)}reconnectionDelayMax(e){var s;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(s=this.backoff)===null||s===void 0||s.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new mP(this.uri,this.opts);const s=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const i=Rt(s,"open",function(){n.onopen(),e&&e()}),r=o=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",o),e?e(o):this.maybeReconnectOnOpen()},a=Rt(s,"error",r);if(this._timeout!==!1){const o=this._timeout,c=this.setTimeoutFn(()=>{i(),r(new Error("timeout")),s.close()},o);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(i),this.subs.push(a),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Rt(e,"ping",this.onping.bind(this)),Rt(e,"data",this.ondata.bind(this)),Rt(e,"error",this.onerror.bind(this)),Rt(e,"close",this.onclose.bind(this)),Rt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(s){this.onclose("parse error",s)}}ondecoded(e){Do(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,s){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new Zy(this,e,s),this.nsps[e]=n),n}_destroy(e){const s=Object.keys(this.nsps);for(const n of s)if(this.nsps[n].active)return;this._close()}_packet(e){const s=this.encoder.encode(e);for(let n=0;n<s.length;n++)this.engine.write(s[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,s){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,s),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const s=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},s);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Di={};function Ca(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const s=pP(t,e.path||"/socket.io"),n=s.source,i=s.id,r=s.path,a=Di[i]&&r in Di[i].nsps,o=e.forceNew||e["force new connection"]||e.multiplex===!1||a;let c;return o?c=new Wc(n,e):(Di[i]||(Di[i]=new Wc(n,e)),c=Di[i]),s.query&&!e.query&&(e.query=s.queryKey),c.socket(s.path,e)}Object.assign(Ca,{Manager:Wc,Socket:Zy,io:Ca,connect:Ca});let Rn=null;const EP=()=>{if(!Rn){const e=(new URL(document.baseURI).pathname+"socket.io").replace(/\/\//g,"/");console.log(` WebSocket initializing at path: ${e}`),Rn=Ca({path:e,transports:["polling","websocket"],autoConnect:!0,reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:5e3}),Rn.on("connect",()=>{console.log(" Connected to Darkstar WebSocket")}),Rn.on("disconnect",s=>{console.warn(" Disconnected from Darkstar WebSocket:",s)}),Rn.on("connect_error",s=>{console.error(" WebSocket connection error:",s)})}return Rn},$n=(t,e)=>{y.useEffect(()=>{const s=EP();return s.on(t,e),()=>{s.off(t,e)}},[t,e])};function Jy({health:t,onDismiss:e}){if(!t||t.healthy)return null;const s=t.issues.filter(i=>i.severity==="critical"),n=t.issues.filter(i=>i.severity==="warning");return l.jsxs("div",{className:"space-y-2",children:[s.map((i,r)=>l.jsxs("div",{className:"banner banner-error px-4 py-3 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{children:""}),l.jsx("span",{className:"font-medium",children:i.message}),i.entity_id&&l.jsx("code",{className:"text-[10px] bg-white/20 px-1.5 py-0.5 rounded",children:i.entity_id}),l.jsxs("span",{className:"opacity-70 text-xs",children:[" ",i.guidance]})]}),e&&l.jsx("button",{onClick:e,className:"opacity-60 hover:opacity-100 text-xs px-2 py-1",title:"Dismiss",children:""})]},`critical-${r}`)),n.map((i,r)=>l.jsxs("div",{className:"banner banner-warning px-4 py-3",children:[l.jsx("span",{children:""}),l.jsx("span",{className:"font-medium",children:i.message}),l.jsxs("span",{className:"opacity-70 text-xs ml-2",children:[" ",i.guidance]})]},`warning-${r}`))]})}function rp(t){if(!t)return"";const e=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),r=String(t.getMinutes()).padStart(2,"0");return`${e}-${s}-${n} ${i}:${r}`}function AP(){const[t,e]=y.useState(null),[s,n]=y.useState(!1),[i,r]=y.useState(null),[a,o]=y.useState(0),[c,d]=y.useState(null),[u,h]=y.useState(!1),[f,m]=y.useState(null),[p,g]=y.useState(null),[x,v]=y.useState(null),[_,S]=y.useState(null),[N,j]=y.useState(null),[k,T]=y.useState(null),[M,P]=y.useState(null),[O,A]=y.useState(null),[F,X]=y.useState(null),[H,Z]=y.useState(0),[Q,Y]=y.useState(null),[oe,ue]=y.useState(0),[Se,We]=y.useState(null),[$,ee]=y.useState(0),[D,R]=y.useState(!1),[B,ae]=y.useState(!1),[he,je]=y.useState(""),[Le,gt]=y.useState(1),[q,ke]=y.useState(null),[Ee,zt]=y.useState({}),[dt,fe]=y.useState(null),{toast:Je}=Or();$n("live_metrics",z=>{console.log(" live_metrics received:",z),z.soc!==void 0&&e(z.soc),zt(V=>({...V,pv_kw:z.pv_kw??V.pv_kw,load_kw:z.load_kw??V.load_kw,battery_kw:z.battery_kw??V.battery_kw,grid_kw:z.grid_kw??V.grid_kw,water_kw:z.water_kw??V.water_kw}))}),$n("schedule_updated",z=>{console.log(" Schedule updated via push:",z),Je({message:"Schedule updated",description:`${z.slot_count??0} slots generated`,variant:"success"}),Promise.all([K.schedule(),K.scheduleTodayWithHistory()]).then(([V,Te])=>{V.schedule&&g(V.schedule),V.meta&&A({planned_at:V.meta.planned_at,planner_version:V.meta.planner_version,s_index:V.meta.s_index}),Te.slots&&v(Te.slots)}).catch(V=>console.error("Failed to refresh after schedule update:",V))}),$n("executor_status",z=>{j({shadow_mode:z.shadow_mode??!1,paused:z.paused??null})}),$n("ha_entity_change",z=>{if(z.entity_id===he){const V=z.state==="on";ae(V)}}),y.useEffect(()=>{const z=async()=>{try{const V=await K.config();if(V){const Te=V.water_heating?.vacation_mode;R(Te?.enabled||!1)}}catch(V){console.log("Failed to reload vacation mode:",V)}};return window.addEventListener("config-updated",z),()=>window.removeEventListener("config-updated",z)},[]);const pi=y.useCallback(async()=>{n(!0);try{const z=await K.dashboardBundle();if(z.status){const V=z.status;V.soc_percent!=null?e(V.soc_percent):V.current_soc?.value!=null&&e(V.current_soc.value),ke(V.status||null)}if(z.config){const V=z.config,Te=V.s_index;typeof Te?.risk_appetite=="number"&&gt(Te.risk_appetite),V.battery?.capacity_kwh!=null?Z(V.battery.capacity_kwh):V.system?.battery?.capacity_kwh!=null&&Z(V.system.battery.capacity_kwh),V.automation?d({enable_scheduler:V.automation.enable_scheduler,every_minutes:V.automation.schedule?.every_minutes??null}):d(null),V.water_heating&&(typeof V.water_heating.comfort_level=="number"&&ee(V.water_heating.comfort_level),typeof V.water_heating.vacation_mode?.enabled=="boolean"&&R(V.water_heating.vacation_mode.enabled)),V.input_sensors?.vacation_mode&&(je(V.input_sensors.vacation_mode),K.haEntityState(V.input_sensors.vacation_mode).then(Ye=>ae(Ye.state==="on")).catch(()=>ae(!1)))}else console.error("Failed to load critical config from bundle");if(z.schedule){const V=z.schedule;g(V.schedule??[]),V.meta&&A({planned_at:V.meta.planned_at,planner_version:V.meta.planner_version,s_index:V.meta.s_index}),V.meta?.last_error?S({message:V.meta.last_error,at:V.meta.last_error_at||""}):S(null);const Te=new Date,Ye=(V.schedule??[]).find(Cs=>{const nn=new Date(Cs.start_time||""),is=new Date(nn.getTime()+1800*1e3);return Te>=nn&&Te<is});Ye?.soc_target_percent!==void 0&&ue(Ye.soc_target_percent)}if(z.executor_status&&j({shadow_mode:z.executor_status.shadow_mode??!1,paused:z.executor_status.paused??null,quick_action:z.executor_status.quick_action??null}),z.scheduler_status){const V=z.scheduler_status;m({last_run_at:V.last_run_at??null,last_run_status:V.last_run_status??null,next_run_at:V.next_run_at??null})}z.water_boost&&P(z.water_boost);try{const V=await K.scheduleTodayWithHistory();V.slots&&v(V.slots)}catch(V){console.warn("Failed to fetch history slots in critical path:",V)}r(new Date)}catch(z){console.error("Error fetching dashboard bundle:",z)}finally{n(!1)}},[]),Qs=y.useCallback(async()=>{try{const[z,V,Te,Ye,Cs,nn]=await Promise.allSettled([K.haAverage(),K.energyToday(),K.haWaterToday(),K.aurora.dashboard(),K.scheduleTodayWithHistory(),K.health()]);nn.status==="fulfilled"&&fe(nn.value),z.status==="fulfilled"&&Y({kw:z.value.average_load_kw??0,dailyKwh:z.value.daily_kwh??0});let is=0;if(Ye.status==="fulfilled"&&Ye.value?.horizon?.slots){const rs=new Date().toISOString().split("T")[0];is=Ye.value.horizon.slots.filter(Et=>Et.slot_start.startsWith(rs)).reduce((Et,Br)=>Et+(Br.final?.pv_kwh||0),0)}if(V.status==="fulfilled"){const xt=V.value;T({gridImport:xt.grid_import_kwh??null,gridExport:xt.grid_export_kwh??null,batteryCycles:xt.battery_cycles??null,pvProduction:xt.pv_production_kwh??null,pvForecast:is>=0?parseFloat(is.toFixed(1)):null,loadConsumption:xt.load_consumption_kwh??null,netCost:xt.net_cost_kr??null})}if(Te.status==="fulfilled"&&We({kwh:Te.value.water_kwh_today??0,source:Te.value.source??"unknown"}),Cs.status==="fulfilled"&&(v(Cs.value.slots??[]),Cs.value.slots)){const xt=new Date;xt.setHours(0,0,0,0);let rs=0;Cs.value.slots.forEach(Et=>{new Date(Et.start_time)>=xt&&(rs+=Et.pv_forecast_kwh??0)}),(rs>0||is===0)&&T(Et=>Et?{...Et,pvForecast:parseFloat(rs.toFixed(1))}:null)}}catch(z){console.error("Error fetching deferred data:",z)}finally{o(z=>z+1)}},[]),Be=y.useCallback(async()=>{await pi(),setTimeout(()=>Qs(),100)},[pi,Qs]);y.useEffect(()=>{X(O)},[O]);const Uo=async z=>{ee(z),await K.configSave({water_heating:{comfort_level:z}})},Go=async z=>{gt(z),await K.configSave({s_index:{risk_appetite:z}})},qo=async(z=60)=>{try{N?.quick_action?.type==="force_charge"?(await K.executor.quickAction.clear(),await Be(),Je({message:"Top-Up Stopped",description:"Battery charging override cleared",variant:"success"})):(await K.executor.quickAction.set("force_charge",60,{target_soc:z}),await Be(),Je({message:"Charging Started",description:`Battery top-up to ${z}% initiated`,variant:"success"}))}catch(V){console.error("Top Up/Stop failed",V),Je({message:"Action failed",variant:"error"})}};y.useEffect(()=>{Be()},[Be]);const Ko=async()=>{if(u)return;const V=!(c?.enable_scheduler??!1);h(!0);try{await K.configSave({automation:{enable_scheduler:V}}),d(Te=>({enable_scheduler:V,every_minutes:Te?.every_minutes??null}))}catch(Te){console.error("Failed to toggle planner automation:",Te)}finally{h(!1)}};let en;if(p&&p.length>0){const z=p.filter(V=>bd(V.start_time)||qa(V.start_time));if(x&&x.length>0){const V=z.filter(Te=>qa(Te.start_time));en=[...x,...V]}else en=z}const Dn=new Date;let gi="Local Plan";F?.planned_at&&(gi=`Generated ${new Date(F.planned_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`);let xi="";if(en){const z=en.find(V=>{const Te=new Date(V.start_time),Ye=new Date(Te.getTime()+1800*1e3);return Dn>=Te&&Dn<Ye});if(z){const V=new Date(new Date(z.start_time).getTime()+18e5),Te=Math.max(0,Math.floor((V.getTime()-Dn.getTime())/6e4));let Ye="Idle";(z.charge_kw||0)>.1?Ye=`Charge ${z.charge_kw?.toFixed(1)}kW`:(z.discharge_kw||0)>.1?Ye=`Discharge ${z.discharge_kw?.toFixed(1)}kW`:(z.export_kwh||0)>.1?Ye=`Export ${z.export_kwh?.toFixed(1)}kWh`:(z.water_heating_kw||0)>.1&&(Ye="Heat Water"),xi=`  Next: ${Ye} (${Te}m)`}}const Vr=`${gi}${xi}`,tn=f?.last_run_at||O?.planned_at,sn=tn?new Date(tn):null,Wr=c?.every_minutes&&c.every_minutes>0?c.every_minutes:null;let yi=null;return f?.next_run_at?yi=new Date(f.next_run_at):c?.enable_scheduler&&sn&&Wr&&(yi=new Date(sn.getTime()+Wr*60*1e3)),l.jsxs("main",{className:"mx-auto max-w-7xl px-4 pb-24 pt-6 sm:px-6 lg:pt-10 space-y-6",children:[l.jsx(Jy,{health:dt}),_&&l.jsx(Fe.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"banner banner-error p-4",children:l.jsxs("div",{className:"flex items-start justify-between gap-4 w-full",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 font-semibold text-sm mb-1",children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Planner Error"})]}),l.jsx("div",{className:"opacity-80 text-xs",children:_.message}),_.at&&l.jsx("div",{className:"opacity-60 text-[10px] mt-1",children:new Date(_.at).toLocaleString()})]}),l.jsx("button",{onClick:()=>S(null),className:"opacity-60 hover:opacity-100 text-xs px-2 py-1",title:"Dismiss",children:""})]})}),N?.shadow_mode&&l.jsxs(Fe.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"banner banner-purple px-4 py-3",children:[l.jsx("span",{children:""}),l.jsx("span",{className:"font-medium",children:"Shadow Mode Active"}),l.jsx("span",{className:"opacity-70 text-xs ml-2",children:" Actions logged but not executed on Home Assistant"})]}),N?.paused&&l.jsxs(Fe.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"banner banner-warning px-4 py-3",children:[l.jsx("span",{children:""}),l.jsx("span",{className:"font-medium",children:"Executor Paused (Idle Mode)"}),N.paused.paused_minutes!==void 0&&l.jsxs("span",{className:"opacity-70 text-xs ml-2",children:[" Paused for ",N.paused.paused_minutes," minutes"]})]}),(D||B)&&l.jsxs(Fe.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"banner banner-warning px-4 py-3",children:[l.jsx("span",{children:""}),l.jsx("span",{className:"font-medium",children:"Vacation Mode Active"}),l.jsx("span",{className:"opacity-70 text-xs ml-2",children:" Water heating is disabled"})]}),M?.boost&&l.jsxs(Fe.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"banner banner-error px-4 py-3 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Lp,{className:"h-4 w-4 text-red-400 animate-pulse"}),l.jsx("span",{className:"font-medium",children:"Water Heater Boost Active"}),M.expires_at&&l.jsxs("span",{className:"opacity-70 text-xs ml-2",children:[" Expires at"," ",new Date(M.expires_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),l.jsx("button",{onClick:async()=>{try{await K.waterBoost.cancel(),Be(),Je({message:"Boost Cancelled",description:"Water heater boost has been stopped.",variant:"success"})}catch(z){console.error("Failed to cancel boost",z)}},className:"bg-white/10 hover:bg-white/20 px-3 py-1 rounded-md text-[10px] font-semibold transition",children:"STOP BOOST"})]}),N?.quick_action?.type==="force_charge"&&l.jsxs(Fe.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"banner banner-success px-4 py-3 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Sr,{className:"h-4 w-4 text-green-600 animate-pulse"}),l.jsx("span",{className:"font-medium text-green-800",children:"Battery Top-Up Active"}),l.jsxs("span",{className:"opacity-70 text-green-700 text-xs ml-2",children:[" Charging ",t??"?","% "," ",N.quick_action.params?.target_soc??60,"%"]})]}),l.jsx("button",{onClick:async()=>{try{await K.executor.quickAction.clear(),await Be(),Je({message:"Top-Up Stopped",variant:"success"})}catch(z){console.error("Failed to stop top-up",z),Je({message:"Failed to stop top-up",variant:"error"})}},className:"px-2 py-1 bg-green-600/20 hover:bg-green-600/30 text-green-800 rounded text-xs transition border border-green-600/20",children:"STOP TOP-UP"})]}),l.jsx(Fe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},children:l.jsx(ox,{useHistoryForToday:!0,refreshToken:a,slotsOverride:en,range:"48h",showDayToggle:!0})}),l.jsxs("div",{className:"grid gap-6 lg:grid-cols-3 items-stretch",children:[l.jsx(Fe.div,{className:"h-full flex flex-col gap-4",initial:{opacity:0,y:8},animate:{opacity:1,y:0},children:l.jsx("div",{className:"flex-1 min-h-0",children:l.jsx(CC,{isLoading:s,powerFlowData:{solar:{kw:Ee.pv_kw??0,todayKwh:k?.pvProduction??void 0},battery:{kw:Ee.battery_kw??0,soc:t??50},grid:{kw:Ee.grid_kw??0,importKwh:k?.gridImport??void 0,exportKwh:k?.gridExport??void 0},house:{kw:Ee.load_kw??0,todayKwh:k?.loadConsumption??void 0},water:{kw:Ee.water_kw??0}}})})}),l.jsx(Fe.div,{className:"h-full",initial:{opacity:0,y:8},animate:{opacity:1,y:0},children:l.jsx(OC,{comfortLevel:$,setComfortLevel:Uo,riskAppetite:Le,setRiskAppetite:Go,vacationMode:D||B,boostActive:M?.boost,activeQuickAction:N?.quick_action,currentSoc:t??0,onBatteryTopUp:qo,onStatusRefresh:Be})}),l.jsx(Fe.div,{className:"h-full",initial:{opacity:0,y:8},animate:{opacity:1,y:0},children:l.jsxs("div",{className:"flex h-full flex-col gap-6",children:[l.jsx(de,{className:"flex-1 p-4 md:p-5",children:l.jsx(JS,{status:q,onRefresh:Be})}),l.jsxs(de,{className:"flex-1 p-4 md:p-5",children:[l.jsxs("div",{className:"flex items-baseline justify-between mb-4",children:[l.jsx("div",{className:"text-sm font-medium text-text",children:"Planner Automation"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-muted",children:[l.jsx("span",{className:`inline-flex h-2 w-2 rounded-full ${c?.enable_scheduler?"bg-good shadow-[0_0_0_2px_rgba(var(--color-good),0.4)]":"bg-line"}`}),l.jsx("span",{children:c?.enable_scheduler?"Active":"Disabled"})]}),l.jsx("button",{type:"button",onClick:Ko,disabled:u,className:"rounded-pill px-2 py-0.5 text-[10px] font-semibold border border-line/60 text-muted hover:border-accent hover:text-accent disabled:opacity-50 transition",children:c?.enable_scheduler?"Disable":"Enable"})]})]}),l.jsxs("div",{className:"mb-4 p-2 rounded-lg bg-surface2/30 border border-line/30 flex items-center justify-between",children:[l.jsx("div",{className:"text-[10px] font-medium text-text",children:Vr}),l.jsx("button",{onClick:()=>Be(),disabled:s,className:`rounded-full p-1 transition ${s?"bg-surface2 text-muted":"text-muted hover:text-accent"}`,title:"Manual sync",children:l.jsx("span",{className:`inline-block text-[10px] ${s?"animate-spin":""}`,children:s?"":""})})]}),l.jsxs("div",{className:"space-y-1 text-[10px] text-muted",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Last plan run:"}),l.jsx("span",{className:"font-mono",children:rp(sn)})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Next expected run:"}),l.jsx("span",{className:"font-mono",children:c?.enable_scheduler?rp(yi):""})]}),l.jsxs("div",{className:"flex justify-between pt-1 border-t border-line/30 mt-1",children:[l.jsx("span",{children:"Dashboard Sync:"}),l.jsx("span",{children:i?i.toLocaleTimeString():""})]})]})]})]})})]}),l.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[l.jsx(DC,{netCost:k?.netCost??null,importKwh:k?.gridImport??null,exportKwh:k?.gridExport??null}),l.jsx(EC,{pvActual:k?.pvProduction??null,pvForecast:k?.pvForecast??null,loadActual:k?.loadConsumption??null,loadAvg:Q?.dailyKwh??null,waterKwh:Se?.kwh??null,batteryCapacity:H}),l.jsx(AC,{soc:t,socTarget:oe,sIndex:F?.s_index?.effective_load_margin??F?.s_index?.risk_factor??F?.s_index?.factor??null,cycles:k?.batteryCycles??null,riskLabel:{1:"Safety",2:"Conservative",3:"Neutral",4:"Aggressive",5:"Gambler"}[Le]||"Neutral"})]})]})}function OP(){const[t,e]=y.useState([]),[s,n]=y.useState(!1),[i,r]=y.useState(null),[a,o]=y.useState("all"),[c,d]=y.useState("all"),[u,h]=y.useState(null),[f,m]=y.useState(null),[p,g]=y.useState("today"),x=y.useRef(null),v=y.useRef(null);y.useEffect(()=>{n(!0),r(null),K.debugLogs().then(j=>e(j.logs??[])).catch(j=>{console.error("Failed to fetch debug logs:",j),r("Failed to load logs")}).finally(()=>n(!1))},[]),y.useEffect(()=>{(()=>{m(null);let j="today";if(p==="yesterday"){const k=new Date;k.setDate(k.getDate()-1),j=k.toISOString().slice(0,10)}K.historySoc(j).then(k=>h(k)).catch(k=>{console.error("Failed to fetch historic SoC:",k),m("Failed to load SoC history")})})()},[p]);const _=t.filter(N=>{if(a==="all")return!0;const j=(N.level||"").toUpperCase();return a==="error"?j==="ERROR"||j==="CRITICAL":j==="WARN"||j==="WARNING"||j==="ERROR"||j==="CRITICAL"}).filter(N=>{if(c==="all")return!0;const j=new Date(N.timestamp).getTime();if(Number.isNaN(j))return!0;const T=Date.now()-j,M=3600*1e3;return c==="1h"?T<=M:c==="6h"?T<=6*M:c==="24h"?T<=24*M:!0}),S=t.filter(N=>{const j=(N.level||"").toUpperCase();return j==="ERROR"||j==="CRITICAL"});return y.useEffect(()=>{if(!x.current)return;const N=u?.slots??[];if(!N.length){v.current&&(v.current.destroy(),v.current=null);return}const j=N.map(P=>{const O=new Date(P.timestamp);return Number.isNaN(O.getTime())?"":O.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})}),k=N.map(P=>P.soc_percent??0),T={labels:j,datasets:[{type:"line",label:"SoC (%)",data:k,borderColor:"rgba(129, 200, 253, 0.9)",backgroundColor:"rgba(129, 200, 253, 0.15)",pointRadius:0,tension:.25}]},M={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:P=>`SoC: ${P.parsed.y?.toFixed(1)??"--"}%`}}},scales:{x:{ticks:{color:"#a6b0bf",maxRotation:0},grid:{display:!1}},y:{ticks:{color:"#a6b0bf",stepSize:10},grid:{color:"rgba(255,255,255,0.06)"},beginAtZero:!0,suggestedMax:100}}};if(v.current){v.current.data=T,v.current.options=M,v.current.update();return}return v.current=new Ct(x.current,{type:"line",data:T,options:M}),()=>{v.current&&(v.current.destroy(),v.current=null)}},[u]),l.jsxs("main",{className:"mx-auto max-w-7xl px-4 pb-24 pt-8 sm:px-6 lg:pt-12",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("div",{className:"text-sm text-muted",children:"Debug & Diagnostics"}),l.jsx("div",{className:"text-[13px] text-muted/80",children:"Logs and SoC history to understand what the planner has been doing recently."})]}),l.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[l.jsxs(de,{className:"p-5 lg:col-span-2",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("div",{className:"text-sm text-muted",children:"Logs"}),l.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-muted",children:[l.jsx("button",{className:"rounded-pill border border-line/60 px-3 py-1 hover:border-accent disabled:opacity-40",onClick:()=>{n(!0),r(null),K.debugLogs().then(N=>e(N.logs??[])).catch(N=>{console.error("Failed to refresh debug logs:",N),r("Failed to refresh logs")}).finally(()=>n(!1))},disabled:s,children:s?"Refreshing":"Refresh"}),l.jsxs("select",{className:"rounded-md bg-surface2 border border-line/60 px-2 py-1 text-[11px]",value:c,onChange:N=>d(N.target.value),children:[l.jsx("option",{value:"all",children:"All time"}),l.jsx("option",{value:"1h",children:"Last 1 hour"}),l.jsx("option",{value:"6h",children:"Last 6 hours"}),l.jsx("option",{value:"24h",children:"Last 24 hours"})]}),l.jsxs("select",{className:"rounded-md bg-surface2 border border-line/60 px-2 py-1 text-[11px]",value:a,onChange:N=>o(N.target.value),children:[l.jsx("option",{value:"all",children:"All levels"}),l.jsx("option",{value:"warn_error",children:"Warn + Error"}),l.jsx("option",{value:"error",children:"Errors only"})]})]})]}),i&&l.jsx("div",{className:"text-[11px] text-amber-400 mb-2",children:i}),l.jsxs("div",{className:"h-64 overflow-auto rounded-xl2 border border-line/60 bg-surface2/40 text-[11px] font-mono text-muted/90",children:[_.length===0&&!s&&!i&&l.jsx("div",{className:"px-3 py-2 text-muted/70",children:"No logs captured yet."}),_.map((N,j)=>l.jsxs("div",{className:"px-3 py-1.5 border-b border-line/20 last:border-b-0",children:[l.jsx("span",{className:"text-muted/60 mr-2",children:new Date(N.timestamp).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit"})}),l.jsx("span",{className:"mr-2 rounded-full px-1.5 py-0.5 text-[10px] uppercase tracking-wide border border-line/50",children:N.level}),l.jsx("span",{className:"text-muted/70 mr-2",children:N.logger}),l.jsx("span",{children:N.message})]},`${N.timestamp}-${j}`))]})]}),l.jsxs(de,{className:"p-5 lg:col-span-1",children:[l.jsx("div",{className:"text-sm text-muted mb-3",children:"Recent events"}),l.jsx("div",{className:"text-[13px] text-muted/80 mb-2",children:"Quick view of recent errors and warnings from the log stream."}),l.jsxs("div",{className:"space-y-2 text-[12px] text-muted/90",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{children:"Total log entries"}),l.jsx("span",{className:"tabular-nums",children:t.length})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{children:"Error/critical entries"}),l.jsx("span",{className:"tabular-nums",children:S.length})]}),l.jsx("div",{className:"mt-3 text-[11px] text-muted/70 uppercase tracking-wide",children:"Last errors"}),l.jsxs("div",{className:"space-y-1.5 max-h-40 overflow-auto",children:[S.slice(-5).map((N,j)=>l.jsxs("div",{className:"rounded-md bg-rose-500/5 border border-rose-500/40 px-2 py-1.5",children:[l.jsxs("div",{className:"text-[10px] text-rose-200/80 mb-0.5",children:[new Date(N.timestamp).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit"})," "," ",N.logger]}),l.jsx("div",{className:"text-[11px] text-rose-50/90 line-clamp-2",children:N.message})]},`${N.timestamp}-err-${j}`)),S.length===0&&l.jsx("div",{className:"text-[11px] text-muted/70",children:"No error-level entries yet."})]})]})]})]}),l.jsx("div",{className:"grid gap-6 mt-6 lg:grid-cols-3",children:l.jsxs(de,{className:"p-5 lg:col-span-2",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("div",{className:"text-sm text-muted",children:"Historical SoC"}),l.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-muted",children:[l.jsx("span",{className:"text-muted/70",children:"Range"}),l.jsxs("select",{className:"rounded-md bg-surface2 border border-line/60 px-2 py-1 text-[11px]",value:p,onChange:N=>g(N.target.value),children:[l.jsx("option",{value:"today",children:"Today"}),l.jsx("option",{value:"yesterday",children:"Yesterday"})]})]})]}),l.jsx("div",{className:"text-[13px] text-muted/80 mb-2",children:"SoC (%) over the selected day from the learning database. Use this to correlate planner behaviour with actual SoC movement."}),f&&l.jsx("div",{className:"text-[11px] text-amber-400 mb-2",children:f}),l.jsx("div",{className:"h-48",children:l.jsx("canvas",{ref:x,className:"w-full h-full"})})]})})]})}function no(t,e){return e.reduce((s,n)=>s&&typeof s=="object"?s[n]:void 0,t)}function Bc(t,e,s){if(e.length===0)return t;const[n,...i]=e;if(i.length===0)return{...t,[n]:s};const r=t[n]||{};return{...t,[n]:Bc(r,i,s)}}function RP(t,e){const s=e.trim();if(t.type==="number"||t.type==="azimuth"||t.type==="tilt"){if(s==="")return null;const n=Number(s);return Number.isNaN(n)?void 0:n}return t.type==="boolean"?s==="true":t.type==="array"?s?s.split(",").map(n=>n.trim()).filter(Boolean).map(n=>{const i=Number(n);return Number.isNaN(i)?n:i}):[]:s}function ap(t,e){const s={};return t&&e.forEach(n=>{if(n.companionKey){const r=no(t,n.companionKey.split("."));s[n.companionKey]=r===!0?"true":"false"}const i=no(t,n.path);n.type==="boolean"?s[n.key]=i===!0?"true":"false":n.type==="array"&&Array.isArray(i)?s[n.key]=i.join(", "):s[n.key]=i!=null?String(i):""}),s}function op(t,e,s){let n={};return s.forEach(i=>{if(i.companionKey){const d=e[i.companionKey];if(d!==void 0){const u=d==="true",h=i.companionKey.split("."),f=no(t,h);u!==f&&(n=Bc(n,h,u))}}const r=e[i.key];if(r===void 0)return;const a=RP(i,r);if(a===void 0||i.type==="number"&&a===null)return;const o=no(t,i.path);((d,u,h)=>h==="array"?!Array.isArray(d)||!Array.isArray(u)||d.length!==u.length?!1:d.every((f,m)=>f===u[m]):d===u)(a,o,i.type)||(n=Bc(n,i.path,a))}),n}function Ao(t){const{toast:e}=Or(),[s,n]=y.useState(null),[i,r]=y.useState({}),[a,o]=y.useState({}),[c,d]=y.useState(!0),[u,h]=y.useState(!1),[f,m]=y.useState(null),[p,g]=y.useState([]),[x,v]=y.useState(!1),_=y.useCallback(async()=>{d(!0),m(null);try{const P=await K.config();n(P),r(ap(P,t)),o({})}catch(P){console.error("Failed to load configuration",P),m("Failed to load configuration: "+(P instanceof Error?P.message:"Unknown error"))}finally{d(!1)}},[t]),S=y.useCallback(async()=>{v(!0);try{const P=await K.haEntities();g(P.entities||[])}catch(P){console.error("Failed to load HA entities",P)}finally{v(!1)}},[]);y.useEffect(()=>{_(),S()},[_,S]);const N=y.useCallback((P,O,A)=>{const F={},X=O.trim(),H=t.find(Y=>Y.key===P);if(!H)return F;if(P.includes("battery_soc")&&console.warn("[SETTINGS_DEBUG] Validating battery_soc:",{key:P,value:O,trimmed:X,fieldType:H.type,fieldLabel:H.label,fullField:H}),X===""&&(P.includes("power_kw")||P.includes("capacity_kwh")))return F[P]="Required",F;if(H.type==="number"||H.type==="azimuth"||H.type==="tilt"){P.includes("battery_soc")&&console.error("[SETTINGS_DEBUG] ERROR: battery_soc entered numeric validation block! Type:",H.type);const Y=Number(X);X!==""&&Number.isNaN(Y)?F[P]="Must be a number":Number.isNaN(Y)||(P.includes("percent")||P.includes("soc")?(Y<0||Y>100)&&(F[P]="Must be between 0 and 100"):(P.includes("power_kw")||P.includes("sek")||P.includes("kwh"))&&Y<0&&(F[P]="Must be positive"))}const Z="battery.min_soc_percent",Q="battery.max_soc_percent";if(P===Z||P===Q){const Y=Number(P===Z?X:A[Z]),oe=Number(P===Q?X:A[Q]);!Number.isNaN(Y)&&!Number.isNaN(oe)&&Y>=oe&&(F[Z]="Min SoC must be less than max SoC",F[Q]="Max SoC must be greater than min SoC")}return F},[t]),j=y.useCallback((P,O)=>{r(A=>{const F={...A,[P]:O},X=N(P,O,F);return o(H=>{const Z={...H,...X};return X[P]||delete Z[P],P==="battery.min_soc_percent"&&!X["battery.min_soc_percent"]&&delete Z["battery.max_soc_percent"],P==="battery.max_soc_percent"&&!X["battery.max_soc_percent"]&&delete Z["battery.min_soc_percent"],Z}),F}),m(null)},[N]),k=y.useCallback(()=>{s&&(r(ap(s,t)),o({}),m(null))},[s,t]),T=y.useCallback(async P=>{if(!s)return!1;if(Object.keys(a).length>0)return m("Please fix validation errors before saving."),!1;const O={...op(s,i,t),...P};if(Object.keys(O).length===0)return m("No changes detected."),!1;h(!0),m(null);try{const A=await K.configSave(O);if(A.status==="success")return A.warnings&&A.warnings.length>0?A.warnings.forEach(F=>{e({message:F.message,description:F.guidance,variant:"warning"})}):e({message:"Settings saved successfully",variant:"success"}),await _(),!0;{const F={};A.errors?.forEach(X=>{X.field&&(F[X.field]=X.message)}),o(X=>({...X,...F})),m(A.errors?.[0]?.message||"Save failed"),e({message:"Save failed",variant:"error"})}}catch(A){console.error("Save failed",A);const F=A instanceof Error?A.message:"Unknown error";m(F),e({message:"Save failed",description:F,variant:"error"})}finally{h(!1)}return!1},[s,i,t,a,_,e]),M=y.useMemo(()=>{if(!s)return!1;const P=op(s,i,t);return Object.keys(P).length>0},[s,i,t]);return{config:s,form:i,fieldErrors:a,loading:c,saving:u,statusMessage:f,isDirty:M,haEntities:p,haLoading:x,handleChange:j,save:T,reset:k,reload:_,reloadEntities:S}}function LP({text:t,className:e=""}){const[s,n]=y.useState(!1);return t?l.jsxs("div",{className:`relative inline-block ${e}`,children:[l.jsx("button",{type:"button",className:"ml-1.5 text-muted/60 hover:text-accent transition-colors",onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),onFocus:()=>n(!0),onBlur:()=>n(!1),children:l.jsx(Cv,{className:"w-3.5 h-3.5"})}),s&&l.jsxs("div",{className:"absolute z-50 w-64 p-2.5 text-xs bg-surface2 border border-line rounded-lg shadow-lg left-0 bottom-full mb-1.5",children:[l.jsx("div",{className:"text-muted leading-relaxed",children:t}),l.jsx("div",{className:"absolute w-2 h-2 bg-surface2 border-r border-b border-line transform rotate-45 left-3 -bottom-1"})]})]}):null}function FP({value:t,onChange:e}){const s=y.useMemo(()=>{if(typeof t!="number"||Number.isNaN(t))return 0;let h=t%360;return h<0&&(h+=360),h},[t]),[n,i]=y.useState(!1),r=h=>{const f=Math.round(h),m=[0,45,90,135,180,225,270,315];let p=f,g=1/0;for(const x of m){const v=Math.abs(f-x);v<g&&v<=7&&(g=v,p=x)}return p},a=h=>{const f=h.currentTarget.getBoundingClientRect(),m=f.left+f.width/2,p=f.top+f.height/2,g=h.clientX-m,x=h.clientY-p;let _=Math.atan2(g,-x)*180/Math.PI;_<0&&(_+=360);const S=r(_);e(S)},o=h=>{i(!0);try{h.currentTarget.setPointerCapture(h.pointerId)}catch{}a(h)},c=h=>{n&&a(h)},d=h=>{if(n){i(!1);try{h.currentTarget.releasePointerCapture(h.pointerId)}catch{}}},u=`rotate(${s} 24 24)`;return l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"relative h-16 w-16 cursor-pointer",onPointerDown:o,onPointerMove:c,onPointerUp:d,"aria-label":"Solar azimuth dial",role:"slider","aria-valuemin":0,"aria-valuemax":360,"aria-valuenow":Math.round(s),children:l.jsxs("svg",{viewBox:"0 0 48 48",className:"h-full w-full",children:[l.jsx("circle",{cx:"24",cy:"24",r:"21",className:"fill-surface2 stroke-line/60",strokeWidth:"2"}),l.jsx("g",{children:Array.from({length:12}).map((h,f)=>{const m=f*30,p=m%90===0,g=!p&&m%45===0,x=21,v=p?16:g?18:19,_=(m-90)*Math.PI/180,S=24+x*Math.cos(_),N=24+x*Math.sin(_),j=24+v*Math.cos(_),k=24+v*Math.sin(_),T=p||g?"stroke-line/80":"stroke-line/40",M=p?1.6:1;return l.jsx("line",{x1:S,y1:N,x2:j,y2:k,className:T,strokeWidth:M},m)})}),l.jsx("text",{x:"24",y:"9",textAnchor:"middle",className:"fill-muted text-[8px]",children:"N"}),l.jsx("text",{x:"24",y:"45",textAnchor:"middle",className:"fill-muted text-[8px]",children:"S"}),l.jsx("text",{x:"43",y:"25",textAnchor:"middle",className:"fill-muted text-[8px]",children:"E"}),l.jsx("text",{x:"5",y:"25",textAnchor:"middle",className:"fill-muted text-[8px]",children:"W"}),l.jsxs("g",{transform:u,children:[l.jsx("line",{x1:"24",y1:"24",x2:"24",y2:"6",className:"stroke-accent",strokeWidth:"2.2",strokeLinecap:"round"}),l.jsx("circle",{cx:"24",cy:"24",r:"2.5",className:"fill-accent"})]})]})}),l.jsxs("div",{className:"text-[11px] text-muted leading-tight",children:[l.jsxs("div",{className:"font-medium text-text",children:[Math.round(s),""]}),l.jsx("div",{children:"0 = North  90 = East  180 = South  270 = West"})]})]})}function IP({value:t,onChange:e}){const s=y.useMemo(()=>{if(typeof t!="number"||Number.isNaN(t))return 0;let h=t;return h<0&&(h=0),h>90&&(h=90),h},[t]),[n,i]=y.useState(!1),r=h=>{const f=h.currentTarget.getBoundingClientRect(),m=f.left+f.width/2,p=f.top+f.height/2,g=h.clientX-m,x=h.clientY-p;let _=Math.atan2(g,-x)*180/Math.PI;_<0&&(_+=360),(_<270||_>360)&&(_>=0&&_<=135?_=360:_=270);let S=360-_;S<0&&(S=0),S>90&&(S=90);const N=Math.round(S/5)*5;e(N)},a=h=>{i(!0);try{h.currentTarget.setPointerCapture(h.pointerId)}catch{}r(h)},o=h=>{n&&r(h)},c=h=>{if(n){i(!1);try{h.currentTarget.releasePointerCapture(h.pointerId)}catch{}}},u=`rotate(${y.useMemo(()=>360-s,[s])} 24 24)`;return l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"relative h-16 w-16 cursor-pointer",onPointerDown:a,onPointerMove:o,onPointerUp:c,"aria-label":"Solar tilt dial",role:"slider","aria-valuemin":0,"aria-valuemax":90,"aria-valuenow":Math.round(s),children:l.jsxs("svg",{viewBox:"0 0 48 48",className:"h-full w-full",children:[l.jsx("circle",{cx:"24",cy:"24",r:"21",className:"fill-surface2 stroke-line/40",strokeWidth:"2"}),l.jsx("path",{d:"M3 24 A21 21 0 0 1 24 3",className:"fill-none stroke-accent/70",strokeWidth:"2.2"}),l.jsx("g",{children:Array.from({length:7}).map((h,f)=>{const m=f*15,p=360-m,g=21,x=m%30===0?18:19,v=(p-90)*Math.PI/180,_=24+g*Math.cos(v),S=24+g*Math.sin(v),N=24+x*Math.cos(v),j=24+x*Math.sin(v),k=m===0||m===90?"stroke-line/80":"stroke-line/60",T=m===0||m===90?1.6:1.2;return l.jsx("line",{x1:_,y1:S,x2:N,y2:j,className:k,strokeWidth:T},m)})}),l.jsx("text",{x:"24",y:"9",textAnchor:"middle",className:"fill-muted text-[8px]",children:"0"}),l.jsx("text",{x:"5",y:"25",textAnchor:"middle",className:"fill-muted text-[8px]",children:"90"}),l.jsxs("g",{transform:u,children:[l.jsx("line",{x1:"24",y1:"24",x2:"24",y2:"6",className:"stroke-accent",strokeWidth:"2.2",strokeLinecap:"round"}),l.jsx("circle",{cx:"24",cy:"24",r:"2.5",className:"fill-accent"})]})]})}),l.jsxs("div",{className:"text-[11px] text-muted leading-tight",children:[l.jsxs("div",{className:"font-medium text-text",children:[Math.round(s),""]}),l.jsx("div",{children:"Drag along the arc: 0 = flat  90 = vertical panel"})]})]})}function VP({entities:t,value:e,onChange:s,placeholder:n="Select entity...",disabled:i=!1,loading:r=!1}){const[a,o]=y.useState(!1),[c,d]=y.useState(""),[u,h]=y.useState(0),f=y.useRef(null),m=y.useRef(null),p=y.useRef(null),g=t.find(k=>k.entity_id===e),x=y.useMemo(()=>{if(!c.trim())return t;const k=c.toLowerCase();return t.filter(T=>T.entity_id.toLowerCase().includes(k)||T.friendly_name.toLowerCase().includes(k))},[t,c]),v=y.useMemo(()=>{const k={};return x.forEach(T=>{const M=T.domain||T.entity_id.split(".")[0];k[M]||(k[M]=[]),k[M].push(T)}),k},[x]),_=y.useMemo(()=>{const k=[];return Object.values(v).forEach(T=>k.push(...T)),k},[v]);y.useEffect(()=>{h(0)},[x.length]),y.useEffect(()=>{const k=T=>{f.current&&!f.current.contains(T.target)&&(o(!1),d(""))};return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[]),y.useEffect(()=>{if(a&&p.current){const k=p.current.querySelector('[data-highlighted="true"]');k&&k.scrollIntoView({block:"nearest"})}},[u,a]);const S=k=>{s(k.entity_id),o(!1),d("")},N=k=>{if(!a){(k.key==="Enter"||k.key===" "||k.key==="ArrowDown")&&(k.preventDefault(),o(!0));return}switch(k.key){case"ArrowDown":k.preventDefault(),h(T=>Math.min(T+1,_.length-1));break;case"ArrowUp":k.preventDefault(),h(T=>Math.max(T-1,0));break;case"Enter":k.preventDefault(),_[u]&&S(_[u]);break;case"Escape":k.preventDefault(),o(!1),d("");break}},j=k=>{k.stopPropagation(),s(""),o(!1),d("")};return l.jsxs("div",{ref:f,className:"relative",children:[l.jsxs("button",{type:"button",disabled:i,onClick:()=>{i||(o(!a),a||setTimeout(()=>m.current?.focus(),0))},onKeyDown:N,className:`
                    w-full flex items-center justify-between gap-2 px-3 py-2
                    rounded-lg border border-line bg-surface2 text-left text-sm
                    hover:border-accent/60 focus:outline-none focus:ring-2 focus:ring-accent/40
                    disabled:opacity-50 disabled:cursor-not-allowed
                    transition-colors
                `,children:[l.jsx("span",{className:g?"text-text":"text-muted",children:r?"Loading...":g?.friendly_name||g?.entity_id||n}),l.jsxs("div",{className:"flex items-center gap-1",children:[e&&!i&&l.jsx("span",{role:"button",tabIndex:-1,onClick:j,onKeyDown:k=>{(k.key==="Enter"||k.key===" ")&&(k.preventDefault(),j(k))},className:"p-0.5 rounded hover:bg-line/60 text-muted hover:text-text cursor-pointer",children:l.jsx(ii,{className:"h-3.5 w-3.5"})}),l.jsx(mo,{className:`h-4 w-4 text-muted transition-transform ${a?"rotate-180":""}`})]})]}),a&&l.jsxs("div",{className:"absolute z-50 mt-1 w-full min-w-[280px] max-h-[300px] overflow-hidden rounded-lg border border-line bg-surface shadow-float",children:[l.jsx("div",{className:"p-2 border-b border-line",children:l.jsxs("div",{className:"relative",children:[l.jsx(Zc,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-muted"}),l.jsx("input",{ref:m,type:"text",value:c,onChange:k=>d(k.target.value),onKeyDown:N,placeholder:"Search entities...",className:"w-full pl-8 pr-3 py-1.5 rounded-md bg-surface2 border border-line text-sm text-text placeholder:text-muted focus:outline-none focus:ring-1 focus:ring-accent/40"})]})}),l.jsx("div",{ref:p,className:"max-h-[240px] overflow-y-auto p-1",children:x.length===0?l.jsx("div",{className:"px-3 py-4 text-center text-sm text-muted",children:"No entities found"}):Object.entries(v).map(([k,T])=>l.jsxs("div",{className:"mb-1",children:[l.jsx("div",{className:"px-2 py-1 text-[10px] uppercase tracking-wider text-muted/70 font-medium",children:k}),T.map(M=>{const O=_.findIndex(F=>F.entity_id===M.entity_id)===u,A=M.entity_id===e;return l.jsxs("button",{type:"button","data-highlighted":O,onClick:()=>S(M),className:`
                                                    w-full text-left px-2 py-1.5 rounded-md text-sm
                                                    transition-colors
                                                    ${O?"bg-accent/20 text-text":"text-text hover:bg-surface2"}
                                                    ${A?"font-medium":""}
                                                `,children:[l.jsx("div",{className:"truncate",children:M.friendly_name||M.entity_id}),l.jsx("div",{className:"text-[10px] text-muted truncate",children:M.entity_id})]},M.entity_id)})]},k))})]})]})}function WP({value:t,onChange:e,placeholder:s="Select service (e.g. notify.mobile_app)...",disabled:n=!1}){const[i,r]=y.useState(!1),[a,o]=y.useState(""),[c,d]=y.useState([]),[u,h]=y.useState(!1),[f,m]=y.useState(0),p=y.useRef(null),g=y.useRef(null),x=y.useRef(null);y.useEffect(()=>{i&&c.length===0&&!u&&(h(!0),K.haServices().then(T=>{d(T.services||[])}).catch(T=>{console.error("Failed to fetch HA services:",T)}).finally(()=>{h(!1)}))},[i,c.length,u]);const v=y.useMemo(()=>{if(!a.trim())return c;const T=a.toLowerCase();return c.filter(M=>M.toLowerCase().includes(T))},[c,a]),_=y.useMemo(()=>{const T={};return v.forEach(M=>{const P=M.split(".")[0]||"other";T[P]||(T[P]=[]),T[P].push(M)}),T},[v]),S=y.useMemo(()=>{const T=[];return Object.values(_).forEach(M=>T.push(...M)),T},[_]);y.useEffect(()=>{m(0)},[v.length]),y.useEffect(()=>{const T=M=>{p.current&&!p.current.contains(M.target)&&(r(!1),o(""))};return document.addEventListener("mousedown",T),()=>document.removeEventListener("mousedown",T)},[]),y.useEffect(()=>{if(i&&x.current){const T=x.current.querySelector('[data-highlighted="true"]');T&&T.scrollIntoView({block:"nearest"})}},[f,i]);const N=T=>{e(T),r(!1),o("")},j=T=>{if(!i){(T.key==="Enter"||T.key===" "||T.key==="ArrowDown")&&(T.preventDefault(),r(!0));return}switch(T.key){case"ArrowDown":T.preventDefault(),m(M=>Math.min(M+1,S.length-1));break;case"ArrowUp":T.preventDefault(),m(M=>Math.max(M-1,0));break;case"Enter":T.preventDefault(),S[f]&&N(S[f]);break;case"Escape":T.preventDefault(),r(!1),o("");break}},k=T=>{T.stopPropagation(),e(""),r(!1),o("")};return l.jsxs("div",{ref:p,className:"relative",children:[l.jsxs("button",{type:"button",disabled:n,onClick:()=>{n||(r(!i),i||setTimeout(()=>g.current?.focus(),0))},onKeyDown:j,className:`
                    w-full flex items-center justify-between gap-2 px-3 py-2
                    rounded-lg border border-line bg-surface2 text-left text-sm
                    hover:border-accent/60 focus:outline-none focus:ring-2 focus:ring-accent/40
                    disabled:opacity-50 disabled:cursor-not-allowed
                    transition-colors
                `,children:[l.jsx("span",{className:t?"text-text":"text-muted",children:u&&c.length===0?"Loading services...":t||s}),l.jsxs("div",{className:"flex items-center gap-1",children:[t&&!n&&l.jsx("span",{role:"button",tabIndex:-1,onClick:k,onKeyDown:T=>{(T.key==="Enter"||T.key===" ")&&(T.preventDefault(),k(T))},className:"p-0.5 rounded hover:bg-line/60 text-muted hover:text-text cursor-pointer",children:l.jsx(ii,{className:"h-3.5 w-3.5"})}),l.jsx(mo,{className:`h-4 w-4 text-muted transition-transform ${i?"rotate-180":""}`})]})]}),i&&l.jsxs("div",{className:"absolute z-50 mt-1 w-full min-w-[280px] max-h-[300px] overflow-hidden rounded-lg border border-line bg-surface shadow-float",children:[l.jsx("div",{className:"p-2 border-b border-line",children:l.jsxs("div",{className:"relative",children:[l.jsx(Zc,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-muted"}),l.jsx("input",{ref:g,type:"text",value:a,onChange:T=>o(T.target.value),onKeyDown:j,placeholder:"Search services...",className:"w-full pl-8 pr-3 py-1.5 rounded-md bg-surface2 border border-line text-sm text-text placeholder:text-muted focus:outline-none focus:ring-1 focus:ring-accent/40"})]})}),l.jsx("div",{ref:x,className:"max-h-[240px] overflow-y-auto p-1 scrollbar-thin",children:u&&c.length===0?l.jsx("div",{className:"px-3 py-4 text-center text-sm text-muted animate-pulse",children:"Loading from Home Assistant..."}):v.length===0?l.jsx("div",{className:"px-3 py-4 text-center text-sm text-muted",children:"No services found"}):Object.entries(_).map(([T,M])=>l.jsxs("div",{className:"mb-1",children:[l.jsx("div",{className:"px-2 py-1 text-[10px] uppercase tracking-wider text-muted/70 font-medium",children:T}),M.map(P=>{const A=S.indexOf(P)===f,F=P===t;return l.jsx("button",{type:"button","data-highlighted":A,onClick:()=>N(P),className:`
                                                    w-full text-left px-2 py-1.5 rounded-md text-sm
                                                    transition-colors
                                                    ${A?"bg-accent/20 text-text":"text-text hover:bg-surface2"}
                                                    ${F?"font-medium":""}
                                                `,children:l.jsx("div",{className:"truncate",children:P})},P)})]},T))})]})]})}function Qy({value:t,onChange:e,options:s,placeholder:n="Select...",disabled:i=!1,className:r="",searchable:a=!1}){const[o,c]=y.useState(!1),[d,u]=y.useState(""),[h,f]=y.useState(0),m=y.useRef(null),p=y.useRef(null),g=y.useRef(null),x=s.find(k=>k.value===t),v=y.useMemo(()=>{if(!d.trim())return s;const k=d.toLowerCase();return s.filter(T=>T.label.toLowerCase().includes(k)||T.value.toLowerCase().includes(k)||T.group?.toLowerCase().includes(k))},[s,d]),_=y.useMemo(()=>{const k={},T=[];return v.forEach(M=>{M.group?(k[M.group]||(k[M.group]=[]),k[M.group].push(M)):T.push(M)}),{groups:k,noGroup:T}},[v]),S=y.useMemo(()=>[..._.noGroup,...Object.values(_.groups).flat()],[_]);y.useEffect(()=>{f(0)},[v.length,o]),y.useEffect(()=>{const k=T=>{m.current&&!m.current.contains(T.target)&&(c(!1),u(""))};return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[]),y.useEffect(()=>{if(o&&g.current){const k=g.current.querySelector(`[data-index="${h}"]`);k&&k.scrollIntoView({block:"nearest"})}},[h,o]);const N=k=>{e(k),c(!1),u("")},j=k=>{if(!i){if(!o){(k.key==="Enter"||k.key===" "||k.key==="ArrowDown")&&(k.preventDefault(),c(!0));return}switch(k.key){case"ArrowDown":k.preventDefault(),f(T=>Math.min(T+1,S.length-1));break;case"ArrowUp":k.preventDefault(),f(T=>Math.max(T-1,0));break;case"Enter":k.preventDefault(),S[h]&&N(S[h].value);break;case"Escape":k.preventDefault(),c(!1),u("");break;case"Tab":c(!1);break}}};return l.jsxs("div",{ref:m,className:`relative ${r}`,children:[l.jsxs("button",{type:"button",disabled:i,onClick:()=>{i||(c(!o),!o&&a&&setTimeout(()=>p.current?.focus(),0))},onKeyDown:j,className:`
                    w-full flex items-center justify-between gap-2 px-3 py-2
                    rounded-lg border border-line bg-surface2 text-left text-sm
                    hover:border-accent/60 focus:outline-none focus:ring-2 focus:ring-accent/40
                    disabled:opacity-50 disabled:cursor-not-allowed
                    transition-colors
                `,children:[l.jsx("span",{className:x?"text-text":"text-muted",children:x?.label||n}),l.jsx(mo,{className:`h-4 w-4 text-muted transition-transform ${o?"rotate-180":""}`})]}),o&&l.jsxs("div",{className:"absolute z-50 mt-1 w-full min-w-[180px] max-h-[300px] overflow-hidden rounded-lg border border-line bg-surface shadow-float animate-in fade-in zoom-in-95 duration-100",children:[a&&l.jsx("div",{className:"p-2 border-b border-line",children:l.jsxs("div",{className:"relative",children:[l.jsx(Zc,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-muted"}),l.jsx("input",{ref:p,type:"text",value:d,onChange:k=>u(k.target.value),placeholder:"Search...",className:"w-full pl-8 pr-3 py-1.5 rounded-md bg-surface2 border border-line text-sm text-text placeholder:text-muted focus:outline-none focus:ring-1 focus:ring-accent/40",onKeyDown:j})]})}),l.jsx("div",{ref:g,className:"max-h-[240px] overflow-y-auto p-1 scrollbar-thin",children:S.length===0?l.jsx("div",{className:"px-3 py-4 text-center text-sm text-muted",children:"No options found"}):l.jsxs(l.Fragment,{children:[_.noGroup.map((k,T)=>{const M=x?.value===k.value,P=S[h]?.value===k.value;return l.jsxs("div",{"data-index":h,className:`
                                                flex items-center justify-between px-2 py-1.5 rounded-md text-sm cursor-pointer
                                                ${P?"bg-accent/20 text-text":"text-text"}
                                                ${M?"font-medium":""}
                                            `,onClick:()=>N(k.value),onMouseEnter:()=>f(S.findIndex(O=>O.value===k.value)),children:[l.jsx("span",{children:k.label}),M&&l.jsx(Xu,{className:"h-3.5 w-3.5 text-accent"})]},k.value)}),Object.entries(_.groups).map(([k,T])=>l.jsxs("div",{className:"mt-1 first:mt-0",children:[l.jsx("div",{className:"px-2 py-1 text-[10px] uppercase tracking-wider text-muted/70 font-medium",children:k}),T.map(M=>{const P=x?.value===M.value,O=S.findIndex(F=>F.value===M.value),A=O===h;return l.jsxs("div",{"data-index":O,className:`
                                                        flex items-center justify-between px-2 py-1.5 rounded-md text-sm cursor-pointer
                                                        ${A?"bg-accent/20 text-text":"text-text"}
                                                        ${P?"font-medium":""}
                                                    `,onClick:()=>N(M.value),onMouseEnter:()=>f(O),children:[l.jsx("span",{children:M.label}),P&&l.jsx(Xu,{className:"h-3.5 w-3.5 text-accent"})]},M.value)})]},k))]})})]})]})}function e0({checked:t,onCheckedChange:e,disabled:s=!1,className:n=""}){return l.jsx("div",{className:`toggle ${t?"active":""} ${n} ${s?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!s&&e(!t),children:l.jsx("div",{className:"toggle-knob"})})}const BP=({variant:t,children:e})=>{const s={warning:"bg-yellow-500/10 text-yellow-500 border-yellow-500/30",info:"bg-blue-500/10 text-blue-500 border-blue-500/30",error:"bg-red-500/10 text-red-500 border-red-500/30",success:"bg-green-500/10 text-green-500 border-green-500/30"};return l.jsx("span",{className:`inline-flex items-center rounded-md border px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide ${s[t]}`,children:e})},zP="IANA timezone for all schedule calculations",HP={timezone:zP,"advisor.enable_llm":"Enable LLM-powered advice on Dashboard","advisor.model":"OpenRouter model identifier (requires API key in secrets.yaml)","advisor.personality":"Advice style: concise | friendly | technical","advisor.auto_fetch":"Automatically fetch advice when Dashboard loads","system.has_solar":"Enable PV forecasting & solar-related features","system.has_battery":"Enable battery control & grid arbitrage","system.has_water_heater":"Enable water heating optimization","system.grid.max_power_kw":"HARD limit: max grid import (cannot be exceeded)","system.inverter.max_power_kw":"Maximum inverter AC power output","system.location.latitude":"Decimal degrees, positive north (for PV forecasting)","system.location.longitude":"Decimal degrees, positive east (for PV forecasting)","system.solar_array.azimuth":"Panel direction: 0=North, 90=East, 180=South, 270=West","system.solar_array.kwp":"Total DC peak power of PV array in kilowatts","system.solar_array.tilt":"Panel angle from horizontal: 0=flat, 90=vertical","battery.max_soc_percent":"Planner target ceiling (BMS still enforces absolute limit)","battery_economics.battery_cycle_cost_kwh":"Degradation cost applied per kWh cycled through the battery","water_heating.power_kw":"Power consumption of the water heater","water_heating.min_kwh_per_day":"Optional; defaults to power * hours when unset","water_heating.defer_up_to_hours":"Allow deferring into early tomorrow up to N hours if cheaper","water_heating.max_hours_between_heating":"Max gap between heating sessions (0 = no constraint)","water_heating.comfort_level":"1-5 (EconomyMaximum) - controls gap penalty","water_heating.min_spacing_hours":"Min gap between starts to avoid efficiency loss","water_heating.spacing_penalty_sek":"Soft penalty for frequent starts","water_heating.vacation_mode.enabled":"Master switch (HA entity can override when ON)","water_heating.vacation_mode.anti_legionella_temp_c":"Target temperature for safety cycle","water_heating.vacation_mode.anti_legionella_interval_days":"Run cycle every N days","water_heating.vacation_mode.anti_legionella_duration_hours":"Duration at power_kw (e.g., 3h * 3kW = 9kWh)","s_index.mode":"Options: probabilistic | dynamic","s_index.static_factor":"Used when mode=static","s_index.base_factor":"Starting point for dynamic calculations","s_index.max_factor":"Upper bound clamp for dynamic mode","s_index.pv_deficit_weight":"Weight for PV/load deficit contribution","s_index.temp_weight":"Weight for temperature adjustment","s_index.temp_baseline_c":"Baseline temperature (no adjustment)","s_index.temp_cold_c":"Temperature where adjustment reaches 100%","s_index.s_index_horizon_days":"Number of days ahead to evaluate (integer)","s_index.risk_appetite":"1-5 scale (1=safe, 3=neutral, 5=gambler)","export.enable_export":"Master switch for grid export (grid-to-home during high price peaks). Implementation pending.","manual_planning.charge_target_percent":"Cap for manual charge slots","manual_planning.export_target_percent":"Floor target when manually scheduling export","debug.enable_planner_debug":"Enable verbose planner logging","debug.sample_size":"Sample size for debug output charts","automation.enable_scheduler":"Enable automatic schedule regeneration","automation.schedule.every_minutes":"How often to regenerate the optimal schedule. Lower values (30min) adapt faster to SoC changes; higher values (60min) reduce CPU usage. Recommended: 30min for most users, 60min for Raspberry Pi.","automation.schedule.jitter_minutes":"Random delay to avoid thundering herd","automation.ml_training.enabled":"Enable automatic ML model retraining","automation.ml_training.run_days":"Days of week to train (0=Mon, 6=Sun)","automation.ml_training.run_time":"Time of day to run training (HH:MM)","learning.default_battery_cost_sek_per_kwh":"Conservative default until dynamic cost is recorded","nordpool.price_area":"Nordpool bidding zone (SE1-SE4, NO1-NO5, DK1-DK2, FI, etc.)","nordpool.currency":"Price currency","nordpool.resolution_minutes":"Slot resolution (15, 30, or 60)","pricing.vat_percent":"VAT percentage on electricity","pricing.grid_transfer_fee_sek":"Grid operator transfer fee per kWh","pricing.energy_tax_sek":"Energy tax per kWh","pricing.subscription_fee_sek_per_month":"[FUTURE] Fixed monthly grid subscription (for cost analysis)","forecasting.active_forecast_version":"Forecast engine: aurora (ML) | legacy","forecasting.pv_confidence_percent":"PV forecast scaling (100 = trust forecast fully)","forecasting.load_safety_margin_percent":"Load forecast scaling (>100 = expect more load)","grid.import_limit_kw":"Soft limit for effekttariff (breached with high penalty)","kepler.ramping_cost_sek_per_kw":"Penalty for power changes between slots (reduces sawtooth)","input_sensors.alarm_state":"Alarm panel for occupancy detection (ML feature)","input_sensors.vacation_mode":"Vacation mode toggle (reduces load forecasts)","input_sensors.battery_soc":"Current battery state of charge (%)","input_sensors.pv_power":"Current PV production (W or kW)","input_sensors.load_power":"Current load consumption (W or kW)","input_sensors.total_battery_charge":"Cumulative battery charge (kWh)","input_sensors.total_battery_discharge":"Cumulative battery discharge (kWh)","input_sensors.total_grid_export":"Cumulative grid export (kWh)","input_sensors.total_grid_import":"Cumulative grid import (kWh)","input_sensors.total_load_consumption":"Cumulative load (kWh)","input_sensors.total_pv_production":"Cumulative PV production (kWh)","input_sensors.water_heater_consumption":"Water heater daily energy (kWh)","input_sensors.today_grid_import":"Today's grid import (kWh)","input_sensors.today_grid_export":"Today's grid export (kWh)","input_sensors.today_battery_charge":"Today's battery charge (kWh)","input_sensors.today_pv_production":"Today's PV production (kWh)","input_sensors.today_load_consumption":"Today's load consumption (kWh)","input_sensors.today_net_cost":"Today's net electricity cost","executor.enabled":"Enable executor control loop","executor.shadow_mode":"Log actions but don't execute (for testing)","executor.interval_seconds":"How often the executor runs to update inverter settings. Lower values (60s) provide faster real-time response; higher values (300s) reduce resource usage. Recommended: 60s for most users, 300s for Raspberry Pi.","executor.pause_reminder_minutes":"Notify if paused longer than this","executor.history_retention_days":"Keep execution history for N days","executor.automation_toggle_entity":"Master enable/disable switch","executor.manual_override_entity":"Manual override active flag","executor.soc_target_entity":"SoC target input_number","executor.inverter.work_mode_entity":"Inverter mode selector","executor.inverter.work_mode_export":"Value for export mode","executor.inverter.work_mode_zero_export":"Value for zero-export mode","executor.inverter.grid_charging_entity":"Enable/disable grid charging","executor.controller.max_charge_a":"Maximum battery charging current (Amps) to command during grid charging. Default is 185A.","executor.controller.max_discharge_a":"Maximum battery discharge current (Amps). Unlike earlier versions, this remains at MAXIMUM even during export slots to ensure local load is covered first.","executor.inverter.grid_max_export_power_entity":"The Home Assistant number entity that controls the inverter's grid export power limit. Value is sent in Watts (W).","executor.inverter.max_charging_current_entity":"The Home Assistant number entity to write battery charging current to (A).","executor.inverter.max_discharging_current_entity":"Max discharge current (A)","executor.controller.battery_capacity_kwh":"Battery capacity in kWh (for current calculations)","executor.controller.system_voltage_v":"Nominal battery voltage","executor.controller.worst_case_voltage_v":"Minimum voltage for conservative calculations","executor.controller.inverter_ac_limit_kw":"Max AC power output of inverter","executor.controller.charge_efficiency":"Charging efficiency (0-1)","executor.controller.min_charge_a":"Minimum meaningful charge current (A)","executor.controller.round_step_a":"Round current commands to nearest X amps","executor.controller.write_threshold_a":"Only write if change exceeds X amps","executor.controller.write_threshold_w":"Minimum power change (Watts) before writing to inverter. Prevents EEPROM wear from frequent small adjustments. Default: 100W.","executor.water_heater.target_entity":"HA entity to control","executor.water_heater.temp_off":"Idle mode (legionella-safe minimum)","executor.water_heater.temp_normal":"Scheduled heating target (used by planner)","executor.water_heater.temp_boost":"Manual boost button (Dashboard/Executor)","executor.water_heater.temp_max":"PV dump target + safety limit (never exceeded)","executor.notifications.service":"HA notify service to use","executor.notifications.on_charge_start":"Notify when grid charging starts","executor.notifications.on_charge_stop":"Notify when grid charging stops","executor.notifications.on_export_start":"Notify when export/discharge starts","executor.notifications.on_export_stop":"Notify when export/discharge stops","executor.notifications.on_water_heat_start":"Notify when water heating starts","executor.notifications.on_water_heat_stop":"Notify when water heating stops","executor.notifications.on_soc_target_change":"Notify when SoC target changes","executor.notifications.on_override_activated":"Notify when manual override triggers","executor.notifications.on_error":"Notify on executor errors","dashboard.auto_refresh_enabled":"Auto-refresh dashboard schedule display","dashboard.overlay_defaults":"Default chart overlays","ui.theme":"Color theme name","ui.theme_accent_index":"Accent color index (0-based)","appliances.dishwasher.label":"Display name in UI","appliances.dishwasher.duration_hours":"Typical run duration"},Oo=({field:t,value:e,onChange:s,error:n,haEntities:i=[],haLoading:r=!1,fullForm:a={}})=>{const o=()=>{switch(t.type){case"boolean":return l.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[l.jsx(e0,{checked:e==="true",onCheckedChange:c=>s(t.key,c?"true":"false"),disabled:t.disabled}),l.jsx("span",{className:"text-sm font-semibold",children:t.label})]});case"select":return l.jsx(Qy,{value:e,onChange:c=>s(t.key,c),options:t.options||[],placeholder:"Select...",disabled:t.disabled});case"entity":return l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"flex-1",children:l.jsx(VP,{entities:i,value:e,onChange:c=>s(t.key,c),loading:r,placeholder:"Select entity..."})}),t.companionKey&&l.jsx("button",{type:"button",onClick:()=>{const c=a[t.companionKey]==="true";s(t.companionKey,c?"false":"true")},className:`flex h-9 w-9 shrink-0 items-center justify-center rounded-xl border transition-all duration-200 ${a[t.companionKey]==="true"?"bg-accent/20 border-accent/50 text-accent shadow-[0_0_10px_rgba(var(--accent-rgb),0.1)]":"bg-surface2 border-line/50 text-muted hover:border-accent/40 hover:text-text"}`,title:"Invert sensor logic (Positive <-> Negative)",children:l.jsx("span",{className:"text-sm font-bold",children:""})})]});case"service":return l.jsx(WP,{value:e,onChange:c=>s(t.key,c),placeholder:"Select notification service..."});case"azimuth":{const c=e&&e.trim()!==""?Number(e):null;return l.jsxs("div",{className:"space-y-2",children:[l.jsx(FP,{value:typeof c=="number"&&!Number.isNaN(c)?c:null,onChange:d=>s(t.key,String(Math.round(d)))}),l.jsx("input",{type:"number",inputMode:"decimal",value:e,onChange:d=>s(t.key,d.target.value),className:"w-full rounded-lg border border-line/50 bg-surface2 px-3 py-2 text-sm text-text focus:border-accent focus:outline-none"})]})}case"tilt":{const c=e&&e.trim()!==""?Number(e):null;return l.jsxs("div",{className:"space-y-2",children:[l.jsx(IP,{value:typeof c=="number"&&!Number.isNaN(c)?c:null,onChange:d=>s(t.key,String(Math.round(d)))}),l.jsx("input",{type:"number",inputMode:"decimal",value:e,onChange:d=>s(t.key,d.target.value),className:"w-full rounded-lg border border-line/50 bg-surface2 px-3 py-2 text-sm text-text focus:border-accent focus:outline-none"})]})}default:return l.jsx("input",{type:t.type==="number"?"number":"text",inputMode:t.type==="number"?"decimal":void 0,value:e,onChange:c=>s(t.key,c.target.value),className:`w-full rounded-lg border border-line/50 bg-surface2 px-3 py-2 text-sm text-text focus:border-accent focus:outline-none ${t.disabled?"opacity-50 cursor-not-allowed":""}`,disabled:t.disabled})}};return l.jsxs("div",{className:"space-y-1",children:[l.jsxs("label",{className:"block text-sm font-medium mb-1.5 flex items-center gap-1.5",children:[l.jsx("span",{className:t.type==="boolean"?"sr-only":"text-[10px] uppercase tracking-wide text-muted",children:t.label}),t.notImplemented&&l.jsx(BP,{variant:"warning",children:"NOT IMPLEMENTED"}),l.jsx(LP,{text:HP[t.key]||t.helper})]}),o(),o(),n&&l.jsx("p",{className:"text-[11px] text-bad",children:n})]})},zc=[{title:"System Profile",description:"Core hardware toggles and high-level system preferences.",fields:[{key:"system.has_solar",label:"Solar panels installed",path:["system","has_solar"],type:"boolean"},{key:"system.has_battery",label:"Home battery installed",path:["system","has_battery"],type:"boolean"},{key:"system.has_water_heater",label:"Smart water heater",path:["system","has_water_heater"],type:"boolean"},{key:"export.enable_export",label:"Enable grid export",path:["export","enable_export"],type:"boolean",disabled:!0,notImplemented:!0}]},{title:"Location & Solar Array",description:"Geolocation and PV array parameters used by the forecasting engine.",fields:[{key:"system.location.latitude",label:"Latitude",helper:"Decimal degrees, positive north. Example: 55.4932",path:["system","location","latitude"],type:"number"},{key:"system.location.longitude",label:"Longitude",helper:"Decimal degrees, positive east. Example: 13.1112",path:["system","location","longitude"],type:"number"},{key:"system.solar_array.azimuth",label:"Solar azimuth ()",helper:"Panel direction: 0 = North, 90 = East, 180 = South, 270 = West.",path:["system","solar_array","azimuth"],type:"azimuth"},{key:"system.solar_array.tilt",label:"Solar tilt ()",helper:"Angle from horizontal. 0 = flat, 90 = vertical.",path:["system","solar_array","tilt"],type:"tilt"},{key:"system.solar_array.kwp",label:"Solar capacity (kWp)",helper:"Total DC peak power of the PV array.",path:["system","solar_array","kwp"],type:"number"}]},{title:"Battery Specifications",description:"Capacity, max power, and SoC limits define safe operating bands.",fields:[{key:"battery.capacity_kwh",label:"Battery capacity (kWh)",helper:"Total usable capacity of your battery bank.",path:["battery","capacity_kwh"],type:"number"},{key:"battery.max_charge_power_kw",label:"Max charge power (kW)",path:["battery","max_charge_power_kw"],type:"number"},{key:"executor.controller.max_charge_a",label:"Max charge current (A)",helper:"Maximum charging current allowed from grid.",path:["executor","controller","max_charge_a"],type:"number"},{key:"executor.controller.max_discharge_a",label:"Max discharge current (A)",helper:"Maximum discharge current for load following.",path:["executor","controller","max_discharge_a"],type:"number"},{key:"battery.max_discharge_power_kw",label:"Max discharge power (kW)",path:["battery","max_discharge_power_kw"],type:"number"},{key:"battery.min_soc_percent",label:"Min SoC (%)",path:["battery","min_soc_percent"],type:"number"},{key:"battery.max_soc_percent",label:"Max SoC (%)",path:["battery","max_soc_percent"],type:"number"},{key:"system.grid.max_power_kw",label:"HARD Grid max power (kW)",path:["system","grid","max_power_kw"],type:"number"},{key:"grid.import_limit_kw",label:"Soft import limit (kW)",path:["grid","import_limit_kw"],type:"number"}]},{title:"Pricing & Timezone",description:"Nordpool zone and local timezone for planner calculations.",fields:[{key:"nordpool.price_area",label:"Nordpool Price Area",helper:"e.g. SE4, NO1, DK2",path:["nordpool","price_area"],type:"text"},{key:"pricing.vat_percent",label:"VAT (%)",path:["pricing","vat_percent"],type:"number"},{key:"pricing.grid_transfer_fee_sek",label:"Grid transfer fee (SEK/kWh)",helper:"Fee paid to your grid operator for power delivery.",path:["pricing","grid_transfer_fee_sek"],type:"number"},{key:"pricing.energy_tax_sek",label:"Energy tax (SEK/kWh)",path:["pricing","energy_tax_sek"],type:"number"},{key:"pricing.subscription_fee_sek_per_month",label:"Monthly subscription fee (SEK)",helper:"Fixed monthly grid connection fee.",path:["pricing","subscription_fee_sek_per_month"],type:"number"},{key:"timezone",label:"Timezone",path:["timezone"],type:"text"}]},{title:"Notifications",description:"Configure automated notifications via Home Assistant.",fields:[{key:"executor.notifications.service",label:"HA Notify Service",helper:"e.g. notify.mobile_app_iphone",path:["executor","notifications","service"],type:"service"},{key:"executor.notifications.on_charge_start",label:"On charge start",path:["executor","notifications","on_charge_start"],type:"boolean"},{key:"executor.notifications.on_charge_stop",label:"On charge stop",path:["executor","notifications","on_charge_stop"],type:"boolean"},{key:"executor.notifications.on_export_start",label:"On export start",path:["executor","notifications","on_export_start"],type:"boolean"},{key:"executor.notifications.on_export_stop",label:"On export stop",path:["executor","notifications","on_export_stop"],type:"boolean"},{key:"executor.notifications.on_water_heat_start",label:"On water heating start",path:["executor","notifications","on_water_heat_start"],type:"boolean"},{key:"executor.notifications.on_water_heat_stop",label:"On water heating stop",path:["executor","notifications","on_water_heat_stop"],type:"boolean"},{key:"executor.notifications.on_soc_target_change",label:"On SoC target change",path:["executor","notifications","on_soc_target_change"],type:"boolean"},{key:"executor.notifications.on_override_activated",label:"On override activated",path:["executor","notifications","on_override_activated"],type:"boolean"},{key:"executor.notifications.on_error",label:"On error",path:["executor","notifications","on_error"],type:"boolean"}]},{title:" Home Assistant Connection ",isHA:!0,description:"Connection parameters for your Home Assistant instance.",fields:[{key:"home_assistant.url",label:"HA URL",helper:"e.g. http://homeassistant.local:8123",path:["home_assistant","url"],type:"text"},{key:"home_assistant.token",label:"Long-Lived Access Token",path:["home_assistant","token"],type:"text"}]},{title:"Required HA Entities",isHA:!0,description:"Core sensors and switches required for battery control.",fields:[{key:"input_sensors.battery_soc",label:"Battery SoC (%)",path:["input_sensors","battery_soc"],type:"entity"},{key:"input_sensors.pv_power",label:"PV Power (W/kW)",path:["input_sensors","pv_power"],type:"entity"},{key:"input_sensors.load_power",label:"Load Power (W/kW)",path:["input_sensors","load_power"],type:"entity"},{key:"executor.inverter.work_mode_entity",label:"Work Mode Selector",path:["executor","inverter","work_mode_entity"],type:"entity"},{key:"executor.inverter.grid_charging_entity",label:"Grid Charging Switch",path:["executor","inverter","grid_charging_entity"],type:"entity"},{key:"executor.inverter.max_charging_current_entity",label:"Max Charge Current",path:["executor","inverter","max_charging_current_entity"],type:"entity"},{key:"executor.inverter.max_discharging_current_entity",label:"Max Discharge Current",path:["executor","inverter","max_discharging_current_entity"],type:"entity"},{key:"executor.inverter.grid_max_export_power_entity",label:"Max Grid Export (W)",helper:"HA Number entity to control grid export limit in Watts.",path:["executor","inverter","grid_max_export_power_entity"],type:"entity"}]},{title:"Optional HA Entities",isHA:!0,description:"Optional sensors for better forecasting and dashboard metrics.",fields:[{key:"executor.automation_toggle_entity",label:"Automation Toggle",path:["executor","automation_toggle_entity"],type:"entity"},{key:"executor.manual_override_entity",label:"Manual Override Toggle",path:["executor","manual_override_entity"],type:"entity"},{key:"executor.soc_target_entity",label:"Target SoC Feedback",path:["executor","soc_target_entity"],type:"entity"},{key:"executor.water_heater.target_entity",label:"Water Heater Setpoint",path:["executor","water_heater","target_entity"],type:"entity"},{key:"input_sensors.vacation_mode",label:"Vacation Mode Toggle",path:["input_sensors","vacation_mode"],type:"entity"},{key:"input_sensors.battery_power",label:"Battery Power (W/kW)",helper:"Positive = charging, negative = discharging",path:["input_sensors","battery_power"],type:"entity",companionKey:"input_sensors.battery_power_inverted"},{key:"input_sensors.water_power",label:"Water Heater Power (W/kW)",path:["input_sensors","water_power"],type:"entity"},{key:"input_sensors.grid_power",label:"Grid Power (W/kW)",helper:"Positive = import, negative = export",path:["input_sensors","grid_power"],type:"entity",companionKey:"input_sensors.grid_power_inverted"},{key:"input_sensors.alarm_state",label:"Alarm Control Panel",path:["input_sensors","alarm_state"],type:"entity"},{key:"input_sensors.water_heater_consumption",label:"Water Heater Daily Energy",path:["input_sensors","water_heater_consumption"],type:"entity"},{key:"input_sensors.today_net_cost",label:"Today's Net Cost",path:["input_sensors","today_net_cost"],type:"entity"},{key:"input_sensors.total_battery_charge",label:"Total Battery Charge (kWh)",path:["input_sensors","total_battery_charge"],type:"entity"},{key:"input_sensors.total_battery_discharge",label:"Total Battery Discharge (kWh)",path:["input_sensors","total_battery_discharge"],type:"entity"},{key:"input_sensors.total_grid_export",label:"Total Grid Export (kWh)",path:["input_sensors","total_grid_export"],type:"entity"},{key:"input_sensors.total_grid_import",label:"Total Grid Import (kWh)",path:["input_sensors","total_grid_import"],type:"entity"},{key:"input_sensors.total_load_consumption",label:"Total Load Consumption (kWh)",path:["input_sensors","total_load_consumption"],type:"entity"},{key:"input_sensors.total_pv_production",label:"Total PV Production (kWh)",path:["input_sensors","total_pv_production"],type:"entity"}]},{title:"Today's Energy Sensors",description:`Daily energy statistics for the Dashboard "Today's Stats" card.`,isHA:!0,fields:[{key:"input_sensors.today_battery_charge",label:"Today's Battery Charge (kWh)",path:["input_sensors","today_battery_charge"],type:"entity"},{key:"input_sensors.today_pv_production",label:"Today's PV Production (kWh)",path:["input_sensors","today_pv_production"],type:"entity"},{key:"input_sensors.today_load_consumption",label:"Today's Load Consumption (kWh)",path:["input_sensors","today_load_consumption"],type:"entity"},{key:"input_sensors.today_grid_import",label:"Today's Grid Import (kWh)",path:["input_sensors","today_grid_import"],type:"entity"},{key:"input_sensors.today_grid_export",label:"Today's Grid Export (kWh)",path:["input_sensors","today_grid_export"],type:"entity"}]}],t0=[{title:"Forecasting & Strategy",description:"Tuning the AI forecasting engine and safety margins.",fields:[{key:"forecasting.pv_confidence_percent",label:"PV Confidence (%)",helper:"100 = trust forecast fully. Lower values make the planner more conservative with solar.",path:["forecasting","pv_confidence_percent"],type:"number"},{key:"forecasting.load_safety_margin_percent",label:"Load Safety Margin (%)",helper:"100 = neutral. >100 = expect more load than predicted (safer).",path:["forecasting","load_safety_margin_percent"],type:"number"}]},{title:"Arbitrage & Economics",description:"Export thresholds, peak-only export, and degradation costs.",fields:[{key:"battery_economics.battery_cycle_cost_kwh",label:"Battery cycle cost (SEK/kWh)",helper:"Estimated degradation cost for every kWh cycled. Affects arbitrage profitability.",path:["battery_economics","battery_cycle_cost_kwh"],type:"number"}]},{title:"Water Heating",description:"Quota, deferral, and sizing controls for the water heater scheduler.",fields:[{key:"water_heating.power_kw",label:"Water heater power (kW)",path:["water_heating","power_kw"],type:"number"},{key:"water_heating.defer_up_to_hours",label:"Max defer hours",path:["water_heating","defer_up_to_hours"],type:"number"},{key:"water_heating.min_kwh_per_day",label:"Min kWh/day",path:["water_heating","min_kwh_per_day"],type:"number"},{key:"water_heating.min_spacing_hours",label:"Min spacing (hours)",path:["water_heating","min_spacing_hours"],type:"number",helper:"Minimum gap between heating sessions to avoid efficiency loss."},{key:"water_heating.spacing_penalty_sek",label:"Spacing penalty (SEK)",path:["water_heating","spacing_penalty_sek"],type:"number",helper:"Penalty applied when heating sessions are too close."},{key:"water_heating.enable_top_ups",label:"Enable spaced top-ups",path:["water_heating","enable_top_ups"],type:"boolean",helper:"Enable small top-up heating blocks to maintain temperature. Disable for bulk heating only."},{key:"water_heating.block_start_penalty_sek",label:"Block start penalty (SEK)",helper:"Advanced: Penalty per heating start (higher = more consolidated bulk heating).",path:["water_heating","block_start_penalty_sek"],type:"number"},{key:"water_heating.max_hours_between_heating",label:"Max gap comfort penalty (h)",helper:"Advanced: Max gap before comfort penalty (only used if top-ups are enabled).",path:["water_heating","max_hours_between_heating"],type:"number"},{key:"executor.water_heater.temp_off",label:"Temp: Off/Idle (C)",helper:"Target temperature when not heating (legionella safety min).",path:["executor","water_heater","temp_off"],type:"number"},{key:"executor.water_heater.temp_normal",label:"Temp: Normal (C)",helper:"Target temperature for regular scheduled heating.",path:["executor","water_heater","temp_normal"],type:"number"},{key:"executor.water_heater.temp_boost",label:"Temp: Boost (C)",helper:"Target temperature for manual boost / spa mode.",path:["executor","water_heater","temp_boost"],type:"number"},{key:"executor.water_heater.temp_max",label:"Temp: Max/PV Dump (C)",helper:"Max safe temperature for dumping excess solar PV.",path:["executor","water_heater","temp_max"],type:"number"}]},{title:"Water Heater Vacation Mode",description:"Anti-legionella safety cycle when vacation mode is active.",fields:[{key:"water_heating.vacation_mode.enabled",label:"Enable Vacation Mode",path:["water_heating","vacation_mode","enabled"],type:"boolean"},{key:"water_heating.vacation_mode.anti_legionella_temp_c",label:"Safety Cycle Temp (C)",path:["water_heating","vacation_mode","anti_legionella_temp_c"],type:"number"},{key:"water_heating.vacation_mode.anti_legionella_interval_days",label:"Safety Cycle Interval (days)",path:["water_heating","vacation_mode","anti_legionella_interval_days"],type:"number"},{key:"water_heating.vacation_mode.anti_legionella_duration_hours",label:"Safety Cycle Duration (hours)",path:["water_heating","vacation_mode","anti_legionella_duration_hours"],type:"number"}]},{title:"Learning Parameter Limits",description:"Limits that keep learning adjustments conservative.",fields:[{key:"learning.min_sample_threshold",label:"Min sample threshold",path:["learning","min_sample_threshold"],type:"number"},{key:"learning.min_improvement_threshold",label:"Min improvement (%)",path:["learning","min_improvement_threshold"],type:"number"},{key:"learning.max_daily_param_change.battery_use_margin_sek",label:"Battery margin change (SEK)",path:["learning","max_daily_param_change","battery_use_margin_sek"],type:"number"},{key:"learning.max_daily_param_change.export_profit_margin_sek",label:"Export margin change (SEK)",path:["learning","max_daily_param_change","export_profit_margin_sek"],type:"number"},{key:"learning.max_daily_param_change.future_price_guard_buffer_sek",label:"Future guard buffer change (SEK)",path:["learning","max_daily_param_change","future_price_guard_buffer_sek"],type:"number"},{key:"learning.max_daily_param_change.load_safety_margin_percent",label:"Load safety change (%)",path:["learning","max_daily_param_change","load_safety_margin_percent"],type:"number"},{key:"learning.max_daily_param_change.pv_confidence_percent",label:"PV confidence change (%)",path:["learning","max_daily_param_change","pv_confidence_percent"],type:"number"},{key:"learning.max_daily_param_change.s_index_base_factor",label:"S-index base change",path:["learning","max_daily_param_change","s_index_base_factor"],type:"number"},{key:"learning.max_daily_param_change.s_index_pv_deficit_weight",label:"S-index PV weight change",path:["learning","max_daily_param_change","s_index_pv_deficit_weight"],type:"number"},{key:"learning.max_daily_param_change.s_index_temp_weight",label:"S-index temp weight change",path:["learning","max_daily_param_change","s_index_temp_weight"],type:"number"}]},{title:"S-Index Safety",description:"Seasonal index parameters for reserve calculations.",fields:[{key:"s_index.temp_cold_c",label:"Cold temp (C)",path:["s_index","temp_cold_c"],type:"number"},{key:"s_index.s_index_horizon_days",label:"S-Index Horizon (days)",path:["s_index","s_index_horizon_days"],type:"select",options:[{label:"1 Day",value:"1"},{label:"2 Days",value:"2"},{label:"3 Days",value:"3"},{label:"4 Days",value:"4"},{label:"5 Days",value:"5"},{label:"6 Days",value:"6"},{label:"7 Days",value:"7"}]}]}],s0=[{title:"Dashboard Defaults",description:"Overlay defaults and refresh cadence for the planner dashboard.",fields:[{key:"dashboard.auto_refresh_enabled",label:"Auto refresh",helper:"Enable automatic refresh of the dashboard schedule.",path:["dashboard","auto_refresh_enabled"],type:"boolean"}]},{title:"AI Advisor",description:"Control the Smart Advisor LLM settings.",fields:[{key:"advisor.enable_llm",label:"Enable LLM advice",path:["advisor","enable_llm"],type:"boolean"},{key:"advisor.auto_fetch",label:"Auto-fetch advice on dashboard load",path:["advisor","auto_fetch"],type:"boolean"},{key:"advisor.personality",label:"Advisor personality",path:["advisor","personality"],type:"select",options:[{label:"Concise (Money focus)",value:"concise"},{label:"Friendly (Emoji style)",value:"friendly"},{label:"Technical (Data heavy)",value:"technical"}]}]}],n0=[{title:"Experimental Features",description:"Toggle advanced and experimental modes.",fields:[{key:"executor.interval_seconds",label:"Executor Interval",helper:"How often the executor runs to update inverter settings. Lower = faster response, higher = less resource usage.",path:["executor","interval_seconds"],type:"select",options:[{label:"5 seconds",value:"5"},{label:"10 seconds",value:"10"},{label:"15 seconds",value:"15"},{label:"20 seconds",value:"20"},{label:"30 seconds",value:"30"},{label:"1 minute",value:"60"},{label:"2.5 minutes",value:"150"},{label:"5 minutes",value:"300"},{label:"10 minutes",value:"600"}]},{key:"automation.schedule.every_minutes",label:"Planner Interval",helper:"How often to regenerate the optimal schedule. Lower = faster SoC adaptation, higher = less CPU usage.",path:["automation","schedule","every_minutes"],type:"select",options:[{label:"15 minutes",value:"15"},{label:"30 minutes",value:"30"},{label:"60 minutes",value:"60"},{label:"90 minutes",value:"90"}]},{key:"automation.enable_scheduler",label:"Enable Background Scheduler",helper:"Master toggle for automatic schedule regeneration.",path:["automation","enable_scheduler"],type:"boolean"},{key:"automation.schedule.jitter_minutes",label:"Schedule Jitter (min)",helper:"Random delay to avoid thundering herd on restart.",path:["automation","schedule","jitter_minutes"],type:"number"},{key:"learning.auto_tune_enabled",label:"Enable Auto-Tuning",helper:"Automatically adjust system constants based on historical data.",path:["learning","auto_tune_enabled"],type:"boolean"},{key:"learning.reflex_enabled",label:"Enable Reflex Loop",helper:"Real-time parameter adjustment loop.",path:["learning","reflex_enabled"],type:"boolean"},{key:"s_index.mode",label:"S-Index Mode",helper:"Switch between probabilistic risk and dynamic balancing.",path:["s_index","mode"],type:"select",options:[{label:"Probabilistic (P10/P90)",value:"probabilistic"},{label:"Dynamic (Adaptive)",value:"dynamic"}]},{key:"s_index.risk_appetite",label:"Risk Appetite",helper:"1 = Conservative (Safety first), 5 = Aggressive (Arbitrage focus).",path:["s_index","risk_appetite"],type:"select",options:[{label:"1 - Ultra Safe",value:"1"},{label:"2 - Safe",value:"2"},{label:"3 - Neutral",value:"3"},{label:"4 - Aggressive",value:"4"},{label:"5 - Gambler",value:"5"}]}]},{title:"Inverter Logic",description:"Custom command strings for your inverter work modes.",fields:[{key:"executor.inverter.work_mode_export",label:"Export Mode String",helper:"The exact value your inverter select entity expects for Export mode.",path:["executor","inverter","work_mode_export"],type:"text"},{key:"executor.inverter.work_mode_zero_export",label:"Zero-Export Mode String",helper:"The exact value your inverter select entity expects for Zero-Export mode.",path:["executor","inverter","work_mode_zero_export"],type:"text"},{key:"executor.shadow_mode",label:"Shadow Mode",helper:"When ON, Darkstar will log planned actions but NOT change any inverter settings. Safe for initial testing.",path:["executor","shadow_mode"],type:"boolean"}]},{title:"Danger Zone",description:"Sensitive actions. Proceed with caution.",fields:[]}],ru=zc.flatMap(t=>t.fields),i0=t0.flatMap(t=>t.fields),r0=s0.flatMap(t=>t.fields),a0=n0.flatMap(t=>t.fields),Ei=ru.find(t=>t.key==="input_sensors.battery_soc");Ei?console.warn("[SETTINGS_DEBUG] Module loaded - battery_soc field definition:",{key:Ei.key,type:Ei.type,label:Ei.label,path:Ei.path}):console.error("[SETTINGS_DEBUG] ERROR: battery_soc field not found in systemFieldList!");const $P=[...ru,...i0,...r0,...a0,{key:"dashboard.overlay_defaults",label:"Overlay Defaults",path:["dashboard","overlay_defaults"],type:"text"}];$P.reduce((t,e)=>(t[e.key]=e,t),{});const YP=()=>{const{form:t,fieldErrors:e,loading:s,saving:n,statusMessage:i,haEntities:r,haLoading:a,handleChange:o,save:c,reloadEntities:d}=Ao(ru),[u,h]=y.useState(null),f=async()=>{h("Testing...");try{const m=t["home_assistant.url"],p=t["home_assistant.token"],g=await K.haTest({url:m,token:p});g.success?(h("Success: Connected!"),d()):h(`Error: ${g.message}`)}catch(m){h(`Error: ${m instanceof Error?m.message:"Unknown error"}`)}};return s?l.jsx(de,{className:"p-6 text-sm text-muted",children:"Loading system configuration"}):l.jsxs("div",{className:"space-y-4",children:[zc.map((m,p)=>{const g=p>0?zc[p-1]:null,x=m.isHA&&g&&!g.isHA;return l.jsxs("div",{children:[x&&l.jsxs("div",{className:"py-8 flex items-center gap-4",children:[l.jsx("div",{className:"h-px flex-1 bg-line/30"}),l.jsx("span",{className:"text-[11px] font-bold uppercase tracking-[0.2em] text-muted whitespace-nowrap",children:"Home Assistant Integration"}),l.jsx("div",{className:"h-px flex-1 bg-line/30"})]}),l.jsxs(de,{className:"p-6",children:[l.jsxs("div",{className:"flex items-baseline justify-between gap-2",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-semibold",children:m.title}),l.jsx("p",{className:"text-xs text-muted mt-1",children:m.description})]}),l.jsx("span",{className:"text-[10px] uppercase text-muted tracking-wide",children:"System"})]}),l.jsx("div",{className:"mt-5 grid gap-4 sm:grid-cols-2",children:m.fields.map(v=>l.jsx(Oo,{field:v,value:t[v.key]??"",onChange:o,error:e[v.key],haEntities:r,haLoading:a,fullForm:t},v.key))}),m.title==="Home Assistant Connection"&&l.jsxs("div",{className:"mt-4 flex items-center gap-3",children:[l.jsx("button",{type:"button",onClick:f,className:"rounded-xl px-4 py-2 text-[11px] font-semibold bg-neutral hover:bg-neutral/80 text-white transition",children:u&&u.startsWith("Testing")?"Testing...":"Test Connection"}),u&&l.jsx("span",{className:`text-xs ${u.startsWith("Success")?"text-good":"text-bad"}`,children:u})]})]})]},m.title)}),l.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[l.jsx("button",{disabled:n,onClick:()=>c(),className:"flex items-center justify-center gap-2 rounded-xl px-3 py-2.5 text-[11px] font-semibold transition btn-glow-primary bg-accent hover:bg-accent2 text-[#100f0e] disabled:opacity-50",children:n?"Saving":"Save System Settings"}),i&&l.jsx("div",{className:`rounded-lg p-3 text-sm ${i.startsWith("Please fix")||i.startsWith("Save failed")||i.startsWith("Failed to load")?"bg-bad/10 border border-bad/30 text-bad":"bg-good/10 border border-good/30 text-good"}`,children:i})]})]})},UP=()=>{const{form:t,fieldErrors:e,loading:s,saving:n,statusMessage:i,handleChange:r,save:a}=Ao(i0);return s?l.jsx(de,{className:"p-6 text-sm text-muted",children:"Loading optimization parameters"}):l.jsxs("div",{className:"space-y-4",children:[t0.map(o=>l.jsxs(de,{className:"p-6",children:[l.jsxs("div",{className:"flex items-baseline justify-between gap-2",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-semibold",children:o.title}),l.jsx("p",{className:"text-xs text-muted mt-1",children:o.description})]}),l.jsx("span",{className:"text-[10px] uppercase text-muted tracking-wide",children:"Optimization"})]}),l.jsx("div",{className:"mt-5 grid gap-4 sm:grid-cols-2",children:o.fields.map(c=>l.jsx(Oo,{field:c,value:t[c.key]??"",onChange:r,error:e[c.key],fullForm:t},c.key))})]},o.title)),l.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[l.jsx("button",{disabled:n,onClick:()=>a(),className:"flex items-center justify-center gap-2 rounded-xl px-3 py-2.5 text-[11px] font-semibold transition btn-glow-primary bg-accent hover:bg-accent2 text-[#100f0e] disabled:opacity-50",children:n?"Saving":"Save Parameters"}),i&&l.jsx("div",{className:`rounded-lg p-3 text-sm ${i.startsWith("Please fix")||i.startsWith("Save failed")||i.startsWith("Failed to load")?"bg-bad/10 border border-bad/30 text-bad":"bg-good/10 border border-good/30 text-good"}`,children:i})]})]})},GP=()=>{const{form:t,fieldErrors:e,loading:s,saving:n,statusMessage:i,handleChange:r,save:a}=Ao(r0);if(s)return l.jsx(de,{className:"p-6 text-sm text-muted",children:"Loading UI configuration"});const o=t["dashboard.overlay_defaults"]?JSON.parse(t["dashboard.overlay_defaults"]):{},c=d=>{const u={...o,[d]:!o[d]};r("dashboard.overlay_defaults",JSON.stringify(u))};return l.jsxs("div",{className:"space-y-4",children:[s0.map(d=>l.jsxs(de,{className:"p-6",children:[l.jsxs("div",{className:"flex items-baseline justify-between gap-2",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-semibold",children:d.title}),l.jsx("p",{className:"text-xs text-muted mt-1",children:d.description})]}),l.jsx("span",{className:"text-[10px] uppercase text-muted tracking-wide",children:"Interface"})]}),l.jsx("div",{className:"mt-5 grid gap-4 sm:grid-cols-2",children:d.fields.map(u=>l.jsx(Oo,{field:u,value:t[u.key]??"",onChange:r,error:e[u.key],fullForm:t},u.key))}),d.title==="Dashboard Defaults"&&l.jsxs("div",{className:"mt-6 border-t border-line/30 pt-4",children:[l.jsx("div",{className:"text-[10px] uppercase tracking-widest text-muted font-bold mb-3",children:"Overlay Defaults"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:["solar","battery","load","grid","water","forecast"].map(u=>l.jsx("button",{onClick:()=>c(u),className:`rounded-lg px-2.5 py-1.5 text-[10px] font-bold uppercase tracking-wider transition ${o[u]?"bg-accent/20 text-accent border border-accent/30":"bg-surface2 text-muted border border-line/50 hover:border-line"}`,children:u},u))})]})]},d.title)),l.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[l.jsx("button",{disabled:n,onClick:()=>a(),className:"flex items-center justify-center gap-2 rounded-xl px-3 py-2.5 text-[11px] font-semibold transition btn-glow-primary bg-accent hover:bg-accent2 text-[#100f0e] disabled:opacity-50",children:n?"Saving":"Save UI Settings"}),i&&l.jsx("div",{className:`rounded-lg p-3 text-sm ${i.startsWith("Please fix")||i.startsWith("Save failed")||i.startsWith("Failed to load")?"bg-bad/10 border border-bad/30 text-bad":"bg-good/10 border border-good/30 text-good"}`,children:i})]})]})};function o0({open:t,onOpenChange:e,title:s,children:n,footer:i,size:r="md",className:a=""}){const o=y.useRef(null);if(y.useEffect(()=>{const u=h=>{t&&h.key==="Escape"&&e(!1)};return window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)},[t,e]),y.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[t]),!t)return null;const c={sm:"max-w-sm",md:"max-w-md",lg:"max-w-2xl",xl:"max-w-4xl"},d=l.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 sm:p-6",children:[l.jsx("div",{ref:o,className:"absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",onClick:u=>{u.target===o.current&&e(!1)}}),l.jsxs("div",{className:`
                    relative w-full ${c[r]} 
                    bg-surface rounded-ds-lg border border-line shadow-2xl 
                    animate-in zoom-in-95 fade-in duration-200
                    flex flex-col max-h-[90vh]
                    ${a}
                `,role:"dialog","aria-modal":"true",children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-line shrink-0",children:[l.jsx("div",{className:"text-lg font-semibold text-text",children:s}),l.jsx("button",{onClick:()=>e(!1),className:"p-1 rounded-md text-muted hover:text-text hover:bg-surface2 transition-colors",children:l.jsx(ii,{className:"h-5 w-5"})})]}),l.jsx("div",{className:"px-6 py-4 overflow-y-auto scrollbar-thin",children:n}),i&&l.jsx("div",{className:"px-6 py-4 border-t border-line bg-surface2/30 flex justify-end gap-3 shrink-0 rounded-b-ds-lg",children:i})]})]});return gp.createPortal(d,document.body)}const qP=()=>{const{toast:t}=Or(),{form:e,fieldErrors:s,loading:n,saving:i,statusMessage:r,handleChange:a,save:o,reload:c}=Ao(a0),[d,u]=y.useState(!1),[h,f]=y.useState(!1),m=async()=>{f(!0);try{await K.configReset(),t({message:"Settings reset to factory defaults",variant:"success"}),await c(),u(!1)}catch(p){t({message:"Reset failed: "+(p instanceof Error?p.message:"Unknown error"),variant:"error"})}finally{f(!1)}};return n?l.jsx(de,{className:"p-6 text-sm text-muted",children:"Loading advanced configuration"}):l.jsxs("div",{className:"space-y-4",children:[n0.map(p=>l.jsxs(de,{className:"p-6",children:[l.jsxs("div",{className:"flex items-baseline justify-between gap-2",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-semibold",children:p.title}),l.jsx("p",{className:"text-xs text-muted mt-1",children:p.description})]}),l.jsx("span",{className:"text-[10px] uppercase text-muted tracking-wide",children:"Advanced"})]}),p.title==="Danger Zone"?l.jsx("div",{className:"mt-5 border border-bad/20 bg-bad/5 rounded-xl p-4",children:l.jsxs("div",{className:"flex items-center justify-between gap-4",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"text-xs font-bold text-bad italic uppercase tracking-wider",children:"Reset All Settings"}),l.jsx("p",{className:"text-[11px] text-bad/80 mt-1",children:"Permanently delete all custom configurations and return to project factory defaults. This action cannot be undone."})]}),l.jsx("button",{onClick:()=>u(!0),className:"rounded-lg bg-bad/20 border border-bad/30 px-3 py-1.5 text-[10px] font-bold text-bad uppercase tracking-wider hover:bg-bad/30 transition",children:"Reset to Defaults"})]})}):l.jsx("div",{className:"mt-5 grid gap-4 sm:grid-cols-2",children:p.fields.map(g=>l.jsx(Oo,{field:g,value:e[g.key]??"",onChange:a,error:s[g.key],fullForm:e},g.key))})]},p.title)),l.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[l.jsx("button",{disabled:i,onClick:()=>o(),className:"flex items-center justify-center gap-2 rounded-xl px-3 py-2.5 text-[11px] font-semibold transition btn-glow-primary bg-accent hover:bg-accent2 text-[#100f0e] disabled:opacity-50",children:i?"Saving":"Save Advanced Settings"}),r&&l.jsx("div",{className:`rounded-lg p-3 text-sm ${r.startsWith("Please fix")||r.startsWith("Save failed")||r.startsWith("Failed to load")?"bg-bad/10 border border-bad/30 text-bad":"bg-good/10 border border-good/30 text-good"}`,children:r})]}),l.jsx(o0,{open:d,onOpenChange:u,title:"Reset to factory defaults?",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("p",{className:"text-sm text-muted",children:["This will clear your location, battery specs, HA tokens, and all optimization parameters. The system will return to the initial state defined in"," ",l.jsx("code",{className:"text-accent",children:"config.yaml"}),"."]}),l.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[l.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 text-xs font-semibold text-white/70 hover:text-white transition",children:"Cancel"}),l.jsx("button",{onClick:m,disabled:h,className:"bg-bad hover:bg-bad/80 px-4 py-2 rounded-xl text-xs font-bold text-white transition disabled:opacity-50",children:h?"Resetting...":"Yes, Reset Everything"})]})]})})]})},KP=[{id:"system",label:"System",icon:l.jsx(Fa,{size:16})},{id:"parameters",label:"Parameters",icon:l.jsx(Wv,{size:16})},{id:"ui",label:"UI & Theme",icon:l.jsx(Rv,{size:16})},{id:"advanced",label:"Advanced",icon:l.jsx(It,{size:16})}];function XP(){const[t,e]=kv(),s=t.get("tab")||"system",n=r=>{e({tab:r})},i=()=>{switch(s){case"parameters":return l.jsx(UP,{});case"ui":return l.jsx(GP,{});case"advanced":return l.jsx(qP,{});default:return l.jsx(YP,{})}};return l.jsx(l.Fragment,{children:l.jsx("main",{className:"p-4 lg:p-8",children:l.jsxs("div",{className:"mx-auto max-w-5xl",children:[l.jsx("div",{className:"mb-6 flex flex-wrap gap-2",children:KP.map(r=>l.jsxs("button",{onClick:()=>n(r.id),className:`flex items-center gap-2 rounded-xl px-4 py-2.5 text-xs font-bold uppercase tracking-wider transition duration-300 ${s===r.id?"bg-accent text-[#100f0e] shadow-[0_0_20px_rgba(var(--color-accent-rgb),0.3)]":"bg-surface2 text-muted hover:bg-surface3 hover:text-white"}`,children:[r.icon,r.label]},r.id))}),l.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-2 duration-500",children:i()})]})})})}const l0="label";function lp(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function ZP(t,e){const s=t.options;s&&e&&Object.assign(s,e)}function c0(t,e){t.labels=e}function d0(t,e,s=l0){const n=[];t.datasets=e.map(i=>{const r=t.datasets.find(a=>a[s]===i[s]);return!r||!i.data||n.includes(r)?{...i}:(n.push(r),Object.assign(r,i),r)})}function JP(t,e=l0){const s={labels:[],datasets:[]};return c0(s,t.labels),d0(s,t.datasets,e),s}function QP(t,e){const{height:s=150,width:n=300,redraw:i=!1,datasetIdKey:r,type:a,data:o,options:c,plugins:d=[],fallbackContent:u,updateMode:h,...f}=t,m=y.useRef(null),p=y.useRef(null),g=()=>{m.current&&(p.current=new Ct(m.current,{type:a,data:JP(o,r),options:c&&{...c},plugins:d}),lp(e,p.current))},x=()=>{lp(e,null),p.current&&(p.current.destroy(),p.current=null)};return y.useEffect(()=>{!i&&p.current&&c&&ZP(p.current,c)},[i,c]),y.useEffect(()=>{!i&&p.current&&c0(p.current.config.data,o.labels)},[i,o.labels]),y.useEffect(()=>{!i&&p.current&&o.datasets&&d0(p.current.config.data,o.datasets,r)},[i,o.datasets]),y.useEffect(()=>{p.current&&(i?(x(),setTimeout(g)):p.current.update(h))},[i,c,o.labels,o.datasets,h]),y.useEffect(()=>{p.current&&(x(),setTimeout(g))},[a]),y.useEffect(()=>(g(),()=>x()),[]),l.jsx("canvas",{ref:m,role:"img",height:s,width:n,...f,children:u})}const eD=y.forwardRef(QP);function au(t,e){return Ct.register(e),y.forwardRef((s,n)=>l.jsx(eD,{...s,ref:n,type:t}))}const ou=au("line",wg),tD=au("bar",_g),sD=au("radar",Sg);Ct.register(Mr,Cr,ri,Ns,md,oi,ai);function Pa({slots:t,mode:e,variant:s="field"}){if(!t||t.length===0)return l.jsx("div",{className:"text-[11px] text-muted px-4 py-6",children:"No forecast data available for the next 48 hours."});const n=t.map(f=>new Date(f.slot_start).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),i=s==="field",r=s==="oled",a=s==="swiss",d=e==="pv"?r?"#22d3ee":a?"#171717":"#22c55e":r?"#f472b6":a?"#ef4444":"#f97316",u={labels:n,datasets:[{type:"line",label:e==="pv"?"Final PV":"Final Load",data:t.map(f=>e==="pv"?f.final.pv_kwh:f.final.load_kwh),borderColor:d,backgroundColor:f=>{const m=f.chart.ctx;if(i){const p=m.createLinearGradient(0,0,0,200);return p.addColorStop(0,e==="pv"?"rgba(34, 197, 94, 0.2)":"rgba(249, 115, 22, 0.2)"),p.addColorStop(1,"rgba(15, 23, 42, 0.0)"),p}return"transparent"},borderWidth:a?4:r?2:3,tension:a?.2:.4,pointRadius:r?2:0,pointBackgroundColor:"#000",pointBorderColor:d,fill:i,shadowColor:i||r?d:"transparent",shadowBlur:i?15:r?8:0},{type:"bar",label:"Base",data:t.map(f=>e==="pv"?f.base.pv_kwh:f.base.load_kwh),backgroundColor:a?"rgba(0,0,0,0.1)":"rgba(255, 255, 255, 0.05)",borderWidth:0,borderRadius:a?0:2,yAxisID:"y",barPercentage:.8}]},h={responsive:!0,maintainAspectRatio:!1,layout:{padding:{top:20,bottom:10,left:10,right:10}},plugins:{legend:{display:!1},tooltip:{enabled:!0,backgroundColor:r?"#000":"rgba(15, 23, 42, 0.95)",titleColor:r?"#fff":"rgba(255, 255, 255, 0.9)",bodyColor:r?"#fff":"rgba(255, 255, 255, 0.7)",borderColor:r?"#333":"rgba(255, 255, 255, 0.1)",borderWidth:1,padding:10,displayColors:!r,callbacks:{label:f=>{let m=f.dataset.label||"";return m&&(m+=": "),f.parsed.y!==null&&(m+=f.parsed.y.toFixed(3)+" kWh"),m}}}},scales:{x:{grid:{display:r,color:r?"#333":"transparent"},ticks:{color:r?"#666":a?"#000":"#64748b",font:{size:10,family:r?"monospace":"inherit",weight:a?"bold":"normal"},maxTicksLimit:8},border:{display:a||r}},y:{grid:{display:r,color:r?"#333":"transparent"},ticks:{display:!i,color:r?"#666":a?"#000":"#64748b",font:{size:10,family:r?"monospace":"inherit",weight:a?"bold":"normal"}},border:{display:a||r}}},interaction:{intersect:!1,mode:"index"}};return l.jsx("div",{className:`w-full h-full min-h-[240px] ${r?"font-mono":""}`,style:i?{backgroundImage:"radial-gradient(rgb(var(--color-grid) / 0.2) 1px, transparent 1px)",backgroundSize:"20px 20px"}:void 0,children:l.jsx(ou,{data:u,options:h},`${e}-${s}`)})}Ct.register(Ug,ri,Ns,wo,oi,ai);function nD({weatherVolatility:t,riskFactor:e,forecastAccuracy:s,priceSpread:n,forecastBias:i}){const r=Math.min(100,t.cloud*100),a=Math.min(100,t.temp*100),o=Math.max(0,Math.min(100,(e-1)*25)),c=s,d=n!=null?Math.max(0,Math.min(100,n/2.5*100)):50,u=i!=null?Math.max(0,Math.min(100,(i+2)/4*100)):50,h=["Cloud Vol.","Temp Vol.","Aggression","Accuracy","Spread","Bias"],f=["#38bdf8","#f472b6","#fbbf24","#34d399","#a78bfa","#fb923c"],m={labels:h,datasets:[{label:"Current Context",data:[r,a,o,c,d,u],backgroundColor:"rgba(56, 189, 248, 0.15)",borderColor:"rgba(56, 189, 248, 0.5)",borderWidth:2,pointBackgroundColor:f,pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:f,pointRadius:4}]},p={scales:{r:{angleLines:{color:"rgba(255, 255, 255, 0.1)"},grid:{color:"rgba(255, 255, 255, 0.1)"},pointLabels:{display:!1},ticks:{display:!1,backdropColor:"transparent"},suggestedMin:0,suggestedMax:100}},plugins:{legend:{display:!1},tooltip:{backgroundColor:"#1e293b",titleColor:"#f8fafc",bodyColor:"#cbd5e1",borderColor:"#334155",borderWidth:1}},maintainAspectRatio:!1},g=h.slice(0,3),x=h.slice(3);return l.jsxs("div",{className:"relative w-full h-full min-h-[200px]",children:[l.jsx("div",{className:"absolute inset-0 overflow-hidden",children:l.jsx(sD,{data:m,options:p})}),l.jsxs("div",{className:"absolute bottom-0 left-0 right-0 flex justify-between px-3 pb-2 z-10",children:[l.jsx("div",{className:"flex flex-col gap-1",children:g.map((v,_)=>l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("div",{className:"w-2 h-2 rounded-full shadow-sm ring-1 ring-white/10",style:{backgroundColor:f[_]}}),l.jsx("span",{className:"text-[9px] text-muted font-medium leading-tight",children:v})]},v))}),l.jsx("div",{className:"flex flex-col gap-1",children:x.map((v,_)=>l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("div",{className:"w-2 h-2 rounded-full shadow-sm ring-1 ring-white/10",style:{backgroundColor:f[_+3]}}),l.jsx("span",{className:"text-[9px] text-muted font-medium leading-tight",children:v})]},v))})]})]})}function iD({events:t}){const e=y.useMemo(()=>[...t].sort((i,r)=>new Date(r.timestamp).getTime()-new Date(i.timestamp).getTime()),[t]),s=i=>{const r=(i.type+" "+i.message).toLowerCase();if(r.includes("charge")||r.includes("charging"))return l.jsx(It,{className:"h-4 w-4 text-amber-400"});if(r.includes("export")||r.includes("discharging"))return l.jsx(zp,{className:"h-4 w-4 text-emerald-400"});if(r.includes("defensive")||r.includes("safety")||r.includes("hold"))return l.jsx(Vv,{className:"h-4 w-4 text-blue-400"});if(r.includes("idle")||r.includes("wait"))return l.jsx(Pv,{className:"h-4 w-4 text-slate-400"});if(r.includes("weather"))return l.jsx(Ju,{className:"h-4 w-4 text-sky-400"});if(r.includes("learning")||r.includes("tune"))return l.jsx(Qu,{className:"h-4 w-4 text-purple-400"});if(r.includes("price")||r.includes("cost"))return l.jsx(sc,{className:"h-4 w-4 text-emerald-400"});switch(i.type){case"STRATEGY_CHANGE":return l.jsx(Ap,{className:"h-4 w-4 text-purple-400"});case"WEATHER_ADJUSTMENT":return l.jsx(Ju,{className:"h-4 w-4 text-blue-400"});case"PRICE_VOLATILITY":return l.jsx(It,{className:"h-4 w-4 text-amber-400"});case"LEARNING_EVENT":return l.jsx(Qu,{className:"h-4 w-4 text-emerald-400"});default:return l.jsx(ec,{className:"h-4 w-4 text-slate-400"})}},n=i=>new Date(i).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1});return t.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center h-48 text-muted text-xs",children:[l.jsx(ec,{className:"h-6 w-6 mb-2 opacity-50"}),"No activity recorded yet."]}):l.jsxs("div",{className:"relative space-y-4 pl-2",children:[l.jsx("div",{className:"absolute left-[19px] top-2 bottom-2 w-[1px] bg-line/50"}),e.map((i,r)=>l.jsxs("div",{className:"relative flex gap-3 items-start group",children:[l.jsx("div",{className:"relative z-10 flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-surface border border-line/60 group-hover:border-accent/50 transition-colors",children:s(i)}),l.jsxs("div",{className:"flex-1 pt-1.5 min-w-0",children:[l.jsxs("div",{className:"flex items-baseline justify-between gap-2",children:[l.jsx("p",{className:"text-xs font-medium text-text truncate",children:i.type.replace("_"," ")}),l.jsx("span",{className:"text-[10px] text-muted shrink-0 font-mono",children:n(i.timestamp)})]}),l.jsx("p",{className:"text-[11px] text-muted mt-0.5 leading-relaxed break-words",children:i.message}),i.details&&Object.keys(i.details).length>0&&l.jsx("div",{className:"mt-1.5",children:l.jsxs("details",{className:"group/details",children:[l.jsxs("summary",{className:"cursor-pointer text-[10px] text-accent/80 hover:text-accent select-none list-none flex items-center gap-1",children:[l.jsx("span",{children:"Details"}),l.jsx("span",{className:"opacity-50 group-open/details:rotate-180 transition-transform",children:""})]}),l.jsx("pre",{className:"mt-1 p-2 rounded bg-surface2/50 text-[10px] text-muted overflow-x-auto font-mono",children:JSON.stringify(i.details,null,2)})]})})]})]},r))]})}function rD({metrics:t,perfData:e}){let s=0,n=0;e?.cost_series&&e.cost_series.forEach(f=>{s+=f.planned,n+=f.realized});const i=n-s,r=i<=0?`Saved ${Math.abs(i).toFixed(1)} SEK`:`Overspent ${i.toFixed(1)} SEK`,a=i<=0,o=t?.mae_pv_aurora?.toFixed(2)??"N/A",c=t?.mae_load_aurora?.toFixed(2)??"N/A",d=t?.max_price_spread,u=d!=null?`${d.toFixed(2)} SEK`:"N/A",h=d!=null&&d>0;return l.jsxs("div",{className:"grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-4",children:[l.jsxs(de,{className:"p-4 flex items-center justify-between relative overflow-hidden group",children:[l.jsx("div",{className:`absolute inset-0 opacity-[0.03] ${a?"bg-emerald-500":"bg-rose-500"}`}),l.jsxs("div",{className:"flex items-center gap-3 relative z-10",children:[l.jsx("div",{className:`p-2 rounded-full ${a?"bg-emerald-500/10 text-emerald-400":"bg-rose-500/10 text-rose-400"}`,children:l.jsx(Rp,{className:"h-5 w-5"})}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[10px] text-muted uppercase tracking-wider font-medium",children:"7-Day Cost Drift"}),l.jsx("div",{className:`text-lg font-semibold ${a?"text-emerald-400":"text-rose-400"}`,children:r})]})]}),l.jsxs("div",{className:"text-right relative z-10",children:[l.jsx("div",{className:"text-[10px] text-muted",children:"vs Plan"}),a?l.jsx(th,{className:"h-4 w-4 text-emerald-500 ml-auto"}):l.jsx(sc,{className:"h-4 w-4 text-rose-500 ml-auto"})]})]}),l.jsxs(de,{className:"p-4 flex items-center justify-between relative overflow-hidden",children:[l.jsx("div",{className:`absolute inset-0 opacity-[0.03] ${h?"bg-emerald-500":"bg-rose-500"}`}),l.jsxs("div",{className:"flex items-center gap-3 relative z-10",children:[l.jsx("div",{className:`p-2 rounded-full ${h?"bg-emerald-500/10 text-emerald-400":"bg-rose-500/10 text-rose-400"}`,children:l.jsx(rr,{className:"h-5 w-5"})}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[10px] text-muted uppercase tracking-wider font-medium",children:"Max Price Spread"}),l.jsx("div",{className:`text-lg font-semibold ${h?"text-emerald-400":"text-rose-400"}`,children:u})]})]}),l.jsxs("div",{className:"text-right relative z-10",children:[l.jsx("div",{className:"text-[10px] text-muted",children:"Arbitrage"}),h?l.jsx(sc,{className:"h-4 w-4 text-emerald-500 ml-auto"}):l.jsx(th,{className:"h-4 w-4 text-rose-500 ml-auto"})]})]}),l.jsxs(de,{className:"p-4 flex items-center justify-between relative overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0 bg-amber-500/[0.02]"}),l.jsxs("div",{className:"flex items-center gap-3 relative z-10",children:[l.jsx("div",{className:"p-2 rounded-full bg-amber-500/10 text-amber-400",children:l.jsx(It,{className:"h-5 w-5"})}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[10px] text-muted uppercase tracking-wider font-medium",children:"PV Forecast Error"}),l.jsxs("div",{className:"text-lg font-semibold text-text",children:[o," ",l.jsx("span",{className:"text-xs font-normal text-muted",children:"kWh"})]})]})]}),l.jsxs("div",{className:"text-right relative z-10",children:[l.jsx("div",{className:"text-[10px] text-muted",children:"MAE (7d)"}),l.jsx(eh,{className:"h-4 w-4 text-amber-500/50 ml-auto"})]})]}),l.jsxs(de,{className:"p-4 flex items-center justify-between relative overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0 bg-blue-500/[0.02]"}),l.jsxs("div",{className:"flex items-center gap-3 relative z-10",children:[l.jsx("div",{className:"p-2 rounded-full bg-blue-500/10 text-blue-400",children:l.jsx(rr,{className:"h-5 w-5"})}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[10px] text-muted uppercase tracking-wider font-medium",children:"Load Forecast Error"}),l.jsxs("div",{className:"text-lg font-semibold text-text",children:[c," ",l.jsx("span",{className:"text-xs font-normal text-muted",children:"kWh"})]})]})]}),l.jsxs("div",{className:"text-right relative z-10",children:[l.jsx("div",{className:"text-[10px] text-muted",children:"MAE (7d)"}),l.jsx(eh,{className:"h-4 w-4 text-blue-500/50 ml-auto"})]})]})]})}Ct.register(Mr,Cr,ri,Ns,ko,oi,ai,wo);function aD({title:t,slots:e,color:s}){const i={labels:e.map(a=>new Date(a.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),datasets:[{label:"Actual",data:e.map(a=>a.actual??null),borderColor:"#94a3b8",backgroundColor:"#94a3b8",borderWidth:2,pointRadius:0,pointHitRadius:10,tension:.4,spanGaps:!0,fill:!1},{label:"p90",data:e.map(a=>a.p90),borderColor:`${s}40`,borderWidth:1,backgroundColor:`${s}33`,pointRadius:0,pointHitRadius:10,tension:.4,spanGaps:!0,fill:"+1"},{label:"p10 (Risk)",data:e.map(a=>a.p10),borderColor:`${s}80`,borderWidth:1.5,borderDash:[4,4],backgroundColor:"transparent",pointRadius:0,pointHitRadius:10,tension:.4,spanGaps:!0,fill:!1},{label:"p50 (Forecast)",data:e.map(a=>a.p50),borderColor:s,backgroundColor:s,borderWidth:2,pointRadius:0,pointHitRadius:10,tension:.4,spanGaps:!0,fill:!1}]},r={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,labels:{color:"#cbd5e1",font:{size:11},boxWidth:8,usePointStyle:!0}},title:{display:!!t,text:t,color:"#e2e8f0",font:{size:13,weight:"normal"},align:"start",padding:{bottom:10}},tooltip:{mode:"index",intersect:!1,backgroundColor:"#1e293b",titleColor:"#e2e8f0",bodyColor:"#cbd5e1",borderColor:"#334155",borderWidth:1}},scales:{x:{grid:{color:"#334155",drawBorder:!1},ticks:{color:"#94a3b8",maxRotation:0,autoSkip:!0,maxTicksLimit:8}},y:{grid:{color:"#334155",drawBorder:!1},ticks:{color:"#94a3b8"},min:0}},interaction:{mode:"nearest",axis:"x",intersect:!1},layout:{padding:{bottom:0,left:10,right:10}}};return l.jsx("div",{className:"w-full h-[250px]",children:l.jsx(ou,{data:i,options:r})})}var u0;function W(){return u0.apply(null,arguments)}function oD(t){u0=t}function Vt(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function wn(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function _e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function lu(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(_e(t,e))return!1;return!0}function ft(t){return t===void 0}function Ss(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Rr(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function h0(t,e){var s=[],n,i=t.length;for(n=0;n<i;++n)s.push(e(t[n],n));return s}function Is(t,e){for(var s in e)_e(e,s)&&(t[s]=e[s]);return _e(e,"toString")&&(t.toString=e.toString),_e(e,"valueOf")&&(t.valueOf=e.valueOf),t}function ss(t,e,s,n){return R0(t,e,s,n,!0).utc()}function lD(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function le(t){return t._pf==null&&(t._pf=lD()),t._pf}var Hc;Array.prototype.some?Hc=Array.prototype.some:Hc=function(t){var e=Object(this),s=e.length>>>0,n;for(n=0;n<s;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function cu(t){var e=null,s=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=le(t),s=Hc.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&s),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function Ro(t){var e=ss(NaN);return t!=null?Is(le(e),t):le(e).userInvalidated=!0,e}var cp=W.momentProperties=[],zl=!1;function du(t,e){var s,n,i,r=cp.length;if(ft(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),ft(e._i)||(t._i=e._i),ft(e._f)||(t._f=e._f),ft(e._l)||(t._l=e._l),ft(e._strict)||(t._strict=e._strict),ft(e._tzm)||(t._tzm=e._tzm),ft(e._isUTC)||(t._isUTC=e._isUTC),ft(e._offset)||(t._offset=e._offset),ft(e._pf)||(t._pf=le(e)),ft(e._locale)||(t._locale=e._locale),r>0)for(s=0;s<r;s++)n=cp[s],i=e[n],ft(i)||(t[n]=i);return t}function Lr(t){du(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),zl===!1&&(zl=!0,W.updateOffset(this),zl=!1)}function Wt(t){return t instanceof Lr||t!=null&&t._isAMomentObject!=null}function f0(t){W.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Pt(t,e){var s=!0;return Is(function(){if(W.deprecationHandler!=null&&W.deprecationHandler(null,t),s){var n=[],i,r,a,o=arguments.length;for(r=0;r<o;r++){if(i="",typeof arguments[r]=="object"){i+=`
[`+r+"] ";for(a in arguments[0])_e(arguments[0],a)&&(i+=a+": "+arguments[0][a]+", ");i=i.slice(0,-2)}else i=arguments[r];n.push(i)}f0(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),s=!1}return e.apply(this,arguments)},e)}var dp={};function m0(t,e){W.deprecationHandler!=null&&W.deprecationHandler(t,e),dp[t]||(f0(e),dp[t]=!0)}W.suppressDeprecationWarnings=!1;W.deprecationHandler=null;function ns(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function cD(t){var e,s;for(s in t)_e(t,s)&&(e=t[s],ns(e)?this[s]=e:this["_"+s]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function $c(t,e){var s=Is({},t),n;for(n in e)_e(e,n)&&(wn(t[n])&&wn(e[n])?(s[n]={},Is(s[n],t[n]),Is(s[n],e[n])):e[n]!=null?s[n]=e[n]:delete s[n]);for(n in t)_e(t,n)&&!_e(e,n)&&wn(t[n])&&(s[n]=Is({},s[n]));return s}function uu(t){t!=null&&this.set(t)}var Yc;Object.keys?Yc=Object.keys:Yc=function(t){var e,s=[];for(e in t)_e(t,e)&&s.push(e);return s};var dD={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function uD(t,e,s){var n=this._calendar[t]||this._calendar.sameElse;return ns(n)?n.call(e,s):n}function ts(t,e,s){var n=""+Math.abs(t),i=e-n.length,r=t>=0;return(r?s?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var hu=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ya=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Hl={},Gn={};function J(t,e,s,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(Gn[t]=i),e&&(Gn[e[0]]=function(){return ts(i.apply(this,arguments),e[1],e[2])}),s&&(Gn[s]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function hD(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function fD(t){var e=t.match(hu),s,n;for(s=0,n=e.length;s<n;s++)Gn[e[s]]?e[s]=Gn[e[s]]:e[s]=hD(e[s]);return function(i){var r="",a;for(a=0;a<n;a++)r+=ns(e[a])?e[a].call(i,t):e[a];return r}}function Da(t,e){return t.isValid()?(e=p0(e,t.localeData()),Hl[e]=Hl[e]||fD(e),Hl[e](t)):t.localeData().invalidDate()}function p0(t,e){var s=5;function n(i){return e.longDateFormat(i)||i}for(ya.lastIndex=0;s>=0&&ya.test(t);)t=t.replace(ya,n),ya.lastIndex=0,s-=1;return t}var mD={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function pD(t){var e=this._longDateFormat[t],s=this._longDateFormat[t.toUpperCase()];return e||!s?e:(this._longDateFormat[t]=s.match(hu).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var gD="Invalid date";function xD(){return this._invalidDate}var yD="%d",bD=/\d{1,2}/;function vD(t){return this._ordinal.replace("%d",t)}var _D={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function wD(t,e,s,n){var i=this._relativeTime[s];return ns(i)?i(t,e,s,n):i.replace(/%d/i,t)}function kD(t,e){var s=this._relativeTime[t>0?"future":"past"];return ns(s)?s(e):s.replace(/%s/i,e)}var up={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Dt(t){return typeof t=="string"?up[t]||up[t.toLowerCase()]:void 0}function fu(t){var e={},s,n;for(n in t)_e(t,n)&&(s=Dt(n),s&&(e[s]=t[n]));return e}var SD={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function jD(t){var e=[],s;for(s in t)_e(t,s)&&e.push({unit:s,priority:SD[s]});return e.sort(function(n,i){return n.priority-i.priority}),e}var g0=/\d/,_t=/\d\d/,x0=/\d{3}/,mu=/\d{4}/,Lo=/[+-]?\d{6}/,De=/\d\d?/,y0=/\d\d\d\d?/,b0=/\d\d\d\d\d\d?/,Fo=/\d{1,3}/,pu=/\d{1,4}/,Io=/[+-]?\d{1,6}/,hi=/\d+/,Vo=/[+-]?\d+/,ND=/Z|[+-]\d\d:?\d\d/gi,Wo=/Z|[+-]\d\d(?::?\d\d)?/gi,TD=/[+-]?\d+(\.\d{1,3})?/,Fr=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,fi=/^[1-9]\d?/,gu=/^([1-9]\d|\d)/,io;io={};function G(t,e,s){io[t]=ns(e)?e:function(n,i){return n&&s?s:e}}function MD(t,e){return _e(io,t)?io[t](e._strict,e._locale):new RegExp(CD(t))}function CD(t){return _s(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,s,n,i,r){return s||n||i||r}))}function _s(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Tt(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function ye(t){var e=+t,s=0;return e!==0&&isFinite(e)&&(s=Tt(e)),s}var Uc={};function Ne(t,e){var s,n=e,i;for(typeof t=="string"&&(t=[t]),Ss(e)&&(n=function(r,a){a[e]=ye(r)}),i=t.length,s=0;s<i;s++)Uc[t[s]]=n}function Ir(t,e){Ne(t,function(s,n,i,r){i._w=i._w||{},e(s,i._w,i,r)})}function PD(t,e,s){e!=null&&_e(Uc,t)&&Uc[t](e,s._a,s,t)}function Bo(t){return t%4===0&&t%100!==0||t%400===0}var lt=0,xs=1,Kt=2,Ze=3,Ft=4,ys=5,xn=6,DD=7,ED=8;J("Y",0,0,function(){var t=this.year();return t<=9999?ts(t,4):"+"+t});J(0,["YY",2],0,function(){return this.year()%100});J(0,["YYYY",4],0,"year");J(0,["YYYYY",5],0,"year");J(0,["YYYYYY",6,!0],0,"year");G("Y",Vo);G("YY",De,_t);G("YYYY",pu,mu);G("YYYYY",Io,Lo);G("YYYYYY",Io,Lo);Ne(["YYYYY","YYYYYY"],lt);Ne("YYYY",function(t,e){e[lt]=t.length===2?W.parseTwoDigitYear(t):ye(t)});Ne("YY",function(t,e){e[lt]=W.parseTwoDigitYear(t)});Ne("Y",function(t,e){e[lt]=parseInt(t,10)});function sr(t){return Bo(t)?366:365}W.parseTwoDigitYear=function(t){return ye(t)+(ye(t)>68?1900:2e3)};var v0=mi("FullYear",!0);function AD(){return Bo(this.year())}function mi(t,e){return function(s){return s!=null?(_0(this,t,s),W.updateOffset(this,e),this):br(this,t)}}function br(t,e){if(!t.isValid())return NaN;var s=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?s.getUTCMilliseconds():s.getMilliseconds();case"Seconds":return n?s.getUTCSeconds():s.getSeconds();case"Minutes":return n?s.getUTCMinutes():s.getMinutes();case"Hours":return n?s.getUTCHours():s.getHours();case"Date":return n?s.getUTCDate():s.getDate();case"Day":return n?s.getUTCDay():s.getDay();case"Month":return n?s.getUTCMonth():s.getMonth();case"FullYear":return n?s.getUTCFullYear():s.getFullYear();default:return NaN}}function _0(t,e,s){var n,i,r,a,o;if(!(!t.isValid()||isNaN(s))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(s):n.setMilliseconds(s));case"Seconds":return void(i?n.setUTCSeconds(s):n.setSeconds(s));case"Minutes":return void(i?n.setUTCMinutes(s):n.setMinutes(s));case"Hours":return void(i?n.setUTCHours(s):n.setHours(s));case"Date":return void(i?n.setUTCDate(s):n.setDate(s));case"FullYear":break;default:return}r=s,a=t.month(),o=t.date(),o=o===29&&a===1&&!Bo(r)?28:o,i?n.setUTCFullYear(r,a,o):n.setFullYear(r,a,o)}}function OD(t){return t=Dt(t),ns(this[t])?this[t]():this}function RD(t,e){if(typeof t=="object"){t=fu(t);var s=jD(t),n,i=s.length;for(n=0;n<i;n++)this[s[n].unit](t[s[n].unit])}else if(t=Dt(t),ns(this[t]))return this[t](e);return this}function LD(t,e){return(t%e+e)%e}var Ge;Array.prototype.indexOf?Ge=Array.prototype.indexOf:Ge=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function xu(t,e){if(isNaN(t)||isNaN(e))return NaN;var s=LD(e,12);return t+=(e-s)/12,s===1?Bo(t)?29:28:31-s%7%2}J("M",["MM",2],"Mo",function(){return this.month()+1});J("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});J("MMMM",0,0,function(t){return this.localeData().months(this,t)});G("M",De,fi);G("MM",De,_t);G("MMM",function(t,e){return e.monthsShortRegex(t)});G("MMMM",function(t,e){return e.monthsRegex(t)});Ne(["M","MM"],function(t,e){e[xs]=ye(t)-1});Ne(["MMM","MMMM"],function(t,e,s,n){var i=s._locale.monthsParse(t,n,s._strict);i!=null?e[xs]=i:le(s).invalidMonth=t});var FD="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),w0="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),k0=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,ID=Fr,VD=Fr;function WD(t,e){return t?Vt(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||k0).test(e)?"format":"standalone"][t.month()]:Vt(this._months)?this._months:this._months.standalone}function BD(t,e){return t?Vt(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[k0.test(e)?"format":"standalone"][t.month()]:Vt(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function zD(t,e,s){var n,i,r,a=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)r=ss([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(r,"").toLocaleLowerCase();return s?e==="MMM"?(i=Ge.call(this._shortMonthsParse,a),i!==-1?i:null):(i=Ge.call(this._longMonthsParse,a),i!==-1?i:null):e==="MMM"?(i=Ge.call(this._shortMonthsParse,a),i!==-1?i:(i=Ge.call(this._longMonthsParse,a),i!==-1?i:null)):(i=Ge.call(this._longMonthsParse,a),i!==-1?i:(i=Ge.call(this._shortMonthsParse,a),i!==-1?i:null))}function HD(t,e,s){var n,i,r;if(this._monthsParseExact)return zD.call(this,t,e,s);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=ss([2e3,n]),s&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!s&&!this._monthsParse[n]&&(r="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(r.replace(".",""),"i")),s&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(s&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!s&&this._monthsParse[n].test(t))return n}}function S0(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=ye(e);else if(e=t.localeData().monthsParse(e),!Ss(e))return t}var s=e,n=t.date();return n=n<29?n:Math.min(n,xu(t.year(),s)),t._isUTC?t._d.setUTCMonth(s,n):t._d.setMonth(s,n),t}function j0(t){return t!=null?(S0(this,t),W.updateOffset(this,!0),this):br(this,"Month")}function $D(){return xu(this.year(),this.month())}function YD(t){return this._monthsParseExact?(_e(this,"_monthsRegex")||N0.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(_e(this,"_monthsShortRegex")||(this._monthsShortRegex=ID),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function UD(t){return this._monthsParseExact?(_e(this,"_monthsRegex")||N0.call(this),t?this._monthsStrictRegex:this._monthsRegex):(_e(this,"_monthsRegex")||(this._monthsRegex=VD),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function N0(){function t(c,d){return d.length-c.length}var e=[],s=[],n=[],i,r,a,o;for(i=0;i<12;i++)r=ss([2e3,i]),a=_s(this.monthsShort(r,"")),o=_s(this.months(r,"")),e.push(a),s.push(o),n.push(o),n.push(a);e.sort(t),s.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function GD(t,e,s,n,i,r,a){var o;return t<100&&t>=0?(o=new Date(t+400,e,s,n,i,r,a),isFinite(o.getFullYear())&&o.setFullYear(t)):o=new Date(t,e,s,n,i,r,a),o}function vr(t){var e,s;return t<100&&t>=0?(s=Array.prototype.slice.call(arguments),s[0]=t+400,e=new Date(Date.UTC.apply(null,s)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function ro(t,e,s){var n=7+e-s,i=(7+vr(t,0,n).getUTCDay()-e)%7;return-i+n-1}function T0(t,e,s,n,i){var r=(7+s-n)%7,a=ro(t,n,i),o=1+7*(e-1)+r+a,c,d;return o<=0?(c=t-1,d=sr(c)+o):o>sr(t)?(c=t+1,d=o-sr(t)):(c=t,d=o),{year:c,dayOfYear:d}}function _r(t,e,s){var n=ro(t.year(),e,s),i=Math.floor((t.dayOfYear()-n-1)/7)+1,r,a;return i<1?(a=t.year()-1,r=i+ws(a,e,s)):i>ws(t.year(),e,s)?(r=i-ws(t.year(),e,s),a=t.year()+1):(a=t.year(),r=i),{week:r,year:a}}function ws(t,e,s){var n=ro(t,e,s),i=ro(t+1,e,s);return(sr(t)-n+i)/7}J("w",["ww",2],"wo","week");J("W",["WW",2],"Wo","isoWeek");G("w",De,fi);G("ww",De,_t);G("W",De,fi);G("WW",De,_t);Ir(["w","ww","W","WW"],function(t,e,s,n){e[n.substr(0,1)]=ye(t)});function qD(t){return _r(t,this._week.dow,this._week.doy).week}var KD={dow:0,doy:6};function XD(){return this._week.dow}function ZD(){return this._week.doy}function JD(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function QD(t){var e=_r(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}J("d",0,"do","day");J("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});J("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});J("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});J("e",0,0,"weekday");J("E",0,0,"isoWeekday");G("d",De);G("e",De);G("E",De);G("dd",function(t,e){return e.weekdaysMinRegex(t)});G("ddd",function(t,e){return e.weekdaysShortRegex(t)});G("dddd",function(t,e){return e.weekdaysRegex(t)});Ir(["dd","ddd","dddd"],function(t,e,s,n){var i=s._locale.weekdaysParse(t,n,s._strict);i!=null?e.d=i:le(s).invalidWeekday=t});Ir(["d","e","E"],function(t,e,s,n){e[n]=ye(t)});function e5(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function t5(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function yu(t,e){return t.slice(e,7).concat(t.slice(0,e))}var s5="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),M0="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),n5="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),i5=Fr,r5=Fr,a5=Fr;function o5(t,e){var s=Vt(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?yu(s,this._week.dow):t?s[t.day()]:s}function l5(t){return t===!0?yu(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function c5(t){return t===!0?yu(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function d5(t,e,s){var n,i,r,a=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)r=ss([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(r,"").toLocaleLowerCase();return s?e==="dddd"?(i=Ge.call(this._weekdaysParse,a),i!==-1?i:null):e==="ddd"?(i=Ge.call(this._shortWeekdaysParse,a),i!==-1?i:null):(i=Ge.call(this._minWeekdaysParse,a),i!==-1?i:null):e==="dddd"?(i=Ge.call(this._weekdaysParse,a),i!==-1||(i=Ge.call(this._shortWeekdaysParse,a),i!==-1)?i:(i=Ge.call(this._minWeekdaysParse,a),i!==-1?i:null)):e==="ddd"?(i=Ge.call(this._shortWeekdaysParse,a),i!==-1||(i=Ge.call(this._weekdaysParse,a),i!==-1)?i:(i=Ge.call(this._minWeekdaysParse,a),i!==-1?i:null)):(i=Ge.call(this._minWeekdaysParse,a),i!==-1||(i=Ge.call(this._weekdaysParse,a),i!==-1)?i:(i=Ge.call(this._shortWeekdaysParse,a),i!==-1?i:null))}function u5(t,e,s){var n,i,r;if(this._weekdaysParseExact)return d5.call(this,t,e,s);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=ss([2e3,1]).day(n),s&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(r="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(r.replace(".",""),"i")),s&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(s&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(s&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!s&&this._weekdaysParse[n].test(t))return n}}function h5(t){if(!this.isValid())return t!=null?this:NaN;var e=br(this,"Day");return t!=null?(t=e5(t,this.localeData()),this.add(t-e,"d")):e}function f5(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function m5(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=t5(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function p5(t){return this._weekdaysParseExact?(_e(this,"_weekdaysRegex")||bu.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(_e(this,"_weekdaysRegex")||(this._weekdaysRegex=i5),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function g5(t){return this._weekdaysParseExact?(_e(this,"_weekdaysRegex")||bu.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(_e(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=r5),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function x5(t){return this._weekdaysParseExact?(_e(this,"_weekdaysRegex")||bu.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(_e(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=a5),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function bu(){function t(u,h){return h.length-u.length}var e=[],s=[],n=[],i=[],r,a,o,c,d;for(r=0;r<7;r++)a=ss([2e3,1]).day(r),o=_s(this.weekdaysMin(a,"")),c=_s(this.weekdaysShort(a,"")),d=_s(this.weekdays(a,"")),e.push(o),s.push(c),n.push(d),i.push(o),i.push(c),i.push(d);e.sort(t),s.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function vu(){return this.hours()%12||12}function y5(){return this.hours()||24}J("H",["HH",2],0,"hour");J("h",["hh",2],0,vu);J("k",["kk",2],0,y5);J("hmm",0,0,function(){return""+vu.apply(this)+ts(this.minutes(),2)});J("hmmss",0,0,function(){return""+vu.apply(this)+ts(this.minutes(),2)+ts(this.seconds(),2)});J("Hmm",0,0,function(){return""+this.hours()+ts(this.minutes(),2)});J("Hmmss",0,0,function(){return""+this.hours()+ts(this.minutes(),2)+ts(this.seconds(),2)});function C0(t,e){J(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}C0("a",!0);C0("A",!1);function P0(t,e){return e._meridiemParse}G("a",P0);G("A",P0);G("H",De,gu);G("h",De,fi);G("k",De,fi);G("HH",De,_t);G("hh",De,_t);G("kk",De,_t);G("hmm",y0);G("hmmss",b0);G("Hmm",y0);G("Hmmss",b0);Ne(["H","HH"],Ze);Ne(["k","kk"],function(t,e,s){var n=ye(t);e[Ze]=n===24?0:n});Ne(["a","A"],function(t,e,s){s._isPm=s._locale.isPM(t),s._meridiem=t});Ne(["h","hh"],function(t,e,s){e[Ze]=ye(t),le(s).bigHour=!0});Ne("hmm",function(t,e,s){var n=t.length-2;e[Ze]=ye(t.substr(0,n)),e[Ft]=ye(t.substr(n)),le(s).bigHour=!0});Ne("hmmss",function(t,e,s){var n=t.length-4,i=t.length-2;e[Ze]=ye(t.substr(0,n)),e[Ft]=ye(t.substr(n,2)),e[ys]=ye(t.substr(i)),le(s).bigHour=!0});Ne("Hmm",function(t,e,s){var n=t.length-2;e[Ze]=ye(t.substr(0,n)),e[Ft]=ye(t.substr(n))});Ne("Hmmss",function(t,e,s){var n=t.length-4,i=t.length-2;e[Ze]=ye(t.substr(0,n)),e[Ft]=ye(t.substr(n,2)),e[ys]=ye(t.substr(i))});function b5(t){return(t+"").toLowerCase().charAt(0)==="p"}var v5=/[ap]\.?m?\.?/i,_5=mi("Hours",!0);function w5(t,e,s){return t>11?s?"pm":"PM":s?"am":"AM"}var D0={calendar:dD,longDateFormat:mD,invalidDate:gD,ordinal:yD,dayOfMonthOrdinalParse:bD,relativeTime:_D,months:FD,monthsShort:w0,week:KD,weekdays:s5,weekdaysMin:n5,weekdaysShort:M0,meridiemParse:v5},Ae={},Ai={},wr;function k5(t,e){var s,n=Math.min(t.length,e.length);for(s=0;s<n;s+=1)if(t[s]!==e[s])return s;return n}function hp(t){return t&&t.toLowerCase().replace("_","-")}function S5(t){for(var e=0,s,n,i,r;e<t.length;){for(r=hp(t[e]).split("-"),s=r.length,n=hp(t[e+1]),n=n?n.split("-"):null;s>0;){if(i=zo(r.slice(0,s).join("-")),i)return i;if(n&&n.length>=s&&k5(r,n)>=s-1)break;s--}e++}return wr}function j5(t){return!!(t&&t.match("^[^/\\\\]*$"))}function zo(t){var e=null,s;if(Ae[t]===void 0&&typeof module<"u"&&module&&module.exports&&j5(t))try{e=wr._abbr,s=require,s("./locale/"+t),Hs(e)}catch{Ae[t]=null}return Ae[t]}function Hs(t,e){var s;return t&&(ft(e)?s=Ts(t):s=_u(t,e),s?wr=s:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),wr._abbr}function _u(t,e){if(e!==null){var s,n=D0;if(e.abbr=t,Ae[t]!=null)m0("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Ae[t]._config;else if(e.parentLocale!=null)if(Ae[e.parentLocale]!=null)n=Ae[e.parentLocale]._config;else if(s=zo(e.parentLocale),s!=null)n=s._config;else return Ai[e.parentLocale]||(Ai[e.parentLocale]=[]),Ai[e.parentLocale].push({name:t,config:e}),null;return Ae[t]=new uu($c(n,e)),Ai[t]&&Ai[t].forEach(function(i){_u(i.name,i.config)}),Hs(t),Ae[t]}else return delete Ae[t],null}function N5(t,e){if(e!=null){var s,n,i=D0;Ae[t]!=null&&Ae[t].parentLocale!=null?Ae[t].set($c(Ae[t]._config,e)):(n=zo(t),n!=null&&(i=n._config),e=$c(i,e),n==null&&(e.abbr=t),s=new uu(e),s.parentLocale=Ae[t],Ae[t]=s),Hs(t)}else Ae[t]!=null&&(Ae[t].parentLocale!=null?(Ae[t]=Ae[t].parentLocale,t===Hs()&&Hs(t)):Ae[t]!=null&&delete Ae[t]);return Ae[t]}function Ts(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return wr;if(!Vt(t)){if(e=zo(t),e)return e;t=[t]}return S5(t)}function T5(){return Yc(Ae)}function wu(t){var e,s=t._a;return s&&le(t).overflow===-2&&(e=s[xs]<0||s[xs]>11?xs:s[Kt]<1||s[Kt]>xu(s[lt],s[xs])?Kt:s[Ze]<0||s[Ze]>24||s[Ze]===24&&(s[Ft]!==0||s[ys]!==0||s[xn]!==0)?Ze:s[Ft]<0||s[Ft]>59?Ft:s[ys]<0||s[ys]>59?ys:s[xn]<0||s[xn]>999?xn:-1,le(t)._overflowDayOfYear&&(e<lt||e>Kt)&&(e=Kt),le(t)._overflowWeeks&&e===-1&&(e=DD),le(t)._overflowWeekday&&e===-1&&(e=ED),le(t).overflow=e),t}var M5=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,C5=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,P5=/Z|[+-]\d\d(?::?\d\d)?/,ba=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],$l=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],D5=/^\/?Date\((-?\d+)/i,E5=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,A5={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function E0(t){var e,s,n=t._i,i=M5.exec(n)||C5.exec(n),r,a,o,c,d=ba.length,u=$l.length;if(i){for(le(t).iso=!0,e=0,s=d;e<s;e++)if(ba[e][1].exec(i[1])){a=ba[e][0],r=ba[e][2]!==!1;break}if(a==null){t._isValid=!1;return}if(i[3]){for(e=0,s=u;e<s;e++)if($l[e][1].exec(i[3])){o=(i[2]||" ")+$l[e][0];break}if(o==null){t._isValid=!1;return}}if(!r&&o!=null){t._isValid=!1;return}if(i[4])if(P5.exec(i[4]))c="Z";else{t._isValid=!1;return}t._f=a+(o||"")+(c||""),Su(t)}else t._isValid=!1}function O5(t,e,s,n,i,r){var a=[R5(t),w0.indexOf(e),parseInt(s,10),parseInt(n,10),parseInt(i,10)];return r&&a.push(parseInt(r,10)),a}function R5(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function L5(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function F5(t,e,s){if(t){var n=M0.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return le(s).weekdayMismatch=!0,s._isValid=!1,!1}return!0}function I5(t,e,s){if(t)return A5[t];if(e)return 0;var n=parseInt(s,10),i=n%100,r=(n-i)/100;return r*60+i}function A0(t){var e=E5.exec(L5(t._i)),s;if(e){if(s=O5(e[4],e[3],e[2],e[5],e[6],e[7]),!F5(e[1],s,t))return;t._a=s,t._tzm=I5(e[8],e[9],e[10]),t._d=vr.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),le(t).rfc2822=!0}else t._isValid=!1}function V5(t){var e=D5.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(E0(t),t._isValid===!1)delete t._isValid;else return;if(A0(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:W.createFromInputFallback(t)}W.createFromInputFallback=Pt("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function In(t,e,s){return t??e??s}function W5(t){var e=new Date(W.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function ku(t){var e,s,n=[],i,r,a;if(!t._d){for(i=W5(t),t._w&&t._a[Kt]==null&&t._a[xs]==null&&B5(t),t._dayOfYear!=null&&(a=In(t._a[lt],i[lt]),(t._dayOfYear>sr(a)||t._dayOfYear===0)&&(le(t)._overflowDayOfYear=!0),s=vr(a,0,t._dayOfYear),t._a[xs]=s.getUTCMonth(),t._a[Kt]=s.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Ze]===24&&t._a[Ft]===0&&t._a[ys]===0&&t._a[xn]===0&&(t._nextDay=!0,t._a[Ze]=0),t._d=(t._useUTC?vr:GD).apply(null,n),r=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Ze]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==r&&(le(t).weekdayMismatch=!0)}}function B5(t){var e,s,n,i,r,a,o,c,d;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(r=1,a=4,s=In(e.GG,t._a[lt],_r(Pe(),1,4).year),n=In(e.W,1),i=In(e.E,1),(i<1||i>7)&&(c=!0)):(r=t._locale._week.dow,a=t._locale._week.doy,d=_r(Pe(),r,a),s=In(e.gg,t._a[lt],d.year),n=In(e.w,d.week),e.d!=null?(i=e.d,(i<0||i>6)&&(c=!0)):e.e!=null?(i=e.e+r,(e.e<0||e.e>6)&&(c=!0)):i=r),n<1||n>ws(s,r,a)?le(t)._overflowWeeks=!0:c!=null?le(t)._overflowWeekday=!0:(o=T0(s,n,i,r,a),t._a[lt]=o.year,t._dayOfYear=o.dayOfYear)}W.ISO_8601=function(){};W.RFC_2822=function(){};function Su(t){if(t._f===W.ISO_8601){E0(t);return}if(t._f===W.RFC_2822){A0(t);return}t._a=[],le(t).empty=!0;var e=""+t._i,s,n,i,r,a,o=e.length,c=0,d,u;for(i=p0(t._f,t._locale).match(hu)||[],u=i.length,s=0;s<u;s++)r=i[s],n=(e.match(MD(r,t))||[])[0],n&&(a=e.substr(0,e.indexOf(n)),a.length>0&&le(t).unusedInput.push(a),e=e.slice(e.indexOf(n)+n.length),c+=n.length),Gn[r]?(n?le(t).empty=!1:le(t).unusedTokens.push(r),PD(r,n,t)):t._strict&&!n&&le(t).unusedTokens.push(r);le(t).charsLeftOver=o-c,e.length>0&&le(t).unusedInput.push(e),t._a[Ze]<=12&&le(t).bigHour===!0&&t._a[Ze]>0&&(le(t).bigHour=void 0),le(t).parsedDateParts=t._a.slice(0),le(t).meridiem=t._meridiem,t._a[Ze]=z5(t._locale,t._a[Ze],t._meridiem),d=le(t).era,d!==null&&(t._a[lt]=t._locale.erasConvertYear(d,t._a[lt])),ku(t),wu(t)}function z5(t,e,s){var n;return s==null?e:t.meridiemHour!=null?t.meridiemHour(e,s):(t.isPM!=null&&(n=t.isPM(s),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function H5(t){var e,s,n,i,r,a,o=!1,c=t._f.length;if(c===0){le(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<c;i++)r=0,a=!1,e=du({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],Su(e),cu(e)&&(a=!0),r+=le(e).charsLeftOver,r+=le(e).unusedTokens.length*10,le(e).score=r,o?r<n&&(n=r,s=e):(n==null||r<n||a)&&(n=r,s=e,a&&(o=!0));Is(t,s||e)}function $5(t){if(!t._d){var e=fu(t._i),s=e.day===void 0?e.date:e.day;t._a=h0([e.year,e.month,s,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),ku(t)}}function Y5(t){var e=new Lr(wu(O0(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function O0(t){var e=t._i,s=t._f;return t._locale=t._locale||Ts(t._l),e===null||s===void 0&&e===""?Ro({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Wt(e)?new Lr(wu(e)):(Rr(e)?t._d=e:Vt(s)?H5(t):s?Su(t):U5(t),cu(t)||(t._d=null),t))}function U5(t){var e=t._i;ft(e)?t._d=new Date(W.now()):Rr(e)?t._d=new Date(e.valueOf()):typeof e=="string"?V5(t):Vt(e)?(t._a=h0(e.slice(0),function(s){return parseInt(s,10)}),ku(t)):wn(e)?$5(t):Ss(e)?t._d=new Date(e):W.createFromInputFallback(t)}function R0(t,e,s,n,i){var r={};return(e===!0||e===!1)&&(n=e,e=void 0),(s===!0||s===!1)&&(n=s,s=void 0),(wn(t)&&lu(t)||Vt(t)&&t.length===0)&&(t=void 0),r._isAMomentObject=!0,r._useUTC=r._isUTC=i,r._l=s,r._i=t,r._f=e,r._strict=n,Y5(r)}function Pe(t,e,s,n){return R0(t,e,s,n,!1)}var G5=Pt("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Pe.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Ro()}),q5=Pt("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Pe.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Ro()});function L0(t,e){var s,n;if(e.length===1&&Vt(e[0])&&(e=e[0]),!e.length)return Pe();for(s=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](s))&&(s=e[n]);return s}function K5(){var t=[].slice.call(arguments,0);return L0("isBefore",t)}function X5(){var t=[].slice.call(arguments,0);return L0("isAfter",t)}var Z5=function(){return Date.now?Date.now():+new Date},Oi=["year","quarter","month","week","day","hour","minute","second","millisecond"];function J5(t){var e,s=!1,n,i=Oi.length;for(e in t)if(_e(t,e)&&!(Ge.call(Oi,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[Oi[n]]){if(s)return!1;parseFloat(t[Oi[n]])!==ye(t[Oi[n]])&&(s=!0)}return!0}function Q5(){return this._isValid}function eE(){return Bt(NaN)}function Ho(t){var e=fu(t),s=e.year||0,n=e.quarter||0,i=e.month||0,r=e.week||e.isoWeek||0,a=e.day||0,o=e.hour||0,c=e.minute||0,d=e.second||0,u=e.millisecond||0;this._isValid=J5(e),this._milliseconds=+u+d*1e3+c*6e4+o*1e3*60*60,this._days=+a+r*7,this._months=+i+n*3+s*12,this._data={},this._locale=Ts(),this._bubble()}function Ea(t){return t instanceof Ho}function Gc(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function tE(t,e,s){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),r=0,a;for(a=0;a<n;a++)ye(t[a])!==ye(e[a])&&r++;return r+i}function F0(t,e){J(t,0,0,function(){var s=this.utcOffset(),n="+";return s<0&&(s=-s,n="-"),n+ts(~~(s/60),2)+e+ts(~~s%60,2)})}F0("Z",":");F0("ZZ","");G("Z",Wo);G("ZZ",Wo);Ne(["Z","ZZ"],function(t,e,s){s._useUTC=!0,s._tzm=ju(Wo,t)});var sE=/([\+\-]|\d\d)/gi;function ju(t,e){var s=(e||"").match(t),n,i,r;return s===null?null:(n=s[s.length-1]||[],i=(n+"").match(sE)||["-",0,0],r=+(i[1]*60)+ye(i[2]),r===0?0:i[0]==="+"?r:-r)}function Nu(t,e){var s,n;return e._isUTC?(s=e.clone(),n=(Wt(t)||Rr(t)?t.valueOf():Pe(t).valueOf())-s.valueOf(),s._d.setTime(s._d.valueOf()+n),W.updateOffset(s,!1),s):Pe(t).local()}function qc(t){return-Math.round(t._d.getTimezoneOffset())}W.updateOffset=function(){};function nE(t,e,s){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=ju(Wo,t),t===null)return this}else Math.abs(t)<16&&!s&&(t=t*60);return!this._isUTC&&e&&(i=qc(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?W0(this,Bt(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,W.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:qc(this)}function iE(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function rE(t){return this.utcOffset(0,t)}function aE(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(qc(this),"m")),this}function oE(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=ju(ND,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function lE(t){return this.isValid()?(t=t?Pe(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function cE(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function dE(){if(!ft(this._isDSTShifted))return this._isDSTShifted;var t={},e;return du(t,this),t=O0(t),t._a?(e=t._isUTC?ss(t._a):Pe(t._a),this._isDSTShifted=this.isValid()&&tE(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function uE(){return this.isValid()?!this._isUTC:!1}function hE(){return this.isValid()?this._isUTC:!1}function I0(){return this.isValid()?this._isUTC&&this._offset===0:!1}var fE=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,mE=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Bt(t,e){var s=t,n=null,i,r,a;return Ea(t)?s={ms:t._milliseconds,d:t._days,M:t._months}:Ss(t)||!isNaN(+t)?(s={},e?s[e]=+t:s.milliseconds=+t):(n=fE.exec(t))?(i=n[1]==="-"?-1:1,s={y:0,d:ye(n[Kt])*i,h:ye(n[Ze])*i,m:ye(n[Ft])*i,s:ye(n[ys])*i,ms:ye(Gc(n[xn]*1e3))*i}):(n=mE.exec(t))?(i=n[1]==="-"?-1:1,s={y:un(n[2],i),M:un(n[3],i),w:un(n[4],i),d:un(n[5],i),h:un(n[6],i),m:un(n[7],i),s:un(n[8],i)}):s==null?s={}:typeof s=="object"&&("from"in s||"to"in s)&&(a=pE(Pe(s.from),Pe(s.to)),s={},s.ms=a.milliseconds,s.M=a.months),r=new Ho(s),Ea(t)&&_e(t,"_locale")&&(r._locale=t._locale),Ea(t)&&_e(t,"_isValid")&&(r._isValid=t._isValid),r}Bt.fn=Ho.prototype;Bt.invalid=eE;function un(t,e){var s=t&&parseFloat(t.replace(",","."));return(isNaN(s)?0:s)*e}function fp(t,e){var s={};return s.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(s.months,"M").isAfter(e)&&--s.months,s.milliseconds=+e-+t.clone().add(s.months,"M"),s}function pE(t,e){var s;return t.isValid()&&e.isValid()?(e=Nu(e,t),t.isBefore(e)?s=fp(t,e):(s=fp(e,t),s.milliseconds=-s.milliseconds,s.months=-s.months),s):{milliseconds:0,months:0}}function V0(t,e){return function(s,n){var i,r;return n!==null&&!isNaN(+n)&&(m0(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),r=s,s=n,n=r),i=Bt(s,n),W0(this,i,t),this}}function W0(t,e,s,n){var i=e._milliseconds,r=Gc(e._days),a=Gc(e._months);t.isValid()&&(n=n??!0,a&&S0(t,br(t,"Month")+a*s),r&&_0(t,"Date",br(t,"Date")+r*s),i&&t._d.setTime(t._d.valueOf()+i*s),n&&W.updateOffset(t,r||a))}var gE=V0(1,"add"),xE=V0(-1,"subtract");function B0(t){return typeof t=="string"||t instanceof String}function yE(t){return Wt(t)||Rr(t)||B0(t)||Ss(t)||vE(t)||bE(t)||t===null||t===void 0}function bE(t){var e=wn(t)&&!lu(t),s=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,r,a=n.length;for(i=0;i<a;i+=1)r=n[i],s=s||_e(t,r);return e&&s}function vE(t){var e=Vt(t),s=!1;return e&&(s=t.filter(function(n){return!Ss(n)&&B0(t)}).length===0),e&&s}function _E(t){var e=wn(t)&&!lu(t),s=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,r;for(i=0;i<n.length;i+=1)r=n[i],s=s||_e(t,r);return e&&s}function wE(t,e){var s=t.diff(e,"days",!0);return s<-6?"sameElse":s<-1?"lastWeek":s<0?"lastDay":s<1?"sameDay":s<2?"nextDay":s<7?"nextWeek":"sameElse"}function kE(t,e){arguments.length===1&&(arguments[0]?yE(arguments[0])?(t=arguments[0],e=void 0):_E(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var s=t||Pe(),n=Nu(s,this).startOf("day"),i=W.calendarFormat(this,n)||"sameElse",r=e&&(ns(e[i])?e[i].call(this,s):e[i]);return this.format(r||this.localeData().calendar(i,this,Pe(s)))}function SE(){return new Lr(this)}function jE(t,e){var s=Wt(t)?t:Pe(t);return this.isValid()&&s.isValid()?(e=Dt(e)||"millisecond",e==="millisecond"?this.valueOf()>s.valueOf():s.valueOf()<this.clone().startOf(e).valueOf()):!1}function NE(t,e){var s=Wt(t)?t:Pe(t);return this.isValid()&&s.isValid()?(e=Dt(e)||"millisecond",e==="millisecond"?this.valueOf()<s.valueOf():this.clone().endOf(e).valueOf()<s.valueOf()):!1}function TE(t,e,s,n){var i=Wt(t)?t:Pe(t),r=Wt(e)?e:Pe(e);return this.isValid()&&i.isValid()&&r.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,s):!this.isBefore(i,s))&&(n[1]===")"?this.isBefore(r,s):!this.isAfter(r,s))):!1}function ME(t,e){var s=Wt(t)?t:Pe(t),n;return this.isValid()&&s.isValid()?(e=Dt(e)||"millisecond",e==="millisecond"?this.valueOf()===s.valueOf():(n=s.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function CE(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function PE(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function DE(t,e,s){var n,i,r;if(!this.isValid())return NaN;if(n=Nu(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=Dt(e),e){case"year":r=Aa(this,n)/12;break;case"month":r=Aa(this,n);break;case"quarter":r=Aa(this,n)/3;break;case"second":r=(this-n)/1e3;break;case"minute":r=(this-n)/6e4;break;case"hour":r=(this-n)/36e5;break;case"day":r=(this-n-i)/864e5;break;case"week":r=(this-n-i)/6048e5;break;default:r=this-n}return s?r:Tt(r)}function Aa(t,e){if(t.date()<e.date())return-Aa(e,t);var s=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(s,"months"),i,r;return e-n<0?(i=t.clone().add(s-1,"months"),r=(e-n)/(n-i)):(i=t.clone().add(s+1,"months"),r=(e-n)/(i-n)),-(s+r)||0}W.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";W.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function EE(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function AE(t){if(!this.isValid())return null;var e=t!==!0,s=e?this.clone().utc():this;return s.year()<0||s.year()>9999?Da(s,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ns(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Da(s,"Z")):Da(s,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function OE(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",s,n,i,r;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),s="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",r=e+'[")]',this.format(s+n+i+r)}function RE(t){t||(t=this.isUtc()?W.defaultFormatUtc:W.defaultFormat);var e=Da(this,t);return this.localeData().postformat(e)}function LE(t,e){return this.isValid()&&(Wt(t)&&t.isValid()||Pe(t).isValid())?Bt({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function FE(t){return this.from(Pe(),t)}function IE(t,e){return this.isValid()&&(Wt(t)&&t.isValid()||Pe(t).isValid())?Bt({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function VE(t){return this.to(Pe(),t)}function z0(t){var e;return t===void 0?this._locale._abbr:(e=Ts(t),e!=null&&(this._locale=e),this)}var H0=Pt("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function $0(){return this._locale}var ao=1e3,qn=60*ao,oo=60*qn,Y0=(365*400+97)*24*oo;function Kn(t,e){return(t%e+e)%e}function U0(t,e,s){return t<100&&t>=0?new Date(t+400,e,s)-Y0:new Date(t,e,s).valueOf()}function G0(t,e,s){return t<100&&t>=0?Date.UTC(t+400,e,s)-Y0:Date.UTC(t,e,s)}function WE(t){var e,s;if(t=Dt(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(s=this._isUTC?G0:U0,t){case"year":e=s(this.year(),0,1);break;case"quarter":e=s(this.year(),this.month()-this.month()%3,1);break;case"month":e=s(this.year(),this.month(),1);break;case"week":e=s(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=s(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=s(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Kn(e+(this._isUTC?0:this.utcOffset()*qn),oo);break;case"minute":e=this._d.valueOf(),e-=Kn(e,qn);break;case"second":e=this._d.valueOf(),e-=Kn(e,ao);break}return this._d.setTime(e),W.updateOffset(this,!0),this}function BE(t){var e,s;if(t=Dt(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(s=this._isUTC?G0:U0,t){case"year":e=s(this.year()+1,0,1)-1;break;case"quarter":e=s(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=s(this.year(),this.month()+1,1)-1;break;case"week":e=s(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=s(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=s(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=oo-Kn(e+(this._isUTC?0:this.utcOffset()*qn),oo)-1;break;case"minute":e=this._d.valueOf(),e+=qn-Kn(e,qn)-1;break;case"second":e=this._d.valueOf(),e+=ao-Kn(e,ao)-1;break}return this._d.setTime(e),W.updateOffset(this,!0),this}function zE(){return this._d.valueOf()-(this._offset||0)*6e4}function HE(){return Math.floor(this.valueOf()/1e3)}function $E(){return new Date(this.valueOf())}function YE(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function UE(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function GE(){return this.isValid()?this.toISOString():null}function qE(){return cu(this)}function KE(){return Is({},le(this))}function XE(){return le(this).overflow}function ZE(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}J("N",0,0,"eraAbbr");J("NN",0,0,"eraAbbr");J("NNN",0,0,"eraAbbr");J("NNNN",0,0,"eraName");J("NNNNN",0,0,"eraNarrow");J("y",["y",1],"yo","eraYear");J("y",["yy",2],0,"eraYear");J("y",["yyy",3],0,"eraYear");J("y",["yyyy",4],0,"eraYear");G("N",Tu);G("NN",Tu);G("NNN",Tu);G("NNNN",lA);G("NNNNN",cA);Ne(["N","NN","NNN","NNNN","NNNNN"],function(t,e,s,n){var i=s._locale.erasParse(t,n,s._strict);i?le(s).era=i:le(s).invalidEra=t});G("y",hi);G("yy",hi);G("yyy",hi);G("yyyy",hi);G("yo",dA);Ne(["y","yy","yyy","yyyy"],lt);Ne(["yo"],function(t,e,s,n){var i;s._locale._eraYearOrdinalRegex&&(i=t.match(s._locale._eraYearOrdinalRegex)),s._locale.eraYearOrdinalParse?e[lt]=s._locale.eraYearOrdinalParse(t,i):e[lt]=parseInt(t,10)});function JE(t,e){var s,n,i,r=this._eras||Ts("en")._eras;for(s=0,n=r.length;s<n;++s)switch(typeof r[s].since==="string"&&(i=W(r[s].since).startOf("day"),r[s].since=i.valueOf()),typeof r[s].until){case"undefined":r[s].until=1/0;break;case"string":i=W(r[s].until).startOf("day").valueOf(),r[s].until=i.valueOf();break}return r}function QE(t,e,s){var n,i,r=this.eras(),a,o,c;for(t=t.toUpperCase(),n=0,i=r.length;n<i;++n)if(a=r[n].name.toUpperCase(),o=r[n].abbr.toUpperCase(),c=r[n].narrow.toUpperCase(),s)switch(e){case"N":case"NN":case"NNN":if(o===t)return r[n];break;case"NNNN":if(a===t)return r[n];break;case"NNNNN":if(c===t)return r[n];break}else if([a,o,c].indexOf(t)>=0)return r[n]}function eA(t,e){var s=t.since<=t.until?1:-1;return e===void 0?W(t.since).year():W(t.since).year()+(e-t.offset)*s}function tA(){var t,e,s,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(s=this.clone().startOf("day").valueOf(),n[t].since<=s&&s<=n[t].until||n[t].until<=s&&s<=n[t].since)return n[t].name;return""}function sA(){var t,e,s,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(s=this.clone().startOf("day").valueOf(),n[t].since<=s&&s<=n[t].until||n[t].until<=s&&s<=n[t].since)return n[t].narrow;return""}function nA(){var t,e,s,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(s=this.clone().startOf("day").valueOf(),n[t].since<=s&&s<=n[t].until||n[t].until<=s&&s<=n[t].since)return n[t].abbr;return""}function iA(){var t,e,s,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(s=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-W(i[t].since).year())*s+i[t].offset;return this.year()}function rA(t){return _e(this,"_erasNameRegex")||Mu.call(this),t?this._erasNameRegex:this._erasRegex}function aA(t){return _e(this,"_erasAbbrRegex")||Mu.call(this),t?this._erasAbbrRegex:this._erasRegex}function oA(t){return _e(this,"_erasNarrowRegex")||Mu.call(this),t?this._erasNarrowRegex:this._erasRegex}function Tu(t,e){return e.erasAbbrRegex(t)}function lA(t,e){return e.erasNameRegex(t)}function cA(t,e){return e.erasNarrowRegex(t)}function dA(t,e){return e._eraYearOrdinalRegex||hi}function Mu(){var t=[],e=[],s=[],n=[],i,r,a,o,c,d=this.eras();for(i=0,r=d.length;i<r;++i)a=_s(d[i].name),o=_s(d[i].abbr),c=_s(d[i].narrow),e.push(a),t.push(o),s.push(c),n.push(a),n.push(o),n.push(c);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+s.join("|")+")","i")}J(0,["gg",2],0,function(){return this.weekYear()%100});J(0,["GG",2],0,function(){return this.isoWeekYear()%100});function $o(t,e){J(0,[t,t.length],0,e)}$o("gggg","weekYear");$o("ggggg","weekYear");$o("GGGG","isoWeekYear");$o("GGGGG","isoWeekYear");G("G",Vo);G("g",Vo);G("GG",De,_t);G("gg",De,_t);G("GGGG",pu,mu);G("gggg",pu,mu);G("GGGGG",Io,Lo);G("ggggg",Io,Lo);Ir(["gggg","ggggg","GGGG","GGGGG"],function(t,e,s,n){e[n.substr(0,2)]=ye(t)});Ir(["gg","GG"],function(t,e,s,n){e[n]=W.parseTwoDigitYear(t)});function uA(t){return q0.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function hA(t){return q0.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function fA(){return ws(this.year(),1,4)}function mA(){return ws(this.isoWeekYear(),1,4)}function pA(){var t=this.localeData()._week;return ws(this.year(),t.dow,t.doy)}function gA(){var t=this.localeData()._week;return ws(this.weekYear(),t.dow,t.doy)}function q0(t,e,s,n,i){var r;return t==null?_r(this,n,i).year:(r=ws(t,n,i),e>r&&(e=r),xA.call(this,t,e,s,n,i))}function xA(t,e,s,n,i){var r=T0(t,e,s,n,i),a=vr(r.year,0,r.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}J("Q",0,"Qo","quarter");G("Q",g0);Ne("Q",function(t,e){e[xs]=(ye(t)-1)*3});function yA(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}J("D",["DD",2],"Do","date");G("D",De,fi);G("DD",De,_t);G("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Ne(["D","DD"],Kt);Ne("Do",function(t,e){e[Kt]=ye(t.match(De)[0])});var K0=mi("Date",!0);J("DDD",["DDDD",3],"DDDo","dayOfYear");G("DDD",Fo);G("DDDD",x0);Ne(["DDD","DDDD"],function(t,e,s){s._dayOfYear=ye(t)});function bA(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}J("m",["mm",2],0,"minute");G("m",De,gu);G("mm",De,_t);Ne(["m","mm"],Ft);var vA=mi("Minutes",!1);J("s",["ss",2],0,"second");G("s",De,gu);G("ss",De,_t);Ne(["s","ss"],ys);var _A=mi("Seconds",!1);J("S",0,0,function(){return~~(this.millisecond()/100)});J(0,["SS",2],0,function(){return~~(this.millisecond()/10)});J(0,["SSS",3],0,"millisecond");J(0,["SSSS",4],0,function(){return this.millisecond()*10});J(0,["SSSSS",5],0,function(){return this.millisecond()*100});J(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});J(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});J(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});J(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});G("S",Fo,g0);G("SS",Fo,_t);G("SSS",Fo,x0);var Vs,X0;for(Vs="SSSS";Vs.length<=9;Vs+="S")G(Vs,hi);function wA(t,e){e[xn]=ye(("0."+t)*1e3)}for(Vs="S";Vs.length<=9;Vs+="S")Ne(Vs,wA);X0=mi("Milliseconds",!1);J("z",0,0,"zoneAbbr");J("zz",0,0,"zoneName");function kA(){return this._isUTC?"UTC":""}function SA(){return this._isUTC?"Coordinated Universal Time":""}var I=Lr.prototype;I.add=gE;I.calendar=kE;I.clone=SE;I.diff=DE;I.endOf=BE;I.format=RE;I.from=LE;I.fromNow=FE;I.to=IE;I.toNow=VE;I.get=OD;I.invalidAt=XE;I.isAfter=jE;I.isBefore=NE;I.isBetween=TE;I.isSame=ME;I.isSameOrAfter=CE;I.isSameOrBefore=PE;I.isValid=qE;I.lang=H0;I.locale=z0;I.localeData=$0;I.max=q5;I.min=G5;I.parsingFlags=KE;I.set=RD;I.startOf=WE;I.subtract=xE;I.toArray=YE;I.toObject=UE;I.toDate=$E;I.toISOString=AE;I.inspect=OE;typeof Symbol<"u"&&Symbol.for!=null&&(I[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});I.toJSON=GE;I.toString=EE;I.unix=HE;I.valueOf=zE;I.creationData=ZE;I.eraName=tA;I.eraNarrow=sA;I.eraAbbr=nA;I.eraYear=iA;I.year=v0;I.isLeapYear=AD;I.weekYear=uA;I.isoWeekYear=hA;I.quarter=I.quarters=yA;I.month=j0;I.daysInMonth=$D;I.week=I.weeks=JD;I.isoWeek=I.isoWeeks=QD;I.weeksInYear=pA;I.weeksInWeekYear=gA;I.isoWeeksInYear=fA;I.isoWeeksInISOWeekYear=mA;I.date=K0;I.day=I.days=h5;I.weekday=f5;I.isoWeekday=m5;I.dayOfYear=bA;I.hour=I.hours=_5;I.minute=I.minutes=vA;I.second=I.seconds=_A;I.millisecond=I.milliseconds=X0;I.utcOffset=nE;I.utc=rE;I.local=aE;I.parseZone=oE;I.hasAlignedHourOffset=lE;I.isDST=cE;I.isLocal=uE;I.isUtcOffset=hE;I.isUtc=I0;I.isUTC=I0;I.zoneAbbr=kA;I.zoneName=SA;I.dates=Pt("dates accessor is deprecated. Use date instead.",K0);I.months=Pt("months accessor is deprecated. Use month instead",j0);I.years=Pt("years accessor is deprecated. Use year instead",v0);I.zone=Pt("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",iE);I.isDSTShifted=Pt("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",dE);function jA(t){return Pe(t*1e3)}function NA(){return Pe.apply(null,arguments).parseZone()}function Z0(t){return t}var we=uu.prototype;we.calendar=uD;we.longDateFormat=pD;we.invalidDate=xD;we.ordinal=vD;we.preparse=Z0;we.postformat=Z0;we.relativeTime=wD;we.pastFuture=kD;we.set=cD;we.eras=JE;we.erasParse=QE;we.erasConvertYear=eA;we.erasAbbrRegex=aA;we.erasNameRegex=rA;we.erasNarrowRegex=oA;we.months=WD;we.monthsShort=BD;we.monthsParse=HD;we.monthsRegex=UD;we.monthsShortRegex=YD;we.week=qD;we.firstDayOfYear=ZD;we.firstDayOfWeek=XD;we.weekdays=o5;we.weekdaysMin=c5;we.weekdaysShort=l5;we.weekdaysParse=u5;we.weekdaysRegex=p5;we.weekdaysShortRegex=g5;we.weekdaysMinRegex=x5;we.isPM=b5;we.meridiem=w5;function lo(t,e,s,n){var i=Ts(),r=ss().set(n,e);return i[s](r,t)}function J0(t,e,s){if(Ss(t)&&(e=t,t=void 0),t=t||"",e!=null)return lo(t,e,s,"month");var n,i=[];for(n=0;n<12;n++)i[n]=lo(t,n,s,"month");return i}function Cu(t,e,s,n){typeof t=="boolean"?(Ss(e)&&(s=e,e=void 0),e=e||""):(e=t,s=e,t=!1,Ss(e)&&(s=e,e=void 0),e=e||"");var i=Ts(),r=t?i._week.dow:0,a,o=[];if(s!=null)return lo(e,(s+r)%7,n,"day");for(a=0;a<7;a++)o[a]=lo(e,(a+r)%7,n,"day");return o}function TA(t,e){return J0(t,e,"months")}function MA(t,e){return J0(t,e,"monthsShort")}function CA(t,e,s){return Cu(t,e,s,"weekdays")}function PA(t,e,s){return Cu(t,e,s,"weekdaysShort")}function DA(t,e,s){return Cu(t,e,s,"weekdaysMin")}Hs("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,s=ye(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+s}});W.lang=Pt("moment.lang is deprecated. Use moment.locale instead.",Hs);W.langData=Pt("moment.langData is deprecated. Use moment.localeData instead.",Ts);var cs=Math.abs;function EA(){var t=this._data;return this._milliseconds=cs(this._milliseconds),this._days=cs(this._days),this._months=cs(this._months),t.milliseconds=cs(t.milliseconds),t.seconds=cs(t.seconds),t.minutes=cs(t.minutes),t.hours=cs(t.hours),t.months=cs(t.months),t.years=cs(t.years),this}function Q0(t,e,s,n){var i=Bt(e,s);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function AA(t,e){return Q0(this,t,e,1)}function OA(t,e){return Q0(this,t,e,-1)}function mp(t){return t<0?Math.floor(t):Math.ceil(t)}function RA(){var t=this._milliseconds,e=this._days,s=this._months,n=this._data,i,r,a,o,c;return t>=0&&e>=0&&s>=0||t<=0&&e<=0&&s<=0||(t+=mp(Kc(s)+e)*864e5,e=0,s=0),n.milliseconds=t%1e3,i=Tt(t/1e3),n.seconds=i%60,r=Tt(i/60),n.minutes=r%60,a=Tt(r/60),n.hours=a%24,e+=Tt(a/24),c=Tt(eb(e)),s+=c,e-=mp(Kc(c)),o=Tt(s/12),s%=12,n.days=e,n.months=s,n.years=o,this}function eb(t){return t*4800/146097}function Kc(t){return t*146097/4800}function LA(t){if(!this.isValid())return NaN;var e,s,n=this._milliseconds;if(t=Dt(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,s=this._months+eb(e),t){case"month":return s;case"quarter":return s/3;case"year":return s/12}else switch(e=this._days+Math.round(Kc(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function Ms(t){return function(){return this.as(t)}}var tb=Ms("ms"),FA=Ms("s"),IA=Ms("m"),VA=Ms("h"),WA=Ms("d"),BA=Ms("w"),zA=Ms("M"),HA=Ms("Q"),$A=Ms("y"),YA=tb;function UA(){return Bt(this)}function GA(t){return t=Dt(t),this.isValid()?this[t+"s"]():NaN}function Pn(t){return function(){return this.isValid()?this._data[t]:NaN}}var qA=Pn("milliseconds"),KA=Pn("seconds"),XA=Pn("minutes"),ZA=Pn("hours"),JA=Pn("days"),QA=Pn("months"),eO=Pn("years");function tO(){return Tt(this.days()/7)}var fs=Math.round,Yn={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function sO(t,e,s,n,i){return i.relativeTime(e||1,!!s,t,n)}function nO(t,e,s,n){var i=Bt(t).abs(),r=fs(i.as("s")),a=fs(i.as("m")),o=fs(i.as("h")),c=fs(i.as("d")),d=fs(i.as("M")),u=fs(i.as("w")),h=fs(i.as("y")),f=r<=s.ss&&["s",r]||r<s.s&&["ss",r]||a<=1&&["m"]||a<s.m&&["mm",a]||o<=1&&["h"]||o<s.h&&["hh",o]||c<=1&&["d"]||c<s.d&&["dd",c];return s.w!=null&&(f=f||u<=1&&["w"]||u<s.w&&["ww",u]),f=f||d<=1&&["M"]||d<s.M&&["MM",d]||h<=1&&["y"]||["yy",h],f[2]=e,f[3]=+t>0,f[4]=n,sO.apply(null,f)}function iO(t){return t===void 0?fs:typeof t=="function"?(fs=t,!0):!1}function rO(t,e){return Yn[t]===void 0?!1:e===void 0?Yn[t]:(Yn[t]=e,t==="s"&&(Yn.ss=e-1),!0)}function aO(t,e){if(!this.isValid())return this.localeData().invalidDate();var s=!1,n=Yn,i,r;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(s=t),typeof e=="object"&&(n=Object.assign({},Yn,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),r=nO(this,!s,n,i),s&&(r=i.pastFuture(+this,r)),i.postformat(r)}var Yl=Math.abs;function Ln(t){return(t>0)-(t<0)||+t}function Yo(){if(!this.isValid())return this.localeData().invalidDate();var t=Yl(this._milliseconds)/1e3,e=Yl(this._days),s=Yl(this._months),n,i,r,a,o=this.asSeconds(),c,d,u,h;return o?(n=Tt(t/60),i=Tt(n/60),t%=60,n%=60,r=Tt(s/12),s%=12,a=t?t.toFixed(3).replace(/\.?0+$/,""):"",c=o<0?"-":"",d=Ln(this._months)!==Ln(o)?"-":"",u=Ln(this._days)!==Ln(o)?"-":"",h=Ln(this._milliseconds)!==Ln(o)?"-":"",c+"P"+(r?d+r+"Y":"")+(s?d+s+"M":"")+(e?u+e+"D":"")+(i||n||t?"T":"")+(i?h+i+"H":"")+(n?h+n+"M":"")+(t?h+a+"S":"")):"P0D"}var be=Ho.prototype;be.isValid=Q5;be.abs=EA;be.add=AA;be.subtract=OA;be.as=LA;be.asMilliseconds=tb;be.asSeconds=FA;be.asMinutes=IA;be.asHours=VA;be.asDays=WA;be.asWeeks=BA;be.asMonths=zA;be.asQuarters=HA;be.asYears=$A;be.valueOf=YA;be._bubble=RA;be.clone=UA;be.get=GA;be.milliseconds=qA;be.seconds=KA;be.minutes=XA;be.hours=ZA;be.days=JA;be.weeks=tO;be.months=QA;be.years=eO;be.humanize=aO;be.toISOString=Yo;be.toString=Yo;be.toJSON=Yo;be.locale=z0;be.localeData=$0;be.toIsoString=Pt("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Yo);be.lang=H0;J("X",0,0,"unix");J("x",0,0,"valueOf");G("x",Vo);G("X",TD);Ne("X",function(t,e,s){s._d=new Date(parseFloat(t)*1e3)});Ne("x",function(t,e,s){s._d=new Date(ye(t))});W.version="2.30.1";oD(Pe);W.fn=I;W.min=K5;W.max=X5;W.now=Z5;W.utc=ss;W.unix=jA;W.months=TA;W.isDate=Rr;W.locale=Hs;W.invalid=Ro;W.duration=Bt;W.isMoment=Wt;W.weekdays=CA;W.parseZone=NA;W.localeData=Ts;W.isDuration=Ea;W.monthsShort=MA;W.weekdaysMin=DA;W.defineLocale=_u;W.updateLocale=N5;W.locales=T5;W.weekdaysShort=PA;W.normalizeUnits=Dt;W.relativeTimeRounding=iO;W.relativeTimeThreshold=rO;W.calendarFormat=wE;W.prototype=I;W.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const oO={datetime:"MMM D, YYYY, h:mm:ss a",millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"};jg._date.override(typeof W=="function"?{_id:"moment",formats:function(){return oO},parse:function(t,e){return typeof t=="string"&&typeof e=="string"?t=W(t,e):t instanceof W||(t=W(t)),t.isValid()?t.valueOf():null},format:function(t,e){return W(t).format(e)},add:function(t,e,s){return W(t).add(e,s).valueOf()},diff:function(t,e,s){return W(t).diff(W(e),s)},startOf:function(t,e,s){return t=W(t),e==="isoWeek"?(s=Math.trunc(Math.min(Math.max(0,s),6)),t.isoWeekday(s).startOf("day").valueOf()):t.startOf(e).valueOf()},endOf:function(t,e){return W(t).endOf(e).valueOf()}}:{});Ct.register(Mr,Cr,ri,Ns,md,ko,oi,ai,Ua);function lO(){const[t,e]=y.useState(null),[s,n]=y.useState(null),[i,r]=y.useState(""),[a,o]=y.useState(!1),[c,d]=y.useState(!1),[u,h]=y.useState(3),[f,m]=y.useState(!1),[p,g]=y.useState("load"),[x,v]=y.useState("forecast"),[_,S]=y.useState(!1),[N,j]=y.useState(!1),[k,T]=y.useState(!1),[M,P]=y.useState(!1),[O,A]=y.useState(!1),[F,X]=y.useState(!1),[H,Z]=y.useState(null),Q=async()=>{o(!0);try{const q=await K.aurora.dashboard();e(q);const ke=q.state?.risk_profile?.risk_appetite;typeof ke=="number"&&h(ke),S(!!q.state?.auto_tune_enabled),T(!!q.state?.reflex_enabled),A(q.state?.risk_profile?.mode==="probabilistic")}catch(q){console.error("Failed to load Aurora dashboard:",q)}finally{o(!1)}};y.useEffect(()=>{Q(),(async()=>{try{const ke=await K.schedulerStatus();n(ke)}catch(ke){console.error("Failed to load scheduler status:",ke)}})()},[]),y.useEffect(()=>{(async()=>{try{const ke=await K.performanceData(7);Z(ke)}catch(ke){console.error("Failed to load performance data:",ke)}})()},[]);const Y=async()=>{if(t){d(!0);try{const q=await K.aurora.briefing(t);r(q.briefing)}catch(q){console.error("Failed to fetch Aurora briefing:",q),r("Failed to fetch Aurora briefing.")}finally{d(!1)}}},oe=async q=>{h(q);try{await K.configSave({s_index:{risk_appetite:q}})}catch(ke){console.error("Failed to save risk level (risk_appetite):",ke)}},ue=async()=>{const q=!_;S(q),j(!0);try{await K.configSave({learning:{auto_tune_enabled:q}})}catch(ke){console.error("Failed to toggle auto-tune:",ke),S(!q)}finally{j(!1)}},Se=async()=>{const q=!k;T(q),P(!0);try{await K.aurora.toggleReflex(q)}catch(ke){console.error("Failed to toggle reflex:",ke),T(!q)}finally{P(!1)}},We=async()=>{const q=!O;A(q),X(!0);try{await K.configSave({s_index:{mode:q?"probabilistic":"dynamic"}})}catch(ke){console.error("Failed to toggle probabilistic mode:",ke),A(!q)}finally{X(!1)}},$=t?.identity?.graduation?.label??"infant",ee=t?.state?.weather_volatility,D=ee?.overall??0,R=D<.3?"bg-emerald-400/90":D<.7?"bg-sky-400/90":"bg-amber-400/90",B=D<.3?"from-emerald-900/60 via-surface to-surface":D<.7?"from-sky-900/60 via-surface to-surface":"from-amber-900/60 via-surface to-surface",ae=t?.horizon?.slots??[],he=t?.horizon?.end??new Date().toISOString(),je=t?.history?.strategy_events??[],Le=y.useMemo(()=>!H||!H.soc_series||H.soc_series.length===0?null:{datasets:[{label:"Planned",data:H.soc_series.map(q=>({x:q.time,y:q.planned})),borderColor:"#94a3b8",borderDash:[5,5],borderWidth:1.5,pointRadius:0,tension:.4},{label:"Actual",data:H.soc_series.map(q=>({x:q.time,y:q.actual})),borderColor:"#60a5fa",backgroundColor:"rgba(96, 165, 250, 0.1)",borderWidth:1.5,pointRadius:0,fill:!0,tension:.4}]},[H]),gt=y.useMemo(()=>!H||!H.cost_series||H.cost_series.length===0?null:{labels:H.cost_series.map(q=>q.date.slice(5)),datasets:[{label:"Plan",data:H.cost_series.map(q=>q.planned),backgroundColor:"#94a3b8",borderRadius:2},{label:"Real",data:H.cost_series.map(q=>q.realized),backgroundColor:H.cost_series.map(q=>q.realized<=q.planned?"#34d399":"#f87171"),borderRadius:2}]},[H]);return l.jsxs("div",{className:"px-4 pt-16 pb-10 lg:px-8 lg:pt-10 space-y-6",children:[l.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3",children:l.jsxs("div",{children:[l.jsxs("h1",{className:"text-lg font-medium text-text flex items-center gap-2",children:["Aurora Command Center",l.jsx("span",{className:"px-2 py-0.5 rounded-full bg-surface2 border border-line/50 text-[10px] text-muted uppercase tracking-wider",children:$})]}),l.jsx("p",{className:"text-[11px] text-muted",children:"The Mastermind. Observing context, managing risk, and learning from reality."})]})}),l.jsxs("div",{className:"grid gap-4 lg:grid-cols-12",children:[l.jsx(de,{className:`lg:col-span-6 p-4 md:p-5 bg-gradient-to-br ${B} relative overflow-hidden`,children:l.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row gap-6",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"relative flex items-center justify-center",children:[l.jsx("div",{className:`absolute h-16 w-16 rounded-full ${R} opacity-30 animate-pulse`}),l.jsx("div",{className:"relative flex items-center justify-center w-14 h-14 rounded-full bg-surface/90 border border-line/80 shadow-float ring-2 ring-accent/20",children:l.jsx(Jl,{className:"h-8 w-8 text-accent drop-shadow-[0_0_12px_rgba(56,189,248,0.75)]"})})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs font-semibold text-text uppercase tracking-wide",children:"Status"}),l.jsx("div",{className:"text-lg font-medium text-text",children:D>.6?"Defensive Mode":D>.3?"Cautious Mode":"Optimal Mode"}),l.jsxs("div",{className:"text-[11px] text-muted flex items-center gap-2",children:[l.jsx("span",{className:`h-1.5 w-1.5 rounded-full ${D>.6?"bg-amber-400":"bg-emerald-400"}`}),D>.6?"High Volatility Detected":"Conditions Stable"]})]})]}),l.jsxs("div",{className:"flex-1 bg-surface/40 rounded-xl p-3 border border-white/5 backdrop-blur-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-text font-medium",children:[l.jsx(Wp,{className:"h-3 w-3 text-accent"}),"Daily Briefing"]}),l.jsx("button",{onClick:Y,disabled:!t||c,className:"text-[10px] text-muted hover:text-accent disabled:opacity-50 transition-colors",children:c?"Thinking...":"Refresh"})]}),l.jsx("div",{className:"text-[11px] leading-relaxed text-muted/90 font-mono",children:i||"Aurora is analyzing current market and weather conditions..."})]})]})}),l.jsxs(de,{className:"lg:col-span-3 p-4 md:p-5 flex flex-col justify-center",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("span",{className:"text-[10px] uppercase font-bold text-muted tracking-wider",children:"Risk Appetite"}),l.jsxs("div",{className:"flex items-center gap-2",children:[t?.state?.risk_profile?.raw_factor!=null&&(t.state.risk_profile.raw_factor??0)>0&&l.jsxs("span",{className:"text-[9px] text-muted/60",title:"Calculated based on risk",children:["Calc: ",(t.state.risk_profile.raw_factor??0).toFixed(2)]}),l.jsxs("span",{className:"text-[9px] text-muted",title:"Proected factor for next run",children:["Applied: ",(t?.state?.risk_profile?.current_factor??1).toFixed(2)]})]})]}),l.jsxs("div",{className:"flex flex-col gap-3",children:[l.jsx("div",{className:"grid grid-cols-5 gap-1 p-1 bg-surface2/50 rounded-lg border border-line/30",children:[1,2,3,4,5].map(q=>{const ke=u===q;let Ee="bg-surface border-line text-text shadow-sm";return ke&&(q===1?Ee="bg-emerald-500/20 border-emerald-500/50 text-emerald-100 shadow-[0_0_10px_rgba(16,185,129,0.2)]":q===2?Ee="bg-teal-500/20 border-teal-500/50 text-teal-100":q===3?Ee="bg-blue-500/20 border-blue-500/50 text-blue-100":q===4?Ee="bg-amber-500/20 border-amber-500/50 text-amber-100":q===5&&(Ee="bg-red-500/20 border-red-500/50 text-red-100 shadow-[0_0_10px_rgba(239,68,68,0.2)]")),l.jsx("button",{onClick:()=>oe(q),className:`
                       relative flex items-center justify-center h-9 rounded-md text-[10px] font-medium transition-all duration-200
                       border border-transparent
                       ${ke?Ee:"text-muted hover:bg-surface/50 hover:text-text"}
                     `,children:q},q)})}),l.jsxs("div",{className:"text-center h-8 flex flex-col justify-center",children:[l.jsx("span",{className:`text-[11px] font-medium transition-colors duration-300 ${u===1?"text-emerald-400":u===2?"text-teal-400":u===3?"text-blue-400":u===4?"text-amber-400":"text-red-400"}`,children:{1:"Safety First",2:"Conservative",3:"Neutral (Balanced)",4:"Aggressive",5:"Gambler"}[u]}),l.jsx("span",{className:"text-[9px] text-muted/70",children:{1:"Covers Worst Case (p90)",2:"Covers High Load (p75)",3:"Trusts the Mean (p50)",4:"Expects Lower Load",5:"Bets on Sun/Empty"}[u]})]})]}),l.jsxs("div",{className:"mt-4 pt-3 border-t border-line/30 flex flex-col items-center gap-2",children:[l.jsx("button",{onClick:async()=>{m(!0);try{await oe(u),await K.runPlanner(),await Q()}finally{m(!1)}},disabled:f,className:`flex items-center gap-2 px-3 py-1.5 rounded-full bg-surface hover:bg-surface2 border border-line/50 text-[10px] transition-colors ${f?"opacity-70 cursor-not-allowed text-muted":"text-muted hover:text-text"}`,title:"Run Strategy Engine to update forecast based on new risk",children:f?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"h-3 w-3 border-2 border-accent/30 border-t-accent rounded-full animate-spin"}),l.jsx("span",{children:"Re-planning..."})]}):l.jsxs(l.Fragment,{children:[l.jsx(It,{className:"h-3 w-3 text-accent"}),l.jsx("span",{children:"Apply & Re-Plan"})]})}),f&&l.jsx("span",{className:"text-[9px] text-muted/70 animate-pulse",children:"Regenerating schedule with new risk level..."})]})]}),l.jsxs(de,{className:"lg:col-span-3 p-4 md:p-5 flex flex-col",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(It,{className:"h-4 w-4 text-accent"}),l.jsx("span",{className:"text-xs font-medium text-text",children:"Controls"})]}),l.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-surface2/50 border border-line/50",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-[11px] font-medium text-text",children:"Auto-Tuner"}),l.jsx("span",{className:"text-[9px] text-muted",children:"Allow Aurora to act"})]}),l.jsx("button",{onClick:ue,disabled:N,className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-2 focus:ring-offset-surface ${_?"bg-accent":"bg-surface2"}`,children:l.jsx("span",{className:`${_?"translate-x-5":"translate-x-1"} inline-block h-3 w-3 transform rounded-full bg-white transition-transform`})})]}),l.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-surface2/50 border border-line/50 mt-2",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-[11px] font-medium text-text",children:"Aurora Reflex"}),l.jsx("span",{className:"text-[9px] text-muted",children:"Long-term auto-tuning"})]}),l.jsx("button",{onClick:Se,disabled:M,className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-2 focus:ring-offset-surface ${k?"bg-accent":"bg-surface2"}`,children:l.jsx("span",{className:`${k?"translate-x-5":"translate-x-1"} inline-block h-3 w-3 transform rounded-full bg-white transition-transform`})})]}),l.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-surface2/50 border border-line/50 mt-2",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-[11px] font-medium text-text",children:"Probabilistic"}),l.jsx("span",{className:"text-[9px] text-muted",children:"Use p10/p90 confidence bands"})]}),l.jsx("button",{onClick:We,disabled:F,className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-2 focus:ring-offset-surface ${O?"bg-accent":"bg-surface2"}`,children:l.jsx("span",{className:`${O?"translate-x-5":"translate-x-1"} inline-block h-3 w-3 transform rounded-full bg-white transition-transform`})})]}),l.jsx("div",{className:"mt-auto pt-2 text-center text-[10px] text-muted",children:"More controls coming soon."})]})]}),l.jsx(rD,{metrics:t?.metrics,perfData:H}),l.jsxs("div",{className:"grid gap-4 lg:grid-cols-12 lg:h-[450px]",children:[l.jsxs(de,{className:"lg:col-span-4 p-4 flex flex-col h-full min-h-0 overflow-hidden",children:[l.jsx("div",{className:"mb-4 flex items-center justify-between shrink-0",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(rr,{className:"h-4 w-4 text-accent"}),l.jsx("span",{className:"text-xs font-medium text-text",children:"Context Radar"})]})}),l.jsx("div",{className:"flex-1 min-h-0 relative",children:l.jsx(nD,{weatherVolatility:{cloud:ee?.cloud_volatility??0,temp:ee?.temp_volatility??0,overall:D},riskFactor:u??3,forecastAccuracy:t?.metrics?.mae_pv_aurora!=null?Math.max(0,100-t.metrics.mae_pv_aurora*20):85,priceSpread:t?.metrics?.max_price_spread,forecastBias:t?.metrics?.forecast_bias})})]}),l.jsxs(de,{className:"lg:col-span-4 p-4 flex flex-col h-full min-h-0 overflow-hidden",children:[l.jsxs("div",{className:"mb-4 flex items-center justify-between shrink-0",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ap,{className:"h-4 w-4 text-accent"}),l.jsx("span",{className:"text-xs font-medium text-text",children:"Activity Log"})]}),l.jsxs("div",{className:"flex flex-col items-end",children:[l.jsxs("span",{className:"text-[10px] text-muted",children:[je.length," events"]}),s?.ml_training_last_run_at&&l.jsxs("span",{className:"text-[9px] text-muted/70",title:"Last ML Training Run",children:["ML Train:"," ",new Date(s.ml_training_last_run_at).toLocaleString("sv-SE",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})]})]})]}),l.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto pr-2 custom-scrollbar",children:l.jsx(iD,{events:je})})]}),l.jsxs(de,{className:"lg:col-span-4 p-4 md:p-5 flex flex-col h-full min-h-0 overflow-hidden",children:[l.jsxs("div",{className:"mb-4 shrink-0",children:[l.jsx("div",{className:"text-xs font-medium text-text",children:"Cost Reality"}),l.jsx("div",{className:"text-[11px] text-muted",children:"Daily financial outcome"})]}),l.jsx("div",{className:"flex-1 min-h-0",children:gt&&l.jsx(tD,{data:gt,options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{grid:{display:!1},ticks:{color:"#94a3b8",font:{size:10}}},y:{grid:{color:"#334155"},ticks:{color:"#94a3b8"}}},plugins:{legend:{labels:{color:"#e2e8f0",font:{size:10}}}}}})})]})]}),l.jsx("div",{className:"grid gap-4 lg:grid-cols-12",children:l.jsxs(de,{className:"lg:col-span-12 p-4 flex flex-col h-[350px] overflow-hidden",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3 shrink-0",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-xs font-medium text-text",children:x==="forecast"?"Forecast Horizon (48h)":"SoC Tunnel"}),l.jsxs("div",{className:"text-[11px] text-muted",children:[x==="forecast"?O?`Probabilistic View (${p.toUpperCase()})`:`Decomposition View (${p.toUpperCase()})`:"Plan vs Reality",x==="forecast"&&l.jsxs(l.Fragment,{children:["  ",new Date().toISOString().slice(0,10)," -"," ",new Date(he).toISOString().slice(0,10)]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-line/70 bg-surface2 px-1 py-0.5 text-[11px] mr-2",children:[l.jsx("button",{className:`px-3 py-0.5 rounded-full ${x==="forecast"?"bg-accent text-[#0F1216]":"text-muted"}`,onClick:()=>v("forecast"),children:"Forecast"}),l.jsx("button",{className:`px-3 py-0.5 rounded-full ${x==="soc"?"bg-accent text-[#0F1216]":"text-muted"}`,onClick:()=>v("soc"),children:"SoC"})]}),x==="forecast"&&l.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-line/70 bg-surface2 px-1 py-0.5 text-[11px]",children:[l.jsx("button",{type:"button",className:`px-2 py-0.5 rounded-full ${p==="load"?"bg-accent text-[#0F1216]":"text-muted"}`,onClick:()=>g("load"),children:l.jsx(It,{className:"h-3 w-3"})}),l.jsx("button",{type:"button",className:`px-2 py-0.5 rounded-full ${p==="pv"?"bg-accent text-[#0F1216]":"text-muted"}`,onClick:()=>g("pv"),children:l.jsx(Bp,{className:"h-3 w-3"})})]})]})]}),l.jsx("div",{className:"flex-1 min-h-0",children:a?l.jsx("div",{className:"text-[11px] text-muted",children:"Loading..."}):x==="soc"?l.jsx("div",{className:"h-full w-full",children:Le&&l.jsx(ou,{data:Le,options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},scales:{x:{type:"time",time:{unit:"hour",displayFormats:{hour:"HH:mm"}},grid:{color:"#334155",display:!1},ticks:{color:"#94a3b8",maxTicksLimit:6}},y:{min:0,max:100,grid:{color:"#334155"},ticks:{color:"#94a3b8",display:!1}}},plugins:{legend:{display:!1}}}})}):O?l.jsx("div",{className:"h-full w-full",children:l.jsx(aD,{title:"",color:p==="load"?"#f97316":"#22c55e",slots:(()=>{const q=t?.horizon?.history_series?.[p==="load"?"load":"pv"]||[],ke=ae.map(fe=>p==="load"?{time:fe.slot_start,p10:fe.probabilistic?.load_p10??null,p50:fe.final.load_kwh,p90:fe.probabilistic?.load_p90??null,actual:null}:{time:fe.slot_start,p10:fe.probabilistic?.pv_p10??null,p50:fe.final.pv_kwh,p90:fe.probabilistic?.pv_p90??null,actual:null}),Ee=new Map;q.forEach(fe=>{Ee.set(fe.slot_start,{time:fe.slot_start,p10:fe.p10??null,p50:fe.forecast??null,p90:fe.p90??null,actual:fe.actual})}),ke.forEach(fe=>{const Je=Ee.get(fe.time);Je?Ee.set(fe.time,{...Je,p10:fe.p10,p50:fe.p50,p90:fe.p90}):Ee.set(fe.time,fe)});const zt=new Date().getTime(),dt=1440*60*1e3;return Array.from(Ee.values()).sort((fe,Je)=>new Date(fe.time).getTime()-new Date(Je.time).getTime()).filter(fe=>{const Je=new Date(fe.time).getTime();return Je>=zt-dt&&Je<=zt+dt})})()})}):l.jsx(Pa,{slots:ae,mode:p})})]})})]})}function Ri({data:t,colorClass:e="bg-accent",height:s=32,bars:n=12}){const i=y.useMemo(()=>{if(!t||t.length===0)return Array(n).fill(.2);const r=t.slice(-n),a=Math.max(...r,1),o=Math.min(...r,0),c=a-o||1;return r.map(d=>.1+.9*((d-o)/c))},[t,n]);return l.jsx("div",{className:"mini-bars",style:{height:s},children:i.map((r,a)=>l.jsx("div",{className:`mini-bar ${e}`,style:{height:`${Math.round(r*100)}%`}},a))})}const Yt={status:async()=>{const t=await fetch("api/executor/status");if(!t.ok)throw new Error(`Status failed: ${t.status}`);return t.json()},toggle:async t=>{const e=await fetch("api/executor/toggle",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok)throw new Error(`Toggle failed: ${e.status}`);return e.json()},run:async()=>{const t=await fetch("api/executor/run",{method:"POST"});if(!t.ok)throw new Error(`Run failed: ${t.status}`);return t.json()},history:async(t=20)=>{const e=await fetch(`api/executor/history?limit=${t}`);if(!e.ok)throw new Error(`History failed: ${e.status}`);return e.json()},stats:async(t=7)=>{const e=await fetch(`api/executor/stats?days=${t}`);if(!e.ok)throw new Error(`Stats failed: ${e.status}`);return e.json()},live:async()=>{const t=await fetch("api/executor/live");if(!t.ok)throw new Error(`Live failed: ${t.status}`);return t.json()},notifications:{get:async()=>{const t=await fetch("api/executor/notifications");if(!t.ok)throw new Error(`Notifications failed: ${t.status}`);return t.json()},update:async t=>{const e=await fetch("api/executor/notifications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok)throw new Error(`Notifications update failed: ${e.status}`);return e.json()},test:async()=>{const t=await fetch("api/executor/notifications/test",{method:"POST"}),e=await t.json();if(!t.ok)throw new Error(e.error||`Test failed: ${t.status}`);return e}},config:{get:async()=>{const t=await fetch("api/executor/config");if(!t.ok)throw new Error(`Config get failed: ${t.status}`);return t.json()},update:async t=>{const e=await fetch("api/executor/config",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok)throw new Error(`Config update failed: ${e.status}`);return e.json()}},quickAction:{get:async()=>{const t=await fetch("api/executor/quick-action");if(!t.ok)throw new Error(`Quick action get failed: ${t.status}`);return t.json()},set:async(t,e)=>{const s=await fetch("api/executor/quick-action",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:t,duration_minutes:e})});if(!s.ok)throw new Error(`Quick action set failed: ${s.status}`);return s.json()},clear:async()=>{const t=await fetch("api/executor/quick-action",{method:"DELETE"});if(!t.ok)throw new Error(`Quick action clear failed: ${t.status}`);return t.json()}}};function Ul({enabled:t,onChange:e,disabled:s=!1,size:n="md"}){const i=n==="sm"?"h-5 w-9":"h-6 w-11",r=n==="sm"?"h-3 w-3":"h-4 w-4",a=n==="sm"?t?"translate-x-5":"translate-x-1":t?"translate-x-6":"translate-x-1";return l.jsx("button",{type:"button",role:"switch","aria-checked":t,disabled:s,onClick:()=>e(!t),className:`relative inline-flex items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-2 focus:ring-offset-surface ${i} ${t?"bg-accent":"bg-surface2"} ${s?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:l.jsx("span",{className:`inline-block transform rounded-full bg-white transition-transform ${r} ${a}`})})}Ct.register(Mr,Cr,ri,Ns,ko,oi,ai,wo);function cO(){const[t,e]=y.useState(null),[s,n]=y.useState(null),[i,r]=y.useState([]),[a,o]=y.useState(null),[c,d]=y.useState({soc:[],pv:[],load:[],import:[],export:[],labels:[]}),[u,h]=y.useState(!0),[f,m]=y.useState(!1),[p,g]=y.useState(!1),[x,v]=y.useState(null),[_,S]=y.useState(!1),[N,j]=y.useState(null),[k,T]=y.useState(!1),[M,P]=y.useState(!1),[O,A]=y.useState(null),[F,X]=y.useState(null),H=y.useCallback(async()=>{try{const[D,R,B]=await Promise.all([Yt.status(),Yt.stats(7),Yt.history(20)]);e(D),n(R),r(B.records??[]),v(null)}catch(D){v(D.message||"Failed to load executor data")}finally{h(!1)}},[]);$n("live_metrics",D=>{o(R=>{const B={...R||{}};return D.soc!==void 0&&(B.soc={value:`${D.soc.toFixed(0)}%`,numeric:D.soc,unit:"%"}),D.pv_kw!==void 0&&(B.pv_power={value:`${D.pv_kw.toFixed(1)} kW`,numeric:D.pv_kw*1e3,unit:"W"}),D.load_kw!==void 0&&(B.load_power={value:`${D.load_kw.toFixed(1)} kW`,numeric:D.load_kw*1e3,unit:"W"}),D.grid_import_kw!==void 0&&(B.grid_import={value:`${D.grid_import_kw.toFixed(2)} kW`,numeric:D.grid_import_kw*1e3,unit:"W"}),D.grid_export_kw!==void 0&&(B.grid_export={value:`${D.grid_export_kw.toFixed(2)} kW`,numeric:D.grid_export_kw*1e3,unit:"W"}),D.work_mode&&(B.work_mode={value:D.work_mode}),B}),d(R=>{const ae=[...R.labels,""],he=[...R.soc,D.soc??R.soc[R.soc.length-1]??0],je=[...R.pv,D.pv_kw??R.pv[R.pv.length-1]??0],Le=[...R.load,D.load_kw??R.load[R.load.length-1]??0],gt=[...R.import,D.grid_import_kw??R.import[R.import.length-1]??0],q=[...R.export,D.grid_export_kw??R.export[R.export.length-1]??0];return ae.length>20&&(ae.shift(),he.shift(),je.shift(),Le.shift(),gt.shift(),q.shift()),{labels:ae,soc:he,pv:je,load:Le,import:gt,export:q}})}),$n("executor_status",D=>{e(D)}),y.useEffect(()=>{h(!0),H();const D=setInterval(H,3e4);return()=>clearInterval(D)},[H]),y.useEffect(()=>{(async()=>{try{const R=await Yt.live(),B={};R.soc!==void 0&&(B.soc={value:`${Number(R.soc).toFixed(0)}%`,numeric:Number(R.soc),unit:"%"}),R.pv_kw!==void 0&&(B.pv_power={value:`${Number(R.pv_kw).toFixed(1)} kW`,numeric:Number(R.pv_kw)*1e3,unit:"W"}),R.load_kw!==void 0&&(B.load_power={value:`${Number(R.load_kw).toFixed(1)} kW`,numeric:Number(R.load_kw)*1e3,unit:"W"}),R.grid_import_kw!==void 0&&(B.grid_import={value:`${Number(R.grid_import_kw).toFixed(2)} kW`,numeric:Number(R.grid_import_kw)*1e3,unit:"W"}),R.grid_export_kw!==void 0&&(B.grid_export={value:`${Number(R.grid_export_kw).toFixed(2)} kW`,numeric:Number(R.grid_export_kw)*1e3,unit:"W"}),R.work_mode&&(B.work_mode={value:R.work_mode}),o(B)}catch(R){console.error("Failed to load initial live metrics",R)}})()},[]),y.useEffect(()=>{(async()=>{try{const R=await Yt.notifications.get();j(R)}catch{}})()},[]);const Z=async(D,R)=>{if(N){T(!0);try{await Yt.notifications.update({[D]:R}),j(B=>B?{...B,[D]:R}:null)}catch(B){v(B.message)}finally{T(!1)}}},Q=async D=>{m(!0);try{await Yt.toggle({enabled:D}),await H()}catch(R){v(R.message)}finally{m(!1)}},Y=async()=>{P(!0),A(null);try{const D=await Yt.notifications.test();A({success:!0,message:D.message||"Test sent!"})}catch(D){A({success:!1,message:D.message})}finally{P(!1)}},oe=async D=>{m(!0);try{await Yt.toggle({shadow_mode:D}),await H()}catch(R){v(R.message)}finally{m(!1)}},ue=async()=>{g(!0);try{await Yt.run(),await H()}catch(D){v(D.message)}finally{g(!1)}},Se=D=>{if(!D)return"";try{return new Date(D).toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit"})}catch{return D}},We=D=>{if(!D)return"";try{return new Date(D).toLocaleString("sv-SE",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return D}},$=t?.enabled?t?.shadow_mode?"from-warn-900/60 via-surface to-surface":"from-good-900/60 via-surface to-surface":"from-neutral-800/60 via-surface to-surface",ee=t?.enabled?t?.shadow_mode?"bg-warn/90":"bg-good/90":"bg-neutral/90";return u?l.jsx("div",{className:"px-4 pt-16 pb-10 lg:px-8 lg:pt-10 space-y-6",children:l.jsxs("div",{className:"animate-pulse space-y-4",children:[l.jsx("div",{className:"h-10 bg-surface2 rounded w-48"}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[l.jsx("div",{className:"h-64 bg-surface2 rounded"}),l.jsx("div",{className:"h-64 bg-surface2 rounded lg:col-span-2"})]})]})}):l.jsxs("div",{className:"px-4 pt-16 pb-10 lg:px-8 lg:pt-10 space-y-6",children:[l.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3",children:l.jsxs("div",{children:[l.jsxs("h1",{className:"text-lg font-medium text-text flex items-center gap-2",children:["Executor Control Center",l.jsx("span",{className:`px-2 py-0.5 rounded-full border text-[10px] uppercase tracking-wider ${t?.enabled?t?.shadow_mode?"bg-warn/20 border-warn/50 text-warn":"bg-good/20 border-good/50 text-good":"bg-neutral/20 border-neutral/50 text-neutral"}`,children:t?.enabled?t?.shadow_mode?"Shadow":"Active":"Disabled"})]}),l.jsx("p",{className:"text-[11px] text-muted",children:"Native execution engine  controls inverter and water heater based on the schedule."})]})}),x&&l.jsxs("div",{className:"rounded-xl p-3 bg-bad/10 border border-bad/30 flex items-center gap-3",children:[l.jsx(va,{className:"h-4 w-4 text-bad"}),l.jsx("span",{className:"text-bad text-[11px] flex-1",children:x}),l.jsx("button",{onClick:()=>v(null),className:"text-bad hover:text-bad/80 text-lg",children:""})]}),l.jsxs("div",{className:"grid gap-4 lg:grid-cols-12",children:[l.jsxs(de,{className:`lg:col-span-5 p-4 md:p-5 bg-gradient-to-br ${$} relative overflow-hidden`,children:[l.jsxs("div",{className:"relative z-10 flex items-start gap-4",children:[l.jsxs("div",{className:"relative flex items-center justify-center shrink-0",children:[l.jsx("div",{className:`absolute h-14 w-14 rounded-full ${ee} opacity-30 animate-pulse`}),l.jsx("div",{className:"relative flex items-center justify-center w-12 h-12 rounded-full bg-surface/90 border border-line/80 shadow-float ring-2 ring-accent/20",children:l.jsx(Ql,{className:"h-6 w-6 text-accent drop-shadow-[0_0_12px_rgba(56,189,248,0.75)]"})})]}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-xs font-semibold text-text uppercase tracking-wide",children:"Status"}),l.jsx("div",{className:"text-lg font-medium text-text",children:t?.enabled?t?.shadow_mode?"Shadow Mode":"Executing":"Standby"}),l.jsxs("div",{className:"text-[11px] text-muted flex items-center gap-2 mt-1",children:[l.jsx("span",{className:`h-1.5 w-1.5 rounded-full ${t?.last_run_status==="success"?"bg-good":t?.last_run_status==="error"?"bg-bad":"bg-neutral"}`}),t?.last_run_status==="success"?"Last run successful":t?.last_run_status==="error"?"Last run failed":"No runs yet"]})]})]}),l.jsxs("div",{className:"mt-4 pt-3 border-t border-line/10 grid grid-cols-3 gap-3",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-[10px] text-muted/70 uppercase",children:"Last Run"}),l.jsx("div",{className:"text-sm font-mono text-text",children:Se(t?.last_run_at)})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[10px] text-muted/70 uppercase",children:"Next Run"}),l.jsx("div",{className:"text-sm font-mono text-text",children:Se(t?.next_run_at)})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[10px] text-muted/70 uppercase",children:"Version"}),l.jsx("div",{className:"text-sm font-mono text-text",children:t?.version||""})]})]}),t?.override_active&&l.jsx("div",{className:"mt-3 p-2 rounded-lg bg-warn/20 border border-warn/30",children:l.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-warn",children:[l.jsx(va,{className:"h-3.5 w-3.5"}),l.jsx("span",{className:"font-medium",children:"Override Active:"}),l.jsx("span",{children:t.override_type})]})})]}),l.jsxs(de,{className:"lg:col-span-4 p-4 md:p-5 flex flex-col",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(Fa,{className:"h-4 w-4 text-accent"}),l.jsx("span",{className:"text-xs font-medium text-text",children:"Controls"})]}),l.jsxs("div",{className:"flex items-center justify-between p-2.5 rounded-lg bg-surface2/50 border border-line/50",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-[11px] font-medium text-text",children:"Executor Enabled"}),l.jsx("span",{className:"text-[9px] text-muted",children:"Execute actions on Home Assistant"})]}),l.jsx(Ul,{enabled:t?.enabled??!1,onChange:Q,disabled:f,size:"sm"})]}),l.jsxs("div",{className:"flex items-center justify-between p-2.5 rounded-lg bg-surface2/50 border border-line/50 mt-2",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsxs("div",{className:"text-[11px] font-medium text-text flex items-center gap-1.5",children:["Shadow Mode",l.jsx(Dv,{className:"h-3 w-3 text-muted"})]}),l.jsx("span",{className:"text-[9px] text-muted",children:"Log only, don't execute actions"})]}),l.jsx(Ul,{enabled:t?.shadow_mode??!1,onChange:oe,disabled:f,size:"sm"})]}),l.jsxs("button",{onClick:()=>S(!0),className:"flex items-center justify-between p-2.5 rounded-lg bg-surface2/50 border border-line/50 mt-2 hover:bg-surface2 transition-colors w-full",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(rl,{className:"h-4 w-4 text-muted"}),l.jsx("span",{className:"text-[11px] font-medium text-text",children:"Notifications"})]}),N&&Object.entries(N).some(([D,R])=>D.startsWith("on_")&&R===!0)&&l.jsxs("div",{className:"relative",children:[l.jsx("span",{className:"absolute inset-0 rounded-full bg-accent/50 blur-sm animate-pulse"}),l.jsx("span",{className:"relative h-2.5 w-2.5 rounded-full bg-accent block ring-2 ring-accent/30"})]})]}),l.jsx("div",{className:"mt-auto pt-4",children:l.jsx("button",{onClick:ue,disabled:p,className:`w-full flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl bg-surface hover:bg-surface2 border border-line/50 text-[11px] font-medium transition-all ${p?"opacity-70 cursor-not-allowed text-muted":"text-text hover:border-accent/50"}`,children:p?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"h-3.5 w-3.5 border-2 border-accent/30 border-t-accent rounded-full animate-spin"}),l.jsx("span",{children:"Running..."})]}):l.jsxs(l.Fragment,{children:[l.jsx(Ip,{className:"h-3.5 w-3.5 text-accent"}),l.jsx("span",{children:"Run Now"})]})})})]}),l.jsxs(de,{className:"lg:col-span-3 p-4 md:p-5 flex flex-col",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(La,{className:"h-4 w-4 text-accent"}),l.jsx("span",{className:"text-xs font-medium text-text",children:"7-Day Stats"})]}),s&&l.jsxs("div",{className:"grid grid-cols-2 gap-3 flex-1",children:[l.jsxs("div",{className:"p-3 rounded-lg bg-surface2/30 border border-line/30",children:[l.jsx("div",{className:"text-xl font-bold text-text",children:s.total_executions}),l.jsx("div",{className:"text-[10px] text-muted",children:"Total Runs"})]}),l.jsxs("div",{className:"p-3 rounded-lg bg-good/10 border border-good/20",children:[l.jsxs("div",{className:"text-xl font-bold text-good",children:[s.success_rate,"%"]}),l.jsx("div",{className:"text-[10px] text-muted",children:"Success Rate"})]}),l.jsxs("div",{className:"p-3 rounded-lg bg-warn/10 border border-warn/20",children:[l.jsx("div",{className:"text-xl font-bold text-warn",children:s.override_count}),l.jsx("div",{className:"text-[10px] text-muted",children:"Overrides"})]}),l.jsxs("div",{className:"p-3 rounded-lg bg-bad/10 border border-bad/20",children:[l.jsx("div",{className:"text-xl font-bold text-bad",children:s.failed}),l.jsx("div",{className:"text-[10px] text-muted",children:"Failed"})]})]})]})]}),l.jsxs(de,{className:"p-4 md:p-5",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(rr,{className:"h-4 w-4 text-accent"}),l.jsx("span",{className:"text-xs font-medium text-text",children:"Live System"}),l.jsx("span",{className:"text-[9px] text-muted/70",children:"(every 10s)"})]}),a?.work_mode&&l.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full border ${a.work_mode.value.includes("Export")?t?.shadow_mode?"bg-warn/20 border-warn/30 text-warn":"bg-good/20 border-good/30 text-good":"bg-water/20 border-water/30 text-water"}`,children:a.work_mode.value})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[l.jsxs("div",{className:"metric-card-border metric-card-border-battery p-3 bg-surface2/30 relative overflow-hidden group",children:[l.jsx("div",{className:"mini-bars-container absolute right-2 bottom-2 transition-opacity pointer-events-none",children:l.jsx(Ri,{data:c.soc,colorClass:"bg-good"})}),l.jsxs("div",{className:"relative z-10 flex items-center gap-3",children:[l.jsx(fo,{className:`h-6 w-6 ${(a?.soc?.numeric??0)>50?"text-good":(a?.soc?.numeric??0)>20?"text-warn":"text-bad"}`}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-lg font-bold text-good",children:[a?.soc?.numeric?.toFixed(0)??"","%"]}),l.jsx("div",{className:"text-[10px] text-muted",children:"Battery SoC"})]})]})]}),l.jsxs("div",{className:"metric-card-border metric-card-border-solar p-3 bg-surface2/30 relative overflow-hidden group",children:[l.jsx("div",{className:"mini-bars-container absolute right-2 bottom-2 transition-opacity pointer-events-none",children:l.jsx(Ri,{data:c.pv,colorClass:"bg-accent"})}),l.jsxs("div",{className:"relative z-10 flex items-center gap-3",children:[l.jsx(jr,{className:`h-6 w-6 ${(a?.pv_power?.numeric??0)>500?"text-accent":"text-accent/40"}`}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-lg font-bold text-accent",children:[a?.pv_power?.numeric?(a.pv_power.numeric/1e3).toFixed(1):""," kW"]}),l.jsx("div",{className:"text-[10px] text-muted",children:"PV Power"})]})]})]}),l.jsxs("div",{className:"metric-card-border metric-card-border-house p-3 bg-surface2/30 relative overflow-hidden group",children:[l.jsx("div",{className:"mini-bars-container absolute right-2 bottom-2 transition-opacity pointer-events-none",children:l.jsx(Ri,{data:c.load,colorClass:"bg-house"})}),l.jsxs("div",{className:"relative z-10 flex items-center gap-3",children:[l.jsx(Fv,{className:"h-6 w-6 text-house"}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-lg font-bold text-house",children:[a?.load_power?.numeric?(a.load_power.numeric/1e3).toFixed(1):""," kW"]}),l.jsx("div",{className:"text-[10px] text-muted",children:"Load"})]})]})]}),l.jsxs("div",{className:"metric-card-border metric-card-border-grid p-3 bg-surface2/30 relative overflow-hidden group",children:[l.jsx("div",{className:"mini-bars-container absolute right-2 bottom-2 transition-opacity pointer-events-none",children:l.jsx(Ri,{data:c.import,colorClass:(a?.grid_import?.numeric??0)>100?"bg-bad":"bg-grid"})}),l.jsxs("div",{className:"relative z-10 flex items-center gap-3",children:[l.jsx(Dp,{className:`h-6 w-6 ${(a?.grid_import?.numeric??0)>100?"text-bad":"text-grid"}`}),l.jsxs("div",{children:[l.jsxs("div",{className:`text-lg font-bold ${(a?.grid_import?.numeric??0)>100?"text-bad":"text-text"}`,children:[a?.grid_import?.numeric?(a.grid_import.numeric/1e3).toFixed(2):""," kW"]}),l.jsx("div",{className:"text-[10px] text-muted",children:"Grid Import"})]})]})]}),l.jsxs("div",{className:"metric-card-border metric-card-border-bad p-3 bg-surface2/30 relative overflow-hidden group",children:[l.jsx("div",{className:"mini-bars-container absolute right-2 bottom-2 transition-opacity pointer-events-none",children:l.jsx(Ri,{data:c.export,colorClass:"bg-bad"})}),l.jsxs("div",{className:"relative z-10 flex items-center gap-3",children:[l.jsx(Ep,{className:"h-6 w-6 text-bad"}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-lg font-bold text-bad",children:[a?.grid_export?.numeric?(a.grid_export.numeric/1e3).toFixed(2):""," kW"]}),l.jsx("div",{className:"text-[10px] text-muted",children:"Grid Export"})]})]})]})]})]}),l.jsxs(de,{className:"p-4 md:p-5",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ev,{className:"h-4 w-4 text-accent"}),l.jsx("span",{className:"text-xs font-medium text-text",children:"Execution History"}),l.jsxs("span",{className:"text-[10px] text-muted",children:["(",i?.length??0," records)"]})]}),l.jsxs("button",{onClick:H,className:"flex items-center gap-1.5 text-[10px] text-muted hover:text-accent transition px-2 py-1 rounded-lg hover:bg-surface2",children:[l.jsx(Vp,{className:"h-3 w-3"}),"Refresh"]})]}),(i?.length??0)===0?l.jsxs("div",{className:"text-center py-12 text-muted",children:[l.jsx(Zu,{className:"h-10 w-10 mx-auto opacity-20 mb-3"}),l.jsx("p",{className:"text-[11px]",children:"No execution history yet."}),l.jsx("p",{className:"text-[10px] mt-1 text-muted/70",children:"Run the executor to see results here."})]}):l.jsxs("div",{className:"space-y-2 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:[t?.next_run_at&&l.jsxs("div",{className:"p-3 rounded-xl border-2 border-dashed border-line/30 bg-surface2/10 opacity-70",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Zu,{className:"h-4 w-4 text-muted animate-pulse"}),l.jsxs("span",{className:"text-[11px] text-muted font-mono",children:["Next: ",Se(t.next_run_at)]})]}),l.jsx("span",{className:"text-[9px] text-muted/70 bg-surface2/50 px-2 py-0.5 rounded-full",children:"Scheduled"})]}),t.current_slot_plan&&l.jsxs("div",{className:"mt-2 grid grid-cols-4 gap-2 text-[10px]",children:[t.current_slot_plan.charge_kw>0&&l.jsxs("div",{className:"flex items-center gap-1 text-good",children:[l.jsx(Sr,{className:"h-3 w-3"}),l.jsxs("span",{children:[t.current_slot_plan.charge_kw.toFixed(1),"kW"]})]}),t.current_slot_plan.export_kw>0&&l.jsxs("div",{className:"flex items-center gap-1 text-warn",children:[l.jsx(zp,{className:"h-3 w-3"}),l.jsxs("span",{children:[t.current_slot_plan.export_kw.toFixed(1),"kW"]})]}),t.current_slot_plan.water_kw>0&&l.jsxs("div",{className:"flex items-center gap-1 text-water",children:[l.jsx(po,{className:"h-3 w-3"}),l.jsxs("span",{children:[t.current_slot_plan.water_kw.toFixed(1),"kW"]})]}),t.current_slot_plan.soc_target>0&&l.jsx("div",{className:"flex items-center gap-1 text-muted",children:l.jsxs("span",{children:["SoC",t.current_slot_plan.soc_target,"%"]})}),!t.current_slot_plan.charge_kw&&!t.current_slot_plan.export_kw&&!t.current_slot_plan.water_kw&&l.jsx("div",{className:"text-muted/60 col-span-4",children:"Idle / Self-consumption"})]})]}),i.map(D=>{const R=F===D.id;return l.jsxs("div",{className:`rounded-xl border transition-all ${D.success?"bg-surface2/30 border-line/40 hover:border-line/60":"bg-bad/10 border-bad/30 hover:border-bad/50"}`,children:[l.jsxs("div",{className:"p-3 cursor-pointer flex items-center justify-between",onClick:()=>X(R?null:D.id),children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(mo,{className:`h-3 w-3 text-muted transition-transform ${R?"rotate-180":""}`}),D.success?l.jsx(Op,{className:"h-4 w-4 text-good"}):l.jsx(va,{className:"h-4 w-4 text-bad"}),l.jsx("span",{className:"text-[11px] text-text font-mono",children:We(D.executed_at)}),D.commanded_charge_current_a&&D.commanded_charge_current_a>0&&l.jsx("span",{className:"text-[9px] text-good bg-good/20 px-1.5 py-0.5 rounded",children:" Charge"}),D.commanded_work_mode==="Export First"&&l.jsx("span",{className:"text-[9px] text-warn bg-warn/20 px-1.5 py-0.5 rounded",children:" Export"}),D.commanded_water_temp&&D.commanded_water_temp>50&&l.jsx("span",{className:"text-[9px] text-warn bg-warn/20 px-1.5 py-0.5 rounded",children:" Heat"}),(!D.commanded_charge_current_a||D.commanded_charge_current_a===0)&&D.commanded_work_mode!=="Export First"&&(!D.commanded_water_temp||D.commanded_water_temp<=50)&&l.jsx("span",{className:"text-[9px] text-muted/60 bg-surface2/50 px-1.5 py-0.5 rounded",children:" Idle"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[D.override_active?l.jsx("span",{className:"text-[9px] text-warn bg-warn/20 px-2 py-0.5 rounded-full border border-warn/30",children:D.override_type}):null,D.duration_ms&&l.jsxs("span",{className:"text-[9px] text-muted font-mono",children:[D.duration_ms,"ms"]})]})]}),R&&l.jsxs("div",{className:"px-3 pb-3 border-t border-line/20",children:[l.jsxs("div",{className:"mt-3",children:[l.jsx("div",{className:"text-[9px] text-muted uppercase tracking-wide mb-1.5",children:"Planned (from Schedule)"}),l.jsxs("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-2 text-[10px]",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-muted/60",children:"Charge"}),l.jsxs("span",{className:D.planned_charge_kw?"text-good":"text-muted/40",children:[D.planned_charge_kw?.toFixed(1)??""," kW"]})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-muted/60",children:"Export"}),l.jsxs("span",{className:D.planned_export_kw?"text-warn":"text-muted/40",children:[D.planned_export_kw?.toFixed(1)??""," kW"]})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-muted/60",children:"Water"}),l.jsxs("span",{className:D.planned_water_kw?"text-warn":"text-muted/40",children:[D.planned_water_kw?.toFixed(1)??""," kW"]})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-muted/60",children:"SoC Target"}),l.jsxs("span",{className:"text-text",children:[D.planned_soc_target??"","%"]})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-muted/60",children:"SoC Projected"}),l.jsxs("span",{className:"text-text",children:[D.planned_soc_projected??"","%"]})]})]})]}),l.jsxs("div",{className:"mt-3",children:[l.jsx("div",{className:"text-[9px] text-muted uppercase tracking-wide mb-1.5",children:"Commanded (What We Set)"}),l.jsxs("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-2 text-[10px]",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-muted/60",children:"Work Mode"}),l.jsx("span",{className:"text-text font-medium",children:D.commanded_work_mode??""})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-muted/60",children:"Grid Charging"}),l.jsx("span",{className:D.commanded_grid_charging?"text-good":"text-muted/40",children:D.commanded_grid_charging?"ON":"OFF"})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-muted/60",children:"Charge I"}),l.jsxs("span",{className:D.commanded_charge_current_a?"text-good":"text-muted/40",children:[D.commanded_charge_current_a??""," A"]})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-muted/60",children:"Discharge I"}),l.jsxs("span",{className:D.commanded_discharge_current_a?"text-warn":"text-muted/40",children:[D.commanded_discharge_current_a??""," A"]})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-muted/60",children:"SoC Target"}),l.jsxs("span",{className:"text-text",children:[D.commanded_soc_target??"","%"]})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-muted/60",children:"Water Temp"}),l.jsxs("span",{className:D.commanded_water_temp&&D.commanded_water_temp>50?"text-warn":"text-muted/40",children:[D.commanded_water_temp??"","C"]})]})]})]}),l.jsxs("div",{className:"mt-3",children:[l.jsx("div",{className:"text-[9px] text-muted uppercase tracking-wide mb-1.5",children:"State Before Execution"}),l.jsxs("div",{className:"grid grid-cols-3 md:grid-cols-5 gap-2 text-[10px]",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-muted/60",children:"SoC"}),l.jsxs("span",{className:"text-text",children:[D.before_soc_percent?.toFixed(0)??"","%"]})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-muted/60",children:"Work Mode"}),l.jsx("span",{className:"text-text",children:D.before_work_mode??""})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-muted/60",children:"PV Power"}),l.jsxs("span",{className:"text-yellow-400",children:[D.before_pv_kw?.toFixed(1)??""," kW"]})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-muted/60",children:"Load"}),l.jsxs("span",{className:"text-sky-400",children:[D.before_load_kw?.toFixed(1)??""," kW"]})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-muted/60",children:"Water Temp"}),l.jsxs("span",{className:"text-text",children:[D.before_water_temp??"","C"]})]})]})]}),D.error_message&&l.jsx("div",{className:"mt-2 text-[10px] text-red-400 bg-red-500/10 rounded-lg p-2",children:D.error_message}),D.override_reason&&l.jsxs("div",{className:"mt-2 text-[10px] text-amber-300/80 bg-amber-500/10 rounded-lg p-2",children:["Override: ",D.override_reason]})]})]},D.id)})]})]}),_&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",onClick:()=>S(!1),children:l.jsxs("div",{className:"bg-surface border border-line rounded-2xl p-5 w-full max-w-md shadow-2xl",onClick:D=>D.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(rl,{className:"h-5 w-5 text-accent"}),l.jsx("span",{className:"text-sm font-medium text-text",children:"Notification Settings"})]}),l.jsx("button",{onClick:()=>S(!1),className:"text-muted hover:text-text transition p-1",children:l.jsx(ii,{className:"h-5 w-5"})})]}),N&&l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"p-2 rounded-lg bg-surface2/30 border border-line/30 mb-3",children:[l.jsx("div",{className:"text-[10px] text-muted mb-1",children:"HA Notify Service"}),l.jsx("div",{className:"text-[11px] text-text font-mono",children:N.service||"Not configured"})]}),[{key:"on_charge_start",label:"Charge Started",desc:"When grid charging begins"},{key:"on_charge_stop",label:"Charge Stopped",desc:"When grid charging ends"},{key:"on_export_start",label:"Export Started",desc:"When battery export begins"},{key:"on_export_stop",label:"Export Stopped",desc:"When battery export ends"},{key:"on_water_heat_start",label:"Water Heating Started",desc:"When water heater activates"},{key:"on_water_heat_stop",label:"Water Heating Stopped",desc:"When water heater deactivates"},{key:"on_soc_target_change",label:"SoC Target Changed",desc:"When battery target changes"},{key:"on_override_activated",label:"Override Activated",desc:"When emergency override triggers"},{key:"on_error",label:"Errors",desc:"When execution fails"}].map(D=>l.jsxs("div",{className:"flex items-center justify-between p-2.5 rounded-lg bg-surface2/50 border border-line/50",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-[11px] font-medium text-text",children:D.label}),l.jsx("span",{className:"text-[9px] text-muted",children:D.desc})]}),l.jsx(Ul,{enabled:N[D.key],onChange:R=>Z(D.key,R),disabled:k,size:"sm"})]},D.key))]}),l.jsxs("div",{className:"mt-4 pt-3 border-t border-line/30",children:[l.jsx("button",{onClick:Y,disabled:M,className:`w-full flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl border text-[11px] font-medium transition-all ${M?"bg-surface2/50 border-line/30 text-muted cursor-not-allowed":"bg-accent/10 border-accent/30 text-accent hover:bg-accent/20"}`,children:M?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"h-3 w-3 border-2 border-accent/30 border-t-accent rounded-full animate-spin"}),"Sending..."]}):l.jsxs(l.Fragment,{children:[l.jsx(rl,{className:"h-3.5 w-3.5"}),"Send Test Notification"]})}),O&&l.jsx("div",{className:`mt-2 text-center text-[10px] ${O.success?"text-emerald-400":"text-red-400"}`,children:O.message}),l.jsx("div",{className:"mt-2 text-center text-[9px] text-muted/70",children:"Changes are saved automatically"})]})]})})]})}function Li({variant:t="info",children:e,className:s=""}){return l.jsx("div",{className:`banner banner-${t} ${s}`,children:e})}function Fi({variant:t="muted",children:e,className:s=""}){return l.jsx("span",{className:`badge badge-${t} ${s}`,children:e})}function dO(){const{toast:t}=Or(),[e,s]=y.useState(!1),[n,i]=y.useState(65),[r,a]=y.useState(!1),[o,c]=y.useState(!1),[d,u]=y.useState("");return l.jsxs("main",{className:"mx-auto max-w-6xl px-6 py-10 space-y-12",children:[l.jsxs("header",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-4xl font-bold text-text",children:"Darkstar Design System"}),l.jsx("p",{className:"text-muted text-lg mt-2",children:"Visual reference & component showcase"})]}),l.jsx(Hp,{})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:"Color Palette"}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[{name:"Accent",var:"--color-accent",hex:"#FFCE59"},{name:"Good",var:"--color-good",hex:"#1FB256"},{name:"Warn",var:"--color-warn",hex:"#F59E0B"},{name:"Bad",var:"--color-bad",hex:"#F15132"},{name:"Water",var:"--color-water",hex:"#4EA8DE"},{name:"House",var:"--color-house",hex:"#A855F7"},{name:"Peak",var:"--color-peak",hex:"#EC4899"},{name:"Night",var:"--color-night",hex:"#06B6D4"},{name:"Grid",var:"--color-grid",hex:"#64748B"},{name:"Neutral",var:"--color-neutral",hex:"#989FA5"},{name:"AI",var:"--color-ai",hex:"#8B5CF6"}].map(h=>l.jsxs("div",{className:"rounded-ds-md overflow-hidden shadow-float bg-surface",children:[l.jsx("div",{className:"h-16",style:{backgroundColor:`rgb(var(${h.var}))`}}),l.jsxs("div",{className:"p-2",children:[l.jsx("div",{className:"text-sm font-medium text-text",children:h.name}),l.jsx("div",{className:"text-xs text-muted font-mono",children:h.hex})]})]},h.name))}),l.jsx("h3",{className:"text-lg font-medium text-text mt-6 mb-3",children:"Surface Colors"}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{name:"Canvas",var:"--color-canvas"},{name:"Surface",var:"--color-surface"},{name:"Surface2",var:"--color-surface2"},{name:"Line",var:"--color-line"}].map(h=>l.jsx("div",{className:"h-20 rounded-ds-md border border-line flex items-center justify-center",style:{backgroundColor:`rgb(var(${h.var}))`},children:l.jsx("span",{className:"text-sm font-medium text-text",children:h.name})},h.name))})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:"Typography"}),l.jsxs("div",{className:"space-y-3 bg-surface p-6 rounded-ds-lg",children:[l.jsx("div",{className:"text-4xl",children:"text-4xl (28px)  Page Titles"}),l.jsx("div",{className:"text-3xl",children:"text-3xl (24px)  Section Headers"}),l.jsx("div",{className:"text-2xl",children:"text-2xl (18px)  Subsections"}),l.jsx("div",{className:"text-xl",children:"text-xl (16px)  Large Body"}),l.jsx("div",{className:"text-lg",children:"text-lg (14px)  Body Text"}),l.jsx("div",{className:"text-md",children:"text-md (13px)  Secondary"}),l.jsx("div",{className:"text-base",children:"text-base (12px)  Small Body"}),l.jsx("div",{className:"text-sm",children:"text-sm (11px)  Labels"}),l.jsx("div",{className:"text-xs",children:"text-xs (10px)  Micro"})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:"Buttons"}),l.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[l.jsx("button",{className:"btn btn-primary",children:"Primary"}),l.jsx("button",{className:"btn btn-secondary",children:"Secondary"}),l.jsx("button",{className:"btn btn-danger",children:"Danger"}),l.jsx("button",{className:"btn btn-ghost",children:"Ghost"}),l.jsx("button",{className:"btn btn-primary btn-pill",children:"Pill Primary"}),l.jsx("button",{className:"btn btn-ghost btn-pill",children:"Pill Ghost"})]}),l.jsxs("div",{className:"flex flex-wrap gap-4 items-center mt-4",children:[l.jsx("button",{className:"btn btn-primary",disabled:!0,children:"Disabled Primary"}),l.jsx("button",{className:"btn btn-secondary",disabled:!0,children:"Disabled Secondary"}),l.jsx("button",{className:"btn btn-ghost",disabled:!0,children:"Disabled Ghost"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("p",{className:"text-sm text-muted mb-2",children:"Dynamic color (using CSS custom property):"}),l.jsx("button",{className:"btn btn-pill btn-dynamic",style:{"--btn-bg":"rgb(var(--color-water))","--btn-text":"#fff"},children:"Custom Water Color"})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:"Banners / Alerts"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Li,{variant:"info",children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Info Banner  Neutral information message"})]}),l.jsxs(Li,{variant:"success",children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Success Banner  Action completed successfully"})]}),l.jsxs(Li,{variant:"warning",children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Warning Banner  Requires attention"})]}),l.jsxs(Li,{variant:"error",children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Error Banner  Critical issue detected"})]}),l.jsxs(Li,{variant:"purple",children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Purple Banner  Special mode (shadow mode)"})]})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:"Badges"}),l.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[l.jsx(Fi,{variant:"accent",children:"Accent"}),l.jsx(Fi,{variant:"good",children:"Good"}),l.jsx(Fi,{variant:"warn",children:"Warning"}),l.jsx(Fi,{variant:"bad",children:"Error"}),l.jsx(Fi,{variant:"muted",children:"Muted"})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:"Form Elements"}),l.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-muted mb-2",children:"Text Input"}),l.jsx("input",{type:"text",className:"input",placeholder:"Enter value..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-muted mb-2",children:"Number Input"}),l.jsx("input",{type:"number",className:"input",placeholder:"0"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-muted mb-2",children:"Toggle Switch"}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(e0,{checked:e,onCheckedChange:s}),l.jsx("span",{className:"text-sm text-text",children:e?"On":"Off"})]})]})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:"Loading States"}),l.jsxs("div",{className:"flex items-center gap-8",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm text-muted mb-2",children:"Spinner"}),l.jsx("div",{className:"spinner"})]}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"text-sm text-muted mb-2",children:"Skeleton"}),l.jsx("div",{className:"skeleton h-8 w-full"})]}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"text-sm text-muted mb-2",children:["Progress Bar (",n,"%)"]}),l.jsx("div",{className:"progress-bar",children:l.jsx("div",{className:"progress-bar-fill",style:{width:`${n}%`}})}),l.jsx("input",{type:"range",min:"0",max:"100",value:n,onChange:h=>i(Number(h.target.value)),className:"slider mt-2"})]})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:"Data Visualization"}),l.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-surface p-4 rounded-ds-lg",children:[l.jsx("div",{className:"text-sm text-muted mb-3",children:"Mini-Bar Chart (Solar)"}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"mini-bars",children:[40,55,75,90,100,85,70,45].map((h,f)=>l.jsx("div",{className:"mini-bar",style:{height:`${h}%`,background:"rgb(var(--color-accent))"}},f))}),l.jsx("span",{className:"font-mono font-bold text-accent",children:"4.2kW"})]})]}),l.jsxs("div",{className:"bg-surface p-4 rounded-ds-lg",children:[l.jsx("div",{className:"text-sm text-muted mb-3",children:"Mini-Bar Chart (Battery)"}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"mini-bars",children:[60,65,70,75,80,82,85,85].map((h,f)=>l.jsx("div",{className:"mini-bar",style:{height:`${h}%`,background:"rgb(var(--color-good))"}},f))}),l.jsx("span",{className:"font-mono font-bold text-good",children:"85%"})]})]})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:" Chart.js  Live Example"}),l.jsx("p",{className:"text-muted text-sm mb-4",children:"This is the actual ChartCard component used throughout Darkstar."}),l.jsx("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:l.jsx(ox,{day:"today",showDayToggle:!1})})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:" Power Flow Visualization"}),l.jsx("p",{className:"text-muted text-sm mb-4",children:"Animated energy flow between sources and loads (inspired by power-flow-card-plus)."}),l.jsx("div",{className:"bg-surface rounded-ds-lg p-8 shadow-float",children:l.jsxs("svg",{viewBox:"0 0 400 300",className:"w-full max-w-lg mx-auto",children:[l.jsx("g",{className:"power-flow-line",style:{stroke:"rgb(var(--color-accent))",strokeWidth:3,fill:"none"},children:l.jsx("path",{d:"M100,50 L200,150"})}),l.jsx("g",{className:"power-flow-line",style:{stroke:"rgb(var(--color-good))",strokeWidth:3,fill:"none",animationDelay:"0.25s"},children:l.jsx("path",{d:"M200,150 L200,250"})}),l.jsx("g",{className:"power-flow-line",style:{stroke:"rgb(var(--color-house))",strokeWidth:3,fill:"none",animationDelay:"0.5s"},children:l.jsx("path",{d:"M200,150 L300,150"})}),l.jsx("g",{style:{stroke:"rgb(var(--color-grid))",strokeWidth:3,fill:"none",strokeDasharray:"5 5"},children:l.jsx("path",{d:"M100,250 L200,150"})}),l.jsxs("g",{transform:"translate(100, 50)",children:[l.jsx("circle",{r:"35",fill:"rgb(var(--color-surface))",stroke:"rgb(var(--color-accent))",strokeWidth:"3",className:"animate-glow"}),l.jsx("text",{y:"5",textAnchor:"middle",fill:"rgb(var(--color-accent))",fontSize:"24",children:""}),l.jsx("text",{y:"55",textAnchor:"middle",fill:"rgb(var(--color-text))",fontSize:"11",fontWeight:"600",children:"4.2 kW"}),l.jsx("text",{y:"70",textAnchor:"middle",fill:"rgb(var(--color-muted))",fontSize:"9",children:"Solar"})]}),l.jsxs("g",{transform:"translate(200, 150)",children:[l.jsx("circle",{r:"40",fill:"rgb(var(--color-surface))",stroke:"rgb(var(--color-house))",strokeWidth:"3"}),l.jsx("text",{y:"5",textAnchor:"middle",fill:"rgb(var(--color-house))",fontSize:"24",children:""}),l.jsx("text",{y:"-50",textAnchor:"middle",fill:"rgb(var(--color-text))",fontSize:"11",fontWeight:"600",children:"3.1 kW"})]}),l.jsxs("g",{transform:"translate(200, 250)",children:[l.jsx("circle",{r:"35",fill:"rgb(var(--color-surface))",stroke:"rgb(var(--color-good))",strokeWidth:"3"}),l.jsx("text",{y:"5",textAnchor:"middle",fill:"rgb(var(--color-good))",fontSize:"24",children:""}),l.jsx("text",{y:"55",textAnchor:"middle",fill:"rgb(var(--color-text))",fontSize:"11",fontWeight:"600",children:"85%"}),l.jsx("text",{y:"70",textAnchor:"middle",fill:"rgb(var(--color-muted))",fontSize:"9",children:"+0.6 kW"})]}),l.jsxs("g",{transform:"translate(100, 250)",children:[l.jsx("circle",{r:"35",fill:"rgb(var(--color-surface))",stroke:"rgb(var(--color-grid))",strokeWidth:"3"}),l.jsx("text",{y:"5",textAnchor:"middle",fill:"rgb(var(--color-grid))",fontSize:"24",children:""}),l.jsx("text",{y:"55",textAnchor:"middle",fill:"rgb(var(--color-text))",fontSize:"11",fontWeight:"600",children:"0 W"}),l.jsx("text",{y:"70",textAnchor:"middle",fill:"rgb(var(--color-muted))",fontSize:"9",children:"Grid"})]}),l.jsxs("g",{transform:"translate(300, 150)",children:[l.jsx("circle",{r:"30",fill:"rgb(var(--color-surface))",stroke:"rgb(var(--color-water))",strokeWidth:"3"}),l.jsx("text",{y:"5",textAnchor:"middle",fill:"rgb(var(--color-water))",fontSize:"20",children:""}),l.jsx("text",{y:"50",textAnchor:"middle",fill:"rgb(var(--color-text))",fontSize:"11",fontWeight:"600",children:"0.5 kW"}),l.jsx("text",{y:"65",textAnchor:"middle",fill:"rgb(var(--color-muted))",fontSize:"9",children:"Water"})]})]})})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:" Animation Examples"}),l.jsx("p",{className:"text-muted text-sm mb-4",children:"CSS animations available in the design system."}),l.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float text-center",children:[l.jsx("div",{className:"w-12 h-12 mx-auto mb-3 rounded-full bg-accent animate-pulse"}),l.jsx("div",{className:"text-sm font-medium text-text",children:"Pulse"}),l.jsx("code",{className:"text-xs text-muted",children:".animate-pulse"})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float text-center",children:[l.jsx("div",{className:"w-12 h-12 mx-auto mb-3 rounded-full bg-good animate-bounce"}),l.jsx("div",{className:"text-sm font-medium text-text",children:"Bounce"}),l.jsx("code",{className:"text-xs text-muted",children:".animate-bounce"})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float text-center",children:[l.jsx("div",{className:"w-12 h-12 mx-auto mb-3 rounded-full bg-accent animate-glow"}),l.jsx("div",{className:"text-sm font-medium text-text",children:"Glow"}),l.jsx("code",{className:"text-xs text-muted",children:".animate-glow"})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float text-center",children:[l.jsx("div",{className:"spinner mx-auto mb-3",style:{width:"3rem",height:"3rem",borderWidth:"4px"}}),l.jsx("div",{className:"text-sm font-medium text-text",children:"Spinner"}),l.jsx("code",{className:"text-xs text-muted",children:".spinner"})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:[l.jsx("div",{className:"text-sm font-medium text-text mb-2",children:"Skeleton Loading"}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"skeleton h-4 w-3/4"}),l.jsx("div",{className:"skeleton h-4 w-1/2"}),l.jsx("div",{className:"skeleton h-4 w-full"})]}),l.jsx("code",{className:"text-xs text-muted mt-2 block",children:".skeleton"})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:[l.jsx("div",{className:"text-sm font-medium text-text mb-2",children:"Mini Bar Animation"}),l.jsx("div",{className:"mini-bars",children:[40,60,80,100,80,60,40,20].map((h,f)=>l.jsx("div",{className:"mini-bar animate-pulse",style:{height:`${h}%`,background:"rgb(var(--color-accent))",animationDelay:`${f*.1}s`}},f))}),l.jsx("code",{className:"text-xs text-muted mt-2 block",children:".mini-bars"})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float text-center",children:[l.jsx("button",{className:"btn btn-primary animate-glow mb-2",children:"Glowing Button"}),l.jsx("div",{className:"text-sm font-medium text-text",children:"Button Glow"}),l.jsx("code",{className:"text-xs text-muted",children:".btn + .animate-glow"})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:[l.jsx("div",{className:"text-sm font-medium text-text mb-2",children:"Animated Progress"}),l.jsx("div",{className:"progress-bar",children:l.jsx("div",{className:"progress-bar-fill",style:{width:"75%",animation:"skeleton-shimmer 1.5s infinite",background:"linear-gradient(90deg, rgb(var(--color-accent)), rgb(var(--color-accent2)), rgb(var(--color-accent)))",backgroundSize:"200% 100%"}})}),l.jsx("code",{className:"text-xs text-muted mt-2 block",children:".progress-bar"})]})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:"Metric Cards"}),l.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:[{border:"solar",label:"Solar",value:"4.2 kW",sub:"+12% today"},{border:"battery",label:"Battery",value:"78%",sub:"Target: 85%"},{border:"house",label:"House Load",value:"1.8 kW",sub:"Avg: 2.1 kW"},{border:"water",label:"Water",value:"2.4 kWh",sub:"Today"},{border:"grid",label:"Grid",value:"-0.5 kW",sub:"Exporting"},{border:"bad",label:"Error",value:"3",sub:"Issues detected"}].map(h=>l.jsxs("div",{className:`metric-card-border metric-card-border-${h.border} bg-surface p-4`,children:[l.jsx("div",{className:"text-xs text-muted uppercase tracking-wider",children:h.label}),l.jsx("div",{className:"text-2xl font-bold text-text mt-1",children:h.value}),l.jsx("div",{className:"text-xs text-muted mt-1",children:h.sub})]},h.border))})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:"Border Radius"}),l.jsx("div",{className:"flex gap-4 items-end",children:[{name:"sm",size:"8px"},{name:"md",size:"12px"},{name:"lg",size:"16px"},{name:"xl",size:"20px"},{name:"pill",size:"9999px"}].map(h=>l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:`w-16 h-16 bg-accent rounded-ds-${h.name}`}),l.jsx("div",{className:"text-xs text-muted mt-2",children:h.name}),l.jsx("div",{className:"text-xs text-muted",children:h.size})]},h.name))})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:"Spacing Scale (4px grid)"}),l.jsx("div",{className:"flex gap-4 items-end flex-wrap",children:[1,2,3,4,5,6,8,10,12].map(h=>l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"bg-accent",style:{width:`var(--space-${h})`,height:`var(--space-${h})`,minWidth:"4px",minHeight:"4px"}}),l.jsxs("div",{className:"text-xs text-muted mt-2",children:["ds-",h]})]},h))})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:"Dark / Light Mode Comparison"}),l.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"rounded-ds-lg overflow-hidden",style:{background:"#0f1216"},children:[l.jsx("div",{className:"px-4 py-3",style:{background:"#14191f"},children:l.jsx("span",{className:"text-sm font-semibold",style:{color:"#e6e9ef"},children:" Dark Mode  Glow Buttons"})}),l.jsxs("div",{className:"p-4 space-y-2",style:{background:"#14191f"},children:[l.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg",style:{background:"#181e25"},children:[l.jsx("span",{style:{color:"#FFCE59"},children:" Solar"}),l.jsx("span",{className:"font-mono font-bold",style:{color:"#FFCE59"},children:"4.2kW"})]}),l.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg",style:{background:"#181e25"},children:[l.jsx("span",{style:{color:"#1FB256"},children:" Battery"}),l.jsx("span",{className:"font-mono font-bold",style:{color:"#1FB256"},children:"85%"})]}),l.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg",style:{background:"#181e25"},children:[l.jsx("span",{style:{color:"#A855F7"},children:" House"}),l.jsx("span",{className:"font-mono font-bold",style:{color:"#e6e9ef"},children:"1.8kW"})]}),l.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg",style:{background:"#181e25"},children:[l.jsx("span",{style:{color:"#4EA8DE"},children:" Water"}),l.jsx("span",{className:"font-mono font-bold",style:{color:"#e6e9ef"},children:"58C"})]}),l.jsxs("div",{className:"flex gap-2 pt-3",children:[l.jsx("button",{style:{background:"#FFCE59",color:"#1a1d23",padding:"8px 16px",borderRadius:"8px",fontWeight:600,fontSize:"11px",boxShadow:"0 0 16px rgba(255, 206, 89, 0.4), 0 0 32px rgba(255, 206, 89, 0.2)"},children:" Boost"}),l.jsx("button",{style:{background:"#989FA5",color:"#fff",padding:"8px 16px",borderRadius:"8px",fontWeight:600,fontSize:"11px",boxShadow:"0 0 12px rgba(152, 159, 165, 0.3)"},children:" Vacation"})]})]})]}),l.jsxs("div",{className:"rounded-ds-lg overflow-hidden",style:{background:"#DFDFDF"},children:[l.jsx("div",{className:"px-4 py-3",style:{background:"#EFEFEF"},children:l.jsx("span",{className:"text-sm font-semibold",style:{color:"#2D2D2D"},children:" Light Mode  Flat Buttons (TE Style)"})}),l.jsxs("div",{className:"p-4 space-y-2",style:{background:"#EFEFEF"},children:[l.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg",style:{background:"#D0D0D0"},children:[l.jsxs("span",{style:{color:"#2D2D2D"},children:[" ",l.jsx("b",{style:{color:"#b38b00"},children:"Solar"})]}),l.jsx("span",{className:"font-mono font-bold",style:{color:"#2D2D2D"},children:"4.2kW"})]}),l.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg",style:{background:"#D0D0D0"},children:[l.jsxs("span",{style:{color:"#2D2D2D"},children:[" ",l.jsx("b",{style:{color:"#1FB256"},children:"Battery"})]}),l.jsx("span",{className:"font-mono font-bold",style:{color:"#2D2D2D"},children:"85%"})]}),l.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg",style:{background:"#D0D0D0"},children:[l.jsxs("span",{style:{color:"#2D2D2D"},children:[" ",l.jsx("b",{style:{color:"#A855F7"},children:"House"})]}),l.jsx("span",{className:"font-mono font-bold",style:{color:"#2D2D2D"},children:"1.8kW"})]}),l.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg",style:{background:"#D0D0D0"},children:[l.jsxs("span",{style:{color:"#2D2D2D"},children:[" ",l.jsx("b",{style:{color:"#4EA8DE"},children:"Water"})]}),l.jsx("span",{className:"font-mono font-bold",style:{color:"#2D2D2D"},children:"58C"})]}),l.jsxs("div",{className:"flex gap-2 pt-3",children:[l.jsx("button",{style:{background:"#FFCE59",color:"#2D2D2D",padding:"8px 16px",borderRadius:"8px",fontWeight:600,fontSize:"11px",border:"none"},children:" Boost"}),l.jsx("button",{style:{background:"#989FA5",color:"#fff",padding:"8px 16px",borderRadius:"8px",fontWeight:600,fontSize:"11px",border:"none"},children:" Vacation"})]})]})]})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:" Future Components (Inspiration)"}),l.jsx("p",{className:"text-muted text-sm mb-6",children:"These components are not yet implemented but can be added as needed."}),l.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:[l.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:" Card"}),l.jsx("p",{className:"text-xs text-muted",children:"Container with shadow, padding, and rounded corners for grouping content."}),l.jsx("div",{className:"mt-3 p-3 bg-surface2 rounded-ds-md",children:l.jsx("div",{className:"text-xs text-text",children:"Card content goes here..."})})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:[l.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:" Select (Dropdown)"}),l.jsx("p",{className:"text-xs text-muted mb-3",children:"Custom searchable dropdown."}),l.jsx(Qy,{options:[{label:"Option 1",value:"1"},{label:"Option 2",value:"2"},{label:"Delete",value:"3",group:"Danger"}],value:"1",onChange:()=>{}})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:[l.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:" Tabs"}),l.jsx("p",{className:"text-xs text-muted mb-3",children:"Navigation between views."}),l.jsxs("div",{className:"flex gap-1 bg-surface2 p-1 rounded-ds-md",children:[l.jsx("div",{className:"px-3 py-1.5 text-xs font-medium bg-accent text-black rounded",children:"Active"}),l.jsx("div",{className:"px-3 py-1.5 text-xs text-muted rounded",children:"Tab 2"}),l.jsx("div",{className:"px-3 py-1.5 text-xs text-muted rounded",children:"Tab 3"})]})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:[l.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:" Avatars"}),l.jsx("p",{className:"text-xs text-muted mb-3",children:"User profile images or initials."}),l.jsxs("div",{className:"flex gap-2 items-center",children:[l.jsx("div",{className:"w-8 h-8 rounded-full bg-accent flex items-center justify-center text-xs font-bold text-black",children:"JD"}),l.jsx("div",{className:"w-8 h-8 rounded-full bg-water flex items-center justify-center text-xs font-bold text-white",children:"AB"}),l.jsx("div",{className:"w-8 h-8 rounded-full bg-house flex items-center justify-center text-xs font-bold text-white",children:"?"})]})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:[l.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:" Tooltip"}),l.jsx("p",{className:"text-xs text-muted mb-3",children:"Hover for more info."}),l.jsx("span",{className:"tooltip px-3 py-1.5 bg-surface2 rounded text-xs text-text cursor-help","data-tooltip":"This is a tooltip!",children:"Hover me"})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:[l.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:" Data Table"}),l.jsx("p",{className:"text-xs text-muted mb-3",children:"Tabular data display."}),l.jsxs("div",{className:"text-xs",children:[l.jsxs("div",{className:"flex gap-2 py-1 border-b border-line text-muted font-medium",children:[l.jsx("span",{className:"flex-1",children:"Name"}),l.jsx("span",{className:"w-16 text-right",children:"Value"})]}),l.jsxs("div",{className:"flex gap-2 py-1 text-text",children:[l.jsx("span",{className:"flex-1",children:"Solar"}),l.jsx("span",{className:"w-16 text-right text-accent",children:"4.2kW"})]}),l.jsxs("div",{className:"flex gap-2 py-1 text-text",children:[l.jsx("span",{className:"flex-1",children:"Battery"}),l.jsx("span",{className:"w-16 text-right text-good",children:"85%"})]})]})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:[l.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:" Gauge / Dial"}),l.jsx("p",{className:"text-xs text-muted mb-3",children:"Circular progress indicator."}),l.jsxs("div",{className:"w-16 h-16 rounded-full border-4 border-surface2 relative",children:[l.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-transparent border-t-accent border-r-accent",style:{transform:"rotate(45deg)"}}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-xs font-bold text-text",children:"75%"})]})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:[l.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:" Notification Badge"}),l.jsx("p",{className:"text-xs text-muted mb-3",children:"Alert indicator on icons."}),l.jsxs("div",{className:"relative inline-block",children:[l.jsx("div",{className:"w-10 h-10 bg-surface2 rounded-lg flex items-center justify-center text-lg",children:""}),l.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-bad rounded-full flex items-center justify-center text-[10px] font-bold text-white",children:"3"})]})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:[l.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:" Stepper"}),l.jsx("p",{className:"text-xs text-muted mb-3",children:"Multi-step progress."}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-6 h-6 rounded-full bg-accent flex items-center justify-center text-[10px] font-bold text-black",children:"1"}),l.jsx("div",{className:"flex-1 h-0.5 bg-accent"}),l.jsx("div",{className:"w-6 h-6 rounded-full bg-accent flex items-center justify-center text-[10px] font-bold text-black",children:"2"}),l.jsx("div",{className:"flex-1 h-0.5 bg-surface2"}),l.jsx("div",{className:"w-6 h-6 rounded-full bg-surface2 flex items-center justify-center text-[10px] font-bold text-muted",children:"3"})]})]})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:" More Future Components"}),l.jsx("p",{className:"text-muted text-sm mb-6",children:"Additional component patterns for future implementation."}),l.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:[l.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:" Modal / Dialog"}),l.jsx("p",{className:"text-xs text-muted mb-3",children:"Overlay for confirmations & forms."}),l.jsx("button",{className:"btn btn-primary text-xs",onClick:()=>c(!0),children:"Open Modal"}),l.jsx(o0,{open:o,onOpenChange:c,title:"Example Modal",footer:l.jsxs(l.Fragment,{children:[l.jsx("button",{className:"btn btn-ghost",onClick:()=>c(!1),children:"Cancel"}),l.jsx("button",{className:"btn btn-primary",onClick:()=>c(!1),children:"Confirm"})]}),children:l.jsx("p",{className:"text-text",children:"This is a reusable modal component using React Portal."})})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:[l.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:" Accordion"}),l.jsx("p",{className:"text-xs text-muted mb-3",children:"Expandable content sections."}),l.jsxs("div",{className:"bg-surface2 rounded-ds-md overflow-hidden",children:[l.jsxs("div",{className:"px-3 py-2 text-xs font-medium text-text flex justify-between items-center cursor-pointer",onClick:()=>a(!r),children:[l.jsx("span",{children:"Click to expand"}),l.jsx("span",{children:r?"":"+"})]}),r&&l.jsx("div",{className:"px-3 py-2 text-xs text-muted border-t border-line",children:"Hidden content revealed!"})]})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:[l.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:" Search Input"}),l.jsx("p",{className:"text-xs text-muted mb-3",children:"With autocomplete dropdown."}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"text",className:"input pr-8",placeholder:"Search entities...",value:d,onChange:h=>u(h.target.value)}),l.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted",children:""})]}),d&&l.jsxs("div",{className:"mt-1 bg-surface2 rounded-ds-md p-1 shadow-lg",children:[l.jsx("div",{className:"px-3 py-2 text-xs text-text hover:bg-accent/10 rounded cursor-pointer",children:"sensor.solar_power"}),l.jsx("div",{className:"px-3 py-2 text-xs text-text hover:bg-accent/10 rounded cursor-pointer",children:"sensor.battery_soc"})]})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:[l.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:" Date Picker"}),l.jsx("p",{className:"text-xs text-muted mb-3",children:"Calendar date selection."}),l.jsxs("div",{className:"bg-surface2 rounded-ds-md p-2 w-48",children:[l.jsx("div",{className:"text-xs font-medium text-text text-center mb-2",children:"December 2024"}),l.jsxs("div",{className:"grid grid-cols-7 gap-1 text-[10px] text-center",children:[["M","T","W","T","F","S","S"].map((h,f)=>l.jsx("div",{className:"text-muted",children:h},f)),[...Array(31)].map((h,f)=>l.jsx("div",{className:`py-1 rounded cursor-pointer ${f===30?"bg-accent text-black font-bold":"text-text hover:bg-accent/20"}`,children:f+1},f))]})]})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:[l.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:" Toast Notification"}),l.jsx("p",{className:"text-xs text-muted mb-3",children:"Temporary status messages."}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("button",{className:"btn btn-secondary w-full text-xs",onClick:()=>t({variant:"success",message:"Success!",description:"Action completed successfully."}),children:"Trigger Success Toast"}),l.jsx("button",{className:"btn btn-ghost w-full text-xs border border-bad/50 text-bad hover:bg-bad/10",onClick:()=>t({variant:"error",message:"Error!",description:"Something went wrong."}),children:"Trigger Error Toast"})]})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float",children:[l.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:" Breadcrumbs"}),l.jsx("p",{className:"text-xs text-muted mb-3",children:"Navigation path trail."}),l.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[l.jsx("span",{className:"text-accent hover:underline cursor-pointer",children:"Home"}),l.jsx("span",{className:"text-muted",children:"/"}),l.jsx("span",{className:"text-accent hover:underline cursor-pointer",children:"Settings"}),l.jsx("span",{className:"text-muted",children:"/"}),l.jsx("span",{className:"text-text font-medium",children:"Entities"})]})]}),l.jsxs("div",{className:"bg-surface rounded-ds-lg p-4 shadow-float col-span-full lg:col-span-2",children:[l.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:" Timeline / Activity Log"}),l.jsx("p",{className:"text-xs text-muted mb-3",children:"Chronological event display."}),l.jsx("div",{className:"space-y-3",children:[{time:"14:32",event:"Battery charging started",color:"good"},{time:"14:15",event:"Solar production peaked at 4.2kW",color:"accent"},{time:"13:45",event:"Grid export enabled",color:"water"}].map((h,f)=>l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:`w-2 h-2 rounded-full mt-1.5 bg-${h.color}`}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs font-mono text-muted",children:h.time}),l.jsx("div",{className:"text-xs text-text",children:h.event})]})]},f))})]})]})]}),o&&l.jsx("div",{className:"modal-overlay",onClick:()=>c(!1),children:l.jsxs("div",{className:"modal",onClick:h=>h.stopPropagation(),children:[l.jsx("h3",{className:"text-lg font-semibold text-text mb-2",children:"Modal Title"}),l.jsx("p",{className:"text-sm text-muted mb-4",children:"This is a sample modal dialog. It uses the design system's modal classes."}),l.jsxs("div",{className:"flex gap-2 justify-end",children:[l.jsx("button",{className:"btn btn-ghost",onClick:()=>c(!1),children:"Cancel"}),l.jsx("button",{className:"btn btn-primary",onClick:()=>c(!1),children:"Confirm"})]})]})}),l.jsxs("footer",{className:"text-center text-muted text-sm pt-8 border-t border-line",children:[l.jsxs("p",{children:["SSOT: ",l.jsx("code",{className:"bg-surface2 px-2 py-1 rounded text-xs",children:"frontend/src/index.css"})]}),l.jsx("p",{className:"mt-2",children:"Toggle dark/light mode using the switch in the header."})]})]})}const pp=t=>{switch(t){case"sunny":return{solar:4.2,battery:1.5,grid:-2,house:2.5,water:.3,batterySOC:75};case"evening":return{solar:0,battery:-2.8,grid:.5,house:3.1,water:.2,batterySOC:45};case"charging":return{solar:.5,battery:3,grid:2.5,house:1,water:0,batterySOC:30};case"exporting":return{solar:6,battery:.5,grid:-4.5,house:1.5,water:.5,batterySOC:95};default:return{solar:2,battery:0,grid:.5,house:2.5,water:0,batterySOC:60}}};function sb(t,e){const s=e.x-t.x,n=e.y-t.y;return Math.sqrt(s*s+n*n)}function uO({from:t,to:e,power:s,color:n,reverse:i}){const r=Math.abs(s),a=i?e:t,o=i?t:e,c=4,d=Math.max(3-r*.4,.8);return l.jsxs("g",{children:[l.jsx("line",{x1:a.x,y1:a.y,x2:o.x,y2:o.y,stroke:n,strokeWidth:2,strokeOpacity:.25}),r>.1&&Array.from({length:c}).map((u,h)=>l.jsx(Fe.circle,{r:4,fill:n,initial:{opacity:0},animate:{cx:[a.x,o.x],cy:[a.y,o.y],opacity:[0,.9,.9,0]},transition:{duration:d,repeat:1/0,delay:h/c*d,ease:"linear"}},h))]})}function hO({from:t,to:e,power:s,color:n,reverse:i}){const r=Math.abs(s),a=i?e:t,o=i?t:e,c=sb(a,o),d=Math.max(2-r*.3,.6);return l.jsxs("g",{children:[l.jsx("line",{x1:a.x,y1:a.y,x2:o.x,y2:o.y,stroke:n,strokeWidth:2,strokeOpacity:.2}),r>.1&&l.jsx(Fe.line,{x1:a.x,y1:a.y,x2:o.x,y2:o.y,stroke:n,strokeWidth:3,strokeOpacity:.7,strokeDasharray:"8 12",initial:{strokeDashoffset:0},animate:{strokeDashoffset:-c},transition:{duration:d,repeat:1/0,ease:"linear"}})]})}function fO({from:t,to:e,power:s,color:n,reverse:i}){const r=Math.abs(s),a=i?e:t,o=i?t:e,c=sb(a,o),d=Math.max(2.5-r*.4,.8);return l.jsxs("g",{children:[l.jsx("line",{x1:a.x,y1:a.y,x2:o.x,y2:o.y,stroke:n,strokeWidth:2,strokeOpacity:.15}),r>.1&&l.jsx(Fe.line,{x1:a.x,y1:a.y,x2:o.x,y2:o.y,stroke:n,strokeWidth:4,strokeOpacity:.8,strokeLinecap:"round",strokeDasharray:"6 14",initial:{strokeDashoffset:0},animate:{strokeDashoffset:-c},transition:{duration:d,repeat:1/0,ease:"linear"}})]})}function mO({from:t,to:e,power:s,color:n,reverse:i}){const r=Math.abs(s),a=i?e:t,o=i?t:e,c=Math.max(2-r*.3,.6),d=o.x-a.x,u=o.y-a.y,h=Math.atan2(u,d)*180/Math.PI,f=3;return l.jsxs("g",{children:[l.jsx("line",{x1:a.x,y1:a.y,x2:o.x,y2:o.y,stroke:n,strokeWidth:2,strokeOpacity:.2}),r>.1&&Array.from({length:f}).map((m,p)=>l.jsx(Fe.g,{initial:{opacity:0},animate:{x:[a.x,o.x],y:[a.y,o.y],opacity:[0,1,1,0]},transition:{duration:c,repeat:1/0,delay:p/f*c,ease:"linear"},children:l.jsx("polygon",{points:"-6,-4 0,0 -6,4",fill:n,transform:`rotate(${h})`})},p))]})}function pO({from:t,to:e,power:s,color:n,reverse:i}){const r=Math.abs(s),a=i?e:t,o=i?t:e,c=2,d=2+r*2;return l.jsx("g",{children:l.jsx(Fe.line,{x1:a.x,y1:a.y,x2:o.x,y2:o.y,stroke:n,strokeLinecap:"round",initial:{strokeWidth:c,strokeOpacity:.3},animate:r>.1?{strokeWidth:[c,d,c],strokeOpacity:[.3,.7,.3]}:{strokeWidth:c,strokeOpacity:.2},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"}})})}function gO({from:t,to:e,power:s,color:n,id:i,reverse:r}){const a=Math.abs(s),o=r?e:t,c=r?t:e,d=Math.max(2.5-a*.4,1);return l.jsxs("g",{children:[l.jsx("defs",{children:l.jsxs("linearGradient",{id:`heat-${i}`,gradientUnits:"userSpaceOnUse",x1:o.x,y1:o.y,x2:c.x,y2:c.y,children:[l.jsx(Fe.stop,{offset:"0%",stopColor:n,initial:{stopOpacity:.8},animate:{stopOpacity:[.8,.2,.8]},transition:{duration:d,repeat:1/0}}),l.jsx(Fe.stop,{offset:"100%",stopColor:n,initial:{stopOpacity:.1},animate:{stopOpacity:[.1,.6,.1]},transition:{duration:d,repeat:1/0,delay:d*.5}})]})}),l.jsx("line",{x1:o.x,y1:o.y,x2:c.x,y2:c.y,stroke:a>.1?`url(#heat-${i})`:n,strokeWidth:4+a,strokeOpacity:a>.1?1:.15,strokeLinecap:"round"})]})}function xO({from:t,to:e,power:s,color:n,reverse:i}){const r=Math.abs(s),a=i?e:t,o=i?t:e,c=Math.max(2-r*.25,.8),d=(a.x+o.x)/2,u=(a.y+o.y)/2;return l.jsxs("g",{children:[l.jsx("line",{x1:a.x,y1:a.y,x2:o.x,y2:o.y,stroke:n,strokeWidth:2,strokeOpacity:.2}),r>.1&&l.jsxs(l.Fragment,{children:[l.jsx(Fe.circle,{cx:a.x,cy:a.y,fill:"none",stroke:n,strokeWidth:2,initial:{r:5,opacity:.8},animate:{r:25,opacity:0},transition:{duration:c*.8,repeat:1/0}}),l.jsx(Fe.circle,{cx:d,cy:u,fill:"none",stroke:n,strokeWidth:2,initial:{r:5,opacity:.6},animate:{r:20,opacity:0},transition:{duration:c*.8,repeat:1/0,delay:c*.4}})]})]})}function Ii({x:t,y:e,iconType:s,label:n,value:i,color:r,glowIntensity:a=0,isCharging:o}){const d=35+20*a,u={solar:jr,house:Fp,battery:o?Sr:fo,grid:It,water:po}[s];return l.jsxs("g",{transform:`translate(${t}, ${e})`,children:[a>.1&&l.jsx(Fe.circle,{r:d,fill:r,initial:{opacity:0},animate:{opacity:.12+a*.15},transition:{duration:.3}}),l.jsx("circle",{r:35,fill:"rgb(var(--color-surface))",stroke:r,strokeWidth:3}),l.jsx("foreignObject",{x:-12,y:-12,width:24,height:24,children:l.jsx(u,{size:24,style:{color:r},strokeWidth:1.5})}),l.jsx("text",{y:55,textAnchor:"middle",fill:"rgb(var(--color-text))",fontSize:"11",fontWeight:"600",children:i}),l.jsx("text",{y:70,textAnchor:"middle",fill:"rgb(var(--color-muted))",fontSize:"9",children:n})]})}function yO({data:t,style:e}){const s={solar:{x:100,y:60},house:{x:200,y:150},battery:{x:200,y:260},grid:{x:100,y:260},water:{x:300,y:150}},n={solar:"rgb(var(--color-accent))",battery:"rgb(var(--color-good))",grid:"rgb(var(--color-grid))",house:"rgb(var(--color-house))",water:"rgb(var(--color-water))"},i=6,r={solar:Math.min(t.solar/i,1),battery:Math.min(Math.abs(t.battery)/i,1),grid:Math.min(Math.abs(t.grid)/i,1),house:Math.min(t.house/i,1),water:Math.min(t.water/i,1)},a=(o,c,d,u,h,f)=>{if(Math.abs(u)<.1)return l.jsx("line",{x1:c.x,y1:c.y,x2:d.x,y2:d.y,stroke:h,strokeWidth:1,strokeOpacity:.1},o);switch(e){case"particles":return l.jsx(uO,{from:c,to:d,power:u,color:h,reverse:f},o);case"glow-flow":return l.jsx(hO,{id:o,from:c,to:d,power:u,color:h,reverse:f},o);case"dash-flow":return l.jsx(fO,{from:c,to:d,power:u,color:h,reverse:f},o);case"arrows":return l.jsx(mO,{from:c,to:d,power:u,color:h,reverse:f},o);case"thickness":return l.jsx(pO,{from:c,to:d,power:u,color:h,reverse:f},o);case"heat-trail":return l.jsx(gO,{id:o,from:c,to:d,power:u,color:h,reverse:f},o);case"ping":return l.jsx(xO,{from:c,to:d,power:u,color:h,reverse:f},o)}};return l.jsxs("svg",{viewBox:"0 0 400 320",className:"w-full max-w-lg mx-auto",children:[a("solar-house",s.solar,s.house,t.solar,n.solar,!1),a("battery-house",s.battery,s.house,Math.abs(t.battery),n.battery,t.battery>0),a("grid-house",s.grid,s.house,Math.abs(t.grid),n.grid,t.grid<0),a("house-water",s.house,s.water,t.water,n.water,!1),l.jsx(Ii,{...s.solar,iconType:"solar",label:"Solar",value:`${t.solar.toFixed(1)} kW`,color:n.solar,glowIntensity:e==="glow-flow"?r.solar:0}),l.jsx(Ii,{...s.house,iconType:"house",label:"House",value:`${t.house.toFixed(1)} kW`,color:n.house,glowIntensity:e==="glow-flow"?r.house:0}),l.jsx(Ii,{...s.battery,iconType:"battery",label:t.battery>=0?"Charging":"Discharging",value:`${t.batterySOC}%`,color:n.battery,glowIntensity:e==="glow-flow"?r.battery:0,isCharging:t.battery>0}),l.jsx(Ii,{...s.grid,iconType:"grid",label:t.grid>=0?"Import":"Export",value:`${Math.abs(t.grid).toFixed(1)} kW`,color:n.grid,glowIntensity:e==="glow-flow"?r.grid:0}),l.jsx(Ii,{...s.water,iconType:"water",label:"Water",value:`${t.water.toFixed(1)} kW`,color:n.water,glowIntensity:e==="glow-flow"?r.water:0})]})}function bO(){const[t,e]=y.useState("particles"),[s,n]=y.useState("sunny"),[i,r]=y.useState(null),a=y.useMemo(()=>i??pp(s),[i,s]),o=[{id:"particles",label:"1. Particles",description:"Clean dots, regular spacing"},{id:"glow-flow",label:"2. Glow + Dash",description:"Hub glow + animated dashes"},{id:"dash-flow",label:"3. Dash Flow",description:"Simple animated dashes"},{id:"arrows",label:"4. Arrows",description:"Chevrons traveling along path"},{id:"thickness",label:"5. Thickness",description:"Line breathes with power"},{id:"heat-trail",label:"6. Heat Trail",description:"Gradient fills like liquid"},{id:"ping",label:"7. Ping",description:"Ripples from source nodes"}],c=[{id:"sunny",label:" Sunny"},{id:"evening",label:" Evening"},{id:"charging",label:" Charging"},{id:"exporting",label:" Exporting"}],d=(u,h)=>{const f=i??pp(s);r({...f,[u]:h})};return l.jsxs("div",{className:"px-4 pt-16 pb-10 lg:px-8 lg:pt-10 space-y-6",children:[l.jsxs("div",{children:[l.jsxs("h1",{className:"text-lg font-medium text-text flex items-center gap-2",children:[" Power Flow Lab",l.jsx("span",{className:"px-2 py-0.5 rounded-full bg-accent/20 text-[10px] text-accent uppercase tracking-wider",children:"v2"})]}),l.jsx("p",{className:"text-[11px] text-muted",children:"Compare 7 animation styles  Lucide icons  Improved spacing"})]}),l.jsxs(de,{className:"p-4",children:[l.jsx("div",{className:"text-[10px] uppercase font-bold text-muted tracking-wider mb-3",children:"Animation Style"}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-2",children:o.map(u=>l.jsxs("button",{onClick:()=>e(u.id),className:`p-3 rounded-xl border transition-all text-left ${t===u.id?"border-accent bg-accent/10":"border-line/50 hover:border-line"}`,children:[l.jsx("div",{className:"text-[11px] font-medium text-text",children:u.label}),l.jsx("div",{className:"text-[9px] text-muted leading-tight",children:u.description})]},u.id))})]}),l.jsx(de,{className:"p-6",children:l.jsx(nj,{mode:"wait",children:l.jsx(Fe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:l.jsx(yO,{data:a,style:t})},t)})}),l.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[l.jsxs(de,{className:"p-4",children:[l.jsx("div",{className:"text-[10px] uppercase font-bold text-muted tracking-wider mb-3",children:"Presets"}),l.jsx("div",{className:"grid grid-cols-4 gap-2",children:c.map(u=>l.jsx("button",{onClick:()=>{n(u.id),r(null)},className:`px-3 py-2 rounded-lg border text-xs transition-all ${s===u.id&&!i?"border-accent bg-accent/10 text-text":"border-line/50 text-muted hover:text-text"}`,children:u.label},u.id))})]}),l.jsxs(de,{className:"p-4",children:[l.jsx("div",{className:"text-[10px] uppercase font-bold text-muted tracking-wider mb-3",children:"Custom Values"}),l.jsx("div",{className:"space-y-3",children:[{key:"solar",label:"Solar",min:0,max:8},{key:"battery",label:"Battery",min:-5,max:5},{key:"grid",label:"Grid",min:-6,max:6},{key:"house",label:"House",min:0,max:6},{key:"water",label:"Water",min:0,max:3}].map(u=>l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"text-xs text-muted w-14",children:u.label}),l.jsx("input",{type:"range",min:u.min,max:u.max,step:.1,value:a[u.key],onChange:h=>d(u.key,parseFloat(h.target.value)),className:"flex-1 h-1 bg-line rounded-full appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:bg-accent [&::-webkit-slider-thumb]:rounded-full"}),l.jsxs("span",{className:"text-xs text-text w-16 text-right",children:[a[u.key].toFixed(1)," kW"]})]},u.key))})]})]})]})}function vO(){const t=[],e=new Date;e.setMinutes(0,0,0);for(let s=0;s<48;s++){const n=new Date(e.getTime()+s*3600*1e3),i=n.getHours();let r=0;i>5&&i<20&&(r=5*Math.sin((i-6)/14*Math.PI)),r=Math.max(0,r+(Math.random()*.5-.25));let a=1;a+=2*Math.exp(-Math.pow(i-8,2)/4),a+=3*Math.exp(-Math.pow(i-19,2)/6),a=Math.max(.5,a+(Math.random()*.5-.25)),t.push({slot_start:n.toISOString(),base:{pv_kwh:r*.8,load_kwh:a*.9},correction:{pv_kwh:r*.2,load_kwh:a*.1},final:{pv_kwh:r,load_kwh:a}})}return t}function _O(){const[t]=y.useState(vO());return l.jsxs("div",{className:"p-8 space-y-16 max-w-5xl mx-auto pb-32",children:[l.jsxs("header",{children:[l.jsx("div",{className:"inline-block px-3 py-1 rounded-full bg-surface2 text-[10px] text-muted uppercase tracking-wider font-bold mb-4",children:"Rev UI6 Brainstorm V2"}),l.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Chart Makeover Concepts"}),l.jsx("p",{className:"text-muted text-lg",children:"Exploring radically different aesthetics."})]}),l.jsxs("section",{className:"space-y-4",children:[l.jsx("div",{className:"flex items-baseline justify-between",children:l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-accent",children:'Option A: "The Field" (Fixed)'}),l.jsx("p",{className:"text-sm text-muted",children:"Tactile, vertical gradients, glowing lines. Now with a real CSS dot grid."})]})}),l.jsxs("div",{className:"relative h-[360px] w-full bg-surface rounded-2xl border border-line shadow-float overflow-hidden p-6",children:[l.jsx("div",{className:"absolute top-4 right-4 px-2 py-1 bg-surface/50 backdrop-blur rounded text-[10px] text-muted font-mono z-10",children:"OP-1 / TE Inspired"}),l.jsx(Pa,{slots:t,mode:"pv",variant:"field"})]})]}),l.jsxs("section",{className:"space-y-4",children:[l.jsx("div",{className:"flex items-baseline justify-between",children:l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-[#22d3ee] font-mono",children:'Option B: "The OLED"'}),l.jsx("p",{className:"text-sm text-muted",children:"Pure black, neon thin lines, high contrast. No fills."})]})}),l.jsx("div",{className:"relative h-[360px] w-full bg-black rounded-xl border border-[#333] p-6 shadow-2xl font-mono",children:l.jsx(Pa,{slots:t,mode:"pv",variant:"oled"})})]}),l.jsxs("section",{className:"space-y-4",children:[l.jsx("div",{className:"flex items-baseline justify-between",children:l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-black dark:text-white",children:'Option C: "The Swiss"'}),l.jsx("p",{className:"text-sm text-muted",children:"Brutalist, thick lines, solid colors. No gradients, no fluff."})]})}),l.jsxs("div",{className:"relative h-[360px] w-full bg-[#f4f4f5] border-4 border-black p-8",children:[l.jsx("div",{className:"absolute top-0 left-0 bg-black text-white px-3 py-1 text-xs font-bold uppercase tracking-widest",children:"Power Log"}),l.jsx(Pa,{slots:t,mode:"pv",variant:"swiss"})]})]})]})}function wO({children:t}){const[e,s]=y.useState([]),n=y.useCallback(r=>{s(a=>a.filter(o=>o.id!==r))},[]),i=y.useCallback(({message:r,description:a,variant:o})=>{const c=Math.random().toString(36).substring(2,9);s(d=>[...d,{id:c,message:r,description:a,variant:o}]),setTimeout(()=>{n(c)},5e3)},[n]);return l.jsxs(Fy.Provider,{value:{toast:i,dismiss:n},children:[t,gp.createPortal(l.jsx("div",{className:"fixed bottom-0 right-0 z-[100] p-6 space-y-4 max-w-sm w-full pointer-events-none",children:e.map(r=>l.jsxs("div",{className:`
                                pointer-events-auto
                                flex gap-3 p-4 rounded-ds-lg shadow-2xl border
                                animate-in slide-in-from-right-full duration-300
                                ${kO(r.variant)}
                            `,children:[l.jsx("div",{className:"shrink-0 mt-0.5",children:SO(r.variant)}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"font-semibold text-sm",children:r.message}),r.description&&l.jsx("div",{className:"text-xs opacity-90 mt-1",children:r.description})]}),l.jsx("button",{onClick:()=>n(r.id),className:"shrink-0 -mt-1 -mr-1 p-1 rounded hover:bg-black/10 transition-colors",children:l.jsx(ii,{className:"h-4 w-4"})})]},r.id))}),document.body)]})}function kO(t){switch(t){case"success":return"bg-surface2 border-good text-text";case"error":return"bg-bad text-white border-bad";case"warning":return"bg-warn text-black border-warn";case"info":return"bg-surface2 border-line text-text";default:return""}}function SO(t){switch(t){case"success":return l.jsx(Op,{className:"h-5 w-5 text-good"});case"error":return l.jsx(Mv,{className:"h-5 w-5 text-white"});case"warning":return l.jsx(va,{className:"h-5 w-5 text-black"});case"info":return l.jsx(ec,{className:"h-5 w-5 text-accent"});default:return null}}function DO(){const[t,e]=y.useState(!1),[s,n]=y.useState(null);return y.useEffect(()=>{let i=!1,r=0;const a=async()=>{try{const[,c]=await Promise.all([K.status(),K.health()]);if(i)return;r=0,e(!1),n(c)}catch{if(i)return;r+=1,r>=3&&(e(!0),n(null))}};a();const o=window.setInterval(a,6e4);return()=>{i=!0,window.clearInterval(o)}},[]),l.jsx(Hv,{children:l.jsx(wO,{children:l.jsxs(xv,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:[l.jsx(zv,{}),l.jsxs("div",{className:"lg:pl-[96px]",children:[s&&!s.healthy&&l.jsx(Jy,{health:s}),t&&!s&&l.jsx("div",{className:"bg-amber-900/80 border-b border-amber-500/60 text-amber-100 text-[11px] px-4 py-2 flex items-center justify-between",children:l.jsx("span",{children:"Backend appears offline or degraded. Some data may be stale or unavailable."})}),l.jsxs(lv,{children:[l.jsx(ds,{path:"/",element:l.jsx(AP,{})}),l.jsx(ds,{path:"/executor",element:l.jsx(cO,{})}),l.jsx(ds,{path:"/aurora",element:l.jsx(lO,{})}),l.jsx(ds,{path:"/debug",element:l.jsx(OP,{})}),l.jsx(ds,{path:"/settings",element:l.jsx(XP,{})}),l.jsx(ds,{path:"/design-system",element:l.jsx(dO,{})}),l.jsx(ds,{path:"/power-flow-lab",element:l.jsx(bO,{})}),l.jsx(ds,{path:"/chart-examples",element:l.jsx(_O,{})})]})]})]})})})}export{DO as default};
