<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Page</title>
    <style>
        body { font-family: monospace; background: #1F2326; color: #D1D0CC; padding: 20px; }
        .debug { background: #262C31; padding: 10px; margin: 10px 0; border: 1px solid #D1D0CC; }
    </style>
</head>
<body>
    <h1>Debug Test</h1>
    <div id="debug" class="debug">Loading...</div>
    <canvas id="testChart" width="800" height="400"></canvas>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const debug = document.getElementById('debug');
            
            try {
                debug.innerHTML = 'Testing APIs...';
                
                // Test schedule API
                const scheduleResponse = await fetch('/api/schedule');
                debug.innerHTML += '<br>✓ Schedule API status: ' + scheduleResponse.status;
                const scheduleData = await scheduleResponse.json();
                debug.innerHTML += '<br>✓ Schedule slots: ' + scheduleData.schedule.length;
                
                // Test config API
                const configResponse = await fetch('/api/config');
                debug.innerHTML += '<br>✓ Config API status: ' + configResponse.status;
                const configData = await configResponse.json();
                const kwp = configData.system?.solar_array?.kwp || 5;
                debug.innerHTML += '<br>✓ System kWp: ' + kwp;
                
                // Create simple chart
                const ctx = document.getElementById('testChart').getContext('2d');
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['00:00', '06:00', '12:00', '18:00', '24:00'],
                        datasets: [{
                            label: 'Test Data',
                            data: [0, 2, 5, 2, 0],
                            borderColor: '#A9C17E',
                            backgroundColor: 'rgba(169, 193, 126, 0.2)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: kwp,
                                title: {
                                    display: true,
                                    text: `Power (kW) - Max: ${kwp} kWp`
                                }
                            }
                        }
                    }
                });
                
                debug.innerHTML += '<br>✓ Chart created successfully!';
                
            } catch (error) {
                debug.innerHTML += '<br>✗ Error: ' + error.message;
                console.error('Full error:', error);
            }
        });
    </script>
</body>
</html>